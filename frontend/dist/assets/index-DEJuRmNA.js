var ZP=Object.defineProperty;var GP=(n,e,t)=>e in n?ZP(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var La=(n,e,t)=>GP(n,typeof e!="symbol"?e+"":e,t);function XP(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Lk(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var qg={exports:{}},Eu={},Vg={exports:{}},Ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ub;function KP(){if(ub)return Ot;ub=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function x(B){return B===null||typeof B!="object"?null:(B=g&&B[g]||B["@@iterator"],typeof B=="function"?B:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function w(B,Q,G){this.props=B,this.context=Q,this.refs=b,this.updater=G||A}w.prototype.isReactComponent={},w.prototype.setState=function(B,Q){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Q,"setState")},w.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function C(){}C.prototype=w.prototype;function T(B,Q,G){this.props=B,this.context=Q,this.refs=b,this.updater=G||A}var E=T.prototype=new C;E.constructor=T,_(E,w.prototype),E.isPureReactComponent=!0;var D=Array.isArray,N=Object.prototype.hasOwnProperty,F={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function I(B,Q,G){var Y,ue={},pe=null,ve=null;if(Q!=null)for(Y in Q.ref!==void 0&&(ve=Q.ref),Q.key!==void 0&&(pe=""+Q.key),Q)N.call(Q,Y)&&!z.hasOwnProperty(Y)&&(ue[Y]=Q[Y]);var xe=arguments.length-2;if(xe===1)ue.children=G;else if(1<xe){for(var ye=Array(xe),Pe=0;Pe<xe;Pe++)ye[Pe]=arguments[Pe+2];ue.children=ye}if(B&&B.defaultProps)for(Y in xe=B.defaultProps,xe)ue[Y]===void 0&&(ue[Y]=xe[Y]);return{$$typeof:n,type:B,key:pe,ref:ve,props:ue,_owner:F.current}}function K(B,Q){return{$$typeof:n,type:B.type,key:Q,ref:B.ref,props:B.props,_owner:B._owner}}function W(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function U(B){var Q={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(G){return Q[G]})}var X=/\/+/g;function $(B,Q){return typeof B=="object"&&B!==null&&B.key!=null?U(""+B.key):Q.toString(36)}function ee(B,Q,G,Y,ue){var pe=typeof B;(pe==="undefined"||pe==="boolean")&&(B=null);var ve=!1;if(B===null)ve=!0;else switch(pe){case"string":case"number":ve=!0;break;case"object":switch(B.$$typeof){case n:case e:ve=!0}}if(ve)return ve=B,ue=ue(ve),B=Y===""?"."+$(ve,0):Y,D(ue)?(G="",B!=null&&(G=B.replace(X,"$&/")+"/"),ee(ue,Q,G,"",function(Pe){return Pe})):ue!=null&&(W(ue)&&(ue=K(ue,G+(!ue.key||ve&&ve.key===ue.key?"":(""+ue.key).replace(X,"$&/")+"/")+B)),Q.push(ue)),1;if(ve=0,Y=Y===""?".":Y+":",D(B))for(var xe=0;xe<B.length;xe++){pe=B[xe];var ye=Y+$(pe,xe);ve+=ee(pe,Q,G,ye,ue)}else if(ye=x(B),typeof ye=="function")for(B=ye.call(B),xe=0;!(pe=B.next()).done;)pe=pe.value,ye=Y+$(pe,xe++),ve+=ee(pe,Q,G,ye,ue);else if(pe==="object")throw Q=String(B),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return ve}function le(B,Q,G){if(B==null)return B;var Y=[],ue=0;return ee(B,Y,"","",function(pe){return Q.call(G,pe,ue++)}),Y}function Z(B){if(B._status===-1){var Q=B._result;Q=Q(),Q.then(function(G){(B._status===0||B._status===-1)&&(B._status=1,B._result=G)},function(G){(B._status===0||B._status===-1)&&(B._status=2,B._result=G)}),B._status===-1&&(B._status=0,B._result=Q)}if(B._status===1)return B._result.default;throw B._result}var ie={current:null},V={transition:null},ne={ReactCurrentDispatcher:ie,ReactCurrentBatchConfig:V,ReactCurrentOwner:F};function q(){throw Error("act(...) is not supported in production builds of React.")}return Ot.Children={map:le,forEach:function(B,Q,G){le(B,function(){Q.apply(this,arguments)},G)},count:function(B){var Q=0;return le(B,function(){Q++}),Q},toArray:function(B){return le(B,function(Q){return Q})||[]},only:function(B){if(!W(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Ot.Component=w,Ot.Fragment=t,Ot.Profiler=i,Ot.PureComponent=T,Ot.StrictMode=r,Ot.Suspense=u,Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Ot.act=q,Ot.cloneElement=function(B,Q,G){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var Y=_({},B.props),ue=B.key,pe=B.ref,ve=B._owner;if(Q!=null){if(Q.ref!==void 0&&(pe=Q.ref,ve=F.current),Q.key!==void 0&&(ue=""+Q.key),B.type&&B.type.defaultProps)var xe=B.type.defaultProps;for(ye in Q)N.call(Q,ye)&&!z.hasOwnProperty(ye)&&(Y[ye]=Q[ye]===void 0&&xe!==void 0?xe[ye]:Q[ye])}var ye=arguments.length-2;if(ye===1)Y.children=G;else if(1<ye){xe=Array(ye);for(var Pe=0;Pe<ye;Pe++)xe[Pe]=arguments[Pe+2];Y.children=xe}return{$$typeof:n,type:B.type,key:ue,ref:pe,props:Y,_owner:ve}},Ot.createContext=function(B){return B={$$typeof:o,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:s,_context:B},B.Consumer=B},Ot.createElement=I,Ot.createFactory=function(B){var Q=I.bind(null,B);return Q.type=B,Q},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(B){return{$$typeof:a,render:B}},Ot.isValidElement=W,Ot.lazy=function(B){return{$$typeof:p,_payload:{_status:-1,_result:B},_init:Z}},Ot.memo=function(B,Q){return{$$typeof:f,type:B,compare:Q===void 0?null:Q}},Ot.startTransition=function(B){var Q=V.transition;V.transition={};try{B()}finally{V.transition=Q}},Ot.unstable_act=q,Ot.useCallback=function(B,Q){return ie.current.useCallback(B,Q)},Ot.useContext=function(B){return ie.current.useContext(B)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(B){return ie.current.useDeferredValue(B)},Ot.useEffect=function(B,Q){return ie.current.useEffect(B,Q)},Ot.useId=function(){return ie.current.useId()},Ot.useImperativeHandle=function(B,Q,G){return ie.current.useImperativeHandle(B,Q,G)},Ot.useInsertionEffect=function(B,Q){return ie.current.useInsertionEffect(B,Q)},Ot.useLayoutEffect=function(B,Q){return ie.current.useLayoutEffect(B,Q)},Ot.useMemo=function(B,Q){return ie.current.useMemo(B,Q)},Ot.useReducer=function(B,Q,G){return ie.current.useReducer(B,Q,G)},Ot.useRef=function(B){return ie.current.useRef(B)},Ot.useState=function(B){return ie.current.useState(B)},Ot.useSyncExternalStore=function(B,Q,G){return ie.current.useSyncExternalStore(B,Q,G)},Ot.useTransition=function(){return ie.current.useTransition()},Ot.version="18.3.1",Ot}var hb;function uv(){return hb||(hb=1,Vg.exports=KP()),Vg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb;function YP(){if(fb)return Eu;fb=1;var n=uv(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,f){var p,g={},x=null,A=null;f!==void 0&&(x=""+f),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(A=u.ref);for(p in u)r.call(u,p)&&!s.hasOwnProperty(p)&&(g[p]=u[p]);if(a&&a.defaultProps)for(p in u=a.defaultProps,u)g[p]===void 0&&(g[p]=u[p]);return{$$typeof:e,type:a,key:x,ref:A,props:g,_owner:i.current}}return Eu.Fragment=t,Eu.jsx=o,Eu.jsxs=o,Eu}var db;function JP(){return db||(db=1,qg.exports=YP()),qg.exports}var S=JP(),R=uv();const Be=Rc(R),hv=XP({__proto__:null,default:Be},[R]);var ud={},$g={exports:{}},Rr={},Ug={exports:{}},Zg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pb;function eB(){return pb||(pb=1,(function(n){function e(V,ne){var q=V.length;V.push(ne);e:for(;0<q;){var B=q-1>>>1,Q=V[B];if(0<i(Q,ne))V[B]=ne,V[q]=Q,q=B;else break e}}function t(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var ne=V[0],q=V.pop();if(q!==ne){V[0]=q;e:for(var B=0,Q=V.length,G=Q>>>1;B<G;){var Y=2*(B+1)-1,ue=V[Y],pe=Y+1,ve=V[pe];if(0>i(ue,q))pe<Q&&0>i(ve,ue)?(V[B]=ve,V[pe]=q,B=pe):(V[B]=ue,V[Y]=q,B=Y);else if(pe<Q&&0>i(ve,q))V[B]=ve,V[pe]=q,B=pe;else break e}}return ne}function i(V,ne){var q=V.sortIndex-ne.sortIndex;return q!==0?q:V.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var u=[],f=[],p=1,g=null,x=3,A=!1,_=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(V){for(var ne=t(f);ne!==null;){if(ne.callback===null)r(f);else if(ne.startTime<=V)r(f),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=t(f)}}function D(V){if(b=!1,E(V),!_)if(t(u)!==null)_=!0,Z(N);else{var ne=t(f);ne!==null&&ie(D,ne.startTime-V)}}function N(V,ne){_=!1,b&&(b=!1,C(I),I=-1),A=!0;var q=x;try{for(E(ne),g=t(u);g!==null&&(!(g.expirationTime>ne)||V&&!U());){var B=g.callback;if(typeof B=="function"){g.callback=null,x=g.priorityLevel;var Q=B(g.expirationTime<=ne);ne=n.unstable_now(),typeof Q=="function"?g.callback=Q:g===t(u)&&r(u),E(ne)}else r(u);g=t(u)}if(g!==null)var G=!0;else{var Y=t(f);Y!==null&&ie(D,Y.startTime-ne),G=!1}return G}finally{g=null,x=q,A=!1}}var F=!1,z=null,I=-1,K=5,W=-1;function U(){return!(n.unstable_now()-W<K)}function X(){if(z!==null){var V=n.unstable_now();W=V;var ne=!0;try{ne=z(!0,V)}finally{ne?$():(F=!1,z=null)}}else F=!1}var $;if(typeof T=="function")$=function(){T(X)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,le=ee.port2;ee.port1.onmessage=X,$=function(){le.postMessage(null)}}else $=function(){w(X,0)};function Z(V){z=V,F||(F=!0,$())}function ie(V,ne){I=w(function(){V(n.unstable_now())},ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_continueExecution=function(){_||A||(_=!0,Z(N))},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(V){switch(x){case 1:case 2:case 3:var ne=3;break;default:ne=x}var q=x;x=ne;try{return V()}finally{x=q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(V,ne){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var q=x;x=V;try{return ne()}finally{x=q}},n.unstable_scheduleCallback=function(V,ne,q){var B=n.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?B+q:B):q=B,V){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=q+Q,V={id:p++,callback:ne,priorityLevel:V,startTime:q,expirationTime:Q,sortIndex:-1},q>B?(V.sortIndex=q,e(f,V),t(u)===null&&V===t(f)&&(b?(C(I),I=-1):b=!0,ie(D,q-B))):(V.sortIndex=Q,e(u,V),_||A||(_=!0,Z(N))),V},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(V){var ne=x;return function(){var q=x;x=ne;try{return V.apply(this,arguments)}finally{x=q}}}})(Zg)),Zg}var mb;function tB(){return mb||(mb=1,Ug.exports=eB()),Ug.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb;function nB(){if(gb)return Rr;gb=1;var n=uv(),e=tB();function t(l){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+l,m=1;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+l+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(l,h){o(l,h),o(l+"Capture",h)}function o(l,h){for(i[l]=h,l=0;l<h.length;l++)r.add(h[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function x(l){return u.call(g,l)?!0:u.call(p,l)?!1:f.test(l)?g[l]=!0:(p[l]=!0,!1)}function A(l,h,m,v){if(m!==null&&m.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return v?!1:m!==null?!m.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function _(l,h,m,v){if(h===null||typeof h>"u"||A(l,h,m,v))return!0;if(v)return!1;if(m!==null)switch(m.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function b(l,h,m,v,k,P,j){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=v,this.attributeNamespace=k,this.mustUseProperty=m,this.propertyName=l,this.type=h,this.sanitizeURL=P,this.removeEmptyString=j}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new b(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var h=l[0];w[h]=new b(h,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new b(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new b(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new b(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new b(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new b(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new b(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new b(l,5,!1,l.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function T(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var h=l.replace(C,T);w[h]=new b(h,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var h=l.replace(C,T);w[h]=new b(h,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var h=l.replace(C,T);w[h]=new b(h,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new b(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new b(l,1,!1,l.toLowerCase(),null,!0,!0)});function E(l,h,m,v){var k=w.hasOwnProperty(h)?w[h]:null;(k!==null?k.type!==0:v||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(_(h,m,k,v)&&(m=null),v||k===null?x(h)&&(m===null?l.removeAttribute(h):l.setAttribute(h,""+m)):k.mustUseProperty?l[k.propertyName]=m===null?k.type===3?!1:"":m:(h=k.attributeName,v=k.attributeNamespace,m===null?l.removeAttribute(h):(k=k.type,m=k===3||k===4&&m===!0?"":""+m,v?l.setAttributeNS(v,h,m):l.setAttribute(h,m))))}var D=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),F=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),U=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),le=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ie=Symbol.for("react.offscreen"),V=Symbol.iterator;function ne(l){return l===null||typeof l!="object"?null:(l=V&&l[V]||l["@@iterator"],typeof l=="function"?l:null)}var q=Object.assign,B;function Q(l){if(B===void 0)try{throw Error()}catch(m){var h=m.stack.trim().match(/\n( *(at )?)/);B=h&&h[1]||""}return`
`+B+l}var G=!1;function Y(l,h){if(!l||G)return"";G=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ge){var v=ge}Reflect.construct(l,[],h)}else{try{h.call()}catch(ge){v=ge}l.call(h.prototype)}else{try{throw Error()}catch(ge){v=ge}l()}}catch(ge){if(ge&&v&&typeof ge.stack=="string"){for(var k=ge.stack.split(`
`),P=v.stack.split(`
`),j=k.length-1,J=P.length-1;1<=j&&0<=J&&k[j]!==P[J];)J--;for(;1<=j&&0<=J;j--,J--)if(k[j]!==P[J]){if(j!==1||J!==1)do if(j--,J--,0>J||k[j]!==P[J]){var re=`
`+k[j].replace(" at new "," at ");return l.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",l.displayName)),re}while(1<=j&&0<=J);break}}}finally{G=!1,Error.prepareStackTrace=m}return(l=l?l.displayName||l.name:"")?Q(l):""}function ue(l){switch(l.tag){case 5:return Q(l.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return l=Y(l.type,!1),l;case 11:return l=Y(l.type.render,!1),l;case 1:return l=Y(l.type,!0),l;default:return""}}function pe(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case z:return"Fragment";case F:return"Portal";case K:return"Profiler";case I:return"StrictMode";case $:return"Suspense";case ee:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case U:return(l.displayName||"Context")+".Consumer";case W:return(l._context.displayName||"Context")+".Provider";case X:var h=l.render;return l=l.displayName,l||(l=h.displayName||h.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case le:return h=l.displayName||null,h!==null?h:pe(l.type)||"Memo";case Z:h=l._payload,l=l._init;try{return pe(l(h))}catch{}}return null}function ve(l){var h=l.type;switch(l.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=h.render,l=l.displayName||l.name||"",h.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(h);case 8:return h===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function xe(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function ye(l){var h=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Pe(l){var h=ye(l)?"checked":"value",m=Object.getOwnPropertyDescriptor(l.constructor.prototype,h),v=""+l[h];if(!l.hasOwnProperty(h)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var k=m.get,P=m.set;return Object.defineProperty(l,h,{configurable:!0,get:function(){return k.call(this)},set:function(j){v=""+j,P.call(this,j)}}),Object.defineProperty(l,h,{enumerable:m.enumerable}),{getValue:function(){return v},setValue:function(j){v=""+j},stopTracking:function(){l._valueTracker=null,delete l[h]}}}}function Ke(l){l._valueTracker||(l._valueTracker=Pe(l))}function nt(l){if(!l)return!1;var h=l._valueTracker;if(!h)return!0;var m=h.getValue(),v="";return l&&(v=ye(l)?l.checked?"true":"false":l.value),l=v,l!==m?(h.setValue(l),!0):!1}function Ce(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function Ge(l,h){var m=h.checked;return q({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??l._wrapperState.initialChecked})}function pt(l,h){var m=h.defaultValue==null?"":h.defaultValue,v=h.checked!=null?h.checked:h.defaultChecked;m=xe(h.value!=null?h.value:m),l._wrapperState={initialChecked:v,initialValue:m,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function bt(l,h){h=h.checked,h!=null&&E(l,"checked",h,!1)}function ot(l,h){bt(l,h);var m=xe(h.value),v=h.type;if(m!=null)v==="number"?(m===0&&l.value===""||l.value!=m)&&(l.value=""+m):l.value!==""+m&&(l.value=""+m);else if(v==="submit"||v==="reset"){l.removeAttribute("value");return}h.hasOwnProperty("value")?et(l,h.type,m):h.hasOwnProperty("defaultValue")&&et(l,h.type,xe(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(l.defaultChecked=!!h.defaultChecked)}function mt(l,h,m){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var v=h.type;if(!(v!=="submit"&&v!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+l._wrapperState.initialValue,m||h===l.value||(l.value=h),l.defaultValue=h}m=l.name,m!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,m!==""&&(l.name=m)}function et(l,h,m){(h!=="number"||Ce(l.ownerDocument)!==l)&&(m==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+m&&(l.defaultValue=""+m))}var tt=Array.isArray;function at(l,h,m,v){if(l=l.options,h){h={};for(var k=0;k<m.length;k++)h["$"+m[k]]=!0;for(m=0;m<l.length;m++)k=h.hasOwnProperty("$"+l[m].value),l[m].selected!==k&&(l[m].selected=k),k&&v&&(l[m].defaultSelected=!0)}else{for(m=""+xe(m),h=null,k=0;k<l.length;k++){if(l[k].value===m){l[k].selected=!0,v&&(l[k].defaultSelected=!0);return}h!==null||l[k].disabled||(h=l[k])}h!==null&&(h.selected=!0)}}function qe(l,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return q({},h,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Dt(l,h){var m=h.value;if(m==null){if(m=h.children,h=h.defaultValue,m!=null){if(h!=null)throw Error(t(92));if(tt(m)){if(1<m.length)throw Error(t(93));m=m[0]}h=m}h==null&&(h=""),m=h}l._wrapperState={initialValue:xe(m)}}function Jt(l,h){var m=xe(h.value),v=xe(h.defaultValue);m!=null&&(m=""+m,m!==l.value&&(l.value=m),h.defaultValue==null&&l.defaultValue!==m&&(l.defaultValue=m)),v!=null&&(l.defaultValue=""+v)}function dr(l){var h=l.textContent;h===l._wrapperState.initialValue&&h!==""&&h!==null&&(l.value=h)}function en(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vn(l,h){return l==null||l==="http://www.w3.org/1999/xhtml"?en(h):l==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var En,Zn=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,m,v,k){MSApp.execUnsafeLocalFunction(function(){return l(h,m,v,k)})}:l})(function(l,h){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=h;else{for(En=En||document.createElement("div"),En.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=En.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;h.firstChild;)l.appendChild(h.firstChild)}});function rn(l,h){if(h){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=h;return}}l.textContent=h}var Qt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sn=["Webkit","ms","Moz","O"];Object.keys(Qt).forEach(function(l){sn.forEach(function(h){h=h+l.charAt(0).toUpperCase()+l.substring(1),Qt[h]=Qt[l]})});function pr(l,h,m){return h==null||typeof h=="boolean"||h===""?"":m||typeof h!="number"||h===0||Qt.hasOwnProperty(l)&&Qt[l]?(""+h).trim():h+"px"}function zn(l,h){l=l.style;for(var m in h)if(h.hasOwnProperty(m)){var v=m.indexOf("--")===0,k=pr(m,h[m],v);m==="float"&&(m="cssFloat"),v?l.setProperty(m,k):l[m]=k}}var Ae=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Te(l,h){if(h){if(Ae[l]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function Ie(l,h){if(l.indexOf("-")===-1)return typeof h.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function se(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var be=null,Oe=null,Le=null;function lt(l){if(l=Ls(l)){if(typeof be!="function")throw Error(t(280));var h=l.stateNode;h&&(h=Fl(h),be(l.stateNode,l.type,h))}}function ae(l){Oe?Le?Le.push(l):Le=[l]:Oe=l}function De(){if(Oe){var l=Oe,h=Le;if(Le=Oe=null,lt(l),h)for(l=0;l<h.length;l++)lt(h[l])}}function wt(l,h){return l(h)}function Gt(){}var On=!1;function At(l,h,m){if(On)return l(h,m);On=!0;try{return wt(l,h,m)}finally{On=!1,(Oe!==null||Le!==null)&&(Gt(),De())}}function Ht(l,h){var m=l.stateNode;if(m===null)return null;var v=Fl(m);if(v===null)return null;m=v[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(l=l.type,v=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!v;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(t(231,h,typeof m));return m}var Qr=!1;if(a)try{var Mt={};Object.defineProperty(Mt,"passive",{get:function(){Qr=!0}}),window.addEventListener("test",Mt,Mt),window.removeEventListener("test",Mt,Mt)}catch{Qr=!1}function on(l,h,m,v,k,P,j,J,re){var ge=Array.prototype.slice.call(arguments,3);try{h.apply(m,ge)}catch(Se){this.onError(Se)}}var pn=!1,ze=null,co=!1,fl=null,Xh={onError:function(l){pn=!0,ze=l}};function Kh(l,h,m,v,k,P,j,J,re){pn=!1,ze=null,on.apply(Xh,arguments)}function jc(l,h,m,v,k,P,j,J,re){if(Kh.apply(this,arguments),pn){if(pn){var ge=ze;pn=!1,ze=null}else throw Error(t(198));co||(co=!0,fl=ge)}}function Gi(l){var h=l,m=l;if(l.alternate)for(;h.return;)h=h.return;else{l=h;do h=l,(h.flags&4098)!==0&&(m=h.return),l=h.return;while(l)}return h.tag===3?m:null}function ks(l){if(l.tag===13){var h=l.memoizedState;if(h===null&&(l=l.alternate,l!==null&&(h=l.memoizedState)),h!==null)return h.dehydrated}return null}function Qc(l){if(Gi(l)!==l)throw Error(t(188))}function bm(l){var h=l.alternate;if(!h){if(h=Gi(l),h===null)throw Error(t(188));return h!==l?null:l}for(var m=l,v=h;;){var k=m.return;if(k===null)break;var P=k.alternate;if(P===null){if(v=k.return,v!==null){m=v;continue}break}if(k.child===P.child){for(P=k.child;P;){if(P===m)return Qc(k),l;if(P===v)return Qc(k),h;P=P.sibling}throw Error(t(188))}if(m.return!==v.return)m=k,v=P;else{for(var j=!1,J=k.child;J;){if(J===m){j=!0,m=k,v=P;break}if(J===v){j=!0,v=k,m=P;break}J=J.sibling}if(!j){for(J=P.child;J;){if(J===m){j=!0,m=P,v=k;break}if(J===v){j=!0,v=P,m=k;break}J=J.sibling}if(!j)throw Error(t(189))}}if(m.alternate!==v)throw Error(t(190))}if(m.tag!==3)throw Error(t(188));return m.stateNode.current===m?l:h}function Yh(l){return l=bm(l),l!==null?Jh(l):null}function Jh(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var h=Jh(l);if(h!==null)return h;l=l.sibling}return null}var ef=e.unstable_scheduleCallback,Hc=e.unstable_cancelCallback,wm=e.unstable_shouldYield,dl=e.unstable_requestPaint,cn=e.unstable_now,_m=e.unstable_getCurrentPriorityLevel,Wc=e.unstable_ImmediatePriority,tf=e.unstable_UserBlockingPriority,pl=e.unstable_NormalPriority,qc=e.unstable_LowPriority,uo=e.unstable_IdlePriority,ha=null,Hr=null;function fa(l){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(ha,l,void 0,(l.current.flags&128)===128)}catch{}}var gt=Math.clz32?Math.clz32:ho,tn=Math.log,ml=Math.LN2;function ho(l){return l>>>=0,l===0?32:31-(tn(l)/ml|0)|0}var Si=64,fo=4194304;function ht(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Xt(l,h){var m=l.pendingLanes;if(m===0)return 0;var v=0,k=l.suspendedLanes,P=l.pingedLanes,j=m&268435455;if(j!==0){var J=j&~k;J!==0?v=ht(J):(P&=j,P!==0&&(v=ht(P)))}else j=m&~k,j!==0?v=ht(j):P!==0&&(v=ht(P));if(v===0)return 0;if(h!==0&&h!==v&&(h&k)===0&&(k=v&-v,P=h&-h,k>=P||k===16&&(P&4194240)!==0))return h;if((v&4)!==0&&(v|=m&16),h=l.entangledLanes,h!==0)for(l=l.entanglements,h&=v;0<h;)m=31-gt(h),k=1<<m,v|=l[m],h&=~k;return v}function Vc(l,h){switch(l){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gl(l,h){for(var m=l.suspendedLanes,v=l.pingedLanes,k=l.expirationTimes,P=l.pendingLanes;0<P;){var j=31-gt(P),J=1<<j,re=k[j];re===-1?((J&m)===0||(J&v)!==0)&&(k[j]=Vc(J,h)):re<=h&&(l.expiredLanes|=J),P&=~J}}function rr(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function nf(){var l=Si;return Si<<=1,(Si&4194240)===0&&(Si=64),l}function po(l){for(var h=[],m=0;31>m;m++)h.push(l);return h}function Wr(l,h,m){l.pendingLanes|=h,h!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,h=31-gt(h),l[h]=m}function mn(l,h){var m=l.pendingLanes&~h;l.pendingLanes=h,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=h,l.mutableReadLanes&=h,l.entangledLanes&=h,h=l.entanglements;var v=l.eventTimes;for(l=l.expirationTimes;0<m;){var k=31-gt(m),P=1<<k;h[k]=0,v[k]=-1,l[k]=-1,m&=~P}}function Ci(l,h){var m=l.entangledLanes|=h;for(l=l.entanglements;m;){var v=31-gt(m),k=1<<v;k&h|l[v]&h&&(l[v]|=h),m&=~k}}var Bt=0;function mo(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var xl,Ss,yl,vl,da,pa=!1,go=[],qr=null,Ti=null,ai=null,ma=new Map,ct=new Map,Pn=[],Wt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $c(l,h){switch(l){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":ma.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":ct.delete(h.pointerId)}}function Cs(l,h,m,v,k,P){return l===null||l.nativeEvent!==P?(l={blockedOn:h,domEventName:m,eventSystemFlags:v,nativeEvent:P,targetContainers:[k]},h!==null&&(h=Ls(h),h!==null&&Ss(h)),l):(l.eventSystemFlags|=v,h=l.targetContainers,k!==null&&h.indexOf(k)===-1&&h.push(k),l)}function Uc(l,h,m,v,k){switch(h){case"focusin":return qr=Cs(qr,l,h,m,v,k),!0;case"dragenter":return Ti=Cs(Ti,l,h,m,v,k),!0;case"mouseover":return ai=Cs(ai,l,h,m,v,k),!0;case"pointerover":var P=k.pointerId;return ma.set(P,Cs(ma.get(P)||null,l,h,m,v,k)),!0;case"gotpointercapture":return P=k.pointerId,ct.set(P,Cs(ct.get(P)||null,l,h,m,v,k)),!0}return!1}function Al(l){var h=Ns(l.target);if(h!==null){var m=Gi(h);if(m!==null){if(h=m.tag,h===13){if(h=ks(m),h!==null){l.blockedOn=h,da(l.priority,function(){yl(m)});return}}else if(h===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function li(l){if(l.blockedOn!==null)return!1;for(var h=l.targetContainers;0<h.length;){var m=_l(l.domEventName,l.eventSystemFlags,h[0],l.nativeEvent);if(m===null){m=l.nativeEvent;var v=new m.constructor(m.type,m);xt=v,m.target.dispatchEvent(v),xt=null}else return h=Ls(m),h!==null&&Ss(h),l.blockedOn=m,!1;h.shift()}return!0}function bl(l,h,m){li(l)&&m.delete(h)}function ga(){pa=!1,qr!==null&&li(qr)&&(qr=null),Ti!==null&&li(Ti)&&(Ti=null),ai!==null&&li(ai)&&(ai=null),ma.forEach(bl),ct.forEach(bl)}function un(l,h){l.blockedOn===h&&(l.blockedOn=null,pa||(pa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ga)))}function Vr(l){function h(k){return un(k,l)}if(0<go.length){un(go[0],l);for(var m=1;m<go.length;m++){var v=go[m];v.blockedOn===l&&(v.blockedOn=null)}}for(qr!==null&&un(qr,l),Ti!==null&&un(Ti,l),ai!==null&&un(ai,l),ma.forEach(h),ct.forEach(h),m=0;m<Pn.length;m++)v=Pn[m],v.blockedOn===l&&(v.blockedOn=null);for(;0<Pn.length&&(m=Pn[0],m.blockedOn===null);)Al(m),m.blockedOn===null&&Pn.shift()}var Ts=D.ReactCurrentBatchConfig,xa=!0;function Om(l,h,m,v){var k=Bt,P=Ts.transition;Ts.transition=null;try{Bt=1,ya(l,h,m,v)}finally{Bt=k,Ts.transition=P}}function rf(l,h,m,v){var k=Bt,P=Ts.transition;Ts.transition=null;try{Bt=4,ya(l,h,m,v)}finally{Bt=k,Ts.transition=P}}function ya(l,h,m,v){if(xa){var k=_l(l,h,m,v);if(k===null)c(l,h,v,wl,m),$c(l,v);else if(Uc(k,l,h,m,v))v.stopPropagation();else if($c(l,v),h&4&&-1<Wt.indexOf(l)){for(;k!==null;){var P=Ls(k);if(P!==null&&xl(P),P=_l(l,h,m,v),P===null&&c(l,h,v,wl,m),P===k)break;k=P}k!==null&&v.stopPropagation()}else c(l,h,v,null,m)}}var wl=null;function _l(l,h,m,v){if(wl=null,l=se(v),l=Ns(l),l!==null)if(h=Gi(l),h===null)l=null;else if(m=h.tag,m===13){if(l=ks(h),l!==null)return l;l=null}else if(m===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;l=null}else h!==l&&(l=null);return wl=l,null}function Ct(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_m()){case Wc:return 1;case tf:return 4;case pl:case qc:return 16;case uo:return 536870912;default:return 16}default:return 16}}var Xi=null,mr=null,Ki=null;function Zc(){if(Ki)return Ki;var l,h=mr,m=h.length,v,k="value"in Xi?Xi.value:Xi.textContent,P=k.length;for(l=0;l<m&&h[l]===k[l];l++);var j=m-l;for(v=1;v<=j&&h[m-v]===k[P-v];v++);return Ki=k.slice(l,1<v?1-v:void 0)}function Ol(l){var h=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&h===13&&(l=13)):l=h,l===10&&(l=13),32<=l||l===13?l:0}function xo(){return!0}function sf(){return!1}function ir(l){function h(m,v,k,P,j){this._reactName=m,this._targetInst=k,this.type=v,this.nativeEvent=P,this.target=j,this.currentTarget=null;for(var J in l)l.hasOwnProperty(J)&&(m=l[J],this[J]=m?m(P):P[J]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?xo:sf,this.isPropagationStopped=sf,this}return q(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=xo)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=xo)},persist:function(){},isPersistent:xo}),h}var yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gc=ir(yo),Es=q({},yo,{view:0,detail:0}),km=ir(Es),kr,Xc,vo,$r=q({},Es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bs,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==vo&&(vo&&l.type==="mousemove"?(kr=l.screenX-vo.screenX,Xc=l.screenY-vo.screenY):Xc=kr=0,vo=l),kr)},movementY:function(l){return"movementY"in l?l.movementY:Xc}}),Kc=ir($r),of=q({},$r,{dataTransfer:0}),Yc=ir(of),Sm=q({},Es,{relatedTarget:0}),kl=ir(Sm),af=q({},yo,{animationName:0,elapsedTime:0,pseudoElement:0}),Cm=ir(af),Tm=q({},yo,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Jc=ir(Tm),Em=q({},yo,{data:0}),eu=ir(Em),lf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ps={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pm(l){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(l):(l=Ps[l])?!!h[l]:!1}function Bs(){return Pm}var Sr=q({},Es,{key:function(l){if(l.key){var h=lf[l.key]||l.key;if(h!=="Unidentified")return h}return l.type==="keypress"?(l=Ol(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?Sl[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bs,charCode:function(l){return l.type==="keypress"?Ol(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Ol(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),cf=ir(Sr),uf=q({},$r,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hf=ir(uf),tu=q({},Es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bs}),nu=ir(tu),Bm=q({},yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rm=ir(Bm),ff=q({},$r,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Dm=ir(ff),Ur=[9,13,27,32],Yi=a&&"CompositionEvent"in window,va=null;a&&"documentMode"in document&&(va=document.documentMode);var Ei=a&&"TextEvent"in window&&!va,df=a&&(!Yi||va&&8<va&&11>=va),Rs=" ",pf=!1;function Ao(l,h){switch(l){case"keyup":return Ur.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ru(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Pi=!1;function Mm(l,h){switch(l){case"compositionend":return ru(h);case"keypress":return h.which!==32?null:(pf=!0,Rs);case"textInput":return l=h.data,l===Rs&&pf?null:l;default:return null}}function Ji(l,h){if(Pi)return l==="compositionend"||!Yi&&Ao(l,h)?(l=Zc(),Ki=mr=Xi=null,Pi=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return df&&h.locale!=="ko"?null:h.data;default:return null}}var Cl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mf(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h==="input"?!!Cl[l.type]:h==="textarea"}function Tl(l,h,m,v){ae(v),h=y(h,"onChange"),0<h.length&&(m=new Gc("onChange","change",null,m,v),l.push({event:m,listeners:h}))}var Aa=null,gr=null;function Nm(l){fu(l,0)}function Bi(l){var h=Fs(l);if(nt(h))return l}function Lm(l,h){if(l==="change")return h}var ci=!1;if(a){var bo;if(a){var El="oninput"in document;if(!El){var Pl=document.createElement("div");Pl.setAttribute("oninput","return;"),El=typeof Pl.oninput=="function"}bo=El}else bo=!1;ci=bo&&(!document.documentMode||9<document.documentMode)}function ba(){Aa&&(Aa.detachEvent("onpropertychange",Bl),gr=Aa=null)}function Bl(l){if(l.propertyName==="value"&&Bi(gr)){var h=[];Tl(h,gr,l,se(l)),At(Nm,h)}}function Rl(l,h,m){l==="focusin"?(ba(),Aa=h,gr=m,Aa.attachEvent("onpropertychange",Bl)):l==="focusout"&&ba()}function wo(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Bi(gr)}function Dl(l,h){if(l==="click")return Bi(h)}function iu(l,h){if(l==="input"||l==="change")return Bi(h)}function gf(l,h){return l===h&&(l!==0||1/l===1/h)||l!==l&&h!==h}var Zr=typeof Object.is=="function"?Object.is:gf;function es(l,h){if(Zr(l,h))return!0;if(typeof l!="object"||l===null||typeof h!="object"||h===null)return!1;var m=Object.keys(l),v=Object.keys(h);if(m.length!==v.length)return!1;for(v=0;v<m.length;v++){var k=m[v];if(!u.call(h,k)||!Zr(l[k],h[k]))return!1}return!0}function xf(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function su(l,h){var m=xf(l);l=0;for(var v;m;){if(m.nodeType===3){if(v=l+m.textContent.length,l<=h&&v>=h)return{node:m,offset:h-l};l=v}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=xf(m)}}function yf(l,h){return l&&h?l===h?!0:l&&l.nodeType===3?!1:h&&h.nodeType===3?yf(l,h.parentNode):"contains"in l?l.contains(h):l.compareDocumentPosition?!!(l.compareDocumentPosition(h)&16):!1:!1}function ou(){for(var l=window,h=Ce();h instanceof l.HTMLIFrameElement;){try{var m=typeof h.contentWindow.location.href=="string"}catch{m=!1}if(m)l=h.contentWindow;else break;h=Ce(l.document)}return h}function au(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h&&(h==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||h==="textarea"||l.contentEditable==="true")}function ui(l){var h=ou(),m=l.focusedElem,v=l.selectionRange;if(h!==m&&m&&m.ownerDocument&&yf(m.ownerDocument.documentElement,m)){if(v!==null&&au(m)){if(h=v.start,l=v.end,l===void 0&&(l=h),"selectionStart"in m)m.selectionStart=h,m.selectionEnd=Math.min(l,m.value.length);else if(l=(h=m.ownerDocument||document)&&h.defaultView||window,l.getSelection){l=l.getSelection();var k=m.textContent.length,P=Math.min(v.start,k);v=v.end===void 0?P:Math.min(v.end,k),!l.extend&&P>v&&(k=v,v=P,P=k),k=su(m,P);var j=su(m,v);k&&j&&(l.rangeCount!==1||l.anchorNode!==k.node||l.anchorOffset!==k.offset||l.focusNode!==j.node||l.focusOffset!==j.offset)&&(h=h.createRange(),h.setStart(k.node,k.offset),l.removeAllRanges(),P>v?(l.addRange(h),l.extend(j.node,j.offset)):(h.setEnd(j.node,j.offset),l.addRange(h)))}}for(h=[],l=m;l=l.parentNode;)l.nodeType===1&&h.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<h.length;m++)l=h[m],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var Ml=a&&"documentMode"in document&&11>=document.documentMode,_o=null,Oo=null,wa=null,Nl=!1;function vf(l,h,m){var v=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Nl||_o==null||_o!==Ce(v)||(v=_o,"selectionStart"in v&&au(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),wa&&es(wa,v)||(wa=v,v=y(Oo,"onSelect"),0<v.length&&(h=new Gc("onSelect","select",null,h,m),l.push({event:h,listeners:v}),h.target=_o)))}function ts(l,h){var m={};return m[l.toLowerCase()]=h.toLowerCase(),m["Webkit"+l]="webkit"+h,m["Moz"+l]="moz"+h,m}var ko={animationend:ts("Animation","AnimationEnd"),animationiteration:ts("Animation","AnimationIteration"),animationstart:ts("Animation","AnimationStart"),transitionend:ts("Transition","TransitionEnd")},ns={},lu={};a&&(lu=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function _a(l){if(ns[l])return ns[l];if(!ko[l])return l;var h=ko[l],m;for(m in h)if(h.hasOwnProperty(m)&&m in lu)return ns[l]=h[m];return l}var Af=_a("animationend"),hi=_a("animationiteration"),cu=_a("animationstart"),uu=_a("transitionend"),So=new Map,bf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(l,h){So.set(l,h),s(h,[l])}for(var Ds=0;Ds<bf.length;Ds++){var Ll=bf[Ds],wf=Ll.toLowerCase(),Fm=Ll[0].toUpperCase()+Ll.slice(1);Gr(wf,"on"+Fm)}Gr(Af,"onAnimationEnd"),Gr(hi,"onAnimationIteration"),Gr(cu,"onAnimationStart"),Gr("dblclick","onDoubleClick"),Gr("focusin","onFocus"),Gr("focusout","onBlur"),Gr(uu,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_f=new Set("cancel close invalid load scroll toggle".split(" ").concat(Co));function hu(l,h,m){var v=l.type||"unknown-event";l.currentTarget=m,jc(v,h,void 0,l),l.currentTarget=null}function fu(l,h){h=(h&4)!==0;for(var m=0;m<l.length;m++){var v=l[m],k=v.event;v=v.listeners;e:{var P=void 0;if(h)for(var j=v.length-1;0<=j;j--){var J=v[j],re=J.instance,ge=J.currentTarget;if(J=J.listener,re!==P&&k.isPropagationStopped())break e;hu(k,J,ge),P=re}else for(j=0;j<v.length;j++){if(J=v[j],re=J.instance,ge=J.currentTarget,J=J.listener,re!==P&&k.isPropagationStopped())break e;hu(k,J,ge),P=re}}}if(co)throw l=fl,co=!1,fl=null,l}function qt(l,h){var m=h[Bo];m===void 0&&(m=h[Bo]=new Set);var v=l+"__bubble";m.has(v)||(Of(h,l,2,!1),m.add(v))}function du(l,h,m){var v=0;h&&(v|=4),Of(m,l,v,h)}var Oa="_reactListening"+Math.random().toString(36).slice(2);function To(l){if(!l[Oa]){l[Oa]=!0,r.forEach(function(m){m!=="selectionchange"&&(_f.has(m)||du(m,!1,l),du(m,!0,l))});var h=l.nodeType===9?l:l.ownerDocument;h===null||h[Oa]||(h[Oa]=!0,du("selectionchange",!1,h))}}function Of(l,h,m,v){switch(Ct(h)){case 1:var k=Om;break;case 4:k=rf;break;default:k=ya}m=k.bind(null,h,m,l),k=void 0,!Qr||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(k=!0),v?k!==void 0?l.addEventListener(h,m,{capture:!0,passive:k}):l.addEventListener(h,m,!0):k!==void 0?l.addEventListener(h,m,{passive:k}):l.addEventListener(h,m,!1)}function c(l,h,m,v,k){var P=v;if((h&1)===0&&(h&2)===0&&v!==null)e:for(;;){if(v===null)return;var j=v.tag;if(j===3||j===4){var J=v.stateNode.containerInfo;if(J===k||J.nodeType===8&&J.parentNode===k)break;if(j===4)for(j=v.return;j!==null;){var re=j.tag;if((re===3||re===4)&&(re=j.stateNode.containerInfo,re===k||re.nodeType===8&&re.parentNode===k))return;j=j.return}for(;J!==null;){if(j=Ns(J),j===null)return;if(re=j.tag,re===5||re===6){v=P=j;continue e}J=J.parentNode}}v=v.return}At(function(){var ge=P,Se=se(m),Ee=[];e:{var ke=So.get(l);if(ke!==void 0){var Qe=Gc,Ve=l;switch(l){case"keypress":if(Ol(m)===0)break e;case"keydown":case"keyup":Qe=cf;break;case"focusin":Ve="focus",Qe=kl;break;case"focusout":Ve="blur",Qe=kl;break;case"beforeblur":case"afterblur":Qe=kl;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=Kc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=Yc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=nu;break;case Af:case hi:case cu:Qe=Cm;break;case uu:Qe=Rm;break;case"scroll":Qe=km;break;case"wheel":Qe=Dm;break;case"copy":case"cut":case"paste":Qe=Jc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=hf}var Xe=(h&4)!==0,An=!Xe&&l==="scroll",he=Xe?ke!==null?ke+"Capture":null:ke;Xe=[];for(var oe=ge,de;oe!==null;){de=oe;var Re=de.stateNode;if(de.tag===5&&Re!==null&&(de=Re,he!==null&&(Re=Ht(oe,he),Re!=null&&Xe.push(d(oe,Re,de)))),An)break;oe=oe.return}0<Xe.length&&(ke=new Qe(ke,Ve,null,m,Se),Ee.push({event:ke,listeners:Xe}))}}if((h&7)===0){e:{if(ke=l==="mouseover"||l==="pointerover",Qe=l==="mouseout"||l==="pointerout",ke&&m!==xt&&(Ve=m.relatedTarget||m.fromElement)&&(Ns(Ve)||Ve[It]))break e;if((Qe||ke)&&(ke=Se.window===Se?Se:(ke=Se.ownerDocument)?ke.defaultView||ke.parentWindow:window,Qe?(Ve=m.relatedTarget||m.toElement,Qe=ge,Ve=Ve?Ns(Ve):null,Ve!==null&&(An=Gi(Ve),Ve!==An||Ve.tag!==5&&Ve.tag!==6)&&(Ve=null)):(Qe=null,Ve=ge),Qe!==Ve)){if(Xe=Kc,Re="onMouseLeave",he="onMouseEnter",oe="mouse",(l==="pointerout"||l==="pointerover")&&(Xe=hf,Re="onPointerLeave",he="onPointerEnter",oe="pointer"),An=Qe==null?ke:Fs(Qe),de=Ve==null?ke:Fs(Ve),ke=new Xe(Re,oe+"leave",Qe,m,Se),ke.target=An,ke.relatedTarget=de,Re=null,Ns(Se)===ge&&(Xe=new Xe(he,oe+"enter",Ve,m,Se),Xe.target=de,Xe.relatedTarget=An,Re=Xe),An=Re,Qe&&Ve)t:{for(Xe=Qe,he=Ve,oe=0,de=Xe;de;de=O(de))oe++;for(de=0,Re=he;Re;Re=O(Re))de++;for(;0<oe-de;)Xe=O(Xe),oe--;for(;0<de-oe;)he=O(he),de--;for(;oe--;){if(Xe===he||he!==null&&Xe===he.alternate)break t;Xe=O(Xe),he=O(he)}Xe=null}else Xe=null;Qe!==null&&M(Ee,ke,Qe,Xe,!1),Ve!==null&&An!==null&&M(Ee,An,Ve,Xe,!0)}}e:{if(ke=ge?Fs(ge):window,Qe=ke.nodeName&&ke.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&ke.type==="file")var Ye=Lm;else if(mf(ke))if(ci)Ye=iu;else{Ye=wo;var it=Rl}else(Qe=ke.nodeName)&&Qe.toLowerCase()==="input"&&(ke.type==="checkbox"||ke.type==="radio")&&(Ye=Dl);if(Ye&&(Ye=Ye(l,ge))){Tl(Ee,Ye,m,Se);break e}it&&it(l,ke,ge),l==="focusout"&&(it=ke._wrapperState)&&it.controlled&&ke.type==="number"&&et(ke,"number",ke.value)}switch(it=ge?Fs(ge):window,l){case"focusin":(mf(it)||it.contentEditable==="true")&&(_o=it,Oo=ge,wa=null);break;case"focusout":wa=Oo=_o=null;break;case"mousedown":Nl=!0;break;case"contextmenu":case"mouseup":case"dragend":Nl=!1,vf(Ee,m,Se);break;case"selectionchange":if(Ml)break;case"keydown":case"keyup":vf(Ee,m,Se)}var st;if(Yi)e:{switch(l){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Pi?Ao(l,m)&&(ut="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(ut="onCompositionStart");ut&&(df&&m.locale!=="ko"&&(Pi||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Pi&&(st=Zc()):(Xi=Se,mr="value"in Xi?Xi.value:Xi.textContent,Pi=!0)),it=y(ge,ut),0<it.length&&(ut=new eu(ut,l,null,m,Se),Ee.push({event:ut,listeners:it}),st?ut.data=st:(st=ru(m),st!==null&&(ut.data=st)))),(st=Ei?Mm(l,m):Ji(l,m))&&(ge=y(ge,"onBeforeInput"),0<ge.length&&(Se=new eu("onBeforeInput","beforeinput",null,m,Se),Ee.push({event:Se,listeners:ge}),Se.data=st))}fu(Ee,h)})}function d(l,h,m){return{instance:l,listener:h,currentTarget:m}}function y(l,h){for(var m=h+"Capture",v=[];l!==null;){var k=l,P=k.stateNode;k.tag===5&&P!==null&&(k=P,P=Ht(l,m),P!=null&&v.unshift(d(l,P,k)),P=Ht(l,h),P!=null&&v.push(d(l,P,k))),l=l.return}return v}function O(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function M(l,h,m,v,k){for(var P=h._reactName,j=[];m!==null&&m!==v;){var J=m,re=J.alternate,ge=J.stateNode;if(re!==null&&re===v)break;J.tag===5&&ge!==null&&(J=ge,k?(re=Ht(m,P),re!=null&&j.unshift(d(m,re,J))):k||(re=Ht(m,P),re!=null&&j.push(d(m,re,J)))),m=m.return}j.length!==0&&l.push({event:h,listeners:j})}var H=/\r\n?/g,te=/\u0000|\uFFFD/g;function ce(l){return(typeof l=="string"?l:""+l).replace(H,`
`).replace(te,"")}function me(l,h,m){if(h=ce(h),ce(l)!==h&&m)throw Error(t(425))}function _e(){}var Fe=null,rt=null;function yt(l,h){return l==="textarea"||l==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Bn=typeof setTimeout=="function"?setTimeout:void 0,kn=typeof clearTimeout=="function"?clearTimeout:void 0,xr=typeof Promise=="function"?Promise:void 0,sr=typeof queueMicrotask=="function"?queueMicrotask:typeof xr<"u"?function(l){return xr.resolve(null).then(l).catch(Eo)}:Bn;function Eo(l){setTimeout(function(){throw l})}function pu(l,h){var m=h,v=0;do{var k=m.nextSibling;if(l.removeChild(m),k&&k.nodeType===8)if(m=k.data,m==="/$"){if(v===0){l.removeChild(k),Vr(h);return}v--}else m!=="$"&&m!=="$?"&&m!=="$!"||v++;m=k}while(m);Vr(h)}function rs(l){for(;l!=null;l=l.nextSibling){var h=l.nodeType;if(h===1||h===3)break;if(h===8){if(h=l.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return l}function kf(l){l=l.previousSibling;for(var h=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"){if(h===0)return l;h--}else m==="/$"&&h++}l=l.previousSibling}return null}var Ms=Math.random().toString(36).slice(2),fi="__reactFiber$"+Ms,Po="__reactProps$"+Ms,It="__reactContainer$"+Ms,Bo="__reactEvents$"+Ms,Im="__reactListeners$"+Ms,zm="__reactHandles$"+Ms;function Ns(l){var h=l[fi];if(h)return h;for(var m=l.parentNode;m;){if(h=m[It]||m[fi]){if(m=h.alternate,h.child!==null||m!==null&&m.child!==null)for(l=kf(l);l!==null;){if(m=l[fi])return m;l=kf(l)}return h}l=m,m=l.parentNode}return null}function Ls(l){return l=l[fi]||l[It],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Fs(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function Fl(l){return l[Po]||null}var jm=[],Il=-1;function Ro(l){return{current:l}}function nn(l){0>Il||(l.current=jm[Il],jm[Il]=null,Il--)}function Kt(l,h){Il++,jm[Il]=l.current,l.current=h}var Do={},or=Ro(Do),Cr=Ro(!1),ka=Do;function zl(l,h){var m=l.type.contextTypes;if(!m)return Do;var v=l.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===h)return v.__reactInternalMemoizedMaskedChildContext;var k={},P;for(P in m)k[P]=h[P];return v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=h,l.__reactInternalMemoizedMaskedChildContext=k),k}function Tr(l){return l=l.childContextTypes,l!=null}function Sf(){nn(Cr),nn(or)}function RA(l,h,m){if(or.current!==Do)throw Error(t(168));Kt(or,h),Kt(Cr,m)}function DA(l,h,m){var v=l.stateNode;if(h=h.childContextTypes,typeof v.getChildContext!="function")return m;v=v.getChildContext();for(var k in v)if(!(k in h))throw Error(t(108,ve(l)||"Unknown",k));return q({},m,v)}function Cf(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Do,ka=or.current,Kt(or,l),Kt(Cr,Cr.current),!0}function MA(l,h,m){var v=l.stateNode;if(!v)throw Error(t(169));m?(l=DA(l,h,ka),v.__reactInternalMemoizedMergedChildContext=l,nn(Cr),nn(or),Kt(or,l)):nn(Cr),Kt(Cr,m)}var Is=null,Tf=!1,Qm=!1;function NA(l){Is===null?Is=[l]:Is.push(l)}function dP(l){Tf=!0,NA(l)}function Mo(){if(!Qm&&Is!==null){Qm=!0;var l=0,h=Bt;try{var m=Is;for(Bt=1;l<m.length;l++){var v=m[l];do v=v(!0);while(v!==null)}Is=null,Tf=!1}catch(k){throw Is!==null&&(Is=Is.slice(l+1)),ef(Wc,Mo),k}finally{Bt=h,Qm=!1}}return null}var jl=[],Ql=0,Ef=null,Pf=0,di=[],pi=0,Sa=null,zs=1,js="";function Ca(l,h){jl[Ql++]=Pf,jl[Ql++]=Ef,Ef=l,Pf=h}function LA(l,h,m){di[pi++]=zs,di[pi++]=js,di[pi++]=Sa,Sa=l;var v=zs;l=js;var k=32-gt(v)-1;v&=~(1<<k),m+=1;var P=32-gt(h)+k;if(30<P){var j=k-k%5;P=(v&(1<<j)-1).toString(32),v>>=j,k-=j,zs=1<<32-gt(h)+k|m<<k|v,js=P+l}else zs=1<<P|m<<k|v,js=l}function Hm(l){l.return!==null&&(Ca(l,1),LA(l,1,0))}function Wm(l){for(;l===Ef;)Ef=jl[--Ql],jl[Ql]=null,Pf=jl[--Ql],jl[Ql]=null;for(;l===Sa;)Sa=di[--pi],di[pi]=null,js=di[--pi],di[pi]=null,zs=di[--pi],di[pi]=null}var Xr=null,Kr=null,an=!1,Ri=null;function FA(l,h){var m=yi(5,null,null,0);m.elementType="DELETED",m.stateNode=h,m.return=l,h=l.deletions,h===null?(l.deletions=[m],l.flags|=16):h.push(m)}function IA(l,h){switch(l.tag){case 5:var m=l.type;return h=h.nodeType!==1||m.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(l.stateNode=h,Xr=l,Kr=rs(h.firstChild),!0):!1;case 6:return h=l.pendingProps===""||h.nodeType!==3?null:h,h!==null?(l.stateNode=h,Xr=l,Kr=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(m=Sa!==null?{id:zs,overflow:js}:null,l.memoizedState={dehydrated:h,treeContext:m,retryLane:1073741824},m=yi(18,null,null,0),m.stateNode=h,m.return=l,l.child=m,Xr=l,Kr=null,!0):!1;default:return!1}}function qm(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Vm(l){if(an){var h=Kr;if(h){var m=h;if(!IA(l,h)){if(qm(l))throw Error(t(418));h=rs(m.nextSibling);var v=Xr;h&&IA(l,h)?FA(v,m):(l.flags=l.flags&-4097|2,an=!1,Xr=l)}}else{if(qm(l))throw Error(t(418));l.flags=l.flags&-4097|2,an=!1,Xr=l}}}function zA(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Xr=l}function Bf(l){if(l!==Xr)return!1;if(!an)return zA(l),an=!0,!1;var h;if((h=l.tag!==3)&&!(h=l.tag!==5)&&(h=l.type,h=h!=="head"&&h!=="body"&&!yt(l.type,l.memoizedProps)),h&&(h=Kr)){if(qm(l))throw jA(),Error(t(418));for(;h;)FA(l,h),h=rs(h.nextSibling)}if(zA(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,h=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"){if(h===0){Kr=rs(l.nextSibling);break e}h--}else m!=="$"&&m!=="$!"&&m!=="$?"||h++}l=l.nextSibling}Kr=null}}else Kr=Xr?rs(l.stateNode.nextSibling):null;return!0}function jA(){for(var l=Kr;l;)l=rs(l.nextSibling)}function Hl(){Kr=Xr=null,an=!1}function $m(l){Ri===null?Ri=[l]:Ri.push(l)}var pP=D.ReactCurrentBatchConfig;function mu(l,h,m){if(l=m.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(t(309));var v=m.stateNode}if(!v)throw Error(t(147,l));var k=v,P=""+l;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===P?h.ref:(h=function(j){var J=k.refs;j===null?delete J[P]:J[P]=j},h._stringRef=P,h)}if(typeof l!="string")throw Error(t(284));if(!m._owner)throw Error(t(290,l))}return l}function Rf(l,h){throw l=Object.prototype.toString.call(h),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":l))}function QA(l){var h=l._init;return h(l._payload)}function HA(l){function h(he,oe){if(l){var de=he.deletions;de===null?(he.deletions=[oe],he.flags|=16):de.push(oe)}}function m(he,oe){if(!l)return null;for(;oe!==null;)h(he,oe),oe=oe.sibling;return null}function v(he,oe){for(he=new Map;oe!==null;)oe.key!==null?he.set(oe.key,oe):he.set(oe.index,oe),oe=oe.sibling;return he}function k(he,oe){return he=Ho(he,oe),he.index=0,he.sibling=null,he}function P(he,oe,de){return he.index=de,l?(de=he.alternate,de!==null?(de=de.index,de<oe?(he.flags|=2,oe):de):(he.flags|=2,oe)):(he.flags|=1048576,oe)}function j(he){return l&&he.alternate===null&&(he.flags|=2),he}function J(he,oe,de,Re){return oe===null||oe.tag!==6?(oe=Fg(de,he.mode,Re),oe.return=he,oe):(oe=k(oe,de),oe.return=he,oe)}function re(he,oe,de,Re){var Ye=de.type;return Ye===z?Se(he,oe,de.props.children,Re,de.key):oe!==null&&(oe.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===Z&&QA(Ye)===oe.type)?(Re=k(oe,de.props),Re.ref=mu(he,oe,de),Re.return=he,Re):(Re=nd(de.type,de.key,de.props,null,he.mode,Re),Re.ref=mu(he,oe,de),Re.return=he,Re)}function ge(he,oe,de,Re){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==de.containerInfo||oe.stateNode.implementation!==de.implementation?(oe=Ig(de,he.mode,Re),oe.return=he,oe):(oe=k(oe,de.children||[]),oe.return=he,oe)}function Se(he,oe,de,Re,Ye){return oe===null||oe.tag!==7?(oe=Na(de,he.mode,Re,Ye),oe.return=he,oe):(oe=k(oe,de),oe.return=he,oe)}function Ee(he,oe,de){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Fg(""+oe,he.mode,de),oe.return=he,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case N:return de=nd(oe.type,oe.key,oe.props,null,he.mode,de),de.ref=mu(he,null,oe),de.return=he,de;case F:return oe=Ig(oe,he.mode,de),oe.return=he,oe;case Z:var Re=oe._init;return Ee(he,Re(oe._payload),de)}if(tt(oe)||ne(oe))return oe=Na(oe,he.mode,de,null),oe.return=he,oe;Rf(he,oe)}return null}function ke(he,oe,de,Re){var Ye=oe!==null?oe.key:null;if(typeof de=="string"&&de!==""||typeof de=="number")return Ye!==null?null:J(he,oe,""+de,Re);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case N:return de.key===Ye?re(he,oe,de,Re):null;case F:return de.key===Ye?ge(he,oe,de,Re):null;case Z:return Ye=de._init,ke(he,oe,Ye(de._payload),Re)}if(tt(de)||ne(de))return Ye!==null?null:Se(he,oe,de,Re,null);Rf(he,de)}return null}function Qe(he,oe,de,Re,Ye){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return he=he.get(de)||null,J(oe,he,""+Re,Ye);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case N:return he=he.get(Re.key===null?de:Re.key)||null,re(oe,he,Re,Ye);case F:return he=he.get(Re.key===null?de:Re.key)||null,ge(oe,he,Re,Ye);case Z:var it=Re._init;return Qe(he,oe,de,it(Re._payload),Ye)}if(tt(Re)||ne(Re))return he=he.get(de)||null,Se(oe,he,Re,Ye,null);Rf(oe,Re)}return null}function Ve(he,oe,de,Re){for(var Ye=null,it=null,st=oe,ut=oe=0,Hn=null;st!==null&&ut<de.length;ut++){st.index>ut?(Hn=st,st=null):Hn=st.sibling;var Ft=ke(he,st,de[ut],Re);if(Ft===null){st===null&&(st=Hn);break}l&&st&&Ft.alternate===null&&h(he,st),oe=P(Ft,oe,ut),it===null?Ye=Ft:it.sibling=Ft,it=Ft,st=Hn}if(ut===de.length)return m(he,st),an&&Ca(he,ut),Ye;if(st===null){for(;ut<de.length;ut++)st=Ee(he,de[ut],Re),st!==null&&(oe=P(st,oe,ut),it===null?Ye=st:it.sibling=st,it=st);return an&&Ca(he,ut),Ye}for(st=v(he,st);ut<de.length;ut++)Hn=Qe(st,he,ut,de[ut],Re),Hn!==null&&(l&&Hn.alternate!==null&&st.delete(Hn.key===null?ut:Hn.key),oe=P(Hn,oe,ut),it===null?Ye=Hn:it.sibling=Hn,it=Hn);return l&&st.forEach(function(Wo){return h(he,Wo)}),an&&Ca(he,ut),Ye}function Xe(he,oe,de,Re){var Ye=ne(de);if(typeof Ye!="function")throw Error(t(150));if(de=Ye.call(de),de==null)throw Error(t(151));for(var it=Ye=null,st=oe,ut=oe=0,Hn=null,Ft=de.next();st!==null&&!Ft.done;ut++,Ft=de.next()){st.index>ut?(Hn=st,st=null):Hn=st.sibling;var Wo=ke(he,st,Ft.value,Re);if(Wo===null){st===null&&(st=Hn);break}l&&st&&Wo.alternate===null&&h(he,st),oe=P(Wo,oe,ut),it===null?Ye=Wo:it.sibling=Wo,it=Wo,st=Hn}if(Ft.done)return m(he,st),an&&Ca(he,ut),Ye;if(st===null){for(;!Ft.done;ut++,Ft=de.next())Ft=Ee(he,Ft.value,Re),Ft!==null&&(oe=P(Ft,oe,ut),it===null?Ye=Ft:it.sibling=Ft,it=Ft);return an&&Ca(he,ut),Ye}for(st=v(he,st);!Ft.done;ut++,Ft=de.next())Ft=Qe(st,he,ut,Ft.value,Re),Ft!==null&&(l&&Ft.alternate!==null&&st.delete(Ft.key===null?ut:Ft.key),oe=P(Ft,oe,ut),it===null?Ye=Ft:it.sibling=Ft,it=Ft);return l&&st.forEach(function(UP){return h(he,UP)}),an&&Ca(he,ut),Ye}function An(he,oe,de,Re){if(typeof de=="object"&&de!==null&&de.type===z&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case N:e:{for(var Ye=de.key,it=oe;it!==null;){if(it.key===Ye){if(Ye=de.type,Ye===z){if(it.tag===7){m(he,it.sibling),oe=k(it,de.props.children),oe.return=he,he=oe;break e}}else if(it.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===Z&&QA(Ye)===it.type){m(he,it.sibling),oe=k(it,de.props),oe.ref=mu(he,it,de),oe.return=he,he=oe;break e}m(he,it);break}else h(he,it);it=it.sibling}de.type===z?(oe=Na(de.props.children,he.mode,Re,de.key),oe.return=he,he=oe):(Re=nd(de.type,de.key,de.props,null,he.mode,Re),Re.ref=mu(he,oe,de),Re.return=he,he=Re)}return j(he);case F:e:{for(it=de.key;oe!==null;){if(oe.key===it)if(oe.tag===4&&oe.stateNode.containerInfo===de.containerInfo&&oe.stateNode.implementation===de.implementation){m(he,oe.sibling),oe=k(oe,de.children||[]),oe.return=he,he=oe;break e}else{m(he,oe);break}else h(he,oe);oe=oe.sibling}oe=Ig(de,he.mode,Re),oe.return=he,he=oe}return j(he);case Z:return it=de._init,An(he,oe,it(de._payload),Re)}if(tt(de))return Ve(he,oe,de,Re);if(ne(de))return Xe(he,oe,de,Re);Rf(he,de)}return typeof de=="string"&&de!==""||typeof de=="number"?(de=""+de,oe!==null&&oe.tag===6?(m(he,oe.sibling),oe=k(oe,de),oe.return=he,he=oe):(m(he,oe),oe=Fg(de,he.mode,Re),oe.return=he,he=oe),j(he)):m(he,oe)}return An}var Wl=HA(!0),WA=HA(!1),Df=Ro(null),Mf=null,ql=null,Um=null;function Zm(){Um=ql=Mf=null}function Gm(l){var h=Df.current;nn(Df),l._currentValue=h}function Xm(l,h,m){for(;l!==null;){var v=l.alternate;if((l.childLanes&h)!==h?(l.childLanes|=h,v!==null&&(v.childLanes|=h)):v!==null&&(v.childLanes&h)!==h&&(v.childLanes|=h),l===m)break;l=l.return}}function Vl(l,h){Mf=l,Um=ql=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&h)!==0&&(Er=!0),l.firstContext=null)}function mi(l){var h=l._currentValue;if(Um!==l)if(l={context:l,memoizedValue:h,next:null},ql===null){if(Mf===null)throw Error(t(308));ql=l,Mf.dependencies={lanes:0,firstContext:l}}else ql=ql.next=l;return h}var Ta=null;function Km(l){Ta===null?Ta=[l]:Ta.push(l)}function qA(l,h,m,v){var k=h.interleaved;return k===null?(m.next=m,Km(h)):(m.next=k.next,k.next=m),h.interleaved=m,Qs(l,v)}function Qs(l,h){l.lanes|=h;var m=l.alternate;for(m!==null&&(m.lanes|=h),m=l,l=l.return;l!==null;)l.childLanes|=h,m=l.alternate,m!==null&&(m.childLanes|=h),m=l,l=l.return;return m.tag===3?m.stateNode:null}var No=!1;function Ym(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function VA(l,h){l=l.updateQueue,h.updateQueue===l&&(h.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Hs(l,h){return{eventTime:l,lane:h,tag:0,payload:null,callback:null,next:null}}function Lo(l,h,m){var v=l.updateQueue;if(v===null)return null;if(v=v.shared,(Nt&2)!==0){var k=v.pending;return k===null?h.next=h:(h.next=k.next,k.next=h),v.pending=h,Qs(l,m)}return k=v.interleaved,k===null?(h.next=h,Km(v)):(h.next=k.next,k.next=h),v.interleaved=h,Qs(l,m)}function Nf(l,h,m){if(h=h.updateQueue,h!==null&&(h=h.shared,(m&4194240)!==0)){var v=h.lanes;v&=l.pendingLanes,m|=v,h.lanes=m,Ci(l,m)}}function $A(l,h){var m=l.updateQueue,v=l.alternate;if(v!==null&&(v=v.updateQueue,m===v)){var k=null,P=null;if(m=m.firstBaseUpdate,m!==null){do{var j={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};P===null?k=P=j:P=P.next=j,m=m.next}while(m!==null);P===null?k=P=h:P=P.next=h}else k=P=h;m={baseState:v.baseState,firstBaseUpdate:k,lastBaseUpdate:P,shared:v.shared,effects:v.effects},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=h:l.next=h,m.lastBaseUpdate=h}function Lf(l,h,m,v){var k=l.updateQueue;No=!1;var P=k.firstBaseUpdate,j=k.lastBaseUpdate,J=k.shared.pending;if(J!==null){k.shared.pending=null;var re=J,ge=re.next;re.next=null,j===null?P=ge:j.next=ge,j=re;var Se=l.alternate;Se!==null&&(Se=Se.updateQueue,J=Se.lastBaseUpdate,J!==j&&(J===null?Se.firstBaseUpdate=ge:J.next=ge,Se.lastBaseUpdate=re))}if(P!==null){var Ee=k.baseState;j=0,Se=ge=re=null,J=P;do{var ke=J.lane,Qe=J.eventTime;if((v&ke)===ke){Se!==null&&(Se=Se.next={eventTime:Qe,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var Ve=l,Xe=J;switch(ke=h,Qe=m,Xe.tag){case 1:if(Ve=Xe.payload,typeof Ve=="function"){Ee=Ve.call(Qe,Ee,ke);break e}Ee=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=Xe.payload,ke=typeof Ve=="function"?Ve.call(Qe,Ee,ke):Ve,ke==null)break e;Ee=q({},Ee,ke);break e;case 2:No=!0}}J.callback!==null&&J.lane!==0&&(l.flags|=64,ke=k.effects,ke===null?k.effects=[J]:ke.push(J))}else Qe={eventTime:Qe,lane:ke,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Se===null?(ge=Se=Qe,re=Ee):Se=Se.next=Qe,j|=ke;if(J=J.next,J===null){if(J=k.shared.pending,J===null)break;ke=J,J=ke.next,ke.next=null,k.lastBaseUpdate=ke,k.shared.pending=null}}while(!0);if(Se===null&&(re=Ee),k.baseState=re,k.firstBaseUpdate=ge,k.lastBaseUpdate=Se,h=k.shared.interleaved,h!==null){k=h;do j|=k.lane,k=k.next;while(k!==h)}else P===null&&(k.shared.lanes=0);Ba|=j,l.lanes=j,l.memoizedState=Ee}}function UA(l,h,m){if(l=h.effects,h.effects=null,l!==null)for(h=0;h<l.length;h++){var v=l[h],k=v.callback;if(k!==null){if(v.callback=null,v=m,typeof k!="function")throw Error(t(191,k));k.call(v)}}}var gu={},is=Ro(gu),xu=Ro(gu),yu=Ro(gu);function Ea(l){if(l===gu)throw Error(t(174));return l}function Jm(l,h){switch(Kt(yu,h),Kt(xu,l),Kt(is,gu),l=h.nodeType,l){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:vn(null,"");break;default:l=l===8?h.parentNode:h,h=l.namespaceURI||null,l=l.tagName,h=vn(h,l)}nn(is),Kt(is,h)}function $l(){nn(is),nn(xu),nn(yu)}function ZA(l){Ea(yu.current);var h=Ea(is.current),m=vn(h,l.type);h!==m&&(Kt(xu,l),Kt(is,m))}function eg(l){xu.current===l&&(nn(is),nn(xu))}var hn=Ro(0);function Ff(l){for(var h=l;h!==null;){if(h.tag===13){var m=h.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var tg=[];function ng(){for(var l=0;l<tg.length;l++)tg[l]._workInProgressVersionPrimary=null;tg.length=0}var If=D.ReactCurrentDispatcher,rg=D.ReactCurrentBatchConfig,Pa=0,fn=null,Rn=null,jn=null,zf=!1,vu=!1,Au=0,mP=0;function ar(){throw Error(t(321))}function ig(l,h){if(h===null)return!1;for(var m=0;m<h.length&&m<l.length;m++)if(!Zr(l[m],h[m]))return!1;return!0}function sg(l,h,m,v,k,P){if(Pa=P,fn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,If.current=l===null||l.memoizedState===null?vP:AP,l=m(v,k),vu){P=0;do{if(vu=!1,Au=0,25<=P)throw Error(t(301));P+=1,jn=Rn=null,h.updateQueue=null,If.current=bP,l=m(v,k)}while(vu)}if(If.current=Hf,h=Rn!==null&&Rn.next!==null,Pa=0,jn=Rn=fn=null,zf=!1,h)throw Error(t(300));return l}function og(){var l=Au!==0;return Au=0,l}function ss(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?fn.memoizedState=jn=l:jn=jn.next=l,jn}function gi(){if(Rn===null){var l=fn.alternate;l=l!==null?l.memoizedState:null}else l=Rn.next;var h=jn===null?fn.memoizedState:jn.next;if(h!==null)jn=h,Rn=l;else{if(l===null)throw Error(t(310));Rn=l,l={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},jn===null?fn.memoizedState=jn=l:jn=jn.next=l}return jn}function bu(l,h){return typeof h=="function"?h(l):h}function ag(l){var h=gi(),m=h.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=l;var v=Rn,k=v.baseQueue,P=m.pending;if(P!==null){if(k!==null){var j=k.next;k.next=P.next,P.next=j}v.baseQueue=k=P,m.pending=null}if(k!==null){P=k.next,v=v.baseState;var J=j=null,re=null,ge=P;do{var Se=ge.lane;if((Pa&Se)===Se)re!==null&&(re=re.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),v=ge.hasEagerState?ge.eagerState:l(v,ge.action);else{var Ee={lane:Se,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};re===null?(J=re=Ee,j=v):re=re.next=Ee,fn.lanes|=Se,Ba|=Se}ge=ge.next}while(ge!==null&&ge!==P);re===null?j=v:re.next=J,Zr(v,h.memoizedState)||(Er=!0),h.memoizedState=v,h.baseState=j,h.baseQueue=re,m.lastRenderedState=v}if(l=m.interleaved,l!==null){k=l;do P=k.lane,fn.lanes|=P,Ba|=P,k=k.next;while(k!==l)}else k===null&&(m.lanes=0);return[h.memoizedState,m.dispatch]}function lg(l){var h=gi(),m=h.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=l;var v=m.dispatch,k=m.pending,P=h.memoizedState;if(k!==null){m.pending=null;var j=k=k.next;do P=l(P,j.action),j=j.next;while(j!==k);Zr(P,h.memoizedState)||(Er=!0),h.memoizedState=P,h.baseQueue===null&&(h.baseState=P),m.lastRenderedState=P}return[P,v]}function GA(){}function XA(l,h){var m=fn,v=gi(),k=h(),P=!Zr(v.memoizedState,k);if(P&&(v.memoizedState=k,Er=!0),v=v.queue,cg(JA.bind(null,m,v,l),[l]),v.getSnapshot!==h||P||jn!==null&&jn.memoizedState.tag&1){if(m.flags|=2048,wu(9,YA.bind(null,m,v,k,h),void 0,null),Qn===null)throw Error(t(349));(Pa&30)!==0||KA(m,h,k)}return k}function KA(l,h,m){l.flags|=16384,l={getSnapshot:h,value:m},h=fn.updateQueue,h===null?(h={lastEffect:null,stores:null},fn.updateQueue=h,h.stores=[l]):(m=h.stores,m===null?h.stores=[l]:m.push(l))}function YA(l,h,m,v){h.value=m,h.getSnapshot=v,e1(h)&&t1(l)}function JA(l,h,m){return m(function(){e1(h)&&t1(l)})}function e1(l){var h=l.getSnapshot;l=l.value;try{var m=h();return!Zr(l,m)}catch{return!0}}function t1(l){var h=Qs(l,1);h!==null&&Li(h,l,1,-1)}function n1(l){var h=ss();return typeof l=="function"&&(l=l()),h.memoizedState=h.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:l},h.queue=l,l=l.dispatch=yP.bind(null,fn,l),[h.memoizedState,l]}function wu(l,h,m,v){return l={tag:l,create:h,destroy:m,deps:v,next:null},h=fn.updateQueue,h===null?(h={lastEffect:null,stores:null},fn.updateQueue=h,h.lastEffect=l.next=l):(m=h.lastEffect,m===null?h.lastEffect=l.next=l:(v=m.next,m.next=l,l.next=v,h.lastEffect=l)),l}function r1(){return gi().memoizedState}function jf(l,h,m,v){var k=ss();fn.flags|=l,k.memoizedState=wu(1|h,m,void 0,v===void 0?null:v)}function Qf(l,h,m,v){var k=gi();v=v===void 0?null:v;var P=void 0;if(Rn!==null){var j=Rn.memoizedState;if(P=j.destroy,v!==null&&ig(v,j.deps)){k.memoizedState=wu(h,m,P,v);return}}fn.flags|=l,k.memoizedState=wu(1|h,m,P,v)}function i1(l,h){return jf(8390656,8,l,h)}function cg(l,h){return Qf(2048,8,l,h)}function s1(l,h){return Qf(4,2,l,h)}function o1(l,h){return Qf(4,4,l,h)}function a1(l,h){if(typeof h=="function")return l=l(),h(l),function(){h(null)};if(h!=null)return l=l(),h.current=l,function(){h.current=null}}function l1(l,h,m){return m=m!=null?m.concat([l]):null,Qf(4,4,a1.bind(null,h,l),m)}function ug(){}function c1(l,h){var m=gi();h=h===void 0?null:h;var v=m.memoizedState;return v!==null&&h!==null&&ig(h,v[1])?v[0]:(m.memoizedState=[l,h],l)}function u1(l,h){var m=gi();h=h===void 0?null:h;var v=m.memoizedState;return v!==null&&h!==null&&ig(h,v[1])?v[0]:(l=l(),m.memoizedState=[l,h],l)}function h1(l,h,m){return(Pa&21)===0?(l.baseState&&(l.baseState=!1,Er=!0),l.memoizedState=m):(Zr(m,h)||(m=nf(),fn.lanes|=m,Ba|=m,l.baseState=!0),h)}function gP(l,h){var m=Bt;Bt=m!==0&&4>m?m:4,l(!0);var v=rg.transition;rg.transition={};try{l(!1),h()}finally{Bt=m,rg.transition=v}}function f1(){return gi().memoizedState}function xP(l,h,m){var v=jo(l);if(m={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null},d1(l))p1(h,m);else if(m=qA(l,h,m,v),m!==null){var k=vr();Li(m,l,v,k),m1(m,h,v)}}function yP(l,h,m){var v=jo(l),k={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null};if(d1(l))p1(h,k);else{var P=l.alternate;if(l.lanes===0&&(P===null||P.lanes===0)&&(P=h.lastRenderedReducer,P!==null))try{var j=h.lastRenderedState,J=P(j,m);if(k.hasEagerState=!0,k.eagerState=J,Zr(J,j)){var re=h.interleaved;re===null?(k.next=k,Km(h)):(k.next=re.next,re.next=k),h.interleaved=k;return}}catch{}finally{}m=qA(l,h,k,v),m!==null&&(k=vr(),Li(m,l,v,k),m1(m,h,v))}}function d1(l){var h=l.alternate;return l===fn||h!==null&&h===fn}function p1(l,h){vu=zf=!0;var m=l.pending;m===null?h.next=h:(h.next=m.next,m.next=h),l.pending=h}function m1(l,h,m){if((m&4194240)!==0){var v=h.lanes;v&=l.pendingLanes,m|=v,h.lanes=m,Ci(l,m)}}var Hf={readContext:mi,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useInsertionEffect:ar,useLayoutEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useMutableSource:ar,useSyncExternalStore:ar,useId:ar,unstable_isNewReconciler:!1},vP={readContext:mi,useCallback:function(l,h){return ss().memoizedState=[l,h===void 0?null:h],l},useContext:mi,useEffect:i1,useImperativeHandle:function(l,h,m){return m=m!=null?m.concat([l]):null,jf(4194308,4,a1.bind(null,h,l),m)},useLayoutEffect:function(l,h){return jf(4194308,4,l,h)},useInsertionEffect:function(l,h){return jf(4,2,l,h)},useMemo:function(l,h){var m=ss();return h=h===void 0?null:h,l=l(),m.memoizedState=[l,h],l},useReducer:function(l,h,m){var v=ss();return h=m!==void 0?m(h):h,v.memoizedState=v.baseState=h,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:h},v.queue=l,l=l.dispatch=xP.bind(null,fn,l),[v.memoizedState,l]},useRef:function(l){var h=ss();return l={current:l},h.memoizedState=l},useState:n1,useDebugValue:ug,useDeferredValue:function(l){return ss().memoizedState=l},useTransition:function(){var l=n1(!1),h=l[0];return l=gP.bind(null,l[1]),ss().memoizedState=l,[h,l]},useMutableSource:function(){},useSyncExternalStore:function(l,h,m){var v=fn,k=ss();if(an){if(m===void 0)throw Error(t(407));m=m()}else{if(m=h(),Qn===null)throw Error(t(349));(Pa&30)!==0||KA(v,h,m)}k.memoizedState=m;var P={value:m,getSnapshot:h};return k.queue=P,i1(JA.bind(null,v,P,l),[l]),v.flags|=2048,wu(9,YA.bind(null,v,P,m,h),void 0,null),m},useId:function(){var l=ss(),h=Qn.identifierPrefix;if(an){var m=js,v=zs;m=(v&~(1<<32-gt(v)-1)).toString(32)+m,h=":"+h+"R"+m,m=Au++,0<m&&(h+="H"+m.toString(32)),h+=":"}else m=mP++,h=":"+h+"r"+m.toString(32)+":";return l.memoizedState=h},unstable_isNewReconciler:!1},AP={readContext:mi,useCallback:c1,useContext:mi,useEffect:cg,useImperativeHandle:l1,useInsertionEffect:s1,useLayoutEffect:o1,useMemo:u1,useReducer:ag,useRef:r1,useState:function(){return ag(bu)},useDebugValue:ug,useDeferredValue:function(l){var h=gi();return h1(h,Rn.memoizedState,l)},useTransition:function(){var l=ag(bu)[0],h=gi().memoizedState;return[l,h]},useMutableSource:GA,useSyncExternalStore:XA,useId:f1,unstable_isNewReconciler:!1},bP={readContext:mi,useCallback:c1,useContext:mi,useEffect:cg,useImperativeHandle:l1,useInsertionEffect:s1,useLayoutEffect:o1,useMemo:u1,useReducer:lg,useRef:r1,useState:function(){return lg(bu)},useDebugValue:ug,useDeferredValue:function(l){var h=gi();return Rn===null?h.memoizedState=l:h1(h,Rn.memoizedState,l)},useTransition:function(){var l=lg(bu)[0],h=gi().memoizedState;return[l,h]},useMutableSource:GA,useSyncExternalStore:XA,useId:f1,unstable_isNewReconciler:!1};function Di(l,h){if(l&&l.defaultProps){h=q({},h),l=l.defaultProps;for(var m in l)h[m]===void 0&&(h[m]=l[m]);return h}return h}function hg(l,h,m,v){h=l.memoizedState,m=m(v,h),m=m==null?h:q({},h,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var Wf={isMounted:function(l){return(l=l._reactInternals)?Gi(l)===l:!1},enqueueSetState:function(l,h,m){l=l._reactInternals;var v=vr(),k=jo(l),P=Hs(v,k);P.payload=h,m!=null&&(P.callback=m),h=Lo(l,P,k),h!==null&&(Li(h,l,k,v),Nf(h,l,k))},enqueueReplaceState:function(l,h,m){l=l._reactInternals;var v=vr(),k=jo(l),P=Hs(v,k);P.tag=1,P.payload=h,m!=null&&(P.callback=m),h=Lo(l,P,k),h!==null&&(Li(h,l,k,v),Nf(h,l,k))},enqueueForceUpdate:function(l,h){l=l._reactInternals;var m=vr(),v=jo(l),k=Hs(m,v);k.tag=2,h!=null&&(k.callback=h),h=Lo(l,k,v),h!==null&&(Li(h,l,v,m),Nf(h,l,v))}};function g1(l,h,m,v,k,P,j){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(v,P,j):h.prototype&&h.prototype.isPureReactComponent?!es(m,v)||!es(k,P):!0}function x1(l,h,m){var v=!1,k=Do,P=h.contextType;return typeof P=="object"&&P!==null?P=mi(P):(k=Tr(h)?ka:or.current,v=h.contextTypes,P=(v=v!=null)?zl(l,k):Do),h=new h(m,P),l.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Wf,l.stateNode=h,h._reactInternals=l,v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=k,l.__reactInternalMemoizedMaskedChildContext=P),h}function y1(l,h,m,v){l=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(m,v),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(m,v),h.state!==l&&Wf.enqueueReplaceState(h,h.state,null)}function fg(l,h,m,v){var k=l.stateNode;k.props=m,k.state=l.memoizedState,k.refs={},Ym(l);var P=h.contextType;typeof P=="object"&&P!==null?k.context=mi(P):(P=Tr(h)?ka:or.current,k.context=zl(l,P)),k.state=l.memoizedState,P=h.getDerivedStateFromProps,typeof P=="function"&&(hg(l,h,P,m),k.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(h=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),h!==k.state&&Wf.enqueueReplaceState(k,k.state,null),Lf(l,m,k,v),k.state=l.memoizedState),typeof k.componentDidMount=="function"&&(l.flags|=4194308)}function Ul(l,h){try{var m="",v=h;do m+=ue(v),v=v.return;while(v);var k=m}catch(P){k=`
Error generating stack: `+P.message+`
`+P.stack}return{value:l,source:h,stack:k,digest:null}}function dg(l,h,m){return{value:l,source:null,stack:m??null,digest:h??null}}function pg(l,h){try{console.error(h.value)}catch(m){setTimeout(function(){throw m})}}var wP=typeof WeakMap=="function"?WeakMap:Map;function v1(l,h,m){m=Hs(-1,m),m.tag=3,m.payload={element:null};var v=h.value;return m.callback=function(){Xf||(Xf=!0,Eg=v),pg(l,h)},m}function A1(l,h,m){m=Hs(-1,m),m.tag=3;var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var k=h.value;m.payload=function(){return v(k)},m.callback=function(){pg(l,h)}}var P=l.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(m.callback=function(){pg(l,h),typeof v!="function"&&(Io===null?Io=new Set([this]):Io.add(this));var j=h.stack;this.componentDidCatch(h.value,{componentStack:j!==null?j:""})}),m}function b1(l,h,m){var v=l.pingCache;if(v===null){v=l.pingCache=new wP;var k=new Set;v.set(h,k)}else k=v.get(h),k===void 0&&(k=new Set,v.set(h,k));k.has(m)||(k.add(m),l=LP.bind(null,l,h,m),h.then(l,l))}function w1(l){do{var h;if((h=l.tag===13)&&(h=l.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return l;l=l.return}while(l!==null);return null}function _1(l,h,m,v,k){return(l.mode&1)===0?(l===h?l.flags|=65536:(l.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(h=Hs(-1,1),h.tag=2,Lo(m,h,1))),m.lanes|=1),l):(l.flags|=65536,l.lanes=k,l)}var _P=D.ReactCurrentOwner,Er=!1;function yr(l,h,m,v){h.child=l===null?WA(h,null,m,v):Wl(h,l.child,m,v)}function O1(l,h,m,v,k){m=m.render;var P=h.ref;return Vl(h,k),v=sg(l,h,m,v,P,k),m=og(),l!==null&&!Er?(h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~k,Ws(l,h,k)):(an&&m&&Hm(h),h.flags|=1,yr(l,h,v,k),h.child)}function k1(l,h,m,v,k){if(l===null){var P=m.type;return typeof P=="function"&&!Lg(P)&&P.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(h.tag=15,h.type=P,S1(l,h,P,v,k)):(l=nd(m.type,null,v,h,h.mode,k),l.ref=h.ref,l.return=h,h.child=l)}if(P=l.child,(l.lanes&k)===0){var j=P.memoizedProps;if(m=m.compare,m=m!==null?m:es,m(j,v)&&l.ref===h.ref)return Ws(l,h,k)}return h.flags|=1,l=Ho(P,v),l.ref=h.ref,l.return=h,h.child=l}function S1(l,h,m,v,k){if(l!==null){var P=l.memoizedProps;if(es(P,v)&&l.ref===h.ref)if(Er=!1,h.pendingProps=v=P,(l.lanes&k)!==0)(l.flags&131072)!==0&&(Er=!0);else return h.lanes=l.lanes,Ws(l,h,k)}return mg(l,h,m,v,k)}function C1(l,h,m){var v=h.pendingProps,k=v.children,P=l!==null?l.memoizedState:null;if(v.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt(Gl,Yr),Yr|=m;else{if((m&1073741824)===0)return l=P!==null?P.baseLanes|m:m,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:l,cachePool:null,transitions:null},h.updateQueue=null,Kt(Gl,Yr),Yr|=l,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=P!==null?P.baseLanes:m,Kt(Gl,Yr),Yr|=v}else P!==null?(v=P.baseLanes|m,h.memoizedState=null):v=m,Kt(Gl,Yr),Yr|=v;return yr(l,h,k,m),h.child}function T1(l,h){var m=h.ref;(l===null&&m!==null||l!==null&&l.ref!==m)&&(h.flags|=512,h.flags|=2097152)}function mg(l,h,m,v,k){var P=Tr(m)?ka:or.current;return P=zl(h,P),Vl(h,k),m=sg(l,h,m,v,P,k),v=og(),l!==null&&!Er?(h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~k,Ws(l,h,k)):(an&&v&&Hm(h),h.flags|=1,yr(l,h,m,k),h.child)}function E1(l,h,m,v,k){if(Tr(m)){var P=!0;Cf(h)}else P=!1;if(Vl(h,k),h.stateNode===null)Vf(l,h),x1(h,m,v),fg(h,m,v,k),v=!0;else if(l===null){var j=h.stateNode,J=h.memoizedProps;j.props=J;var re=j.context,ge=m.contextType;typeof ge=="object"&&ge!==null?ge=mi(ge):(ge=Tr(m)?ka:or.current,ge=zl(h,ge));var Se=m.getDerivedStateFromProps,Ee=typeof Se=="function"||typeof j.getSnapshotBeforeUpdate=="function";Ee||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(J!==v||re!==ge)&&y1(h,j,v,ge),No=!1;var ke=h.memoizedState;j.state=ke,Lf(h,v,j,k),re=h.memoizedState,J!==v||ke!==re||Cr.current||No?(typeof Se=="function"&&(hg(h,m,Se,v),re=h.memoizedState),(J=No||g1(h,m,J,v,ke,re,ge))?(Ee||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(h.flags|=4194308)):(typeof j.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=v,h.memoizedState=re),j.props=v,j.state=re,j.context=ge,v=J):(typeof j.componentDidMount=="function"&&(h.flags|=4194308),v=!1)}else{j=h.stateNode,VA(l,h),J=h.memoizedProps,ge=h.type===h.elementType?J:Di(h.type,J),j.props=ge,Ee=h.pendingProps,ke=j.context,re=m.contextType,typeof re=="object"&&re!==null?re=mi(re):(re=Tr(m)?ka:or.current,re=zl(h,re));var Qe=m.getDerivedStateFromProps;(Se=typeof Qe=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(J!==Ee||ke!==re)&&y1(h,j,v,re),No=!1,ke=h.memoizedState,j.state=ke,Lf(h,v,j,k);var Ve=h.memoizedState;J!==Ee||ke!==Ve||Cr.current||No?(typeof Qe=="function"&&(hg(h,m,Qe,v),Ve=h.memoizedState),(ge=No||g1(h,m,ge,v,ke,Ve,re)||!1)?(Se||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(v,Ve,re),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(v,Ve,re)),typeof j.componentDidUpdate=="function"&&(h.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof j.componentDidUpdate!="function"||J===l.memoizedProps&&ke===l.memoizedState||(h.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&ke===l.memoizedState||(h.flags|=1024),h.memoizedProps=v,h.memoizedState=Ve),j.props=v,j.state=Ve,j.context=re,v=ge):(typeof j.componentDidUpdate!="function"||J===l.memoizedProps&&ke===l.memoizedState||(h.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||J===l.memoizedProps&&ke===l.memoizedState||(h.flags|=1024),v=!1)}return gg(l,h,m,v,P,k)}function gg(l,h,m,v,k,P){T1(l,h);var j=(h.flags&128)!==0;if(!v&&!j)return k&&MA(h,m,!1),Ws(l,h,P);v=h.stateNode,_P.current=h;var J=j&&typeof m.getDerivedStateFromError!="function"?null:v.render();return h.flags|=1,l!==null&&j?(h.child=Wl(h,l.child,null,P),h.child=Wl(h,null,J,P)):yr(l,h,J,P),h.memoizedState=v.state,k&&MA(h,m,!0),h.child}function P1(l){var h=l.stateNode;h.pendingContext?RA(l,h.pendingContext,h.pendingContext!==h.context):h.context&&RA(l,h.context,!1),Jm(l,h.containerInfo)}function B1(l,h,m,v,k){return Hl(),$m(k),h.flags|=256,yr(l,h,m,v),h.child}var xg={dehydrated:null,treeContext:null,retryLane:0};function yg(l){return{baseLanes:l,cachePool:null,transitions:null}}function R1(l,h,m){var v=h.pendingProps,k=hn.current,P=!1,j=(h.flags&128)!==0,J;if((J=j)||(J=l!==null&&l.memoizedState===null?!1:(k&2)!==0),J?(P=!0,h.flags&=-129):(l===null||l.memoizedState!==null)&&(k|=1),Kt(hn,k&1),l===null)return Vm(h),l=h.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((h.mode&1)===0?h.lanes=1:l.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(j=v.children,l=v.fallback,P?(v=h.mode,P=h.child,j={mode:"hidden",children:j},(v&1)===0&&P!==null?(P.childLanes=0,P.pendingProps=j):P=rd(j,v,0,null),l=Na(l,v,m,null),P.return=h,l.return=h,P.sibling=l,h.child=P,h.child.memoizedState=yg(m),h.memoizedState=xg,l):vg(h,j));if(k=l.memoizedState,k!==null&&(J=k.dehydrated,J!==null))return OP(l,h,j,v,J,k,m);if(P){P=v.fallback,j=h.mode,k=l.child,J=k.sibling;var re={mode:"hidden",children:v.children};return(j&1)===0&&h.child!==k?(v=h.child,v.childLanes=0,v.pendingProps=re,h.deletions=null):(v=Ho(k,re),v.subtreeFlags=k.subtreeFlags&14680064),J!==null?P=Ho(J,P):(P=Na(P,j,m,null),P.flags|=2),P.return=h,v.return=h,v.sibling=P,h.child=v,v=P,P=h.child,j=l.child.memoizedState,j=j===null?yg(m):{baseLanes:j.baseLanes|m,cachePool:null,transitions:j.transitions},P.memoizedState=j,P.childLanes=l.childLanes&~m,h.memoizedState=xg,v}return P=l.child,l=P.sibling,v=Ho(P,{mode:"visible",children:v.children}),(h.mode&1)===0&&(v.lanes=m),v.return=h,v.sibling=null,l!==null&&(m=h.deletions,m===null?(h.deletions=[l],h.flags|=16):m.push(l)),h.child=v,h.memoizedState=null,v}function vg(l,h){return h=rd({mode:"visible",children:h},l.mode,0,null),h.return=l,l.child=h}function qf(l,h,m,v){return v!==null&&$m(v),Wl(h,l.child,null,m),l=vg(h,h.pendingProps.children),l.flags|=2,h.memoizedState=null,l}function OP(l,h,m,v,k,P,j){if(m)return h.flags&256?(h.flags&=-257,v=dg(Error(t(422))),qf(l,h,j,v)):h.memoizedState!==null?(h.child=l.child,h.flags|=128,null):(P=v.fallback,k=h.mode,v=rd({mode:"visible",children:v.children},k,0,null),P=Na(P,k,j,null),P.flags|=2,v.return=h,P.return=h,v.sibling=P,h.child=v,(h.mode&1)!==0&&Wl(h,l.child,null,j),h.child.memoizedState=yg(j),h.memoizedState=xg,P);if((h.mode&1)===0)return qf(l,h,j,null);if(k.data==="$!"){if(v=k.nextSibling&&k.nextSibling.dataset,v)var J=v.dgst;return v=J,P=Error(t(419)),v=dg(P,v,void 0),qf(l,h,j,v)}if(J=(j&l.childLanes)!==0,Er||J){if(v=Qn,v!==null){switch(j&-j){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(v.suspendedLanes|j))!==0?0:k,k!==0&&k!==P.retryLane&&(P.retryLane=k,Qs(l,k),Li(v,l,k,-1))}return Ng(),v=dg(Error(t(421))),qf(l,h,j,v)}return k.data==="$?"?(h.flags|=128,h.child=l.child,h=FP.bind(null,l),k._reactRetry=h,null):(l=P.treeContext,Kr=rs(k.nextSibling),Xr=h,an=!0,Ri=null,l!==null&&(di[pi++]=zs,di[pi++]=js,di[pi++]=Sa,zs=l.id,js=l.overflow,Sa=h),h=vg(h,v.children),h.flags|=4096,h)}function D1(l,h,m){l.lanes|=h;var v=l.alternate;v!==null&&(v.lanes|=h),Xm(l.return,h,m)}function Ag(l,h,m,v,k){var P=l.memoizedState;P===null?l.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:v,tail:m,tailMode:k}:(P.isBackwards=h,P.rendering=null,P.renderingStartTime=0,P.last=v,P.tail=m,P.tailMode=k)}function M1(l,h,m){var v=h.pendingProps,k=v.revealOrder,P=v.tail;if(yr(l,h,v.children,m),v=hn.current,(v&2)!==0)v=v&1|2,h.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=h.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&D1(l,m,h);else if(l.tag===19)D1(l,m,h);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===h)break e;for(;l.sibling===null;){if(l.return===null||l.return===h)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}v&=1}if(Kt(hn,v),(h.mode&1)===0)h.memoizedState=null;else switch(k){case"forwards":for(m=h.child,k=null;m!==null;)l=m.alternate,l!==null&&Ff(l)===null&&(k=m),m=m.sibling;m=k,m===null?(k=h.child,h.child=null):(k=m.sibling,m.sibling=null),Ag(h,!1,k,m,P);break;case"backwards":for(m=null,k=h.child,h.child=null;k!==null;){if(l=k.alternate,l!==null&&Ff(l)===null){h.child=k;break}l=k.sibling,k.sibling=m,m=k,k=l}Ag(h,!0,m,null,P);break;case"together":Ag(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Vf(l,h){(h.mode&1)===0&&l!==null&&(l.alternate=null,h.alternate=null,h.flags|=2)}function Ws(l,h,m){if(l!==null&&(h.dependencies=l.dependencies),Ba|=h.lanes,(m&h.childLanes)===0)return null;if(l!==null&&h.child!==l.child)throw Error(t(153));if(h.child!==null){for(l=h.child,m=Ho(l,l.pendingProps),h.child=m,m.return=h;l.sibling!==null;)l=l.sibling,m=m.sibling=Ho(l,l.pendingProps),m.return=h;m.sibling=null}return h.child}function kP(l,h,m){switch(h.tag){case 3:P1(h),Hl();break;case 5:ZA(h);break;case 1:Tr(h.type)&&Cf(h);break;case 4:Jm(h,h.stateNode.containerInfo);break;case 10:var v=h.type._context,k=h.memoizedProps.value;Kt(Df,v._currentValue),v._currentValue=k;break;case 13:if(v=h.memoizedState,v!==null)return v.dehydrated!==null?(Kt(hn,hn.current&1),h.flags|=128,null):(m&h.child.childLanes)!==0?R1(l,h,m):(Kt(hn,hn.current&1),l=Ws(l,h,m),l!==null?l.sibling:null);Kt(hn,hn.current&1);break;case 19:if(v=(m&h.childLanes)!==0,(l.flags&128)!==0){if(v)return M1(l,h,m);h.flags|=128}if(k=h.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Kt(hn,hn.current),v)break;return null;case 22:case 23:return h.lanes=0,C1(l,h,m)}return Ws(l,h,m)}var N1,bg,L1,F1;N1=function(l,h){for(var m=h.child;m!==null;){if(m.tag===5||m.tag===6)l.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},bg=function(){},L1=function(l,h,m,v){var k=l.memoizedProps;if(k!==v){l=h.stateNode,Ea(is.current);var P=null;switch(m){case"input":k=Ge(l,k),v=Ge(l,v),P=[];break;case"select":k=q({},k,{value:void 0}),v=q({},v,{value:void 0}),P=[];break;case"textarea":k=qe(l,k),v=qe(l,v),P=[];break;default:typeof k.onClick!="function"&&typeof v.onClick=="function"&&(l.onclick=_e)}Te(m,v);var j;m=null;for(ge in k)if(!v.hasOwnProperty(ge)&&k.hasOwnProperty(ge)&&k[ge]!=null)if(ge==="style"){var J=k[ge];for(j in J)J.hasOwnProperty(j)&&(m||(m={}),m[j]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(i.hasOwnProperty(ge)?P||(P=[]):(P=P||[]).push(ge,null));for(ge in v){var re=v[ge];if(J=k!=null?k[ge]:void 0,v.hasOwnProperty(ge)&&re!==J&&(re!=null||J!=null))if(ge==="style")if(J){for(j in J)!J.hasOwnProperty(j)||re&&re.hasOwnProperty(j)||(m||(m={}),m[j]="");for(j in re)re.hasOwnProperty(j)&&J[j]!==re[j]&&(m||(m={}),m[j]=re[j])}else m||(P||(P=[]),P.push(ge,m)),m=re;else ge==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,J=J?J.__html:void 0,re!=null&&J!==re&&(P=P||[]).push(ge,re)):ge==="children"?typeof re!="string"&&typeof re!="number"||(P=P||[]).push(ge,""+re):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(i.hasOwnProperty(ge)?(re!=null&&ge==="onScroll"&&qt("scroll",l),P||J===re||(P=[])):(P=P||[]).push(ge,re))}m&&(P=P||[]).push("style",m);var ge=P;(h.updateQueue=ge)&&(h.flags|=4)}},F1=function(l,h,m,v){m!==v&&(h.flags|=4)};function _u(l,h){if(!an)switch(l.tailMode){case"hidden":h=l.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?h||l.tail===null?l.tail=null:l.tail.sibling=null:v.sibling=null}}function lr(l){var h=l.alternate!==null&&l.alternate.child===l.child,m=0,v=0;if(h)for(var k=l.child;k!==null;)m|=k.lanes|k.childLanes,v|=k.subtreeFlags&14680064,v|=k.flags&14680064,k.return=l,k=k.sibling;else for(k=l.child;k!==null;)m|=k.lanes|k.childLanes,v|=k.subtreeFlags,v|=k.flags,k.return=l,k=k.sibling;return l.subtreeFlags|=v,l.childLanes=m,h}function SP(l,h,m){var v=h.pendingProps;switch(Wm(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(h),null;case 1:return Tr(h.type)&&Sf(),lr(h),null;case 3:return v=h.stateNode,$l(),nn(Cr),nn(or),ng(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(l===null||l.child===null)&&(Bf(h)?h.flags|=4:l===null||l.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ri!==null&&(Rg(Ri),Ri=null))),bg(l,h),lr(h),null;case 5:eg(h);var k=Ea(yu.current);if(m=h.type,l!==null&&h.stateNode!=null)L1(l,h,m,v,k),l.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!v){if(h.stateNode===null)throw Error(t(166));return lr(h),null}if(l=Ea(is.current),Bf(h)){v=h.stateNode,m=h.type;var P=h.memoizedProps;switch(v[fi]=h,v[Po]=P,l=(h.mode&1)!==0,m){case"dialog":qt("cancel",v),qt("close",v);break;case"iframe":case"object":case"embed":qt("load",v);break;case"video":case"audio":for(k=0;k<Co.length;k++)qt(Co[k],v);break;case"source":qt("error",v);break;case"img":case"image":case"link":qt("error",v),qt("load",v);break;case"details":qt("toggle",v);break;case"input":pt(v,P),qt("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!P.multiple},qt("invalid",v);break;case"textarea":Dt(v,P),qt("invalid",v)}Te(m,P),k=null;for(var j in P)if(P.hasOwnProperty(j)){var J=P[j];j==="children"?typeof J=="string"?v.textContent!==J&&(P.suppressHydrationWarning!==!0&&me(v.textContent,J,l),k=["children",J]):typeof J=="number"&&v.textContent!==""+J&&(P.suppressHydrationWarning!==!0&&me(v.textContent,J,l),k=["children",""+J]):i.hasOwnProperty(j)&&J!=null&&j==="onScroll"&&qt("scroll",v)}switch(m){case"input":Ke(v),mt(v,P,!0);break;case"textarea":Ke(v),dr(v);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(v.onclick=_e)}v=k,h.updateQueue=v,v!==null&&(h.flags|=4)}else{j=k.nodeType===9?k:k.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=en(m)),l==="http://www.w3.org/1999/xhtml"?m==="script"?(l=j.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof v.is=="string"?l=j.createElement(m,{is:v.is}):(l=j.createElement(m),m==="select"&&(j=l,v.multiple?j.multiple=!0:v.size&&(j.size=v.size))):l=j.createElementNS(l,m),l[fi]=h,l[Po]=v,N1(l,h,!1,!1),h.stateNode=l;e:{switch(j=Ie(m,v),m){case"dialog":qt("cancel",l),qt("close",l),k=v;break;case"iframe":case"object":case"embed":qt("load",l),k=v;break;case"video":case"audio":for(k=0;k<Co.length;k++)qt(Co[k],l);k=v;break;case"source":qt("error",l),k=v;break;case"img":case"image":case"link":qt("error",l),qt("load",l),k=v;break;case"details":qt("toggle",l),k=v;break;case"input":pt(l,v),k=Ge(l,v),qt("invalid",l);break;case"option":k=v;break;case"select":l._wrapperState={wasMultiple:!!v.multiple},k=q({},v,{value:void 0}),qt("invalid",l);break;case"textarea":Dt(l,v),k=qe(l,v),qt("invalid",l);break;default:k=v}Te(m,k),J=k;for(P in J)if(J.hasOwnProperty(P)){var re=J[P];P==="style"?zn(l,re):P==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&Zn(l,re)):P==="children"?typeof re=="string"?(m!=="textarea"||re!=="")&&rn(l,re):typeof re=="number"&&rn(l,""+re):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(i.hasOwnProperty(P)?re!=null&&P==="onScroll"&&qt("scroll",l):re!=null&&E(l,P,re,j))}switch(m){case"input":Ke(l),mt(l,v,!1);break;case"textarea":Ke(l),dr(l);break;case"option":v.value!=null&&l.setAttribute("value",""+xe(v.value));break;case"select":l.multiple=!!v.multiple,P=v.value,P!=null?at(l,!!v.multiple,P,!1):v.defaultValue!=null&&at(l,!!v.multiple,v.defaultValue,!0);break;default:typeof k.onClick=="function"&&(l.onclick=_e)}switch(m){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return lr(h),null;case 6:if(l&&h.stateNode!=null)F1(l,h,l.memoizedProps,v);else{if(typeof v!="string"&&h.stateNode===null)throw Error(t(166));if(m=Ea(yu.current),Ea(is.current),Bf(h)){if(v=h.stateNode,m=h.memoizedProps,v[fi]=h,(P=v.nodeValue!==m)&&(l=Xr,l!==null))switch(l.tag){case 3:me(v.nodeValue,m,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&me(v.nodeValue,m,(l.mode&1)!==0)}P&&(h.flags|=4)}else v=(m.nodeType===9?m:m.ownerDocument).createTextNode(v),v[fi]=h,h.stateNode=v}return lr(h),null;case 13:if(nn(hn),v=h.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(an&&Kr!==null&&(h.mode&1)!==0&&(h.flags&128)===0)jA(),Hl(),h.flags|=98560,P=!1;else if(P=Bf(h),v!==null&&v.dehydrated!==null){if(l===null){if(!P)throw Error(t(318));if(P=h.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(t(317));P[fi]=h}else Hl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;lr(h),P=!1}else Ri!==null&&(Rg(Ri),Ri=null),P=!0;if(!P)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=m,h):(v=v!==null,v!==(l!==null&&l.memoizedState!==null)&&v&&(h.child.flags|=8192,(h.mode&1)!==0&&(l===null||(hn.current&1)!==0?Dn===0&&(Dn=3):Ng())),h.updateQueue!==null&&(h.flags|=4),lr(h),null);case 4:return $l(),bg(l,h),l===null&&To(h.stateNode.containerInfo),lr(h),null;case 10:return Gm(h.type._context),lr(h),null;case 17:return Tr(h.type)&&Sf(),lr(h),null;case 19:if(nn(hn),P=h.memoizedState,P===null)return lr(h),null;if(v=(h.flags&128)!==0,j=P.rendering,j===null)if(v)_u(P,!1);else{if(Dn!==0||l!==null&&(l.flags&128)!==0)for(l=h.child;l!==null;){if(j=Ff(l),j!==null){for(h.flags|=128,_u(P,!1),v=j.updateQueue,v!==null&&(h.updateQueue=v,h.flags|=4),h.subtreeFlags=0,v=m,m=h.child;m!==null;)P=m,l=v,P.flags&=14680066,j=P.alternate,j===null?(P.childLanes=0,P.lanes=l,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=j.childLanes,P.lanes=j.lanes,P.child=j.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=j.memoizedProps,P.memoizedState=j.memoizedState,P.updateQueue=j.updateQueue,P.type=j.type,l=j.dependencies,P.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),m=m.sibling;return Kt(hn,hn.current&1|2),h.child}l=l.sibling}P.tail!==null&&cn()>Xl&&(h.flags|=128,v=!0,_u(P,!1),h.lanes=4194304)}else{if(!v)if(l=Ff(j),l!==null){if(h.flags|=128,v=!0,m=l.updateQueue,m!==null&&(h.updateQueue=m,h.flags|=4),_u(P,!0),P.tail===null&&P.tailMode==="hidden"&&!j.alternate&&!an)return lr(h),null}else 2*cn()-P.renderingStartTime>Xl&&m!==1073741824&&(h.flags|=128,v=!0,_u(P,!1),h.lanes=4194304);P.isBackwards?(j.sibling=h.child,h.child=j):(m=P.last,m!==null?m.sibling=j:h.child=j,P.last=j)}return P.tail!==null?(h=P.tail,P.rendering=h,P.tail=h.sibling,P.renderingStartTime=cn(),h.sibling=null,m=hn.current,Kt(hn,v?m&1|2:m&1),h):(lr(h),null);case 22:case 23:return Mg(),v=h.memoizedState!==null,l!==null&&l.memoizedState!==null!==v&&(h.flags|=8192),v&&(h.mode&1)!==0?(Yr&1073741824)!==0&&(lr(h),h.subtreeFlags&6&&(h.flags|=8192)):lr(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function CP(l,h){switch(Wm(h),h.tag){case 1:return Tr(h.type)&&Sf(),l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 3:return $l(),nn(Cr),nn(or),ng(),l=h.flags,(l&65536)!==0&&(l&128)===0?(h.flags=l&-65537|128,h):null;case 5:return eg(h),null;case 13:if(nn(hn),l=h.memoizedState,l!==null&&l.dehydrated!==null){if(h.alternate===null)throw Error(t(340));Hl()}return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 19:return nn(hn),null;case 4:return $l(),null;case 10:return Gm(h.type._context),null;case 22:case 23:return Mg(),null;case 24:return null;default:return null}}var $f=!1,cr=!1,TP=typeof WeakSet=="function"?WeakSet:Set,We=null;function Zl(l,h){var m=l.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(v){gn(l,h,v)}else m.current=null}function wg(l,h,m){try{m()}catch(v){gn(l,h,v)}}var I1=!1;function EP(l,h){if(Fe=xa,l=ou(),au(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var v=m.getSelection&&m.getSelection();if(v&&v.rangeCount!==0){m=v.anchorNode;var k=v.anchorOffset,P=v.focusNode;v=v.focusOffset;try{m.nodeType,P.nodeType}catch{m=null;break e}var j=0,J=-1,re=-1,ge=0,Se=0,Ee=l,ke=null;t:for(;;){for(var Qe;Ee!==m||k!==0&&Ee.nodeType!==3||(J=j+k),Ee!==P||v!==0&&Ee.nodeType!==3||(re=j+v),Ee.nodeType===3&&(j+=Ee.nodeValue.length),(Qe=Ee.firstChild)!==null;)ke=Ee,Ee=Qe;for(;;){if(Ee===l)break t;if(ke===m&&++ge===k&&(J=j),ke===P&&++Se===v&&(re=j),(Qe=Ee.nextSibling)!==null)break;Ee=ke,ke=Ee.parentNode}Ee=Qe}m=J===-1||re===-1?null:{start:J,end:re}}else m=null}m=m||{start:0,end:0}}else m=null;for(rt={focusedElem:l,selectionRange:m},xa=!1,We=h;We!==null;)if(h=We,l=h.child,(h.subtreeFlags&1028)!==0&&l!==null)l.return=h,We=l;else for(;We!==null;){h=We;try{var Ve=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Ve!==null){var Xe=Ve.memoizedProps,An=Ve.memoizedState,he=h.stateNode,oe=he.getSnapshotBeforeUpdate(h.elementType===h.type?Xe:Di(h.type,Xe),An);he.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var de=h.stateNode.containerInfo;de.nodeType===1?de.textContent="":de.nodeType===9&&de.documentElement&&de.removeChild(de.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Re){gn(h,h.return,Re)}if(l=h.sibling,l!==null){l.return=h.return,We=l;break}We=h.return}return Ve=I1,I1=!1,Ve}function Ou(l,h,m){var v=h.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var k=v=v.next;do{if((k.tag&l)===l){var P=k.destroy;k.destroy=void 0,P!==void 0&&wg(h,m,P)}k=k.next}while(k!==v)}}function Uf(l,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&l)===l){var v=m.create;m.destroy=v()}m=m.next}while(m!==h)}}function _g(l){var h=l.ref;if(h!==null){var m=l.stateNode;switch(l.tag){case 5:l=m;break;default:l=m}typeof h=="function"?h(l):h.current=l}}function z1(l){var h=l.alternate;h!==null&&(l.alternate=null,z1(h)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(h=l.stateNode,h!==null&&(delete h[fi],delete h[Po],delete h[Bo],delete h[Im],delete h[zm])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function j1(l){return l.tag===5||l.tag===3||l.tag===4}function Q1(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||j1(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Og(l,h,m){var v=l.tag;if(v===5||v===6)l=l.stateNode,h?m.nodeType===8?m.parentNode.insertBefore(l,h):m.insertBefore(l,h):(m.nodeType===8?(h=m.parentNode,h.insertBefore(l,m)):(h=m,h.appendChild(l)),m=m._reactRootContainer,m!=null||h.onclick!==null||(h.onclick=_e));else if(v!==4&&(l=l.child,l!==null))for(Og(l,h,m),l=l.sibling;l!==null;)Og(l,h,m),l=l.sibling}function kg(l,h,m){var v=l.tag;if(v===5||v===6)l=l.stateNode,h?m.insertBefore(l,h):m.appendChild(l);else if(v!==4&&(l=l.child,l!==null))for(kg(l,h,m),l=l.sibling;l!==null;)kg(l,h,m),l=l.sibling}var Gn=null,Mi=!1;function Fo(l,h,m){for(m=m.child;m!==null;)H1(l,h,m),m=m.sibling}function H1(l,h,m){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(ha,m)}catch{}switch(m.tag){case 5:cr||Zl(m,h);case 6:var v=Gn,k=Mi;Gn=null,Fo(l,h,m),Gn=v,Mi=k,Gn!==null&&(Mi?(l=Gn,m=m.stateNode,l.nodeType===8?l.parentNode.removeChild(m):l.removeChild(m)):Gn.removeChild(m.stateNode));break;case 18:Gn!==null&&(Mi?(l=Gn,m=m.stateNode,l.nodeType===8?pu(l.parentNode,m):l.nodeType===1&&pu(l,m),Vr(l)):pu(Gn,m.stateNode));break;case 4:v=Gn,k=Mi,Gn=m.stateNode.containerInfo,Mi=!0,Fo(l,h,m),Gn=v,Mi=k;break;case 0:case 11:case 14:case 15:if(!cr&&(v=m.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){k=v=v.next;do{var P=k,j=P.destroy;P=P.tag,j!==void 0&&((P&2)!==0||(P&4)!==0)&&wg(m,h,j),k=k.next}while(k!==v)}Fo(l,h,m);break;case 1:if(!cr&&(Zl(m,h),v=m.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=m.memoizedProps,v.state=m.memoizedState,v.componentWillUnmount()}catch(J){gn(m,h,J)}Fo(l,h,m);break;case 21:Fo(l,h,m);break;case 22:m.mode&1?(cr=(v=cr)||m.memoizedState!==null,Fo(l,h,m),cr=v):Fo(l,h,m);break;default:Fo(l,h,m)}}function W1(l){var h=l.updateQueue;if(h!==null){l.updateQueue=null;var m=l.stateNode;m===null&&(m=l.stateNode=new TP),h.forEach(function(v){var k=IP.bind(null,l,v);m.has(v)||(m.add(v),v.then(k,k))})}}function Ni(l,h){var m=h.deletions;if(m!==null)for(var v=0;v<m.length;v++){var k=m[v];try{var P=l,j=h,J=j;e:for(;J!==null;){switch(J.tag){case 5:Gn=J.stateNode,Mi=!1;break e;case 3:Gn=J.stateNode.containerInfo,Mi=!0;break e;case 4:Gn=J.stateNode.containerInfo,Mi=!0;break e}J=J.return}if(Gn===null)throw Error(t(160));H1(P,j,k),Gn=null,Mi=!1;var re=k.alternate;re!==null&&(re.return=null),k.return=null}catch(ge){gn(k,h,ge)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)q1(h,l),h=h.sibling}function q1(l,h){var m=l.alternate,v=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ni(h,l),os(l),v&4){try{Ou(3,l,l.return),Uf(3,l)}catch(Xe){gn(l,l.return,Xe)}try{Ou(5,l,l.return)}catch(Xe){gn(l,l.return,Xe)}}break;case 1:Ni(h,l),os(l),v&512&&m!==null&&Zl(m,m.return);break;case 5:if(Ni(h,l),os(l),v&512&&m!==null&&Zl(m,m.return),l.flags&32){var k=l.stateNode;try{rn(k,"")}catch(Xe){gn(l,l.return,Xe)}}if(v&4&&(k=l.stateNode,k!=null)){var P=l.memoizedProps,j=m!==null?m.memoizedProps:P,J=l.type,re=l.updateQueue;if(l.updateQueue=null,re!==null)try{J==="input"&&P.type==="radio"&&P.name!=null&&bt(k,P),Ie(J,j);var ge=Ie(J,P);for(j=0;j<re.length;j+=2){var Se=re[j],Ee=re[j+1];Se==="style"?zn(k,Ee):Se==="dangerouslySetInnerHTML"?Zn(k,Ee):Se==="children"?rn(k,Ee):E(k,Se,Ee,ge)}switch(J){case"input":ot(k,P);break;case"textarea":Jt(k,P);break;case"select":var ke=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!P.multiple;var Qe=P.value;Qe!=null?at(k,!!P.multiple,Qe,!1):ke!==!!P.multiple&&(P.defaultValue!=null?at(k,!!P.multiple,P.defaultValue,!0):at(k,!!P.multiple,P.multiple?[]:"",!1))}k[Po]=P}catch(Xe){gn(l,l.return,Xe)}}break;case 6:if(Ni(h,l),os(l),v&4){if(l.stateNode===null)throw Error(t(162));k=l.stateNode,P=l.memoizedProps;try{k.nodeValue=P}catch(Xe){gn(l,l.return,Xe)}}break;case 3:if(Ni(h,l),os(l),v&4&&m!==null&&m.memoizedState.isDehydrated)try{Vr(h.containerInfo)}catch(Xe){gn(l,l.return,Xe)}break;case 4:Ni(h,l),os(l);break;case 13:Ni(h,l),os(l),k=l.child,k.flags&8192&&(P=k.memoizedState!==null,k.stateNode.isHidden=P,!P||k.alternate!==null&&k.alternate.memoizedState!==null||(Tg=cn())),v&4&&W1(l);break;case 22:if(Se=m!==null&&m.memoizedState!==null,l.mode&1?(cr=(ge=cr)||Se,Ni(h,l),cr=ge):Ni(h,l),os(l),v&8192){if(ge=l.memoizedState!==null,(l.stateNode.isHidden=ge)&&!Se&&(l.mode&1)!==0)for(We=l,Se=l.child;Se!==null;){for(Ee=We=Se;We!==null;){switch(ke=We,Qe=ke.child,ke.tag){case 0:case 11:case 14:case 15:Ou(4,ke,ke.return);break;case 1:Zl(ke,ke.return);var Ve=ke.stateNode;if(typeof Ve.componentWillUnmount=="function"){v=ke,m=ke.return;try{h=v,Ve.props=h.memoizedProps,Ve.state=h.memoizedState,Ve.componentWillUnmount()}catch(Xe){gn(v,m,Xe)}}break;case 5:Zl(ke,ke.return);break;case 22:if(ke.memoizedState!==null){U1(Ee);continue}}Qe!==null?(Qe.return=ke,We=Qe):U1(Ee)}Se=Se.sibling}e:for(Se=null,Ee=l;;){if(Ee.tag===5){if(Se===null){Se=Ee;try{k=Ee.stateNode,ge?(P=k.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(J=Ee.stateNode,re=Ee.memoizedProps.style,j=re!=null&&re.hasOwnProperty("display")?re.display:null,J.style.display=pr("display",j))}catch(Xe){gn(l,l.return,Xe)}}}else if(Ee.tag===6){if(Se===null)try{Ee.stateNode.nodeValue=ge?"":Ee.memoizedProps}catch(Xe){gn(l,l.return,Xe)}}else if((Ee.tag!==22&&Ee.tag!==23||Ee.memoizedState===null||Ee===l)&&Ee.child!==null){Ee.child.return=Ee,Ee=Ee.child;continue}if(Ee===l)break e;for(;Ee.sibling===null;){if(Ee.return===null||Ee.return===l)break e;Se===Ee&&(Se=null),Ee=Ee.return}Se===Ee&&(Se=null),Ee.sibling.return=Ee.return,Ee=Ee.sibling}}break;case 19:Ni(h,l),os(l),v&4&&W1(l);break;case 21:break;default:Ni(h,l),os(l)}}function os(l){var h=l.flags;if(h&2){try{e:{for(var m=l.return;m!==null;){if(j1(m)){var v=m;break e}m=m.return}throw Error(t(160))}switch(v.tag){case 5:var k=v.stateNode;v.flags&32&&(rn(k,""),v.flags&=-33);var P=Q1(l);kg(l,P,k);break;case 3:case 4:var j=v.stateNode.containerInfo,J=Q1(l);Og(l,J,j);break;default:throw Error(t(161))}}catch(re){gn(l,l.return,re)}l.flags&=-3}h&4096&&(l.flags&=-4097)}function PP(l,h,m){We=l,V1(l)}function V1(l,h,m){for(var v=(l.mode&1)!==0;We!==null;){var k=We,P=k.child;if(k.tag===22&&v){var j=k.memoizedState!==null||$f;if(!j){var J=k.alternate,re=J!==null&&J.memoizedState!==null||cr;J=$f;var ge=cr;if($f=j,(cr=re)&&!ge)for(We=k;We!==null;)j=We,re=j.child,j.tag===22&&j.memoizedState!==null?Z1(k):re!==null?(re.return=j,We=re):Z1(k);for(;P!==null;)We=P,V1(P),P=P.sibling;We=k,$f=J,cr=ge}$1(l)}else(k.subtreeFlags&8772)!==0&&P!==null?(P.return=k,We=P):$1(l)}}function $1(l){for(;We!==null;){var h=We;if((h.flags&8772)!==0){var m=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:cr||Uf(5,h);break;case 1:var v=h.stateNode;if(h.flags&4&&!cr)if(m===null)v.componentDidMount();else{var k=h.elementType===h.type?m.memoizedProps:Di(h.type,m.memoizedProps);v.componentDidUpdate(k,m.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var P=h.updateQueue;P!==null&&UA(h,P,v);break;case 3:var j=h.updateQueue;if(j!==null){if(m=null,h.child!==null)switch(h.child.tag){case 5:m=h.child.stateNode;break;case 1:m=h.child.stateNode}UA(h,j,m)}break;case 5:var J=h.stateNode;if(m===null&&h.flags&4){m=J;var re=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&m.focus();break;case"img":re.src&&(m.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var ge=h.alternate;if(ge!==null){var Se=ge.memoizedState;if(Se!==null){var Ee=Se.dehydrated;Ee!==null&&Vr(Ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}cr||h.flags&512&&_g(h)}catch(ke){gn(h,h.return,ke)}}if(h===l){We=null;break}if(m=h.sibling,m!==null){m.return=h.return,We=m;break}We=h.return}}function U1(l){for(;We!==null;){var h=We;if(h===l){We=null;break}var m=h.sibling;if(m!==null){m.return=h.return,We=m;break}We=h.return}}function Z1(l){for(;We!==null;){var h=We;try{switch(h.tag){case 0:case 11:case 15:var m=h.return;try{Uf(4,h)}catch(re){gn(h,m,re)}break;case 1:var v=h.stateNode;if(typeof v.componentDidMount=="function"){var k=h.return;try{v.componentDidMount()}catch(re){gn(h,k,re)}}var P=h.return;try{_g(h)}catch(re){gn(h,P,re)}break;case 5:var j=h.return;try{_g(h)}catch(re){gn(h,j,re)}}}catch(re){gn(h,h.return,re)}if(h===l){We=null;break}var J=h.sibling;if(J!==null){J.return=h.return,We=J;break}We=h.return}}var BP=Math.ceil,Zf=D.ReactCurrentDispatcher,Sg=D.ReactCurrentOwner,xi=D.ReactCurrentBatchConfig,Nt=0,Qn=null,Sn=null,Xn=0,Yr=0,Gl=Ro(0),Dn=0,ku=null,Ba=0,Gf=0,Cg=0,Su=null,Pr=null,Tg=0,Xl=1/0,qs=null,Xf=!1,Eg=null,Io=null,Kf=!1,zo=null,Yf=0,Cu=0,Pg=null,Jf=-1,ed=0;function vr(){return(Nt&6)!==0?cn():Jf!==-1?Jf:Jf=cn()}function jo(l){return(l.mode&1)===0?1:(Nt&2)!==0&&Xn!==0?Xn&-Xn:pP.transition!==null?(ed===0&&(ed=nf()),ed):(l=Bt,l!==0||(l=window.event,l=l===void 0?16:Ct(l.type)),l)}function Li(l,h,m,v){if(50<Cu)throw Cu=0,Pg=null,Error(t(185));Wr(l,m,v),((Nt&2)===0||l!==Qn)&&(l===Qn&&((Nt&2)===0&&(Gf|=m),Dn===4&&Qo(l,Xn)),Br(l,v),m===1&&Nt===0&&(h.mode&1)===0&&(Xl=cn()+500,Tf&&Mo()))}function Br(l,h){var m=l.callbackNode;gl(l,h);var v=Xt(l,l===Qn?Xn:0);if(v===0)m!==null&&Hc(m),l.callbackNode=null,l.callbackPriority=0;else if(h=v&-v,l.callbackPriority!==h){if(m!=null&&Hc(m),h===1)l.tag===0?dP(X1.bind(null,l)):NA(X1.bind(null,l)),sr(function(){(Nt&6)===0&&Mo()}),m=null;else{switch(mo(v)){case 1:m=Wc;break;case 4:m=tf;break;case 16:m=pl;break;case 536870912:m=uo;break;default:m=pl}m=ib(m,G1.bind(null,l))}l.callbackPriority=h,l.callbackNode=m}}function G1(l,h){if(Jf=-1,ed=0,(Nt&6)!==0)throw Error(t(327));var m=l.callbackNode;if(Kl()&&l.callbackNode!==m)return null;var v=Xt(l,l===Qn?Xn:0);if(v===0)return null;if((v&30)!==0||(v&l.expiredLanes)!==0||h)h=td(l,v);else{h=v;var k=Nt;Nt|=2;var P=Y1();(Qn!==l||Xn!==h)&&(qs=null,Xl=cn()+500,Da(l,h));do try{MP();break}catch(J){K1(l,J)}while(!0);Zm(),Zf.current=P,Nt=k,Sn!==null?h=0:(Qn=null,Xn=0,h=Dn)}if(h!==0){if(h===2&&(k=rr(l),k!==0&&(v=k,h=Bg(l,k))),h===1)throw m=ku,Da(l,0),Qo(l,v),Br(l,cn()),m;if(h===6)Qo(l,v);else{if(k=l.current.alternate,(v&30)===0&&!RP(k)&&(h=td(l,v),h===2&&(P=rr(l),P!==0&&(v=P,h=Bg(l,P))),h===1))throw m=ku,Da(l,0),Qo(l,v),Br(l,cn()),m;switch(l.finishedWork=k,l.finishedLanes=v,h){case 0:case 1:throw Error(t(345));case 2:Ma(l,Pr,qs);break;case 3:if(Qo(l,v),(v&130023424)===v&&(h=Tg+500-cn(),10<h)){if(Xt(l,0)!==0)break;if(k=l.suspendedLanes,(k&v)!==v){vr(),l.pingedLanes|=l.suspendedLanes&k;break}l.timeoutHandle=Bn(Ma.bind(null,l,Pr,qs),h);break}Ma(l,Pr,qs);break;case 4:if(Qo(l,v),(v&4194240)===v)break;for(h=l.eventTimes,k=-1;0<v;){var j=31-gt(v);P=1<<j,j=h[j],j>k&&(k=j),v&=~P}if(v=k,v=cn()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*BP(v/1960))-v,10<v){l.timeoutHandle=Bn(Ma.bind(null,l,Pr,qs),v);break}Ma(l,Pr,qs);break;case 5:Ma(l,Pr,qs);break;default:throw Error(t(329))}}}return Br(l,cn()),l.callbackNode===m?G1.bind(null,l):null}function Bg(l,h){var m=Su;return l.current.memoizedState.isDehydrated&&(Da(l,h).flags|=256),l=td(l,h),l!==2&&(h=Pr,Pr=m,h!==null&&Rg(h)),l}function Rg(l){Pr===null?Pr=l:Pr.push.apply(Pr,l)}function RP(l){for(var h=l;;){if(h.flags&16384){var m=h.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var v=0;v<m.length;v++){var k=m[v],P=k.getSnapshot;k=k.value;try{if(!Zr(P(),k))return!1}catch{return!1}}}if(m=h.child,h.subtreeFlags&16384&&m!==null)m.return=h,h=m;else{if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Qo(l,h){for(h&=~Cg,h&=~Gf,l.suspendedLanes|=h,l.pingedLanes&=~h,l=l.expirationTimes;0<h;){var m=31-gt(h),v=1<<m;l[m]=-1,h&=~v}}function X1(l){if((Nt&6)!==0)throw Error(t(327));Kl();var h=Xt(l,0);if((h&1)===0)return Br(l,cn()),null;var m=td(l,h);if(l.tag!==0&&m===2){var v=rr(l);v!==0&&(h=v,m=Bg(l,v))}if(m===1)throw m=ku,Da(l,0),Qo(l,h),Br(l,cn()),m;if(m===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=h,Ma(l,Pr,qs),Br(l,cn()),null}function Dg(l,h){var m=Nt;Nt|=1;try{return l(h)}finally{Nt=m,Nt===0&&(Xl=cn()+500,Tf&&Mo())}}function Ra(l){zo!==null&&zo.tag===0&&(Nt&6)===0&&Kl();var h=Nt;Nt|=1;var m=xi.transition,v=Bt;try{if(xi.transition=null,Bt=1,l)return l()}finally{Bt=v,xi.transition=m,Nt=h,(Nt&6)===0&&Mo()}}function Mg(){Yr=Gl.current,nn(Gl)}function Da(l,h){l.finishedWork=null,l.finishedLanes=0;var m=l.timeoutHandle;if(m!==-1&&(l.timeoutHandle=-1,kn(m)),Sn!==null)for(m=Sn.return;m!==null;){var v=m;switch(Wm(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Sf();break;case 3:$l(),nn(Cr),nn(or),ng();break;case 5:eg(v);break;case 4:$l();break;case 13:nn(hn);break;case 19:nn(hn);break;case 10:Gm(v.type._context);break;case 22:case 23:Mg()}m=m.return}if(Qn=l,Sn=l=Ho(l.current,null),Xn=Yr=h,Dn=0,ku=null,Cg=Gf=Ba=0,Pr=Su=null,Ta!==null){for(h=0;h<Ta.length;h++)if(m=Ta[h],v=m.interleaved,v!==null){m.interleaved=null;var k=v.next,P=m.pending;if(P!==null){var j=P.next;P.next=k,v.next=j}m.pending=v}Ta=null}return l}function K1(l,h){do{var m=Sn;try{if(Zm(),If.current=Hf,zf){for(var v=fn.memoizedState;v!==null;){var k=v.queue;k!==null&&(k.pending=null),v=v.next}zf=!1}if(Pa=0,jn=Rn=fn=null,vu=!1,Au=0,Sg.current=null,m===null||m.return===null){Dn=1,ku=h,Sn=null;break}e:{var P=l,j=m.return,J=m,re=h;if(h=Xn,J.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var ge=re,Se=J,Ee=Se.tag;if((Se.mode&1)===0&&(Ee===0||Ee===11||Ee===15)){var ke=Se.alternate;ke?(Se.updateQueue=ke.updateQueue,Se.memoizedState=ke.memoizedState,Se.lanes=ke.lanes):(Se.updateQueue=null,Se.memoizedState=null)}var Qe=w1(j);if(Qe!==null){Qe.flags&=-257,_1(Qe,j,J,P,h),Qe.mode&1&&b1(P,ge,h),h=Qe,re=ge;var Ve=h.updateQueue;if(Ve===null){var Xe=new Set;Xe.add(re),h.updateQueue=Xe}else Ve.add(re);break e}else{if((h&1)===0){b1(P,ge,h),Ng();break e}re=Error(t(426))}}else if(an&&J.mode&1){var An=w1(j);if(An!==null){(An.flags&65536)===0&&(An.flags|=256),_1(An,j,J,P,h),$m(Ul(re,J));break e}}P=re=Ul(re,J),Dn!==4&&(Dn=2),Su===null?Su=[P]:Su.push(P),P=j;do{switch(P.tag){case 3:P.flags|=65536,h&=-h,P.lanes|=h;var he=v1(P,re,h);$A(P,he);break e;case 1:J=re;var oe=P.type,de=P.stateNode;if((P.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||de!==null&&typeof de.componentDidCatch=="function"&&(Io===null||!Io.has(de)))){P.flags|=65536,h&=-h,P.lanes|=h;var Re=A1(P,J,h);$A(P,Re);break e}}P=P.return}while(P!==null)}eb(m)}catch(Ye){h=Ye,Sn===m&&m!==null&&(Sn=m=m.return);continue}break}while(!0)}function Y1(){var l=Zf.current;return Zf.current=Hf,l===null?Hf:l}function Ng(){(Dn===0||Dn===3||Dn===2)&&(Dn=4),Qn===null||(Ba&268435455)===0&&(Gf&268435455)===0||Qo(Qn,Xn)}function td(l,h){var m=Nt;Nt|=2;var v=Y1();(Qn!==l||Xn!==h)&&(qs=null,Da(l,h));do try{DP();break}catch(k){K1(l,k)}while(!0);if(Zm(),Nt=m,Zf.current=v,Sn!==null)throw Error(t(261));return Qn=null,Xn=0,Dn}function DP(){for(;Sn!==null;)J1(Sn)}function MP(){for(;Sn!==null&&!wm();)J1(Sn)}function J1(l){var h=rb(l.alternate,l,Yr);l.memoizedProps=l.pendingProps,h===null?eb(l):Sn=h,Sg.current=null}function eb(l){var h=l;do{var m=h.alternate;if(l=h.return,(h.flags&32768)===0){if(m=SP(m,h,Yr),m!==null){Sn=m;return}}else{if(m=CP(m,h),m!==null){m.flags&=32767,Sn=m;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Dn=6,Sn=null;return}}if(h=h.sibling,h!==null){Sn=h;return}Sn=h=l}while(h!==null);Dn===0&&(Dn=5)}function Ma(l,h,m){var v=Bt,k=xi.transition;try{xi.transition=null,Bt=1,NP(l,h,m,v)}finally{xi.transition=k,Bt=v}return null}function NP(l,h,m,v){do Kl();while(zo!==null);if((Nt&6)!==0)throw Error(t(327));m=l.finishedWork;var k=l.finishedLanes;if(m===null)return null;if(l.finishedWork=null,l.finishedLanes=0,m===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var P=m.lanes|m.childLanes;if(mn(l,P),l===Qn&&(Sn=Qn=null,Xn=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||Kf||(Kf=!0,ib(pl,function(){return Kl(),null})),P=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||P){P=xi.transition,xi.transition=null;var j=Bt;Bt=1;var J=Nt;Nt|=4,Sg.current=null,EP(l,m),q1(m,l),ui(rt),xa=!!Fe,rt=Fe=null,l.current=m,PP(m),dl(),Nt=J,Bt=j,xi.transition=P}else l.current=m;if(Kf&&(Kf=!1,zo=l,Yf=k),P=l.pendingLanes,P===0&&(Io=null),fa(m.stateNode),Br(l,cn()),h!==null)for(v=l.onRecoverableError,m=0;m<h.length;m++)k=h[m],v(k.value,{componentStack:k.stack,digest:k.digest});if(Xf)throw Xf=!1,l=Eg,Eg=null,l;return(Yf&1)!==0&&l.tag!==0&&Kl(),P=l.pendingLanes,(P&1)!==0?l===Pg?Cu++:(Cu=0,Pg=l):Cu=0,Mo(),null}function Kl(){if(zo!==null){var l=mo(Yf),h=xi.transition,m=Bt;try{if(xi.transition=null,Bt=16>l?16:l,zo===null)var v=!1;else{if(l=zo,zo=null,Yf=0,(Nt&6)!==0)throw Error(t(331));var k=Nt;for(Nt|=4,We=l.current;We!==null;){var P=We,j=P.child;if((We.flags&16)!==0){var J=P.deletions;if(J!==null){for(var re=0;re<J.length;re++){var ge=J[re];for(We=ge;We!==null;){var Se=We;switch(Se.tag){case 0:case 11:case 15:Ou(8,Se,P)}var Ee=Se.child;if(Ee!==null)Ee.return=Se,We=Ee;else for(;We!==null;){Se=We;var ke=Se.sibling,Qe=Se.return;if(z1(Se),Se===ge){We=null;break}if(ke!==null){ke.return=Qe,We=ke;break}We=Qe}}}var Ve=P.alternate;if(Ve!==null){var Xe=Ve.child;if(Xe!==null){Ve.child=null;do{var An=Xe.sibling;Xe.sibling=null,Xe=An}while(Xe!==null)}}We=P}}if((P.subtreeFlags&2064)!==0&&j!==null)j.return=P,We=j;else e:for(;We!==null;){if(P=We,(P.flags&2048)!==0)switch(P.tag){case 0:case 11:case 15:Ou(9,P,P.return)}var he=P.sibling;if(he!==null){he.return=P.return,We=he;break e}We=P.return}}var oe=l.current;for(We=oe;We!==null;){j=We;var de=j.child;if((j.subtreeFlags&2064)!==0&&de!==null)de.return=j,We=de;else e:for(j=oe;We!==null;){if(J=We,(J.flags&2048)!==0)try{switch(J.tag){case 0:case 11:case 15:Uf(9,J)}}catch(Ye){gn(J,J.return,Ye)}if(J===j){We=null;break e}var Re=J.sibling;if(Re!==null){Re.return=J.return,We=Re;break e}We=J.return}}if(Nt=k,Mo(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(ha,l)}catch{}v=!0}return v}finally{Bt=m,xi.transition=h}}return!1}function tb(l,h,m){h=Ul(m,h),h=v1(l,h,1),l=Lo(l,h,1),h=vr(),l!==null&&(Wr(l,1,h),Br(l,h))}function gn(l,h,m){if(l.tag===3)tb(l,l,m);else for(;h!==null;){if(h.tag===3){tb(h,l,m);break}else if(h.tag===1){var v=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Io===null||!Io.has(v))){l=Ul(m,l),l=A1(h,l,1),h=Lo(h,l,1),l=vr(),h!==null&&(Wr(h,1,l),Br(h,l));break}}h=h.return}}function LP(l,h,m){var v=l.pingCache;v!==null&&v.delete(h),h=vr(),l.pingedLanes|=l.suspendedLanes&m,Qn===l&&(Xn&m)===m&&(Dn===4||Dn===3&&(Xn&130023424)===Xn&&500>cn()-Tg?Da(l,0):Cg|=m),Br(l,h)}function nb(l,h){h===0&&((l.mode&1)===0?h=1:(h=fo,fo<<=1,(fo&130023424)===0&&(fo=4194304)));var m=vr();l=Qs(l,h),l!==null&&(Wr(l,h,m),Br(l,m))}function FP(l){var h=l.memoizedState,m=0;h!==null&&(m=h.retryLane),nb(l,m)}function IP(l,h){var m=0;switch(l.tag){case 13:var v=l.stateNode,k=l.memoizedState;k!==null&&(m=k.retryLane);break;case 19:v=l.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(h),nb(l,m)}var rb;rb=function(l,h,m){if(l!==null)if(l.memoizedProps!==h.pendingProps||Cr.current)Er=!0;else{if((l.lanes&m)===0&&(h.flags&128)===0)return Er=!1,kP(l,h,m);Er=(l.flags&131072)!==0}else Er=!1,an&&(h.flags&1048576)!==0&&LA(h,Pf,h.index);switch(h.lanes=0,h.tag){case 2:var v=h.type;Vf(l,h),l=h.pendingProps;var k=zl(h,or.current);Vl(h,m),k=sg(null,h,v,l,k,m);var P=og();return h.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Tr(v)?(P=!0,Cf(h)):P=!1,h.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Ym(h),k.updater=Wf,h.stateNode=k,k._reactInternals=h,fg(h,v,l,m),h=gg(null,h,v,!0,P,m)):(h.tag=0,an&&P&&Hm(h),yr(null,h,k,m),h=h.child),h;case 16:v=h.elementType;e:{switch(Vf(l,h),l=h.pendingProps,k=v._init,v=k(v._payload),h.type=v,k=h.tag=jP(v),l=Di(v,l),k){case 0:h=mg(null,h,v,l,m);break e;case 1:h=E1(null,h,v,l,m);break e;case 11:h=O1(null,h,v,l,m);break e;case 14:h=k1(null,h,v,Di(v.type,l),m);break e}throw Error(t(306,v,""))}return h;case 0:return v=h.type,k=h.pendingProps,k=h.elementType===v?k:Di(v,k),mg(l,h,v,k,m);case 1:return v=h.type,k=h.pendingProps,k=h.elementType===v?k:Di(v,k),E1(l,h,v,k,m);case 3:e:{if(P1(h),l===null)throw Error(t(387));v=h.pendingProps,P=h.memoizedState,k=P.element,VA(l,h),Lf(h,v,null,m);var j=h.memoizedState;if(v=j.element,P.isDehydrated)if(P={element:v,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},h.updateQueue.baseState=P,h.memoizedState=P,h.flags&256){k=Ul(Error(t(423)),h),h=B1(l,h,v,m,k);break e}else if(v!==k){k=Ul(Error(t(424)),h),h=B1(l,h,v,m,k);break e}else for(Kr=rs(h.stateNode.containerInfo.firstChild),Xr=h,an=!0,Ri=null,m=WA(h,null,v,m),h.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Hl(),v===k){h=Ws(l,h,m);break e}yr(l,h,v,m)}h=h.child}return h;case 5:return ZA(h),l===null&&Vm(h),v=h.type,k=h.pendingProps,P=l!==null?l.memoizedProps:null,j=k.children,yt(v,k)?j=null:P!==null&&yt(v,P)&&(h.flags|=32),T1(l,h),yr(l,h,j,m),h.child;case 6:return l===null&&Vm(h),null;case 13:return R1(l,h,m);case 4:return Jm(h,h.stateNode.containerInfo),v=h.pendingProps,l===null?h.child=Wl(h,null,v,m):yr(l,h,v,m),h.child;case 11:return v=h.type,k=h.pendingProps,k=h.elementType===v?k:Di(v,k),O1(l,h,v,k,m);case 7:return yr(l,h,h.pendingProps,m),h.child;case 8:return yr(l,h,h.pendingProps.children,m),h.child;case 12:return yr(l,h,h.pendingProps.children,m),h.child;case 10:e:{if(v=h.type._context,k=h.pendingProps,P=h.memoizedProps,j=k.value,Kt(Df,v._currentValue),v._currentValue=j,P!==null)if(Zr(P.value,j)){if(P.children===k.children&&!Cr.current){h=Ws(l,h,m);break e}}else for(P=h.child,P!==null&&(P.return=h);P!==null;){var J=P.dependencies;if(J!==null){j=P.child;for(var re=J.firstContext;re!==null;){if(re.context===v){if(P.tag===1){re=Hs(-1,m&-m),re.tag=2;var ge=P.updateQueue;if(ge!==null){ge=ge.shared;var Se=ge.pending;Se===null?re.next=re:(re.next=Se.next,Se.next=re),ge.pending=re}}P.lanes|=m,re=P.alternate,re!==null&&(re.lanes|=m),Xm(P.return,m,h),J.lanes|=m;break}re=re.next}}else if(P.tag===10)j=P.type===h.type?null:P.child;else if(P.tag===18){if(j=P.return,j===null)throw Error(t(341));j.lanes|=m,J=j.alternate,J!==null&&(J.lanes|=m),Xm(j,m,h),j=P.sibling}else j=P.child;if(j!==null)j.return=P;else for(j=P;j!==null;){if(j===h){j=null;break}if(P=j.sibling,P!==null){P.return=j.return,j=P;break}j=j.return}P=j}yr(l,h,k.children,m),h=h.child}return h;case 9:return k=h.type,v=h.pendingProps.children,Vl(h,m),k=mi(k),v=v(k),h.flags|=1,yr(l,h,v,m),h.child;case 14:return v=h.type,k=Di(v,h.pendingProps),k=Di(v.type,k),k1(l,h,v,k,m);case 15:return S1(l,h,h.type,h.pendingProps,m);case 17:return v=h.type,k=h.pendingProps,k=h.elementType===v?k:Di(v,k),Vf(l,h),h.tag=1,Tr(v)?(l=!0,Cf(h)):l=!1,Vl(h,m),x1(h,v,k),fg(h,v,k,m),gg(null,h,v,!0,l,m);case 19:return M1(l,h,m);case 22:return C1(l,h,m)}throw Error(t(156,h.tag))};function ib(l,h){return ef(l,h)}function zP(l,h,m,v){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yi(l,h,m,v){return new zP(l,h,m,v)}function Lg(l){return l=l.prototype,!(!l||!l.isReactComponent)}function jP(l){if(typeof l=="function")return Lg(l)?1:0;if(l!=null){if(l=l.$$typeof,l===X)return 11;if(l===le)return 14}return 2}function Ho(l,h){var m=l.alternate;return m===null?(m=yi(l.tag,h,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=h,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&14680064,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,h=l.dependencies,m.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m}function nd(l,h,m,v,k,P){var j=2;if(v=l,typeof l=="function")Lg(l)&&(j=1);else if(typeof l=="string")j=5;else e:switch(l){case z:return Na(m.children,k,P,h);case I:j=8,k|=8;break;case K:return l=yi(12,m,h,k|2),l.elementType=K,l.lanes=P,l;case $:return l=yi(13,m,h,k),l.elementType=$,l.lanes=P,l;case ee:return l=yi(19,m,h,k),l.elementType=ee,l.lanes=P,l;case ie:return rd(m,k,P,h);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case W:j=10;break e;case U:j=9;break e;case X:j=11;break e;case le:j=14;break e;case Z:j=16,v=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return h=yi(j,m,h,k),h.elementType=l,h.type=v,h.lanes=P,h}function Na(l,h,m,v){return l=yi(7,l,v,h),l.lanes=m,l}function rd(l,h,m,v){return l=yi(22,l,v,h),l.elementType=ie,l.lanes=m,l.stateNode={isHidden:!1},l}function Fg(l,h,m){return l=yi(6,l,null,h),l.lanes=m,l}function Ig(l,h,m){return h=yi(4,l.children!==null?l.children:[],l.key,h),h.lanes=m,h.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},h}function QP(l,h,m,v,k){this.tag=h,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=po(0),this.expirationTimes=po(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=po(0),this.identifierPrefix=v,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function zg(l,h,m,v,k,P,j,J,re){return l=new QP(l,h,m,J,re),h===1?(h=1,P===!0&&(h|=8)):h=0,P=yi(3,null,null,h),l.current=P,P.stateNode=l,P.memoizedState={element:v,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ym(P),l}function HP(l,h,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:v==null?null:""+v,children:l,containerInfo:h,implementation:m}}function sb(l){if(!l)return Do;l=l._reactInternals;e:{if(Gi(l)!==l||l.tag!==1)throw Error(t(170));var h=l;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Tr(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(l.tag===1){var m=l.type;if(Tr(m))return DA(l,m,h)}return h}function ob(l,h,m,v,k,P,j,J,re){return l=zg(m,v,!0,l,k,P,j,J,re),l.context=sb(null),m=l.current,v=vr(),k=jo(m),P=Hs(v,k),P.callback=h??null,Lo(m,P,k),l.current.lanes=k,Wr(l,k,v),Br(l,v),l}function id(l,h,m,v){var k=h.current,P=vr(),j=jo(k);return m=sb(m),h.context===null?h.context=m:h.pendingContext=m,h=Hs(P,j),h.payload={element:l},v=v===void 0?null:v,v!==null&&(h.callback=v),l=Lo(k,h,j),l!==null&&(Li(l,k,j,P),Nf(l,k,j)),j}function sd(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function ab(l,h){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<h?m:h}}function jg(l,h){ab(l,h),(l=l.alternate)&&ab(l,h)}function WP(){return null}var lb=typeof reportError=="function"?reportError:function(l){console.error(l)};function Qg(l){this._internalRoot=l}od.prototype.render=Qg.prototype.render=function(l){var h=this._internalRoot;if(h===null)throw Error(t(409));id(l,h,null,null)},od.prototype.unmount=Qg.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var h=l.containerInfo;Ra(function(){id(null,l,null,null)}),h[It]=null}};function od(l){this._internalRoot=l}od.prototype.unstable_scheduleHydration=function(l){if(l){var h=vl();l={blockedOn:null,target:l,priority:h};for(var m=0;m<Pn.length&&h!==0&&h<Pn[m].priority;m++);Pn.splice(m,0,l),m===0&&Al(l)}};function Hg(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function ad(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function cb(){}function qP(l,h,m,v,k){if(k){if(typeof v=="function"){var P=v;v=function(){var ge=sd(j);P.call(ge)}}var j=ob(h,v,l,0,null,!1,!1,"",cb);return l._reactRootContainer=j,l[It]=j.current,To(l.nodeType===8?l.parentNode:l),Ra(),j}for(;k=l.lastChild;)l.removeChild(k);if(typeof v=="function"){var J=v;v=function(){var ge=sd(re);J.call(ge)}}var re=zg(l,0,!1,null,null,!1,!1,"",cb);return l._reactRootContainer=re,l[It]=re.current,To(l.nodeType===8?l.parentNode:l),Ra(function(){id(h,re,m,v)}),re}function ld(l,h,m,v,k){var P=m._reactRootContainer;if(P){var j=P;if(typeof k=="function"){var J=k;k=function(){var re=sd(j);J.call(re)}}id(h,j,l,k)}else j=qP(m,h,l,k,v);return sd(j)}xl=function(l){switch(l.tag){case 3:var h=l.stateNode;if(h.current.memoizedState.isDehydrated){var m=ht(h.pendingLanes);m!==0&&(Ci(h,m|1),Br(h,cn()),(Nt&6)===0&&(Xl=cn()+500,Mo()))}break;case 13:Ra(function(){var v=Qs(l,1);if(v!==null){var k=vr();Li(v,l,1,k)}}),jg(l,1)}},Ss=function(l){if(l.tag===13){var h=Qs(l,134217728);if(h!==null){var m=vr();Li(h,l,134217728,m)}jg(l,134217728)}},yl=function(l){if(l.tag===13){var h=jo(l),m=Qs(l,h);if(m!==null){var v=vr();Li(m,l,h,v)}jg(l,h)}},vl=function(){return Bt},da=function(l,h){var m=Bt;try{return Bt=l,h()}finally{Bt=m}},be=function(l,h,m){switch(h){case"input":if(ot(l,m),h=m.name,m.type==="radio"&&h!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<m.length;h++){var v=m[h];if(v!==l&&v.form===l.form){var k=Fl(v);if(!k)throw Error(t(90));nt(v),ot(v,k)}}}break;case"textarea":Jt(l,m);break;case"select":h=m.value,h!=null&&at(l,!!m.multiple,h,!1)}},wt=Dg,Gt=Ra;var VP={usingClientEntryPoint:!1,Events:[Ls,Fs,Fl,ae,De,Dg]},Tu={findFiberByHostInstance:Ns,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$P={bundleType:Tu.bundleType,version:Tu.version,rendererPackageName:Tu.rendererPackageName,rendererConfig:Tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Yh(l),l===null?null:l.stateNode},findFiberByHostInstance:Tu.findFiberByHostInstance||WP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cd.isDisabled&&cd.supportsFiber)try{ha=cd.inject($P),Hr=cd}catch{}}return Rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VP,Rr.createPortal=function(l,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hg(h))throw Error(t(200));return HP(l,h,null,m)},Rr.createRoot=function(l,h){if(!Hg(l))throw Error(t(299));var m=!1,v="",k=lb;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(v=h.identifierPrefix),h.onRecoverableError!==void 0&&(k=h.onRecoverableError)),h=zg(l,1,!1,null,null,m,!1,v,k),l[It]=h.current,To(l.nodeType===8?l.parentNode:l),new Qg(h)},Rr.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var h=l._reactInternals;if(h===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=Yh(h),l=l===null?null:l.stateNode,l},Rr.flushSync=function(l){return Ra(l)},Rr.hydrate=function(l,h,m){if(!ad(h))throw Error(t(200));return ld(null,l,h,!0,m)},Rr.hydrateRoot=function(l,h,m){if(!Hg(l))throw Error(t(405));var v=m!=null&&m.hydratedSources||null,k=!1,P="",j=lb;if(m!=null&&(m.unstable_strictMode===!0&&(k=!0),m.identifierPrefix!==void 0&&(P=m.identifierPrefix),m.onRecoverableError!==void 0&&(j=m.onRecoverableError)),h=ob(h,null,l,1,m??null,k,!1,P,j),l[It]=h.current,To(l),v)for(l=0;l<v.length;l++)m=v[l],k=m._getVersion,k=k(m._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[m,k]:h.mutableSourceEagerHydrationData.push(m,k);return new od(h)},Rr.render=function(l,h,m){if(!ad(h))throw Error(t(200));return ld(null,l,h,!1,m)},Rr.unmountComponentAtNode=function(l){if(!ad(l))throw Error(t(40));return l._reactRootContainer?(Ra(function(){ld(null,null,l,!1,function(){l._reactRootContainer=null,l[It]=null})}),!0):!1},Rr.unstable_batchedUpdates=Dg,Rr.unstable_renderSubtreeIntoContainer=function(l,h,m,v){if(!ad(m))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return ld(l,h,m,!1,v)},Rr.version="18.3.1-next-f1338f8080-20240426",Rr}var xb;function Fk(){if(xb)return $g.exports;xb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),$g.exports=nB(),$g.exports}var yb;function rB(){if(yb)return ud;yb=1;var n=Fk();return ud.createRoot=n.createRoot,ud.hydrateRoot=n.hydrateRoot,ud}var iB=rB();const sB="/api",fv=100;async function zt(n,e){const t=await fetch(`${sB}${n}`,{...e,headers:{"Content-Type":"application/json",...e==null?void 0:e.headers}});if(!t.ok){const r=await t.text();let i=r||t.statusText;try{const s=JSON.parse(r);s.detail&&(i=s.detail)}catch{}throw new Error(i)}return t.json()}function oB(n){return n instanceof DOMException&&n.name==="AbortError"?!0:n instanceof Error&&n.name==="AbortError"}const dt={getHealth:()=>zt("/health"),getRadioConfig:()=>zt("/radio/config"),updateRadioConfig:n=>zt("/radio/config",{method:"PATCH",body:JSON.stringify(n)}),setPrivateKey:n=>zt("/radio/private-key",{method:"PUT",body:JSON.stringify({private_key:n})}),sendAdvertisement:(n=!0)=>zt(`/radio/advertise?flood=${n}`,{method:"POST"}),rebootRadio:()=>zt("/radio/reboot",{method:"POST"}),reconnectRadio:()=>zt("/radio/reconnect",{method:"POST"}),getContacts:(n=100,e=0)=>zt(`/contacts?limit=${n}&offset=${e}`),deleteContact:n=>zt(`/contacts/${n}`,{method:"DELETE"}),createContact:(n,e,t)=>zt("/contacts",{method:"POST",body:JSON.stringify({public_key:n,name:e,try_historical:t})}),markContactRead:n=>zt(`/contacts/${n}/mark-read`,{method:"POST"}),requestTelemetry:(n,e)=>zt(`/contacts/${n}/telemetry`,{method:"POST",body:JSON.stringify({password:e})}),sendRepeaterCommand:(n,e)=>zt(`/contacts/${n}/command`,{method:"POST",body:JSON.stringify({command:e})}),getChannels:()=>zt("/channels"),createChannel:(n,e)=>zt("/channels",{method:"POST",body:JSON.stringify({name:n,key:e})}),deleteChannel:n=>zt(`/channels/${n}`,{method:"DELETE"}),markChannelRead:n=>zt(`/channels/${n}/mark-read`,{method:"POST"}),getMessages:(n,e)=>{const t=new URLSearchParams;n!=null&&n.limit&&t.set("limit",n.limit.toString()),n!=null&&n.offset&&t.set("offset",n.offset.toString()),n!=null&&n.type&&t.set("type",n.type),n!=null&&n.conversation_key&&t.set("conversation_key",n.conversation_key);const r=t.toString();return zt(`/messages${r?`?${r}`:""}`,{signal:e})},getMessagesBulk:(n,e=fv)=>zt(`/messages/bulk?limit_per_conversation=${e}`,{method:"POST",body:JSON.stringify(n)}),sendDirectMessage:(n,e)=>zt("/messages/direct",{method:"POST",body:JSON.stringify({destination:n,text:e})}),sendChannelMessage:(n,e)=>zt("/messages/channel",{method:"POST",body:JSON.stringify({channel_key:n,text:e})}),getUndecryptedPacketCount:()=>zt("/packets/undecrypted/count"),decryptHistoricalPackets:n=>zt("/packets/decrypt/historical",{method:"POST",body:JSON.stringify(n)}),runMaintenance:n=>zt("/packets/maintenance",{method:"POST",body:JSON.stringify({prune_undecrypted_days:n})}),markAllRead:()=>zt("/read-state/mark-all-read",{method:"POST"}),getSettings:()=>zt("/settings"),updateSettings:n=>zt("/settings",{method:"PATCH",body:JSON.stringify(n)}),toggleFavorite:(n,e)=>zt("/settings/favorites/toggle",{method:"POST",body:JSON.stringify({type:n,id:e})}),updateLastMessageTime:(n,e)=>zt("/settings/last-message-time",{method:"POST",body:JSON.stringify({state_key:n,timestamp:e})}),migratePreferences:n=>zt("/settings/migrate",{method:"POST",body:JSON.stringify(n)})};function aB(n){const e=R.useRef(null),t=R.useRef(null),[r,i]=R.useState(!1),s=R.useRef(n);R.useEffect(()=>{s.current=n},[n]);const o=R.useCallback(()=>{const a=window.location.protocol==="https:"?"wss:":"ws:",f=window.location.port==="5173"?"ws://localhost:8000/api/ws":`${a}//${window.location.host}/api/ws`,p=new WebSocket(f);p.onopen=()=>{console.log("WebSocket connected"),i(!0)},p.onclose=()=>{console.log("WebSocket disconnected"),i(!1),e.current=null,t.current=window.setTimeout(()=>{console.log("Attempting WebSocket reconnect..."),o()},3e3)},p.onerror=g=>{console.error("WebSocket error:",g)},p.onmessage=g=>{var x,A,_,b,w,C,T,E,D;try{const N=JSON.parse(g.data),F=s.current;switch(N.type){case"health":(x=F.onHealth)==null||x.call(F,N.data);break;case"contacts":(A=F.onContacts)==null||A.call(F,N.data);break;case"channels":(_=F.onChannels)==null||_.call(F,N.data);break;case"message":(b=F.onMessage)==null||b.call(F,N.data);break;case"contact":(w=F.onContact)==null||w.call(F,N.data);break;case"raw_packet":(C=F.onRawPacket)==null||C.call(F,N.data);break;case"message_acked":{const z=N.data;(T=F.onMessageAcked)==null||T.call(F,z.message_id,z.ack_count,z.paths);break}case"error":(E=F.onError)==null||E.call(F,N.data);break;case"success":(D=F.onSuccess)==null||D.call(F,N.data);break;case"pong":break;default:console.log("Unknown WebSocket message type:",N.type)}}catch(N){console.error("Failed to parse WebSocket message:",N)}},e.current=p},[]);return R.useEffect(()=>{o();const a=setInterval(()=>{var u;((u=e.current)==null?void 0:u.readyState)===WebSocket.OPEN&&e.current.send("ping")},3e4);return()=>{clearInterval(a),t.current&&clearTimeout(t.current),e.current&&e.current.close()}},[o]),{connected:r}}const Lp=2,lB=300*1e3;function vb(n){const e=Math.floor(n/3600),t=Math.floor(n%3600/60),r=Math.floor(n%60);return`${e}h${t}m${r}s`}function cB(n){return n<=5?"":n<=10?"":n<=25?"":n<=50?"":""}function uB(n,e){const r=Math.floor(Date.now()/1e3)-n.startTime,i=e.uptime_seconds-n.uptime,s=e.airtime_seconds-n.txAirtime,o=e.rx_airtime_seconds-n.rxAirtime,a=e.sent_flood-n.sentFlood,u=e.sent_direct-n.sentDirect,f=e.recv_flood-n.recvFlood,p=e.recv_direct-n.recvDirect,g=i>0?s/i*100:0,x=i>0?o/i*100:0,A=a+u,_=f+p,b=A>0?g*(a/A):0,w=A>0?g*(u/A):0,C=_>0?x*(f/_):0,T=_>0?x*(p/_):0,E=cB(g),D=Math.max(0,100-g-x);return["Airtime/Duty Cycle Statistics",`Duration: ${vb(r)} (uptime delta: ${vb(i)})`,"",`${E} TX Airtime: ${g.toFixed(3)}% (${A.toLocaleString()} pkts)`,`  Flood: ${b.toFixed(3)}% (${a.toLocaleString()} pkts)`,`  Direct: ${w.toFixed(3)}% (${u.toLocaleString()} pkts)`,"",`RX Airtime: ${x.toFixed(3)}% (${_.toLocaleString()} pkts)`,`  Flood: ${C.toFixed(3)}% (${f.toLocaleString()} pkts)`,`  Direct: ${T.toFixed(3)}% (${p.toLocaleString()} pkts)`,"",`Idle: ${D.toFixed(3)}%`].join(`
`)}function Yl(n,e,t){const r=Math.floor(Date.now()/1e3);return{id:-Date.now(),type:"PRIV",conversation_key:n,text:e,sender_timestamp:r,received_at:r,paths:null,txt_type:0,signature:null,outgoing:t,acked:1}}function hB(n){const e=R.useRef(null),t=R.useRef(null),r=R.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null),e.current=null},[]),i=R.useCallback(async()=>{const o=e.current;if(!o)return;let a=null,u=null;for(let f=0;f<2;f++)try{a=await dt.requestTelemetry(o.conversationId,"");break}catch(p){u=p instanceof Error?p:new Error("Unknown error"),f===0&&await new Promise(g=>setTimeout(g,2e3))}if(a){const f=Yl(o.conversationId,uB(o,a),!1);n(p=>[...p,f])}else{const f=Yl(o.conversationId,`Duty cycle poll failed after retry: ${(u==null?void 0:u.message)??"Unknown error"}`,!1);n(p=>[...p,f])}},[n]),s=R.useCallback(async(o,a)=>{const u=o.trim().toLowerCase();if(u==="dutycycle_start"){r();let f=null,p=null;for(let A=0;A<2;A++)try{f=await dt.requestTelemetry(a,"");break}catch(_){p=_ instanceof Error?_:new Error("Unknown error"),A===0&&await new Promise(b=>setTimeout(b,2e3))}if(!f){const A=Yl(a,`Failed to start duty cycle tracking after retry: ${(p==null?void 0:p.message)??"Unknown error"}`,!1);return n(_=>[..._,A]),!0}const g=Math.floor(Date.now()/1e3);e.current={startTime:g,uptime:f.uptime_seconds,txAirtime:f.airtime_seconds,rxAirtime:f.rx_airtime_seconds,sentFlood:f.sent_flood,sentDirect:f.sent_direct,recvFlood:f.recv_flood,recvDirect:f.recv_direct,conversationId:a};const x=Yl(a,`Airtime/duty cycle statistics gathering begins at ${g}. Logs will follow every 5 minutes. To stop, run dutycycle_stop or navigate away from this conversation.`,!1);return n(A=>[...A,x]),t.current=window.setInterval(i,lB),!0}if(u==="dutycycle_stop"){if(e.current&&e.current.conversationId===a){await i(),r();const f=Yl(a,"Airtime/duty cycle statistics gathering stopped.",!1);n(p=>[...p,f])}else{const f=Yl(a,"Duty cycle tracking is not active.",!1);n(p=>[...p,f])}return!0}return!1},[n,r,i]);return R.useEffect(()=>()=>{t.current!==null&&clearInterval(t.current)},[]),{handleAirtimeCommand:s,stopTracking:r}}function Xd(n){if(n<60)return`${n}s`;const e=Math.floor(n/86400),t=Math.floor(n%86400/3600),r=Math.floor(n%3600/60);return e>0?t>0&&r>0?`${e}d${t}h${r}m`:t>0?`${e}d${t}h`:r>0?`${e}d${r}m`:`${e}d`:t>0?r>0?`${t}h${r}m`:`${t}h`:`${r}m`}function fB(n){return["Telemetry",`Battery Voltage: ${n.battery_volts.toFixed(3)}V`,`Uptime: ${Xd(n.uptime_seconds)}`,...n.clock_output?[`Clock: ${n.clock_output}`]:[],`TX Airtime: ${Xd(n.airtime_seconds)}`,`RX Airtime: ${Xd(n.rx_airtime_seconds)}`,"",`Noise Floor: ${n.noise_floor_dbm} dBm`,`Last RSSI: ${n.last_rssi_dbm} dBm`,`Last SNR: ${n.last_snr_db.toFixed(1)} dB`,"",`Packets: ${n.packets_received.toLocaleString()} rx / ${n.packets_sent.toLocaleString()} tx`,`Flood: ${n.recv_flood.toLocaleString()} rx / ${n.sent_flood.toLocaleString()} tx`,`Direct: ${n.recv_direct.toLocaleString()} rx / ${n.sent_direct.toLocaleString()} tx`,`Duplicates: ${n.flood_dups.toLocaleString()} flood / ${n.direct_dups.toLocaleString()} direct`,"",`TX Queue: ${n.tx_queue_len}`,`Debug Flags: ${n.full_events}`].join(`
`)}function dB(n){if(n.length===0)return`Neighbors
No neighbors reported`;const e=[...n].sort((r,i)=>i.snr-r.snr),t=[`Neighbors (${e.length})`];for(const r of e){const i=r.name||r.pubkey_prefix,s=r.snr>=0?`+${r.snr.toFixed(1)}`:r.snr.toFixed(1);t.push(`${i}, ${s} dB [${Xd(r.last_heard_seconds)} ago]`)}return t.join(`
`)}function pB(n){if(n.length===0)return`ACL
No ACL entries`;const e=[`ACL (${n.length})`];for(const t of n){const r=t.name||t.pubkey_prefix;e.push(`${r}: ${t.permission_name}`)}return e.join(`
`)}function Fa(n,e,t,r=0){const i=Math.floor(Date.now()/1e3);return{id:-Date.now()-r,type:"PRIV",conversation_key:n,text:e,sender_timestamp:i,received_at:i,paths:null,txt_type:0,signature:null,outgoing:t,acked:1}}function mB(n,e,t){const[r,i]=R.useState(!1),{handleAirtimeCommand:s,stopTracking:o}=hB(t);R.useEffect(()=>{i(!1),o()},[n==null?void 0:n.id,o]);const a=R.useMemo(()=>{if(!n||n.type!=="contact")return!1;const p=e.find(g=>g.public_key===n.id);return(p==null?void 0:p.type)===Lp},[n,e]),u=R.useCallback(async p=>{if(!(!n||n.type!=="contact")&&a)try{const g=await dt.requestTelemetry(n.id,p),x=Fa(n.id,fB(g),!1,0),A=Fa(n.id,dB(g.neighbors),!1,1),_=Fa(n.id,pB(g.acl),!1,2);t(b=>[...b,x,A,_]),i(!0)}catch(g){const x=Fa(n.id,`Telemetry request failed: ${g instanceof Error?g.message:"Unknown error"}`,!1,0);t(A=>[...A,x])}},[n,a,t]),f=R.useCallback(async p=>{if(!n||n.type!=="contact"||!a||!r||await s(p,n.id))return;const x=Fa(n.id,`> ${p}`,!0,0);t(A=>[...A,x]);try{const A=await dt.sendRepeaterCommand(n.id,p),_=Fa(n.id,A.response,!1,1);A.sender_timestamp&&(_.sender_timestamp=A.sender_timestamp),t(b=>[...b,_])}catch(A){const _=Fa(n.id,`Command failed: ${A instanceof Error?A.message:"Unknown error"}`,!1,1);t(b=>[...b,_])}},[n,a,r,t,s]);return{repeaterLoggedIn:r,activeContactIsRepeater:a,handleTelemetryRequest:u,handleRepeaterCommand:f}}const Ik="remoteterm-lastMessageTime",zk="remoteterm-sortOrder";let Y0={};function Ab(n){Y0={...n}}function bb(){return{...Y0}}function Gg(n,e){return Y0[n]=e,{...Y0}}function Ii(n,e){return`${n}-${e}`}function gB(){try{const n=localStorage.getItem(Ik);return n?JSON.parse(n):{}}catch{return{}}}function xB(){try{return localStorage.getItem(zk)==="alpha"?"alpha":"recent"}catch{return"recent"}}function wb(){try{localStorage.removeItem(Ik),localStorage.removeItem(zk)}catch{}}function _b(n,e){if(!e)return!1;const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(`@\\[${t}\\]`,"i").test(n)}function yB(n,e,t,r=null){const[i,s]=R.useState({}),[o,a]=R.useState({}),[u,f]=R.useState(bb),p=R.useRef(r);R.useEffect(()=>{p.current=r},[r]);const g=R.useRef(new Set),x=R.useRef(new Set);R.useEffect(()=>{const C=n.filter(D=>!g.current.has(D.key)),T=e.filter(D=>D.public_key&&!x.current.has(D.public_key));if(C.length===0&&T.length===0)return;C.forEach(D=>g.current.add(D.key)),T.forEach(D=>x.current.add(D.public_key)),(async()=>{const D=[...C.map(N=>({type:"CHAN",conversation_key:N.key})),...T.map(N=>({type:"PRIV",conversation_key:N.public_key}))];if(D.length!==0)try{const F={};for(let W=0;W<D.length;W+=200){const U=D.slice(W,W+200),X=await dt.getMessagesBulk(U,fv);Object.assign(F,X)}const z={},I={},K={};for(const W of C){const U=F[`CHAN:${W.key}`]||[];if(U.length>0){const X=Ii("channel",W.key),$=W.last_read_at||0,ee=U.filter(Z=>!Z.outgoing&&Z.received_at>$);ee.length>0&&(z[X]=ee.length,ee.some(Z=>_b(Z.text,p.current))&&(I[X]=!0));const le=Math.max(...U.map(Z=>Z.received_at));K[X]=le,Gg(X,le)}}for(const W of T){const U=F[`PRIV:${W.public_key}`]||[];if(U.length>0){const X=Ii("contact",W.public_key),$=W.last_read_at||0,ee=U.filter(Z=>!Z.outgoing&&Z.received_at>$);ee.length>0&&(z[X]=ee.length,ee.some(Z=>_b(Z.text,p.current))&&(I[X]=!0));const le=Math.max(...U.map(Z=>Z.received_at));K[X]=le,Gg(X,le)}}Object.keys(z).length>0&&s(W=>({...W,...z})),Object.keys(I).length>0&&a(W=>({...W,...I})),f(bb())}catch(N){console.error("Failed to fetch messages bulk:",N)}})()},[n,e]),R.useEffect(()=>{if(t&&t.type!=="raw"&&t.type!=="map"){const C=Ii(t.type,t.id);s(T=>{if(T[C]){const E={...T};return delete E[C],E}return T}),a(T=>{if(T[C]){const E={...T};return delete E[C],E}return T}),t.type==="channel"?dt.markChannelRead(t.id).catch(T=>{console.error("Failed to mark channel as read on server:",T)}):t.type==="contact"&&dt.markContactRead(t.id).catch(T=>{console.error("Failed to mark contact as read on server:",T)})}},[t]);const A=R.useCallback((C,T)=>{s(E=>({...E,[C]:(E[C]||0)+1})),T&&a(E=>({...E,[C]:!0}))},[]),_=R.useCallback(()=>{s({}),a({}),dt.markAllRead().catch(C=>{console.error("Failed to mark all as read on server:",C)})},[]),b=R.useCallback(C=>{if(C.type==="raw"||C.type==="map")return;const T=Ii(C.type,C.id);s(E=>{if(E[T]){const D={...E};return delete D[T],D}return E}),a(E=>{if(E[T]){const D={...E};return delete D[T],D}return E}),C.type==="channel"?dt.markChannelRead(C.id).catch(E=>{console.error("Failed to mark channel as read on server:",E)}):C.type==="contact"&&dt.markContactRead(C.id).catch(E=>{console.error("Failed to mark contact as read on server:",E)})},[]),w=R.useCallback(C=>{let T=null;if(C.type==="CHAN"&&C.conversation_key?T=Ii("channel",C.conversation_key):C.type==="PRIV"&&C.conversation_key&&(T=Ii("contact",C.conversation_key)),T){const E=C.received_at||Math.floor(Date.now()/1e3),D=Gg(T,E);f(D)}},[]);return{unreadCounts:i,mentions:o,lastMessageTimes:u,incrementUnread:A,markAllRead:_,markConversationRead:b,trackNewMessage:w}}var dv=Fk();const jk=Rc(dv);function vB(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}const AB=n=>{switch(n){case"success":return _B;case"info":return kB;case"warning":return OB;case"error":return SB;default:return null}},bB=Array(12).fill(0),wB=({visible:n,className:e})=>Be.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":n},Be.createElement("div",{className:"sonner-spinner"},bB.map((t,r)=>Be.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),_B=Be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Be.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),OB=Be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Be.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),kB=Be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Be.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),SB=Be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Be.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),CB=Be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Be.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Be.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),TB=()=>{const[n,e]=Be.useState(document.hidden);return Be.useEffect(()=>{const t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),n};let Kx=1;class EB{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:r,...i}=e,s=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Kx++,o=this.toasts.find(u=>u.id===s),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),o?this.toasts=this.toasts.map(u=>u.id===s?(this.publish({...u,...e,id:s,title:r}),{...u,...e,id:s,dismissible:a,title:r}):u):this.addToast({title:r,...i,dismissible:a,id:s}),s},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let s=r!==void 0,o;const a=i.then(async f=>{if(o=["resolve",f],Be.isValidElement(f))s=!1,this.create({id:r,type:"default",message:f});else if(BB(f)&&!f.ok){s=!1;const g=typeof t.error=="function"?await t.error(`HTTP error! status: ${f.status}`):t.error,x=typeof t.description=="function"?await t.description(`HTTP error! status: ${f.status}`):t.description,_=typeof g=="object"&&!Be.isValidElement(g)?g:{message:g};this.create({id:r,type:"error",description:x,..._})}else if(f instanceof Error){s=!1;const g=typeof t.error=="function"?await t.error(f):t.error,x=typeof t.description=="function"?await t.description(f):t.description,_=typeof g=="object"&&!Be.isValidElement(g)?g:{message:g};this.create({id:r,type:"error",description:x,..._})}else if(t.success!==void 0){s=!1;const g=typeof t.success=="function"?await t.success(f):t.success,x=typeof t.description=="function"?await t.description(f):t.description,_=typeof g=="object"&&!Be.isValidElement(g)?g:{message:g};this.create({id:r,type:"success",description:x,..._})}}).catch(async f=>{if(o=["reject",f],t.error!==void 0){s=!1;const p=typeof t.error=="function"?await t.error(f):t.error,g=typeof t.description=="function"?await t.description(f):t.description,A=typeof p=="object"&&!Be.isValidElement(p)?p:{message:p};this.create({id:r,type:"error",description:g,...A})}}).finally(()=>{s&&(this.dismiss(r),r=void 0),t.finally==null||t.finally.call(t)}),u=()=>new Promise((f,p)=>a.then(()=>o[0]==="reject"?p(o[1]):f(o[1])).catch(p));return typeof r!="string"&&typeof r!="number"?{unwrap:u}:Object.assign(r,{unwrap:u})},this.custom=(e,t)=>{const r=(t==null?void 0:t.id)||Kx++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Dr=new EB,PB=(n,e)=>{const t=(e==null?void 0:e.id)||Kx++;return Dr.addToast({title:n,...e,id:t}),t},BB=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",RB=PB,DB=()=>Dr.toasts,MB=()=>Dr.getActiveToasts(),kt=Object.assign(RB,{success:Dr.success,info:Dr.info,warning:Dr.warning,error:Dr.error,custom:Dr.custom,message:Dr.message,promise:Dr.promise,dismiss:Dr.dismiss,loading:Dr.loading},{getHistory:DB,getToasts:MB});vB("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function hd(n){return n.label!==void 0}const NB=3,LB="24px",FB="16px",Ob=4e3,IB=356,zB=14,jB=45,QB=200;function as(...n){return n.filter(Boolean).join(" ")}function HB(n){const[e,t]=n.split("-"),r=[];return e&&r.push(e),t&&r.push(t),r}const WB=n=>{var e,t,r,i,s,o,a,u,f;const{invert:p,toast:g,unstyled:x,interacting:A,setHeights:_,visibleToasts:b,heights:w,index:C,toasts:T,expanded:E,removeToast:D,defaultRichColors:N,closeButton:F,style:z,cancelButtonStyle:I,actionButtonStyle:K,className:W="",descriptionClassName:U="",duration:X,position:$,gap:ee,expandByDefault:le,classNames:Z,icons:ie,closeButtonAriaLabel:V="Close toast"}=n,[ne,q]=Be.useState(null),[B,Q]=Be.useState(null),[G,Y]=Be.useState(!1),[ue,pe]=Be.useState(!1),[ve,xe]=Be.useState(!1),[ye,Pe]=Be.useState(!1),[Ke,nt]=Be.useState(!1),[Ce,Ge]=Be.useState(0),[pt,bt]=Be.useState(0),ot=Be.useRef(g.duration||X||Ob),mt=Be.useRef(null),et=Be.useRef(null),tt=C===0,at=C+1<=b,qe=g.type,Dt=g.dismissible!==!1,Jt=g.className||"",dr=g.descriptionClassName||"",en=Be.useMemo(()=>w.findIndex(ae=>ae.toastId===g.id)||0,[w,g.id]),vn=Be.useMemo(()=>{var ae;return(ae=g.closeButton)!=null?ae:F},[g.closeButton,F]),En=Be.useMemo(()=>g.duration||X||Ob,[g.duration,X]),Zn=Be.useRef(0),rn=Be.useRef(0),Qt=Be.useRef(0),sn=Be.useRef(null),[pr,zn]=$.split("-"),Ae=Be.useMemo(()=>w.reduce((ae,De,wt)=>wt>=en?ae:ae+De.height,0),[w,en]),Te=TB(),Ie=g.invert||p,xt=qe==="loading";rn.current=Be.useMemo(()=>en*ee+Ae,[en,Ae]),Be.useEffect(()=>{ot.current=En},[En]),Be.useEffect(()=>{Y(!0)},[]),Be.useEffect(()=>{const ae=et.current;if(ae){const De=ae.getBoundingClientRect().height;return bt(De),_(wt=>[{toastId:g.id,height:De,position:g.position},...wt]),()=>_(wt=>wt.filter(Gt=>Gt.toastId!==g.id))}},[_,g.id]),Be.useLayoutEffect(()=>{if(!G)return;const ae=et.current,De=ae.style.height;ae.style.height="auto";const wt=ae.getBoundingClientRect().height;ae.style.height=De,bt(wt),_(Gt=>Gt.find(At=>At.toastId===g.id)?Gt.map(At=>At.toastId===g.id?{...At,height:wt}:At):[{toastId:g.id,height:wt,position:g.position},...Gt])},[G,g.title,g.description,_,g.id,g.jsx,g.action,g.cancel]);const se=Be.useCallback(()=>{pe(!0),Ge(rn.current),_(ae=>ae.filter(De=>De.toastId!==g.id)),setTimeout(()=>{D(g)},QB)},[g,D,_,rn]);Be.useEffect(()=>{if(g.promise&&qe==="loading"||g.duration===1/0||g.type==="loading")return;let ae;return E||A||Te?(()=>{if(Qt.current<Zn.current){const Gt=new Date().getTime()-Zn.current;ot.current=ot.current-Gt}Qt.current=new Date().getTime()})():(()=>{ot.current!==1/0&&(Zn.current=new Date().getTime(),ae=setTimeout(()=>{g.onAutoClose==null||g.onAutoClose.call(g,g),se()},ot.current))})(),()=>clearTimeout(ae)},[E,A,g,qe,Te,se]),Be.useEffect(()=>{g.delete&&(se(),g.onDismiss==null||g.onDismiss.call(g,g))},[se,g.delete]);function be(){var ae;if(ie!=null&&ie.loading){var De;return Be.createElement("div",{className:as(Z==null?void 0:Z.loader,g==null||(De=g.classNames)==null?void 0:De.loader,"sonner-loader"),"data-visible":qe==="loading"},ie.loading)}return Be.createElement(wB,{className:as(Z==null?void 0:Z.loader,g==null||(ae=g.classNames)==null?void 0:ae.loader),visible:qe==="loading"})}const Oe=g.icon||(ie==null?void 0:ie[qe])||AB(qe);var Le,lt;return Be.createElement("li",{tabIndex:0,ref:et,className:as(W,Jt,Z==null?void 0:Z.toast,g==null||(e=g.classNames)==null?void 0:e.toast,Z==null?void 0:Z.default,Z==null?void 0:Z[qe],g==null||(t=g.classNames)==null?void 0:t[qe]),"data-sonner-toast":"","data-rich-colors":(Le=g.richColors)!=null?Le:N,"data-styled":!(g.jsx||g.unstyled||x),"data-mounted":G,"data-promise":!!g.promise,"data-swiped":Ke,"data-removed":ue,"data-visible":at,"data-y-position":pr,"data-x-position":zn,"data-index":C,"data-front":tt,"data-swiping":ve,"data-dismissible":Dt,"data-type":qe,"data-invert":Ie,"data-swipe-out":ye,"data-swipe-direction":B,"data-expanded":!!(E||le&&G),"data-testid":g.testId,style:{"--index":C,"--toasts-before":C,"--z-index":T.length-C,"--offset":`${ue?Ce:rn.current}px`,"--initial-height":le?"auto":`${pt}px`,...z,...g.style},onDragEnd:()=>{xe(!1),q(null),sn.current=null},onPointerDown:ae=>{ae.button!==2&&(xt||!Dt||(mt.current=new Date,Ge(rn.current),ae.target.setPointerCapture(ae.pointerId),ae.target.tagName!=="BUTTON"&&(xe(!0),sn.current={x:ae.clientX,y:ae.clientY})))},onPointerUp:()=>{var ae,De,wt;if(ye||!Dt)return;sn.current=null;const Gt=Number(((ae=et.current)==null?void 0:ae.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),On=Number(((De=et.current)==null?void 0:De.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),At=new Date().getTime()-((wt=mt.current)==null?void 0:wt.getTime()),Ht=ne==="x"?Gt:On,Qr=Math.abs(Ht)/At;if(Math.abs(Ht)>=jB||Qr>.11){Ge(rn.current),g.onDismiss==null||g.onDismiss.call(g,g),Q(ne==="x"?Gt>0?"right":"left":On>0?"down":"up"),se(),Pe(!0);return}else{var Mt,on;(Mt=et.current)==null||Mt.style.setProperty("--swipe-amount-x","0px"),(on=et.current)==null||on.style.setProperty("--swipe-amount-y","0px")}nt(!1),xe(!1),q(null)},onPointerMove:ae=>{var De,wt,Gt;if(!sn.current||!Dt||((De=window.getSelection())==null?void 0:De.toString().length)>0)return;const At=ae.clientY-sn.current.y,Ht=ae.clientX-sn.current.x;var Qr;const Mt=(Qr=n.swipeDirections)!=null?Qr:HB($);!ne&&(Math.abs(Ht)>1||Math.abs(At)>1)&&q(Math.abs(Ht)>Math.abs(At)?"x":"y");let on={x:0,y:0};const pn=ze=>1/(1.5+Math.abs(ze)/20);if(ne==="y"){if(Mt.includes("top")||Mt.includes("bottom"))if(Mt.includes("top")&&At<0||Mt.includes("bottom")&&At>0)on.y=At;else{const ze=At*pn(At);on.y=Math.abs(ze)<Math.abs(At)?ze:At}}else if(ne==="x"&&(Mt.includes("left")||Mt.includes("right")))if(Mt.includes("left")&&Ht<0||Mt.includes("right")&&Ht>0)on.x=Ht;else{const ze=Ht*pn(Ht);on.x=Math.abs(ze)<Math.abs(Ht)?ze:Ht}(Math.abs(on.x)>0||Math.abs(on.y)>0)&&nt(!0),(wt=et.current)==null||wt.style.setProperty("--swipe-amount-x",`${on.x}px`),(Gt=et.current)==null||Gt.style.setProperty("--swipe-amount-y",`${on.y}px`)}},vn&&!g.jsx&&qe!=="loading"?Be.createElement("button",{"aria-label":V,"data-disabled":xt,"data-close-button":!0,onClick:xt||!Dt?()=>{}:()=>{se(),g.onDismiss==null||g.onDismiss.call(g,g)},className:as(Z==null?void 0:Z.closeButton,g==null||(r=g.classNames)==null?void 0:r.closeButton)},(lt=ie==null?void 0:ie.close)!=null?lt:CB):null,(qe||g.icon||g.promise)&&g.icon!==null&&((ie==null?void 0:ie[qe])!==null||g.icon)?Be.createElement("div",{"data-icon":"",className:as(Z==null?void 0:Z.icon,g==null||(i=g.classNames)==null?void 0:i.icon)},g.promise||g.type==="loading"&&!g.icon?g.icon||be():null,g.type!=="loading"?Oe:null):null,Be.createElement("div",{"data-content":"",className:as(Z==null?void 0:Z.content,g==null||(s=g.classNames)==null?void 0:s.content)},Be.createElement("div",{"data-title":"",className:as(Z==null?void 0:Z.title,g==null||(o=g.classNames)==null?void 0:o.title)},g.jsx?g.jsx:typeof g.title=="function"?g.title():g.title),g.description?Be.createElement("div",{"data-description":"",className:as(U,dr,Z==null?void 0:Z.description,g==null||(a=g.classNames)==null?void 0:a.description)},typeof g.description=="function"?g.description():g.description):null),Be.isValidElement(g.cancel)?g.cancel:g.cancel&&hd(g.cancel)?Be.createElement("button",{"data-button":!0,"data-cancel":!0,style:g.cancelButtonStyle||I,onClick:ae=>{hd(g.cancel)&&Dt&&(g.cancel.onClick==null||g.cancel.onClick.call(g.cancel,ae),se())},className:as(Z==null?void 0:Z.cancelButton,g==null||(u=g.classNames)==null?void 0:u.cancelButton)},g.cancel.label):null,Be.isValidElement(g.action)?g.action:g.action&&hd(g.action)?Be.createElement("button",{"data-button":!0,"data-action":!0,style:g.actionButtonStyle||K,onClick:ae=>{hd(g.action)&&(g.action.onClick==null||g.action.onClick.call(g.action,ae),!ae.defaultPrevented&&se())},className:as(Z==null?void 0:Z.actionButton,g==null||(f=g.classNames)==null?void 0:f.actionButton)},g.action.label):null)};function kb(){if(typeof window>"u"||typeof document>"u")return"ltr";const n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}function qB(n,e){const t={};return[n,e].forEach((r,i)=>{const s=i===1,o=s?"--mobile-offset":"--offset",a=s?FB:LB;function u(f){["top","right","bottom","left"].forEach(p=>{t[`${o}-${p}`]=typeof f=="number"?`${f}px`:f})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(f=>{r[f]===void 0?t[`${o}-${f}`]=a:t[`${o}-${f}`]=typeof r[f]=="number"?`${r[f]}px`:r[f]}):u(a)}),t}const VB=Be.forwardRef(function(e,t){const{id:r,invert:i,position:s="bottom-right",hotkey:o=["altKey","KeyT"],expand:a,closeButton:u,className:f,offset:p,mobileOffset:g,theme:x="light",richColors:A,duration:_,style:b,visibleToasts:w=NB,toastOptions:C,dir:T=kb(),gap:E=zB,icons:D,containerAriaLabel:N="Notifications"}=e,[F,z]=Be.useState([]),I=Be.useMemo(()=>r?F.filter(G=>G.toasterId===r):F.filter(G=>!G.toasterId),[F,r]),K=Be.useMemo(()=>Array.from(new Set([s].concat(I.filter(G=>G.position).map(G=>G.position)))),[I,s]),[W,U]=Be.useState([]),[X,$]=Be.useState(!1),[ee,le]=Be.useState(!1),[Z,ie]=Be.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),V=Be.useRef(null),ne=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),q=Be.useRef(null),B=Be.useRef(!1),Q=Be.useCallback(G=>{z(Y=>{var ue;return(ue=Y.find(pe=>pe.id===G.id))!=null&&ue.delete||Dr.dismiss(G.id),Y.filter(({id:pe})=>pe!==G.id)})},[]);return Be.useEffect(()=>Dr.subscribe(G=>{if(G.dismiss){requestAnimationFrame(()=>{z(Y=>Y.map(ue=>ue.id===G.id?{...ue,delete:!0}:ue))});return}setTimeout(()=>{jk.flushSync(()=>{z(Y=>{const ue=Y.findIndex(pe=>pe.id===G.id);return ue!==-1?[...Y.slice(0,ue),{...Y[ue],...G},...Y.slice(ue+1)]:[G,...Y]})})})}),[F]),Be.useEffect(()=>{if(x!=="system"){ie(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ie("dark"):ie("light")),typeof window>"u")return;const G=window.matchMedia("(prefers-color-scheme: dark)");try{G.addEventListener("change",({matches:Y})=>{ie(Y?"dark":"light")})}catch{G.addListener(({matches:ue})=>{try{ie(ue?"dark":"light")}catch(pe){console.error(pe)}})}},[x]),Be.useEffect(()=>{F.length<=1&&$(!1)},[F]),Be.useEffect(()=>{const G=Y=>{var ue;if(o.every(xe=>Y[xe]||Y.code===xe)){var ve;$(!0),(ve=V.current)==null||ve.focus()}Y.code==="Escape"&&(document.activeElement===V.current||(ue=V.current)!=null&&ue.contains(document.activeElement))&&$(!1)};return document.addEventListener("keydown",G),()=>document.removeEventListener("keydown",G)},[o]),Be.useEffect(()=>{if(V.current)return()=>{q.current&&(q.current.focus({preventScroll:!0}),q.current=null,B.current=!1)}},[V.current]),Be.createElement("section",{ref:t,"aria-label":`${N} ${ne}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},K.map((G,Y)=>{var ue;const[pe,ve]=G.split("-");return I.length?Be.createElement("ol",{key:G,dir:T==="auto"?kb():T,tabIndex:-1,ref:V,className:f,"data-sonner-toaster":!0,"data-sonner-theme":Z,"data-y-position":pe,"data-x-position":ve,style:{"--front-toast-height":`${((ue=W[0])==null?void 0:ue.height)||0}px`,"--width":`${IB}px`,"--gap":`${E}px`,...b,...qB(p,g)},onBlur:xe=>{B.current&&!xe.currentTarget.contains(xe.relatedTarget)&&(B.current=!1,q.current&&(q.current.focus({preventScroll:!0}),q.current=null))},onFocus:xe=>{xe.target instanceof HTMLElement&&xe.target.dataset.dismissible==="false"||B.current||(B.current=!0,q.current=xe.relatedTarget)},onMouseEnter:()=>$(!0),onMouseMove:()=>$(!0),onMouseLeave:()=>{ee||$(!1)},onDragEnd:()=>$(!1),onPointerDown:xe=>{xe.target instanceof HTMLElement&&xe.target.dataset.dismissible==="false"||le(!0)},onPointerUp:()=>le(!1)},I.filter(xe=>!xe.position&&Y===0||xe.position===G).map((xe,ye)=>{var Pe,Ke;return Be.createElement(WB,{key:xe.id,icons:D,index:ye,toast:xe,defaultRichColors:A,duration:(Pe=C==null?void 0:C.duration)!=null?Pe:_,className:C==null?void 0:C.className,descriptionClassName:C==null?void 0:C.descriptionClassName,invert:i,visibleToasts:w,closeButton:(Ke=C==null?void 0:C.closeButton)!=null?Ke:u,interacting:ee,position:G,style:C==null?void 0:C.style,unstyled:C==null?void 0:C.unstyled,classNames:C==null?void 0:C.classNames,cancelButtonStyle:C==null?void 0:C.cancelButtonStyle,actionButtonStyle:C==null?void 0:C.actionButtonStyle,closeButtonAriaLabel:C==null?void 0:C.closeButtonAriaLabel,removeToast:Q,toasts:I.filter(nt=>nt.position==xe.position),heights:W.filter(nt=>nt.position==xe.position),setHeights:U,expandByDefault:a,gap:E,expanded:X,swipeDirections:e.swipeDirections})})):null}))}),$B=({...n})=>S.jsx(VB,{theme:"dark",className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-card group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",error:"group-[.toaster]:bg-[#2a1a1a] group-[.toaster]:text-[#e8a0a0] group-[.toaster]:border-[#4a2a2a] [&_[data-description]]:text-[#b08080]"}},...n}),fd=200;function Kd(n){return`${n.type}-${n.conversation_key}-${n.text}-${n.sender_timestamp}`}function UB(n){const[e,t]=R.useState([]),[r,i]=R.useState(!1),[s,o]=R.useState(!1),[a,u]=R.useState(!1),f=R.useRef(new Set),p=R.useRef(null),g=R.useRef(null),x=R.useCallback(async(w=!1,C)=>{if(!n||n.type==="raw"){t([]),u(!1);return}const T=n.id;w&&(i(!0),t([]));try{const E=await dt.getMessages({type:n.type==="channel"?"CHAN":"PRIV",conversation_key:n.id,limit:fd},C);if(g.current!==T)return;t(E),f.current.clear();for(const D of E)f.current.add(Kd(D));u(E.length>=fd)}catch(E){if(oB(E))return;console.error("Failed to fetch messages:",E),kt.error("Failed to load messages",{description:E instanceof Error?E.message:"Check your connection"})}finally{w&&i(!1)}},[n]),A=R.useCallback(async()=>{if(!(!n||n.type==="raw"||s||!a)){o(!0);try{const w=await dt.getMessages({type:n.type==="channel"?"CHAN":"PRIV",conversation_key:n.id,limit:fd,offset:e.length});if(w.length>0){t(C=>[...C,...w]);for(const C of w)f.current.add(Kd(C))}u(w.length>=fd)}catch(w){console.error("Failed to fetch older messages:",w),kt.error("Failed to load older messages",{description:w instanceof Error?w.message:"Check your connection"})}finally{o(!1)}}},[n,s,a,e.length]);R.useEffect(()=>{if(p.current&&p.current.abort(),g.current=(n==null?void 0:n.id)??null,!n||n.type==="raw"){t([]),u(!1);return}const w=new AbortController;return p.current=w,x(!0,w.signal),()=>{w.abort()}},[n==null?void 0:n.id,n==null?void 0:n.type]);const _=R.useCallback(w=>{const C=Kd(w);if(f.current.has(C))return console.debug("Duplicate message content ignored:",C.slice(0,50)),!1;if(f.current.add(C),f.current.size>1e3){const T=Array.from(f.current);f.current=new Set(T.slice(-500))}return t(T=>T.some(E=>E.id===w.id)?T:[...T,w]),!0},[]),b=R.useCallback((w,C,T)=>{t(E=>{const D=E.findIndex(N=>N.id===w);if(D>=0){const N=[...E];return N[D]={...E[D],acked:C,...T!==void 0&&{paths:T}},N}return E})},[]);return{messages:e,messagesLoading:r,loadingOlder:s,hasOlderMessages:a,setMessages:t,fetchMessages:x,fetchOlderMessages:A,addMessageIfNew:_,updateMessageAck:b}}/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GB=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Sb=n=>{const e=GB(n);return e.charAt(0).toUpperCase()+e.slice(1)},Qk=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),XB=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var KB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=R.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},u)=>R.createElement("svg",{ref:u,...KB,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:Qk("lucide",i),...!s&&!XB(a)&&{"aria-hidden":"true"},...a},[...o.map(([f,p])=>R.createElement(f,p)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=(n,e)=>{const t=R.forwardRef(({className:r,...i},s)=>R.createElement(YB,{ref:s,iconNode:e,className:Qk(`lucide-${ZB(Sb(n))}`,`lucide-${n}`,r),...i}));return t.displayName=Sb(n),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],e4=pv("check",JB);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],n4=pv("menu",t4);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Hk=pv("x",r4);function i4({health:n,config:e,onSettingsClick:t,onMenuClick:r}){const i=(n==null?void 0:n.radio_connected)??!1,[s,o]=R.useState(!1),a=async()=>{o(!0);try{const u=await dt.reconnectRadio();u.connected&&kt.success("Reconnected",{description:u.message})}catch(u){kt.error("Reconnection failed",{description:u instanceof Error?u.message:"Check radio connection and power"})}finally{o(!1)}};return S.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 bg-[#252525] border-b border-[#333] text-xs",children:[r&&S.jsx("button",{onClick:r,className:"md:hidden p-1 bg-transparent border-none text-[#e0e0e0] cursor-pointer","aria-label":"Open menu",children:S.jsx(n4,{className:"h-5 w-5"})}),S.jsx("h1",{className:"text-base font-semibold mr-auto",children:"RemoteTerm"}),S.jsxs("div",{className:"flex items-center gap-1 text-[#888]",children:[S.jsx("div",{className:`w-2 h-2 rounded-full ${i?"bg-[#4caf50]":"bg-[#666]"}`}),S.jsx("span",{className:"hidden lg:inline text-[#e0e0e0]",children:i?"Connected":"Disconnected"})]}),e&&S.jsxs("div",{className:"hidden lg:flex items-center gap-2 text-[#888]",children:[S.jsx("span",{className:"text-[#e0e0e0]",children:e.name||"Unnamed"}),S.jsx("span",{className:"font-mono text-[#888] cursor-pointer hover:text-[#4a9eff]",onClick:()=>{navigator.clipboard.writeText(e.public_key),kt.success("Public key copied!")},title:"Click to copy public key",children:e.public_key.toLowerCase()})]}),!i&&S.jsx("button",{onClick:a,disabled:s,className:"px-3 py-1 bg-[#4a3000] border border-[#6b4500] text-[#ffa500] rounded text-xs cursor-pointer hover:bg-[#5a3a00] disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Reconnecting...":"Reconnect"}),S.jsxs("button",{onClick:t,className:"px-3 py-1 bg-[#333] border border-[#444] text-[#e0e0e0] rounded text-xs cursor-pointer hover:bg-[#444]",children:[S.jsx("span",{role:"img","aria-label":"Settings",children:""})," ","Radio & Config"]})]})}const s4=12;function o4(n){return n.slice(0,s4)}function ro(n,e){return n||o4(e)}const vc=2,a4={text:"",background:"#444444",textColor:"#ffffff"};function l4(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);e=(e<<5)-e+r,e=e&e}return Math.abs(e)}const c4=/[\u{1F1E0}-\u{1F1FF}]{2}|[\u{1F300}-\u{1F9FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]|[\u{1F600}-\u{1F64F}]|[\u{1F680}-\u{1F6FF}]/u;function u4(n,e){if(!n)return e.slice(0,2).toUpperCase();const t=n.match(c4);if(t)return t[0];const r=n.match(/[a-zA-Z]/g);if(!r||r.length===0)return e.slice(0,2).toUpperCase();const i=n.indexOf(" ");if(i!==-1){const s=r[0],o=n.slice(i+1).match(/[a-zA-Z]/);if(o)return(s+o[0]).toUpperCase()}return r[0].toUpperCase()}function h4(n){const e=l4(n),t=e%360,r=50+(e>>8)%30,i=35+(e>>16)%20,s=`hsl(${t}, ${r}%, ${i}%)`,o=i<45?"#ffffff":"#000000";return{background:s,text:o}}function f4(n,e,t){if(t===vc)return a4;const r=u4(n,e),i=h4(e);return{text:r,background:i.background,textColor:i.text}}function Yx({name:n,publicKey:e,size:t=28,contactType:r}){const i=f4(n,e,r);return S.jsx("div",{className:"flex items-center justify-center rounded-full font-semibold flex-shrink-0 select-none",style:{backgroundColor:i.background,color:i.textColor,width:t,height:t,fontSize:t*.45},children:i.text})}const Wk="remoteterm-favorites";function Ga(n,e,t){return n.some(r=>r.type===e&&r.id===t)}function d4(){try{const n=localStorage.getItem(Wk);return n?JSON.parse(n):[]}catch{return[]}}function Cb(){try{localStorage.removeItem(Wk)}catch{}}function qk(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=qk(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Vk(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=qk(n))&&(r&&(r+=" "),r+=e);return r}const p4=(n,e)=>{const t=new Array(n.length+e.length);for(let r=0;r<n.length;r++)t[r]=n[r];for(let r=0;r<e.length;r++)t[n.length+r]=e[r];return t},m4=(n,e)=>({classGroupId:n,validator:e}),$k=(n=new Map,e=null,t)=>({nextPart:n,validators:e,classGroupId:t}),J0="-",Tb=[],g4="arbitrary..",x4=n=>{const e=v4(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return y4(o);const a=o.split(J0),u=a[0]===""&&a.length>1?1:0;return Uk(a,u,e)},getConflictingClassGroupIds:(o,a)=>{if(a){const u=r[o],f=t[o];return u?f?p4(f,u):u:f||Tb}return t[o]||Tb}}},Uk=(n,e,t)=>{if(n.length-e===0)return t.classGroupId;const i=n[e],s=t.nextPart.get(i);if(s){const f=Uk(n,e+1,s);if(f)return f}const o=t.validators;if(o===null)return;const a=e===0?n.join(J0):n.slice(e).join(J0),u=o.length;for(let f=0;f<u;f++){const p=o[f];if(p.validator(a))return p.classGroupId}},y4=n=>n.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=n.slice(1,-1),t=e.indexOf(":"),r=e.slice(0,t);return r?g4+r:void 0})(),v4=n=>{const{theme:e,classGroups:t}=n;return A4(t,e)},A4=(n,e)=>{const t=$k();for(const r in n){const i=n[r];mv(i,t,r,e)}return t},mv=(n,e,t,r)=>{const i=n.length;for(let s=0;s<i;s++){const o=n[s];b4(o,e,t,r)}},b4=(n,e,t,r)=>{if(typeof n=="string"){w4(n,e,t);return}if(typeof n=="function"){_4(n,e,t,r);return}O4(n,e,t,r)},w4=(n,e,t)=>{const r=n===""?e:Zk(e,n);r.classGroupId=t},_4=(n,e,t,r)=>{if(k4(n)){mv(n(r),e,t,r);return}e.validators===null&&(e.validators=[]),e.validators.push(m4(t,n))},O4=(n,e,t,r)=>{const i=Object.entries(n),s=i.length;for(let o=0;o<s;o++){const[a,u]=i[o];mv(u,Zk(e,a),t,r)}},Zk=(n,e)=>{let t=n;const r=e.split(J0),i=r.length;for(let s=0;s<i;s++){const o=r[s];let a=t.nextPart.get(o);a||(a=$k(),t.nextPart.set(o,a)),t=a}return t},k4=n=>"isThemeGetter"in n&&n.isThemeGetter===!0,S4=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=Object.create(null),r=Object.create(null);const i=(s,o)=>{t[s]=o,e++,e>n&&(e=0,r=t,t=Object.create(null))};return{get(s){let o=t[s];if(o!==void 0)return o;if((o=r[s])!==void 0)return i(s,o),o},set(s,o){s in t?t[s]=o:i(s,o)}}},Jx="!",Eb=":",C4=[],Pb=(n,e,t,r,i)=>({modifiers:n,hasImportantModifier:e,baseClassName:t,maybePostfixModifierPosition:r,isExternal:i}),T4=n=>{const{prefix:e,experimentalParseClassName:t}=n;let r=i=>{const s=[];let o=0,a=0,u=0,f;const p=i.length;for(let b=0;b<p;b++){const w=i[b];if(o===0&&a===0){if(w===Eb){s.push(i.slice(u,b)),u=b+1;continue}if(w==="/"){f=b;continue}}w==="["?o++:w==="]"?o--:w==="("?a++:w===")"&&a--}const g=s.length===0?i:i.slice(u);let x=g,A=!1;g.endsWith(Jx)?(x=g.slice(0,-1),A=!0):g.startsWith(Jx)&&(x=g.slice(1),A=!0);const _=f&&f>u?f-u:void 0;return Pb(s,A,x,_)};if(e){const i=e+Eb,s=r;r=o=>o.startsWith(i)?s(o.slice(i.length)):Pb(C4,!1,o,void 0,!0)}if(t){const i=r;r=s=>t({className:s,parseClassName:i})}return r},E4=n=>{const e=new Map;return n.orderSensitiveModifiers.forEach((t,r)=>{e.set(t,1e6+r)}),t=>{const r=[];let i=[];for(let s=0;s<t.length;s++){const o=t[s],a=o[0]==="[",u=e.has(o);a||u?(i.length>0&&(i.sort(),r.push(...i),i=[]),r.push(o)):i.push(o)}return i.length>0&&(i.sort(),r.push(...i)),r}},P4=n=>({cache:S4(n.cacheSize),parseClassName:T4(n),sortModifiers:E4(n),...x4(n)}),B4=/\s+/,R4=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:s}=e,o=[],a=n.trim().split(B4);let u="";for(let f=a.length-1;f>=0;f-=1){const p=a[f],{isExternal:g,modifiers:x,hasImportantModifier:A,baseClassName:_,maybePostfixModifierPosition:b}=t(p);if(g){u=p+(u.length>0?" "+u:u);continue}let w=!!b,C=r(w?_.substring(0,b):_);if(!C){if(!w){u=p+(u.length>0?" "+u:u);continue}if(C=r(_),!C){u=p+(u.length>0?" "+u:u);continue}w=!1}const T=x.length===0?"":x.length===1?x[0]:s(x).join(":"),E=A?T+Jx:T,D=E+C;if(o.indexOf(D)>-1)continue;o.push(D);const N=i(C,w);for(let F=0;F<N.length;++F){const z=N[F];o.push(E+z)}u=p+(u.length>0?" "+u:u)}return u},D4=(...n)=>{let e=0,t,r,i="";for(;e<n.length;)(t=n[e++])&&(r=Gk(t))&&(i&&(i+=" "),i+=r);return i},Gk=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=Gk(n[r]))&&(t&&(t+=" "),t+=e);return t},M4=(n,...e)=>{let t,r,i,s;const o=u=>{const f=e.reduce((p,g)=>g(p),n());return t=P4(f),r=t.cache.get,i=t.cache.set,s=a,a(u)},a=u=>{const f=r(u);if(f)return f;const p=R4(u,t);return i(u,p),p};return s=o,(...u)=>s(D4(...u))},N4=[],Mn=n=>{const e=t=>t[n]||N4;return e.isThemeGetter=!0,e},Xk=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Kk=/^\((?:(\w[\w-]*):)?(.+)\)$/i,L4=/^\d+\/\d+$/,F4=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,I4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,z4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,j4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Q4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Jl=n=>L4.test(n),_t=n=>!!n&&!Number.isNaN(Number(n)),qo=n=>!!n&&Number.isInteger(Number(n)),Xg=n=>n.endsWith("%")&&_t(n.slice(0,-1)),Vs=n=>F4.test(n),H4=()=>!0,W4=n=>I4.test(n)&&!z4.test(n),Yk=()=>!1,q4=n=>j4.test(n),V4=n=>Q4.test(n),$4=n=>!$e(n)&&!Ue(n),U4=n=>Dc(n,tS,Yk),$e=n=>Xk.test(n),Ia=n=>Dc(n,nS,W4),Kg=n=>Dc(n,Y4,_t),Bb=n=>Dc(n,Jk,Yk),Z4=n=>Dc(n,eS,V4),dd=n=>Dc(n,rS,q4),Ue=n=>Kk.test(n),Pu=n=>Mc(n,nS),G4=n=>Mc(n,J4),Rb=n=>Mc(n,Jk),X4=n=>Mc(n,tS),K4=n=>Mc(n,eS),pd=n=>Mc(n,rS,!0),Dc=(n,e,t)=>{const r=Xk.exec(n);return r?r[1]?e(r[1]):t(r[2]):!1},Mc=(n,e,t=!1)=>{const r=Kk.exec(n);return r?r[1]?e(r[1]):t:!1},Jk=n=>n==="position"||n==="percentage",eS=n=>n==="image"||n==="url",tS=n=>n==="length"||n==="size"||n==="bg-size",nS=n=>n==="length",Y4=n=>n==="number",J4=n=>n==="family-name",rS=n=>n==="shadow",eR=()=>{const n=Mn("color"),e=Mn("font"),t=Mn("text"),r=Mn("font-weight"),i=Mn("tracking"),s=Mn("leading"),o=Mn("breakpoint"),a=Mn("container"),u=Mn("spacing"),f=Mn("radius"),p=Mn("shadow"),g=Mn("inset-shadow"),x=Mn("text-shadow"),A=Mn("drop-shadow"),_=Mn("blur"),b=Mn("perspective"),w=Mn("aspect"),C=Mn("ease"),T=Mn("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],N=()=>[...D(),Ue,$e],F=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto","contain","none"],I=()=>[Ue,$e,u],K=()=>[Jl,"full","auto",...I()],W=()=>[qo,"none","subgrid",Ue,$e],U=()=>["auto",{span:["full",qo,Ue,$e]},qo,Ue,$e],X=()=>[qo,"auto",Ue,$e],$=()=>["auto","min","max","fr",Ue,$e],ee=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],le=()=>["start","end","center","stretch","center-safe","end-safe"],Z=()=>["auto",...I()],ie=()=>[Jl,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...I()],V=()=>[n,Ue,$e],ne=()=>[...D(),Rb,Bb,{position:[Ue,$e]}],q=()=>["no-repeat",{repeat:["","x","y","space","round"]}],B=()=>["auto","cover","contain",X4,U4,{size:[Ue,$e]}],Q=()=>[Xg,Pu,Ia],G=()=>["","none","full",f,Ue,$e],Y=()=>["",_t,Pu,Ia],ue=()=>["solid","dashed","dotted","double"],pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ve=()=>[_t,Xg,Rb,Bb],xe=()=>["","none",_,Ue,$e],ye=()=>["none",_t,Ue,$e],Pe=()=>["none",_t,Ue,$e],Ke=()=>[_t,Ue,$e],nt=()=>[Jl,"full",...I()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Vs],breakpoint:[Vs],color:[H4],container:[Vs],"drop-shadow":[Vs],ease:["in","out","in-out"],font:[$4],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Vs],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Vs],shadow:[Vs],spacing:["px",_t],text:[Vs],"text-shadow":[Vs],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Jl,$e,Ue,w]}],container:["container"],columns:[{columns:[_t,$e,Ue,a]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:N()}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:z()}],"overscroll-x":[{"overscroll-x":z()}],"overscroll-y":[{"overscroll-y":z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:K()}],"inset-x":[{"inset-x":K()}],"inset-y":[{"inset-y":K()}],start:[{start:K()}],end:[{end:K()}],top:[{top:K()}],right:[{right:K()}],bottom:[{bottom:K()}],left:[{left:K()}],visibility:["visible","invisible","collapse"],z:[{z:[qo,"auto",Ue,$e]}],basis:[{basis:[Jl,"full","auto",a,...I()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[_t,Jl,"auto","initial","none",$e]}],grow:[{grow:["",_t,Ue,$e]}],shrink:[{shrink:["",_t,Ue,$e]}],order:[{order:[qo,"first","last","none",Ue,$e]}],"grid-cols":[{"grid-cols":W()}],"col-start-end":[{col:U()}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":W()}],"row-start-end":[{row:U()}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":$()}],"auto-rows":[{"auto-rows":$()}],gap:[{gap:I()}],"gap-x":[{"gap-x":I()}],"gap-y":[{"gap-y":I()}],"justify-content":[{justify:[...ee(),"normal"]}],"justify-items":[{"justify-items":[...le(),"normal"]}],"justify-self":[{"justify-self":["auto",...le()]}],"align-content":[{content:["normal",...ee()]}],"align-items":[{items:[...le(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...le(),{baseline:["","last"]}]}],"place-content":[{"place-content":ee()}],"place-items":[{"place-items":[...le(),"baseline"]}],"place-self":[{"place-self":["auto",...le()]}],p:[{p:I()}],px:[{px:I()}],py:[{py:I()}],ps:[{ps:I()}],pe:[{pe:I()}],pt:[{pt:I()}],pr:[{pr:I()}],pb:[{pb:I()}],pl:[{pl:I()}],m:[{m:Z()}],mx:[{mx:Z()}],my:[{my:Z()}],ms:[{ms:Z()}],me:[{me:Z()}],mt:[{mt:Z()}],mr:[{mr:Z()}],mb:[{mb:Z()}],ml:[{ml:Z()}],"space-x":[{"space-x":I()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":I()}],"space-y-reverse":["space-y-reverse"],size:[{size:ie()}],w:[{w:[a,"screen",...ie()]}],"min-w":[{"min-w":[a,"screen","none",...ie()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...ie()]}],h:[{h:["screen","lh",...ie()]}],"min-h":[{"min-h":["screen","lh","none",...ie()]}],"max-h":[{"max-h":["screen","lh",...ie()]}],"font-size":[{text:["base",t,Pu,Ia]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Ue,Kg]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Xg,$e]}],"font-family":[{font:[G4,$e,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Ue,$e]}],"line-clamp":[{"line-clamp":[_t,"none",Ue,Kg]}],leading:[{leading:[s,...I()]}],"list-image":[{"list-image":["none",Ue,$e]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ue,$e]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:V()}],"text-color":[{text:V()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ue(),"wavy"]}],"text-decoration-thickness":[{decoration:[_t,"from-font","auto",Ue,Ia]}],"text-decoration-color":[{decoration:V()}],"underline-offset":[{"underline-offset":[_t,"auto",Ue,$e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ue,$e]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ue,$e]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:q()}],"bg-size":[{bg:B()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},qo,Ue,$e],radial:["",Ue,$e],conic:[qo,Ue,$e]},K4,Z4]}],"bg-color":[{bg:V()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:V()}],"gradient-via":[{via:V()}],"gradient-to":[{to:V()}],rounded:[{rounded:G()}],"rounded-s":[{"rounded-s":G()}],"rounded-e":[{"rounded-e":G()}],"rounded-t":[{"rounded-t":G()}],"rounded-r":[{"rounded-r":G()}],"rounded-b":[{"rounded-b":G()}],"rounded-l":[{"rounded-l":G()}],"rounded-ss":[{"rounded-ss":G()}],"rounded-se":[{"rounded-se":G()}],"rounded-ee":[{"rounded-ee":G()}],"rounded-es":[{"rounded-es":G()}],"rounded-tl":[{"rounded-tl":G()}],"rounded-tr":[{"rounded-tr":G()}],"rounded-br":[{"rounded-br":G()}],"rounded-bl":[{"rounded-bl":G()}],"border-w":[{border:Y()}],"border-w-x":[{"border-x":Y()}],"border-w-y":[{"border-y":Y()}],"border-w-s":[{"border-s":Y()}],"border-w-e":[{"border-e":Y()}],"border-w-t":[{"border-t":Y()}],"border-w-r":[{"border-r":Y()}],"border-w-b":[{"border-b":Y()}],"border-w-l":[{"border-l":Y()}],"divide-x":[{"divide-x":Y()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Y()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ue(),"hidden","none"]}],"divide-style":[{divide:[...ue(),"hidden","none"]}],"border-color":[{border:V()}],"border-color-x":[{"border-x":V()}],"border-color-y":[{"border-y":V()}],"border-color-s":[{"border-s":V()}],"border-color-e":[{"border-e":V()}],"border-color-t":[{"border-t":V()}],"border-color-r":[{"border-r":V()}],"border-color-b":[{"border-b":V()}],"border-color-l":[{"border-l":V()}],"divide-color":[{divide:V()}],"outline-style":[{outline:[...ue(),"none","hidden"]}],"outline-offset":[{"outline-offset":[_t,Ue,$e]}],"outline-w":[{outline:["",_t,Pu,Ia]}],"outline-color":[{outline:V()}],shadow:[{shadow:["","none",p,pd,dd]}],"shadow-color":[{shadow:V()}],"inset-shadow":[{"inset-shadow":["none",g,pd,dd]}],"inset-shadow-color":[{"inset-shadow":V()}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:V()}],"ring-offset-w":[{"ring-offset":[_t,Ia]}],"ring-offset-color":[{"ring-offset":V()}],"inset-ring-w":[{"inset-ring":Y()}],"inset-ring-color":[{"inset-ring":V()}],"text-shadow":[{"text-shadow":["none",x,pd,dd]}],"text-shadow-color":[{"text-shadow":V()}],opacity:[{opacity:[_t,Ue,$e]}],"mix-blend":[{"mix-blend":[...pe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":pe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[_t]}],"mask-image-linear-from-pos":[{"mask-linear-from":ve()}],"mask-image-linear-to-pos":[{"mask-linear-to":ve()}],"mask-image-linear-from-color":[{"mask-linear-from":V()}],"mask-image-linear-to-color":[{"mask-linear-to":V()}],"mask-image-t-from-pos":[{"mask-t-from":ve()}],"mask-image-t-to-pos":[{"mask-t-to":ve()}],"mask-image-t-from-color":[{"mask-t-from":V()}],"mask-image-t-to-color":[{"mask-t-to":V()}],"mask-image-r-from-pos":[{"mask-r-from":ve()}],"mask-image-r-to-pos":[{"mask-r-to":ve()}],"mask-image-r-from-color":[{"mask-r-from":V()}],"mask-image-r-to-color":[{"mask-r-to":V()}],"mask-image-b-from-pos":[{"mask-b-from":ve()}],"mask-image-b-to-pos":[{"mask-b-to":ve()}],"mask-image-b-from-color":[{"mask-b-from":V()}],"mask-image-b-to-color":[{"mask-b-to":V()}],"mask-image-l-from-pos":[{"mask-l-from":ve()}],"mask-image-l-to-pos":[{"mask-l-to":ve()}],"mask-image-l-from-color":[{"mask-l-from":V()}],"mask-image-l-to-color":[{"mask-l-to":V()}],"mask-image-x-from-pos":[{"mask-x-from":ve()}],"mask-image-x-to-pos":[{"mask-x-to":ve()}],"mask-image-x-from-color":[{"mask-x-from":V()}],"mask-image-x-to-color":[{"mask-x-to":V()}],"mask-image-y-from-pos":[{"mask-y-from":ve()}],"mask-image-y-to-pos":[{"mask-y-to":ve()}],"mask-image-y-from-color":[{"mask-y-from":V()}],"mask-image-y-to-color":[{"mask-y-to":V()}],"mask-image-radial":[{"mask-radial":[Ue,$e]}],"mask-image-radial-from-pos":[{"mask-radial-from":ve()}],"mask-image-radial-to-pos":[{"mask-radial-to":ve()}],"mask-image-radial-from-color":[{"mask-radial-from":V()}],"mask-image-radial-to-color":[{"mask-radial-to":V()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[_t]}],"mask-image-conic-from-pos":[{"mask-conic-from":ve()}],"mask-image-conic-to-pos":[{"mask-conic-to":ve()}],"mask-image-conic-from-color":[{"mask-conic-from":V()}],"mask-image-conic-to-color":[{"mask-conic-to":V()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:q()}],"mask-size":[{mask:B()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ue,$e]}],filter:[{filter:["","none",Ue,$e]}],blur:[{blur:xe()}],brightness:[{brightness:[_t,Ue,$e]}],contrast:[{contrast:[_t,Ue,$e]}],"drop-shadow":[{"drop-shadow":["","none",A,pd,dd]}],"drop-shadow-color":[{"drop-shadow":V()}],grayscale:[{grayscale:["",_t,Ue,$e]}],"hue-rotate":[{"hue-rotate":[_t,Ue,$e]}],invert:[{invert:["",_t,Ue,$e]}],saturate:[{saturate:[_t,Ue,$e]}],sepia:[{sepia:["",_t,Ue,$e]}],"backdrop-filter":[{"backdrop-filter":["","none",Ue,$e]}],"backdrop-blur":[{"backdrop-blur":xe()}],"backdrop-brightness":[{"backdrop-brightness":[_t,Ue,$e]}],"backdrop-contrast":[{"backdrop-contrast":[_t,Ue,$e]}],"backdrop-grayscale":[{"backdrop-grayscale":["",_t,Ue,$e]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[_t,Ue,$e]}],"backdrop-invert":[{"backdrop-invert":["",_t,Ue,$e]}],"backdrop-opacity":[{"backdrop-opacity":[_t,Ue,$e]}],"backdrop-saturate":[{"backdrop-saturate":[_t,Ue,$e]}],"backdrop-sepia":[{"backdrop-sepia":["",_t,Ue,$e]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":I()}],"border-spacing-x":[{"border-spacing-x":I()}],"border-spacing-y":[{"border-spacing-y":I()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ue,$e]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[_t,"initial",Ue,$e]}],ease:[{ease:["linear","initial",C,Ue,$e]}],delay:[{delay:[_t,Ue,$e]}],animate:[{animate:["none",T,Ue,$e]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,Ue,$e]}],"perspective-origin":[{"perspective-origin":N()}],rotate:[{rotate:ye()}],"rotate-x":[{"rotate-x":ye()}],"rotate-y":[{"rotate-y":ye()}],"rotate-z":[{"rotate-z":ye()}],scale:[{scale:Pe()}],"scale-x":[{"scale-x":Pe()}],"scale-y":[{"scale-y":Pe()}],"scale-z":[{"scale-z":Pe()}],"scale-3d":["scale-3d"],skew:[{skew:Ke()}],"skew-x":[{"skew-x":Ke()}],"skew-y":[{"skew-y":Ke()}],transform:[{transform:[Ue,$e,"","none","gpu","cpu"]}],"transform-origin":[{origin:N()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:nt()}],"translate-x":[{"translate-x":nt()}],"translate-y":[{"translate-y":nt()}],"translate-z":[{"translate-z":nt()}],"translate-none":["translate-none"],accent:[{accent:V()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:V()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ue,$e]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ue,$e]}],fill:[{fill:["none",...V()]}],"stroke-w":[{stroke:[_t,Pu,Ia,Kg]}],stroke:[{stroke:["none",...V()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},tR=M4(eR);function vt(...n){return tR(Vk(n))}const xn=R.forwardRef(({className:n,type:e,...t},r)=>S.jsx("input",{type:e,className:vt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:r,...t}));xn.displayName="Input";function Db(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function Nh(...n){return e=>{let t=!1;const r=n.map(i=>{const s=Db(i,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():Db(n[i],null)}}}}function _i(...n){return R.useCallback(Nh(...n),n)}var nR=Symbol.for("react.lazy"),ep=hv[" use ".trim().toString()];function rR(n){return typeof n=="object"&&n!==null&&"then"in n}function iS(n){return n!=null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===nR&&"_payload"in n&&rR(n._payload)}function gv(n){const e=sR(n),t=R.forwardRef((r,i)=>{let{children:s,...o}=r;iS(s)&&typeof ep=="function"&&(s=ep(s._payload));const a=R.Children.toArray(s),u=a.find(aR);if(u){const f=u.props.children,p=a.map(g=>g===u?R.Children.count(f)>1?R.Children.only(null):R.isValidElement(f)?f.props.children:null:g);return S.jsx(e,{...o,ref:i,children:R.isValidElement(f)?R.cloneElement(f,void 0,p):null})}return S.jsx(e,{...o,ref:i,children:s})});return t.displayName=`${n}.Slot`,t}var iR=gv("Slot");function sR(n){const e=R.forwardRef((t,r)=>{let{children:i,...s}=t;if(iS(i)&&typeof ep=="function"&&(i=ep(i._payload)),R.isValidElement(i)){const o=cR(i),a=lR(s,i.props);return i.type!==R.Fragment&&(a.ref=r?Nh(r,o):o),R.cloneElement(i,a)}return R.Children.count(i)>1?R.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var oR=Symbol("radix.slottable");function aR(n){return R.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===oR}function lR(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{const u=s(...a);return i(...a),u}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}function cR(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}const Mb=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,Nb=Vk,xv=(n,e)=>t=>{var r;if((e==null?void 0:e.variants)==null)return Nb(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(f=>{const p=t==null?void 0:t[f],g=s==null?void 0:s[f];if(p===null)return null;const x=Mb(p)||Mb(g);return i[f][x]}),a=t&&Object.entries(t).reduce((f,p)=>{let[g,x]=p;return x===void 0||(f[g]=x),f},{}),u=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((f,p)=>{let{class:g,className:x,...A}=p;return Object.entries(A).every(_=>{let[b,w]=_;return Array.isArray(w)?w.includes({...s,...a}[b]):{...s,...a}[b]===w})?[...f,g,x]:f},[]);return Nb(n,o,u,t==null?void 0:t.class,t==null?void 0:t.className)},uR=xv("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),yn=R.forwardRef(({className:n,variant:e,size:t,asChild:r=!1,...i},s)=>{const o=r?iR:"button";return S.jsx(o,{className:vt(uR({variant:e,size:t,className:n})),ref:s,...i})});yn.displayName="Button";function md(n){return n>=fv?`${n}+`:`${n}`}function hR({contacts:n,channels:e,activeConversation:t,onSelectConversation:r,onNewMessage:i,lastMessageTimes:s,unreadCounts:o,mentions:a,showCracker:u,crackerRunning:f,onToggleCracker:p,onMarkAllRead:g,favorites:x,sortOrder:A="recent",onSortOrderChange:_}){const b=A,[w,C]=R.useState(""),T=()=>{const q=b==="alpha"?"recent":"alpha";_==null||_(q)},E=q=>{C(""),r(q)},D=(q,B)=>(t==null?void 0:t.type)===q&&(t==null?void 0:t.id)===B,N=(q,B)=>{const Q=Ii(q,B);return o[Q]||0},F=(q,B)=>{const Q=Ii(q,B);return a[Q]||!1},z=(q,B)=>{const Q=Ii(q,B);return s[Q]||0},I=e.reduce((q,B)=>(q.some(Q=>Q.name===B.name)||q.push(B),q),[]),K=n.filter(q=>q.public_key&&q.public_key.length>0).sort((q,B)=>q.name&&!B.name?-1:!q.name&&B.name?1:(q.name||"").localeCompare(B.name||"")).reduce((q,B)=>(q.some(Q=>Q.public_key===B.public_key)||q.push(B),q),[]),W=[...I].sort((q,B)=>{if(q.name==="Public")return-1;if(B.name==="Public")return 1;if(b==="recent"){const Q=z("channel",q.key),G=z("channel",B.key);if(Q&&G)return G-Q;if(Q&&!G)return-1;if(!Q&&G)return 1}return q.name.localeCompare(B.name)}),U=[...K].sort((q,B)=>{const Q=q.type===vc,G=B.type===vc;if(Q&&!G)return 1;if(!Q&&G)return-1;if(Q&&G)return(q.name||q.public_key).localeCompare(B.name||B.public_key);if(b==="recent"){const Y=z("contact",q.public_key),ue=z("contact",B.public_key);if(Y&&ue)return ue-Y;if(Y&&!ue)return-1;if(!Y&&ue)return 1}return(q.name||q.public_key).localeCompare(B.name||B.public_key)}),X=w.toLowerCase().trim(),$=X?W.filter(q=>q.name.toLowerCase().includes(X)||q.key.toLowerCase().includes(X)):W,ee=X?U.filter(q=>{var B;return((B=q.name)==null?void 0:B.toLowerCase().includes(X))||q.public_key.toLowerCase().includes(X)}):U,le=$.filter(q=>Ga(x,"channel",q.key)),Z=ee.filter(q=>Ga(x,"contact",q.public_key)),ie=$.filter(q=>!Ga(x,"channel",q.key)),V=ee.filter(q=>!Ga(x,"contact",q.public_key)),ne=[...le.map(q=>({type:"channel",channel:q})),...Z.map(q=>({type:"contact",contact:q}))].sort((q,B)=>{const Q=q.type==="channel"?z("channel",q.channel.key):z("contact",q.contact.public_key),G=B.type==="channel"?z("channel",B.channel.key):z("contact",B.contact.public_key);if(Q&&G)return G-Q;if(Q&&!G)return-1;if(!Q&&G)return 1;const Y=q.type==="channel"?q.channel.name:q.contact.name||q.contact.public_key,ue=B.type==="channel"?B.channel.name:B.contact.name||B.contact.public_key;return Y.localeCompare(ue)});return S.jsxs("div",{className:"sidebar w-60 h-full min-h-0 bg-card border-r border-border flex flex-col",children:[S.jsxs("div",{className:"flex justify-between items-center px-3 py-3 border-b border-border",children:[S.jsx("h2",{className:"text-xs uppercase text-muted-foreground font-medium",children:"Conversations"}),S.jsx(yn,{variant:"ghost",size:"sm",onClick:i,title:"New Message",className:"h-6 w-6 p-0 text-muted-foreground hover:text-foreground",children:"+"})]}),S.jsxs("div",{className:"relative px-3 py-2 border-b border-border",children:[S.jsx(xn,{type:"text",placeholder:"Search...",value:w,onChange:q=>C(q.target.value),className:"h-8 text-sm pr-8"}),w&&S.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground text-lg leading-none",onClick:()=>C(""),title:"Clear search",children:""})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto",children:[!X&&S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("raw","raw")&&"bg-accent border-l-primary"),onClick:()=>E({type:"raw",id:"raw",name:"Raw Packet Feed"}),children:[S.jsx("span",{className:"text-muted-foreground text-xs",children:""}),S.jsx("span",{className:"flex-1 truncate",children:"Packet Feed"})]}),!X&&S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("map","map")&&"bg-accent border-l-primary"),onClick:()=>E({type:"map",id:"map",name:"Node Map"}),children:[S.jsx("span",{className:"text-muted-foreground text-xs",children:""}),S.jsx("span",{className:"flex-1 truncate",children:"Node Map"})]}),!X&&S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("visualizer","visualizer")&&"bg-accent border-l-primary"),onClick:()=>E({type:"visualizer",id:"visualizer",name:"Mesh Visualizer"}),children:[S.jsx("span",{className:"text-muted-foreground text-xs",children:""}),S.jsx("span",{className:"flex-1 truncate",children:"Mesh Visualizer"})]}),!X&&S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",u&&"bg-accent border-l-primary"),onClick:p,children:[S.jsx("span",{className:"text-muted-foreground text-xs",children:""}),S.jsxs("span",{className:"flex-1 truncate",children:[u?"Hide":"Show"," Room Finder",S.jsxs("span",{className:vt("ml-1 text-xs",f?"text-green-500":"text-muted-foreground"),children:["(",f?"running":"stopped",")"]})]})]}),!X&&Object.keys(o).length>0&&S.jsxs("div",{className:"px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",onClick:g,children:[S.jsx("span",{className:"text-muted-foreground text-xs",children:""}),S.jsx("span",{className:"flex-1 truncate text-muted-foreground",children:"Mark all as read"})]}),ne.length>0&&S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"flex justify-between items-center px-3 py-2 pt-3",children:S.jsx("span",{className:"text-[11px] uppercase text-muted-foreground",children:"Favorites"})}),ne.map(q=>{if(q.type==="channel"){const B=q.channel,Q=N("channel",B.key),G=F("channel",B.key);return S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("channel",B.key)&&"bg-accent border-l-primary",Q>0&&"[&_.name]:font-bold [&_.name]:text-foreground"),onClick:()=>E({type:"channel",id:B.key,name:B.name}),children:[S.jsx("span",{className:"name flex-1 truncate",children:B.name}),Q>0&&S.jsx("span",{className:vt("text-[10px] font-semibold px-1.5 py-0.5 rounded-full min-w-[18px] text-center",G?"bg-destructive text-destructive-foreground":"bg-primary text-primary-foreground"),children:md(Q)})]},`fav-chan-${B.key}`)}else{const B=q.contact,Q=N("contact",B.public_key),G=F("contact",B.public_key);return S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("contact",B.public_key)&&"bg-accent border-l-primary",Q>0&&"[&_.name]:font-bold [&_.name]:text-foreground"),onClick:()=>E({type:"contact",id:B.public_key,name:ro(B.name,B.public_key)}),children:[S.jsx(Yx,{name:B.name,publicKey:B.public_key,size:24,contactType:B.type}),S.jsx("span",{className:"name flex-1 truncate",children:ro(B.name,B.public_key)}),Q>0&&S.jsx("span",{className:vt("text-[10px] font-semibold px-1.5 py-0.5 rounded-full min-w-[18px] text-center",G?"bg-destructive text-destructive-foreground":"bg-primary text-primary-foreground"),children:md(Q)})]},`fav-contact-${B.public_key}`)}})]}),ie.length>0&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"flex justify-between items-center px-3 py-2 pt-3",children:[S.jsx("span",{className:"text-[11px] uppercase text-muted-foreground",children:"Channels"}),S.jsx("button",{className:"bg-transparent border border-border text-muted-foreground px-1.5 py-0.5 text-[10px] rounded hover:bg-accent hover:text-foreground",onClick:T,title:b==="alpha"?"Sort by recent":"Sort alphabetically",children:b==="alpha"?"A-Z":""})]}),ie.map(q=>{const B=N("channel",q.key),Q=F("channel",q.key);return S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("channel",q.key)&&"bg-accent border-l-primary",B>0&&"[&_.name]:font-bold [&_.name]:text-foreground"),onClick:()=>E({type:"channel",id:q.key,name:q.name}),children:[S.jsx("span",{className:"name flex-1 truncate",children:q.name}),B>0&&S.jsx("span",{className:vt("text-[10px] font-semibold px-1.5 py-0.5 rounded-full min-w-[18px] text-center",Q?"bg-destructive text-destructive-foreground":"bg-primary text-primary-foreground"),children:md(B)})]},`chan-${q.key}`)})]}),V.length>0&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"flex justify-between items-center px-3 py-2 pt-3",children:[S.jsx("span",{className:"text-[11px] uppercase text-muted-foreground",children:"Contacts"}),ie.length===0&&S.jsx("button",{className:"bg-transparent border border-border text-muted-foreground px-1.5 py-0.5 text-[10px] rounded hover:bg-accent hover:text-foreground",onClick:T,title:b==="alpha"?"Sort by recent":"Sort alphabetically",children:b==="alpha"?"A-Z":""})]}),V.map(q=>{const B=N("contact",q.public_key),Q=F("contact",q.public_key);return S.jsxs("div",{className:vt("px-3 py-2.5 cursor-pointer flex items-center gap-2 border-l-2 border-transparent hover:bg-accent",D("contact",q.public_key)&&"bg-accent border-l-primary",B>0&&"[&_.name]:font-bold [&_.name]:text-foreground"),onClick:()=>E({type:"contact",id:q.public_key,name:ro(q.name,q.public_key)}),children:[S.jsx(Yx,{name:q.name,publicKey:q.public_key,size:24,contactType:q.type}),S.jsx("span",{className:"name flex-1 truncate",children:ro(q.name,q.public_key)}),B>0&&S.jsx("span",{className:vt("text-[10px] font-semibold px-1.5 py-0.5 rounded-full min-w-[18px] text-center",Q?"bg-destructive text-destructive-foreground":"bg-primary text-primary-foreground"),children:md(B)})]},q.public_key)})]}),V.length===0&&ie.length===0&&ne.length===0&&S.jsx("div",{className:"p-5 text-center text-muted-foreground",children:X?"No matches found":"No conversations yet"})]})]})}function Lb(n){const e=n.indexOf(": ");if(e>0&&e<50){const t=n.substring(0,e);if(!t.includes(":"))return{sender:t,content:n.substring(e+2)}}return{sender:null,content:n}}function Ac(n){const e=new Date(n*1e3),t=new Date,r=e.toDateString()===t.toDateString(),i=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return r?i:`${e.toLocaleDateString([],{month:"short",day:"numeric"})} ${i}`}function fR(n){if(!n||n.length===0)return[];const e=n.toUpperCase(),t=[];for(let r=0;r<e.length;r+=2)r+1<e.length&&t.push(e.slice(r,r+2));return t}function dR(n,e,t=!0){const r=n.toUpperCase();return e.filter(i=>t&&i.type!==Lp?!1:i.public_key.toUpperCase().startsWith(r))}function Hi(n,e,t,r){if(n===null||e===null||t===null||r===null)return null;const i=6371,s=gd(t-n),o=gd(r-e),a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(gd(n))*Math.cos(gd(t))*Math.sin(o/2)*Math.sin(o/2),u=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return i*u}function gd(n){return n*Math.PI/180}function jt(n,e){return!(n===null||e===null||n===0&&e===0)}function tl(n){return n<1?`${Math.round(n*1e3)}m`:`${n.toFixed(1)}km`}function pR(n,e,t){return e===null||t===null?n:[...n].sort((r,i)=>{const s=Hi(e,t,r.lat,r.lon),o=Hi(e,t,i.lat,i.lon);return s===null&&o===null?0:s===null?1:o===null?-1:s-o})}function mR(n){return!n||n.length===0?0:Math.floor(n.length/2)}function gR(n){if(!n||n.length===0)return{display:"",allDirect:!0,hasMultiple:!1};const e=n.map(o=>mR(o.path)).sort((o,a)=>o-a),t=e.every(o=>o===0),r=n.length>1;return{display:e.map(o=>o===0?"d":o.toString()).join("/"),allDirect:t,hasMultiple:r}}function xR(n,e,t,r){var b;const i=fR(n),s=e.publicKeyOrPrefix.toUpperCase().slice(0,2),o={name:e.name,prefix:s,lat:e.lat,lon:e.lon},a=((b=r==null?void 0:r.public_key)==null?void 0:b.toUpperCase().slice(0,2))||"??",u={name:(r==null?void 0:r.name)||"Unknown",prefix:a,lat:(r==null?void 0:r.lat)??null,lon:(r==null?void 0:r.lon)??null,publicKey:(r==null?void 0:r.public_key)??null},f=[];let p=e.lat,g=e.lon,x=!jt(e.lat,e.lon);for(const w of i){const C=dR(w,t,!0),T=pR(C,p,g);let E=null;const D=T.length===1&&jt(T[0].lat,T[0].lon);!x&&D&&(E=Hi(p,g,T[0].lat,T[0].lon)),f.push({prefix:w,matches:T,distanceFromPrev:E}),T.length===0?(x=!0,p=null,g=null):T.length>1?(x=!0,jt(T[0].lat,T[0].lon)?(p=T[0].lat,g=T[0].lon):(p=null,g=null)):jt(T[0].lat,T[0].lon)?(x=!1,p=T[0].lat,g=T[0].lon):(x=!0,p=null,g=null)}const A=yR(o,f,u),_=!jt(o.lat,o.lon)||!jt(u.lat,u.lon)||f.some(w=>w.matches.length!==1||!jt(w.matches[0].lat,w.matches[0].lon));return{sender:o,hops:f,receiver:u,totalDistances:A,hasGaps:_}}function yR(n,e,t){if(e.length===0){if(!jt(n.lat,n.lon)||!jt(t.lat,t.lon))return null;const f=Hi(n.lat,n.lon,t.lat,t.lon);return f!==null?[f]:null}let r=n.lat,i=n.lon,s=0;if(!jt(r,i)){for(let f=0;f<e.length;f++){const p=e[f];if(p.matches.length===1&&jt(p.matches[0].lat,p.matches[0].lon)){r=p.matches[0].lat,i=p.matches[0].lon,s=f+1;break}}if(!jt(r,i))return null}let o=0,a=!1,u=-1;for(let f=s;f<e.length;f++){const p=e[f];if(p.matches.length!==1||!jt(p.matches[0].lat,p.matches[0].lon)){r=null,i=null;continue}if(r!==null&&i!==null){const g=Hi(r,i,p.matches[0].lat,p.matches[0].lon);g!==null&&(o+=g,a=!0)}r=p.matches[0].lat,i=p.matches[0].lon,u=f}if(u===e.length-1&&r!==null&&i!==null&&jt(t.lat,t.lon)){const f=Hi(r,i,t.lat,t.lon);f!==null&&(o+=f,a=!0)}return a?[o]:null}function In(n,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(n==null||n(i),t===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function vR(n,e){const t=R.createContext(e),r=s=>{const{children:o,...a}=s,u=R.useMemo(()=>a,Object.values(a));return S.jsx(t.Provider,{value:u,children:o})};r.displayName=n+"Provider";function i(s){const o=R.useContext(t);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${n}\``)}return[r,i]}function Lh(n,e=[]){let t=[];function r(s,o){const a=R.createContext(o),u=t.length;t=[...t,o];const f=g=>{var C;const{scope:x,children:A,..._}=g,b=((C=x==null?void 0:x[n])==null?void 0:C[u])||a,w=R.useMemo(()=>_,Object.values(_));return S.jsx(b.Provider,{value:w,children:A})};f.displayName=s+"Provider";function p(g,x){var b;const A=((b=x==null?void 0:x[n])==null?void 0:b[u])||a,_=R.useContext(A);if(_)return _;if(o!==void 0)return o;throw new Error(`\`${g}\` must be used within \`${s}\``)}return[f,p]}const i=()=>{const s=t.map(o=>R.createContext(o));return function(a){const u=(a==null?void 0:a[n])||s;return R.useMemo(()=>({[`__scope${n}`]:{...a,[n]:u}}),[a,u])}};return i.scopeName=n,[r,AR(i,...e)]}function AR(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:u,scopeName:f})=>{const g=u(s)[`__scope${f}`];return{...a,...g}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}var bc=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{},bR=hv[" useId ".trim().toString()]||(()=>{}),wR=0;function ih(n){const[e,t]=R.useState(bR());return bc(()=>{t(r=>r??String(wR++))},[n]),e?`radix-${e}`:""}var _R=hv[" useInsertionEffect ".trim().toString()]||bc;function Fp({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[i,s,o]=OR({defaultProp:e,onChange:t}),a=n!==void 0,u=a?n:i;{const p=R.useRef(n!==void 0);R.useEffect(()=>{const g=p.current;g!==a&&console.warn(`${r} is changing from ${g?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=a},[a,r])}const f=R.useCallback(p=>{var g;if(a){const x=kR(p)?p(n):p;x!==n&&((g=o.current)==null||g.call(o,x))}else s(p)},[a,n,s,o]);return[u,f]}function OR({defaultProp:n,onChange:e}){const[t,r]=R.useState(n),i=R.useRef(t),s=R.useRef(e);return _R(()=>{s.current=e},[e]),R.useEffect(()=>{var o;i.current!==t&&((o=s.current)==null||o.call(s,t),i.current=t)},[t,i]),[t,r,s]}function kR(n){return typeof n=="function"}function SR(n){const e=CR(n),t=R.forwardRef((r,i)=>{const{children:s,...o}=r,a=R.Children.toArray(s),u=a.find(ER);if(u){const f=u.props.children,p=a.map(g=>g===u?R.Children.count(f)>1?R.Children.only(null):R.isValidElement(f)?f.props.children:null:g);return S.jsx(e,{...o,ref:i,children:R.isValidElement(f)?R.cloneElement(f,void 0,p):null})}return S.jsx(e,{...o,ref:i,children:s})});return t.displayName=`${n}.Slot`,t}function CR(n){const e=R.forwardRef((t,r)=>{const{children:i,...s}=t;if(R.isValidElement(i)){const o=BR(i),a=PR(s,i.props);return i.type!==R.Fragment&&(a.ref=r?Nh(r,o):o),R.cloneElement(i,a)}return R.Children.count(i)>1?R.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var TR=Symbol("radix.slottable");function ER(n){return R.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===TR}function PR(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{const u=s(...a);return i(...a),u}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}function BR(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var RR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Vn=RR.reduce((n,e)=>{const t=SR(`Primitive.${e}`),r=R.forwardRef((i,s)=>{const{asChild:o,...a}=i,u=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),S.jsx(u,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{});function DR(n,e){n&&dv.flushSync(()=>n.dispatchEvent(e))}function wc(n){const e=R.useRef(n);return R.useEffect(()=>{e.current=n}),R.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function MR(n,e=globalThis==null?void 0:globalThis.document){const t=wc(n);R.useEffect(()=>{const r=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var NR="DismissableLayer",ey="dismissableLayer.update",LR="dismissableLayer.pointerDownOutside",FR="dismissableLayer.focusOutside",Fb,sS=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),oS=R.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:a,...u}=n,f=R.useContext(sS),[p,g]=R.useState(null),x=(p==null?void 0:p.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=R.useState({}),_=_i(e,z=>g(z)),b=Array.from(f.layers),[w]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),C=b.indexOf(w),T=p?b.indexOf(p):-1,E=f.layersWithOutsidePointerEventsDisabled.size>0,D=T>=C,N=jR(z=>{const I=z.target,K=[...f.branches].some(W=>W.contains(I));!D||K||(i==null||i(z),o==null||o(z),z.defaultPrevented||a==null||a())},x),F=QR(z=>{const I=z.target;[...f.branches].some(W=>W.contains(I))||(s==null||s(z),o==null||o(z),z.defaultPrevented||a==null||a())},x);return MR(z=>{T===f.layers.size-1&&(r==null||r(z),!z.defaultPrevented&&a&&(z.preventDefault(),a()))},x),R.useEffect(()=>{if(p)return t&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(Fb=x.body.style.pointerEvents,x.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(p)),f.layers.add(p),Ib(),()=>{t&&f.layersWithOutsidePointerEventsDisabled.size===1&&(x.body.style.pointerEvents=Fb)}},[p,x,t,f]),R.useEffect(()=>()=>{p&&(f.layers.delete(p),f.layersWithOutsidePointerEventsDisabled.delete(p),Ib())},[p,f]),R.useEffect(()=>{const z=()=>A({});return document.addEventListener(ey,z),()=>document.removeEventListener(ey,z)},[]),S.jsx(Vn.div,{...u,ref:_,style:{pointerEvents:E?D?"auto":"none":void 0,...n.style},onFocusCapture:In(n.onFocusCapture,F.onFocusCapture),onBlurCapture:In(n.onBlurCapture,F.onBlurCapture),onPointerDownCapture:In(n.onPointerDownCapture,N.onPointerDownCapture)})});oS.displayName=NR;var IR="DismissableLayerBranch",zR=R.forwardRef((n,e)=>{const t=R.useContext(sS),r=R.useRef(null),i=_i(e,r);return R.useEffect(()=>{const s=r.current;if(s)return t.branches.add(s),()=>{t.branches.delete(s)}},[t.branches]),S.jsx(Vn.div,{...n,ref:i})});zR.displayName=IR;function jR(n,e=globalThis==null?void 0:globalThis.document){const t=wc(n),r=R.useRef(!1),i=R.useRef(()=>{});return R.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let u=function(){aS(LR,t,f,{discrete:!0})};const f={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=u,e.addEventListener("click",i.current,{once:!0})):u()}else e.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function QR(n,e=globalThis==null?void 0:globalThis.document){const t=wc(n),r=R.useRef(!1);return R.useEffect(()=>{const i=s=>{s.target&&!r.current&&aS(FR,t,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Ib(){const n=new CustomEvent(ey);document.dispatchEvent(n)}function aS(n,e,t,{discrete:r}){const i=t.originalEvent.target,s=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(n,e,{once:!0}),r?DR(i,s):i.dispatchEvent(s)}var Yg="focusScope.autoFocusOnMount",Jg="focusScope.autoFocusOnUnmount",zb={bubbles:!1,cancelable:!0},HR="FocusScope",lS=R.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=n,[a,u]=R.useState(null),f=wc(i),p=wc(s),g=R.useRef(null),x=_i(e,b=>u(b)),A=R.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;R.useEffect(()=>{if(r){let b=function(E){if(A.paused||!a)return;const D=E.target;a.contains(D)?g.current=D:Vo(g.current,{select:!0})},w=function(E){if(A.paused||!a)return;const D=E.relatedTarget;D!==null&&(a.contains(D)||Vo(g.current,{select:!0}))},C=function(E){if(document.activeElement===document.body)for(const N of E)N.removedNodes.length>0&&Vo(a)};document.addEventListener("focusin",b),document.addEventListener("focusout",w);const T=new MutationObserver(C);return a&&T.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",w),T.disconnect()}}},[r,a,A.paused]),R.useEffect(()=>{if(a){Qb.add(A);const b=document.activeElement;if(!a.contains(b)){const C=new CustomEvent(Yg,zb);a.addEventListener(Yg,f),a.dispatchEvent(C),C.defaultPrevented||(WR(ZR(cS(a)),{select:!0}),document.activeElement===b&&Vo(a))}return()=>{a.removeEventListener(Yg,f),setTimeout(()=>{const C=new CustomEvent(Jg,zb);a.addEventListener(Jg,p),a.dispatchEvent(C),C.defaultPrevented||Vo(b??document.body,{select:!0}),a.removeEventListener(Jg,p),Qb.remove(A)},0)}}},[a,f,p,A]);const _=R.useCallback(b=>{if(!t&&!r||A.paused)return;const w=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,C=document.activeElement;if(w&&C){const T=b.currentTarget,[E,D]=qR(T);E&&D?!b.shiftKey&&C===D?(b.preventDefault(),t&&Vo(E,{select:!0})):b.shiftKey&&C===E&&(b.preventDefault(),t&&Vo(D,{select:!0})):C===T&&b.preventDefault()}},[t,r,A.paused]);return S.jsx(Vn.div,{tabIndex:-1,...o,ref:x,onKeyDown:_})});lS.displayName=HR;function WR(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Vo(r,{select:e}),document.activeElement!==t)return}function qR(n){const e=cS(n),t=jb(e,n),r=jb(e.reverse(),n);return[t,r]}function cS(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function jb(n,e){for(const t of n)if(!VR(t,{upTo:e}))return t}function VR(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function $R(n){return n instanceof HTMLInputElement&&"select"in n}function Vo(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&$R(n)&&e&&n.select()}}var Qb=UR();function UR(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=Hb(n,e),n.unshift(e)},remove(e){var t;n=Hb(n,e),(t=n[0])==null||t.resume()}}}function Hb(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function ZR(n){return n.filter(e=>e.tagName!=="A")}var GR="Portal",uS=R.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[i,s]=R.useState(!1);bc(()=>s(!0),[]);const o=t||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?jk.createPortal(S.jsx(Vn.div,{...r,ref:e}),o):null});uS.displayName=GR;function XR(n,e){return R.useReducer((t,r)=>e[t][r]??t,n)}var Nc=n=>{const{present:e,children:t}=n,r=KR(e),i=typeof t=="function"?t({present:r.isPresent}):R.Children.only(t),s=_i(r.ref,YR(i));return typeof t=="function"||r.isPresent?R.cloneElement(i,{ref:s}):null};Nc.displayName="Presence";function KR(n){const[e,t]=R.useState(),r=R.useRef(null),i=R.useRef(n),s=R.useRef("none"),o=n?"mounted":"unmounted",[a,u]=XR(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const f=xd(r.current);s.current=a==="mounted"?f:"none"},[a]),bc(()=>{const f=r.current,p=i.current;if(p!==n){const x=s.current,A=xd(f);n?u("MOUNT"):A==="none"||(f==null?void 0:f.display)==="none"?u("UNMOUNT"):u(p&&x!==A?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,u]),bc(()=>{if(e){let f;const p=e.ownerDocument.defaultView??window,g=A=>{const b=xd(r.current).includes(CSS.escape(A.animationName));if(A.target===e&&b&&(u("ANIMATION_END"),!i.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",f=p.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},x=A=>{A.target===e&&(s.current=xd(r.current))};return e.addEventListener("animationstart",x),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{p.clearTimeout(f),e.removeEventListener("animationstart",x),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:R.useCallback(f=>{r.current=f?getComputedStyle(f):null,t(f)},[])}}function xd(n){return(n==null?void 0:n.animationName)||"none"}function YR(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var ex=0;function JR(){R.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??Wb()),document.body.insertAdjacentElement("beforeend",n[1]??Wb()),ex++,()=>{ex===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),ex--}},[])}function Wb(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var ps=function(){return ps=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ps.apply(this,arguments)};function hS(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function eD(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}var Yd="right-scroll-bar-position",Jd="width-before-scroll-bar",tD="with-scroll-bars-hidden",nD="--removed-body-scroll-bar-size";function tx(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function rD(n,e){var t=R.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var i=t.value;i!==r&&(t.value=r,t.callback(r,i))}}}})[0];return t.callback=e,t.facade}var iD=typeof window<"u"?R.useLayoutEffect:R.useEffect,qb=new WeakMap;function sD(n,e){var t=rD(null,function(r){return n.forEach(function(i){return tx(i,r)})});return iD(function(){var r=qb.get(t);if(r){var i=new Set(r),s=new Set(n),o=t.current;i.forEach(function(a){s.has(a)||tx(a,null)}),s.forEach(function(a){i.has(a)||tx(a,o)})}qb.set(t,n)},[n]),t}function oD(n){return n}function aD(n,e){e===void 0&&(e=oD);var t=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(s){var o=e(s,r);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;t.length;){var o=t;t=[],o.forEach(s)}t={push:function(a){return s(a)},filter:function(){return t}}},assignMedium:function(s){r=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(s),o=t}var u=function(){var p=o;o=[],p.forEach(s)},f=function(){return Promise.resolve().then(u)};f(),t={push:function(p){o.push(p),f()},filter:function(p){return o=o.filter(p),t}}}};return i}function lD(n){n===void 0&&(n={});var e=aD(null);return e.options=ps({async:!0,ssr:!1},n),e}var fS=function(n){var e=n.sideCar,t=hS(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return R.createElement(r,ps({},t))};fS.isSideCarExport=!0;function cD(n,e){return n.useMedium(e),fS}var dS=lD(),nx=function(){},Ip=R.forwardRef(function(n,e){var t=R.useRef(null),r=R.useState({onScrollCapture:nx,onWheelCapture:nx,onTouchMoveCapture:nx}),i=r[0],s=r[1],o=n.forwardProps,a=n.children,u=n.className,f=n.removeScrollBar,p=n.enabled,g=n.shards,x=n.sideCar,A=n.noRelative,_=n.noIsolation,b=n.inert,w=n.allowPinchZoom,C=n.as,T=C===void 0?"div":C,E=n.gapMode,D=hS(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),N=x,F=sD([t,e]),z=ps(ps({},D),i);return R.createElement(R.Fragment,null,p&&R.createElement(N,{sideCar:dS,removeScrollBar:f,shards:g,noRelative:A,noIsolation:_,inert:b,setCallbacks:s,allowPinchZoom:!!w,lockRef:t,gapMode:E}),o?R.cloneElement(R.Children.only(a),ps(ps({},z),{ref:F})):R.createElement(T,ps({},z,{className:u,ref:F}),a))});Ip.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ip.classNames={fullWidth:Jd,zeroRight:Yd};var uD=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function hD(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=uD();return e&&n.setAttribute("nonce",e),n}function fD(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function dD(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var pD=function(){var n=0,e=null;return{add:function(t){n==0&&(e=hD())&&(fD(e,t),dD(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},mD=function(){var n=pD();return function(e,t){R.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},pS=function(){var n=mD(),e=function(t){var r=t.styles,i=t.dynamic;return n(r,i),null};return e},gD={left:0,top:0,right:0,gap:0},rx=function(n){return parseInt(n||"",10)||0},xD=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],i=e[n==="padding"?"paddingRight":"marginRight"];return[rx(t),rx(r),rx(i)]},yD=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return gD;var e=xD(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},vD=pS(),uc="data-scroll-locked",AD=function(n,e,t,r){var i=n.left,s=n.top,o=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(tD,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(uc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Yd,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Jd,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Yd," .").concat(Yd,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Jd," .").concat(Jd,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(uc,`] {
    `).concat(nD,": ").concat(a,`px;
  }
`)},Vb=function(){var n=parseInt(document.body.getAttribute(uc)||"0",10);return isFinite(n)?n:0},bD=function(){R.useEffect(function(){return document.body.setAttribute(uc,(Vb()+1).toString()),function(){var n=Vb()-1;n<=0?document.body.removeAttribute(uc):document.body.setAttribute(uc,n.toString())}},[])},wD=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,i=r===void 0?"margin":r;bD();var s=R.useMemo(function(){return yD(i)},[i]);return R.createElement(vD,{styles:AD(s,!e,i,t?"":"!important")})},ty=!1;if(typeof window<"u")try{var yd=Object.defineProperty({},"passive",{get:function(){return ty=!0,!0}});window.addEventListener("test",yd,yd),window.removeEventListener("test",yd,yd)}catch{ty=!1}var ec=ty?{passive:!1}:!1,_D=function(n){return n.tagName==="TEXTAREA"},mS=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!_D(n)&&t[e]==="visible")},OD=function(n){return mS(n,"overflowY")},kD=function(n){return mS(n,"overflowX")},$b=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=gS(n,r);if(i){var s=xS(n,r),o=s[1],a=s[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},SD=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},CD=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},gS=function(n,e){return n==="v"?OD(e):kD(e)},xS=function(n,e){return n==="v"?SD(e):CD(e)},TD=function(n,e){return n==="h"&&e==="rtl"?-1:1},ED=function(n,e,t,r,i){var s=TD(n,window.getComputedStyle(e).direction),o=s*r,a=t.target,u=e.contains(a),f=!1,p=o>0,g=0,x=0;do{if(!a)break;var A=xS(n,a),_=A[0],b=A[1],w=A[2],C=b-w-s*_;(_||C)&&gS(n,a)&&(g+=C,x+=_);var T=a.parentNode;a=T&&T.nodeType===Node.DOCUMENT_FRAGMENT_NODE?T.host:T}while(!u&&a!==document.body||u&&(e.contains(a)||e===a));return(p&&Math.abs(g)<1||!p&&Math.abs(x)<1)&&(f=!0),f},vd=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},Ub=function(n){return[n.deltaX,n.deltaY]},Zb=function(n){return n&&"current"in n?n.current:n},PD=function(n,e){return n[0]===e[0]&&n[1]===e[1]},BD=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},RD=0,tc=[];function DD(n){var e=R.useRef([]),t=R.useRef([0,0]),r=R.useRef(),i=R.useState(RD++)[0],s=R.useState(pS)[0],o=R.useRef(n);R.useEffect(function(){o.current=n},[n]),R.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(i));var b=eD([n.lockRef.current],(n.shards||[]).map(Zb),!0).filter(Boolean);return b.forEach(function(w){return w.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),b.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(i))})}}},[n.inert,n.lockRef.current,n.shards]);var a=R.useCallback(function(b,w){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!o.current.allowPinchZoom;var C=vd(b),T=t.current,E="deltaX"in b?b.deltaX:T[0]-C[0],D="deltaY"in b?b.deltaY:T[1]-C[1],N,F=b.target,z=Math.abs(E)>Math.abs(D)?"h":"v";if("touches"in b&&z==="h"&&F.type==="range")return!1;var I=window.getSelection(),K=I&&I.anchorNode,W=K?K===F||K.contains(F):!1;if(W)return!1;var U=$b(z,F);if(!U)return!0;if(U?N=z:(N=z==="v"?"h":"v",U=$b(z,F)),!U)return!1;if(!r.current&&"changedTouches"in b&&(E||D)&&(r.current=N),!N)return!0;var X=r.current||N;return ED(X,w,b,X==="h"?E:D)},[]),u=R.useCallback(function(b){var w=b;if(!(!tc.length||tc[tc.length-1]!==s)){var C="deltaY"in w?Ub(w):vd(w),T=e.current.filter(function(N){return N.name===w.type&&(N.target===w.target||w.target===N.shadowParent)&&PD(N.delta,C)})[0];if(T&&T.should){w.cancelable&&w.preventDefault();return}if(!T){var E=(o.current.shards||[]).map(Zb).filter(Boolean).filter(function(N){return N.contains(w.target)}),D=E.length>0?a(w,E[0]):!o.current.noIsolation;D&&w.cancelable&&w.preventDefault()}}},[]),f=R.useCallback(function(b,w,C,T){var E={name:b,delta:w,target:C,should:T,shadowParent:MD(C)};e.current.push(E),setTimeout(function(){e.current=e.current.filter(function(D){return D!==E})},1)},[]),p=R.useCallback(function(b){t.current=vd(b),r.current=void 0},[]),g=R.useCallback(function(b){f(b.type,Ub(b),b.target,a(b,n.lockRef.current))},[]),x=R.useCallback(function(b){f(b.type,vd(b),b.target,a(b,n.lockRef.current))},[]);R.useEffect(function(){return tc.push(s),n.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:x}),document.addEventListener("wheel",u,ec),document.addEventListener("touchmove",u,ec),document.addEventListener("touchstart",p,ec),function(){tc=tc.filter(function(b){return b!==s}),document.removeEventListener("wheel",u,ec),document.removeEventListener("touchmove",u,ec),document.removeEventListener("touchstart",p,ec)}},[]);var A=n.removeScrollBar,_=n.inert;return R.createElement(R.Fragment,null,_?R.createElement(s,{styles:BD(i)}):null,A?R.createElement(wD,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function MD(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const ND=cD(dS,DD);var yS=R.forwardRef(function(n,e){return R.createElement(Ip,ps({},n,{ref:e,sideCar:ND}))});yS.classNames=Ip.classNames;var LD=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},nc=new WeakMap,Ad=new WeakMap,bd={},ix=0,vS=function(n){return n&&(n.host||vS(n.parentNode))},FD=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=vS(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},ID=function(n,e,t,r){var i=FD(e,Array.isArray(n)?n:[n]);bd[t]||(bd[t]=new WeakMap);var s=bd[t],o=[],a=new Set,u=new Set(i),f=function(g){!g||a.has(g)||(a.add(g),f(g.parentNode))};i.forEach(f);var p=function(g){!g||u.has(g)||Array.prototype.forEach.call(g.children,function(x){if(a.has(x))p(x);else try{var A=x.getAttribute(r),_=A!==null&&A!=="false",b=(nc.get(x)||0)+1,w=(s.get(x)||0)+1;nc.set(x,b),s.set(x,w),o.push(x),b===1&&_&&Ad.set(x,!0),w===1&&x.setAttribute(t,"true"),_||x.setAttribute(r,"true")}catch(C){console.error("aria-hidden: cannot operate on ",x,C)}})};return p(e),a.clear(),ix++,function(){o.forEach(function(g){var x=nc.get(g)-1,A=s.get(g)-1;nc.set(g,x),s.set(g,A),x||(Ad.has(g)||g.removeAttribute(r),Ad.delete(g)),A||g.removeAttribute(t)}),ix--,ix||(nc=new WeakMap,nc=new WeakMap,Ad=new WeakMap,bd={})}},zD=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),i=LD(n);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live], script"))),ID(r,i,t,"aria-hidden")):function(){return null}};function jD(n){const e=QD(n),t=R.forwardRef((r,i)=>{const{children:s,...o}=r,a=R.Children.toArray(s),u=a.find(WD);if(u){const f=u.props.children,p=a.map(g=>g===u?R.Children.count(f)>1?R.Children.only(null):R.isValidElement(f)?f.props.children:null:g);return S.jsx(e,{...o,ref:i,children:R.isValidElement(f)?R.cloneElement(f,void 0,p):null})}return S.jsx(e,{...o,ref:i,children:s})});return t.displayName=`${n}.Slot`,t}function QD(n){const e=R.forwardRef((t,r)=>{const{children:i,...s}=t;if(R.isValidElement(i)){const o=VD(i),a=qD(s,i.props);return i.type!==R.Fragment&&(a.ref=r?Nh(r,o):o),R.cloneElement(i,a)}return R.Children.count(i)>1?R.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var HD=Symbol("radix.slottable");function WD(n){return R.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===HD}function qD(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{const u=s(...a);return i(...a),u}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}function VD(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var zp="Dialog",[AS]=Lh(zp),[$D,Vi]=AS(zp),bS=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:i,onOpenChange:s,modal:o=!0}=n,a=R.useRef(null),u=R.useRef(null),[f,p]=Fp({prop:r,defaultProp:i??!1,onChange:s,caller:zp});return S.jsx($D,{scope:e,triggerRef:a,contentRef:u,contentId:ih(),titleId:ih(),descriptionId:ih(),open:f,onOpenChange:p,onOpenToggle:R.useCallback(()=>p(g=>!g),[p]),modal:o,children:t})};bS.displayName=zp;var wS="DialogTrigger",UD=R.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=Vi(wS,t),s=_i(e,i.triggerRef);return S.jsx(Vn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Av(i.open),...r,ref:s,onClick:In(n.onClick,i.onOpenToggle)})});UD.displayName=wS;var yv="DialogPortal",[ZD,_S]=AS(yv,{forceMount:void 0}),OS=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:i}=n,s=Vi(yv,e);return S.jsx(ZD,{scope:e,forceMount:t,children:R.Children.map(r,o=>S.jsx(Nc,{present:t||s.open,children:S.jsx(uS,{asChild:!0,container:i,children:o})}))})};OS.displayName=yv;var tp="DialogOverlay",kS=R.forwardRef((n,e)=>{const t=_S(tp,n.__scopeDialog),{forceMount:r=t.forceMount,...i}=n,s=Vi(tp,n.__scopeDialog);return s.modal?S.jsx(Nc,{present:r||s.open,children:S.jsx(XD,{...i,ref:e})}):null});kS.displayName=tp;var GD=jD("DialogOverlay.RemoveScroll"),XD=R.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=Vi(tp,t);return S.jsx(yS,{as:GD,allowPinchZoom:!0,shards:[i.contentRef],children:S.jsx(Vn.div,{"data-state":Av(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),nl="DialogContent",SS=R.forwardRef((n,e)=>{const t=_S(nl,n.__scopeDialog),{forceMount:r=t.forceMount,...i}=n,s=Vi(nl,n.__scopeDialog);return S.jsx(Nc,{present:r||s.open,children:s.modal?S.jsx(KD,{...i,ref:e}):S.jsx(YD,{...i,ref:e})})});SS.displayName=nl;var KD=R.forwardRef((n,e)=>{const t=Vi(nl,n.__scopeDialog),r=R.useRef(null),i=_i(e,t.contentRef,r);return R.useEffect(()=>{const s=r.current;if(s)return zD(s)},[]),S.jsx(CS,{...n,ref:i,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:In(n.onCloseAutoFocus,s=>{var o;s.preventDefault(),(o=t.triggerRef.current)==null||o.focus()}),onPointerDownOutside:In(n.onPointerDownOutside,s=>{const o=s.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&s.preventDefault()}),onFocusOutside:In(n.onFocusOutside,s=>s.preventDefault())})}),YD=R.forwardRef((n,e)=>{const t=Vi(nl,n.__scopeDialog),r=R.useRef(!1),i=R.useRef(!1);return S.jsx(CS,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,a;(o=n.onCloseAutoFocus)==null||o.call(n,s),s.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var u,f;(u=n.onInteractOutside)==null||u.call(n,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=s.target;((f=t.triggerRef.current)==null?void 0:f.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),CS=R.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,...o}=n,a=Vi(nl,t),u=R.useRef(null),f=_i(e,u);return JR(),S.jsxs(S.Fragment,{children:[S.jsx(lS,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:S.jsx(oS,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":Av(a.open),...o,ref:f,onDismiss:()=>a.onOpenChange(!1)})}),S.jsxs(S.Fragment,{children:[S.jsx(JD,{titleId:a.titleId}),S.jsx(t5,{contentRef:u,descriptionId:a.descriptionId})]})]})}),vv="DialogTitle",TS=R.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=Vi(vv,t);return S.jsx(Vn.h2,{id:i.titleId,...r,ref:e})});TS.displayName=vv;var ES="DialogDescription",PS=R.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=Vi(ES,t);return S.jsx(Vn.p,{id:i.descriptionId,...r,ref:e})});PS.displayName=ES;var BS="DialogClose",RS=R.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,i=Vi(BS,t);return S.jsx(Vn.button,{type:"button",...r,ref:e,onClick:In(n.onClick,()=>i.onOpenChange(!1))})});RS.displayName=BS;function Av(n){return n?"open":"closed"}var DS="DialogTitleWarning",[oH,MS]=vR(DS,{contentName:nl,titleName:vv,docsSlug:"dialog"}),JD=({titleId:n})=>{const e=MS(DS),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return R.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},e5="DialogDescriptionWarning",t5=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${MS(e5).contentName}}.`;return R.useEffect(()=>{var s;const i=(s=n.current)==null?void 0:s.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},NS=bS,LS=OS,jp=kS,Qp=SS,Hp=TS,Wp=PS,FS=RS;const bv=NS,n5=LS,IS=R.forwardRef(({className:n,...e},t)=>S.jsx(jp,{ref:t,className:vt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e}));IS.displayName=jp.displayName;const qp=R.forwardRef(({className:n,children:e,...t},r)=>S.jsxs(n5,{children:[S.jsx(IS,{}),S.jsxs(Qp,{ref:r,className:vt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...t,children:[e,S.jsxs(FS,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[S.jsx(Hk,{className:"h-4 w-4"}),S.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qp.displayName=Qp.displayName;const Vp=({className:n,...e})=>S.jsx("div",{className:vt("flex flex-col space-y-1.5 text-center sm:text-left",n),...e});Vp.displayName="DialogHeader";const wv=({className:n,...e})=>S.jsx("div",{className:vt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",n),...e});wv.displayName="DialogFooter";const $p=R.forwardRef(({className:n,...e},t)=>S.jsx(Hp,{ref:t,className:vt("text-lg font-semibold leading-none tracking-tight",n),...e}));$p.displayName=Hp.displayName;const Up=R.forwardRef(({className:n,...e},t)=>S.jsx(Wp,{ref:t,className:vt("text-sm text-muted-foreground",n),...e}));Up.displayName=Wp.displayName;function r5(){const n=window.location.hash.slice(1);if(!n)return null;if(n==="raw")return{type:"raw",name:"raw"};if(n==="map")return{type:"map",name:"map"};if(n==="visualizer")return{type:"visualizer",name:"visualizer"};if(n.startsWith("map/focus/")){const i=n.slice(10);return i?{type:"map",name:"map",mapFocusKey:decodeURIComponent(i)}:{type:"map",name:"map"}}const e=n.indexOf("/");if(e===-1)return null;const t=n.slice(0,e),r=decodeURIComponent(n.slice(e+1));return(t==="channel"||t==="contact")&&r?{type:t,name:r}:null}function zS(n){return`#map/focus/${encodeURIComponent(n)}`}function i5(n){if(!n)return"";if(n.type==="raw")return"#raw";if(n.type==="map")return"#map";if(n.type==="visualizer")return"#visualizer";const e=n.type==="channel"&&n.name.startsWith("#")?n.name.slice(1):n.name;return`#${n.type}/${encodeURIComponent(e)}`}function s5(n){const e=i5(n);e!==window.location.hash&&window.history.replaceState(null,"",e||window.location.pathname)}function o5({open:n,onClose:e,paths:t,senderInfo:r,contacts:i,config:s}){const o=t.map(u=>({...u,resolved:xR(u.path,r,i,s)})),a=t.length===1;return S.jsx(bv,{open:n,onOpenChange:u=>!u&&e(),children:S.jsxs(qp,{className:"max-w-md max-h-[80vh] flex flex-col",children:[S.jsxs(Vp,{children:[S.jsxs($p,{children:["Message Path",!a&&`s (${t.length})`]}),S.jsx(Up,{children:a?S.jsxs(S.Fragment,{children:["This shows ",S.jsx("em",{children:"one route"})," that this message traveled through the mesh network. Routers may be incorrectly identified due to prefix collisions between heard and non-heard router advertisements."]}):S.jsxs(S.Fragment,{children:["This message was received via ",S.jsxs("strong",{children:[t.length," different routes"]}),". Routers may be incorrectly identified due to prefix collisions."]})})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto py-2 space-y-4",children:[o.map((u,f)=>S.jsxs("div",{children:[!a&&S.jsxs("div",{className:"text-xs text-muted-foreground font-medium mb-2 pb-1 border-b border-border",children:["Path ",f+1,"  received ",Ac(u.received_at)]}),S.jsx(a5,{resolved:u.resolved,senderInfo:r,hideStraightLine:!a})]},f)),!a&&o.length>0&&(()=>{const u=o[0].resolved;return jt(u.sender.lat,u.sender.lon)&&jt(u.receiver.lat,u.receiver.lon)?S.jsxs("div",{className:"pt-3 mt-1 border-t border-border",children:[S.jsx("span",{className:"text-sm text-muted-foreground",children:"Straight-line distance: "}),S.jsx("span",{className:"text-sm font-medium",children:tl(Hi(u.sender.lat,u.sender.lon,u.receiver.lat,u.receiver.lon))})]}):null})()]}),S.jsx(wv,{children:S.jsx(yn,{onClick:e,children:"Close"})})]})})}function a5({resolved:n,senderInfo:e,hideStraightLine:t}){const r=i=>{if(i===0)return jt(n.sender.lat,n.sender.lon)?{lat:n.sender.lat,lon:n.sender.lon}:null;const s=n.hops[i-1];return s.matches.length>1||s.matches.length===0?null:jt(s.matches[0].lat,s.matches[0].lon)?{lat:s.matches[0].lat,lon:s.matches[0].lon}:null};return S.jsxs("div",{className:"space-y-0",children:[S.jsx(Gb,{label:"Sender",name:n.sender.name,prefix:n.sender.prefix,distance:null,isFirst:!0,lat:n.sender.lat,lon:n.sender.lon,publicKey:e.publicKeyOrPrefix}),n.hops.map((i,s)=>S.jsx(l5,{hop:i,hopNumber:s+1,prevLocation:r(s)},s)),S.jsx(Gb,{label:"Receiver (me)",name:n.receiver.name,prefix:n.receiver.prefix,distance:c5(n),isLast:!0,lat:n.receiver.lat,lon:n.receiver.lon,publicKey:n.receiver.publicKey??void 0}),n.totalDistances&&n.totalDistances.length>0&&S.jsxs("div",{className:"pt-3 mt-3 border-t border-border",children:[S.jsxs("span",{className:"text-sm text-muted-foreground",children:["Presumed unambiguous distance covered:"," "]}),S.jsxs("span",{className:"text-sm font-medium",children:[n.hasGaps?">":"",tl(n.totalDistances[0])]})]}),!t&&jt(n.sender.lat,n.sender.lon)&&jt(n.receiver.lat,n.receiver.lon)&&S.jsxs("div",{className:n.totalDistances&&n.totalDistances.length>0?"pt-1":"pt-3 mt-3 border-t border-border",children:[S.jsx("span",{className:"text-sm text-muted-foreground",children:"Straight-line distance: "}),S.jsx("span",{className:"text-sm font-medium",children:tl(Hi(n.sender.lat,n.sender.lon,n.receiver.lat,n.receiver.lon))})]})]})}function Gb({label:n,name:e,prefix:t,distance:r,isFirst:i,isLast:s,lat:o,lon:a,publicKey:u}){const f=jt(o??null,a??null)&&u;return S.jsxs("div",{className:"flex gap-3",children:[S.jsxs("div",{className:"flex flex-col items-center w-4 flex-shrink-0",children:[!i&&S.jsx("div",{className:"w-0.5 h-3 bg-border"}),S.jsx("div",{className:"w-3 h-3 rounded-full bg-primary flex-shrink-0"}),!s&&S.jsx("div",{className:"w-0.5 flex-1 bg-border"})]}),S.jsxs("div",{className:"pb-3 flex-1 min-w-0",children:[S.jsx("div",{className:"text-xs text-muted-foreground font-medium",children:n}),S.jsxs("div",{className:"font-medium truncate",children:[e," ",S.jsxs("span",{className:"text-muted-foreground font-mono text-sm",children:["(",t,")"]}),r!==null&&S.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["- ",tl(r)]}),f&&S.jsx(ny,{lat:o,lon:a,publicKey:u})]})]})]})}function l5({hop:n,hopNumber:e,prevLocation:t}){const r=n.matches.length>1,i=n.matches.length===0,s=o=>!t||t.lat===null||t.lon===null||!jt(o.lat,o.lon)?null:Hi(t.lat,t.lon,o.lat,o.lon);return S.jsxs("div",{className:"flex gap-3",children:[S.jsxs("div",{className:"flex flex-col items-center w-4 flex-shrink-0",children:[S.jsx("div",{className:"w-0.5 h-3 bg-border"}),S.jsx("div",{className:"w-3 h-3 rounded-full bg-muted-foreground flex-shrink-0"}),S.jsx("div",{className:"w-0.5 flex-1 bg-border"})]}),S.jsxs("div",{className:"pb-3 flex-1 min-w-0",children:[S.jsxs("div",{className:"text-xs text-muted-foreground font-medium",children:["Hop ",e,r&&S.jsx("span",{className:"text-yellow-500 ml-1",children:"(ambiguous)"})]}),i?S.jsxs("div",{className:"font-medium text-muted-foreground/70",children:["<UNKNOWN ",S.jsx("span",{className:"font-mono text-sm",children:n.prefix}),">"]}):r?S.jsx("div",{children:n.matches.map(o=>{const a=s(o),u=jt(o.lat,o.lon);return S.jsxs("div",{className:"font-medium truncate",children:[o.name||o.public_key.slice(0,12)," ",S.jsxs("span",{className:"text-muted-foreground font-mono text-sm",children:["(",o.public_key.slice(0,2).toUpperCase(),")"]}),a!==null&&S.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["- ",tl(a)]}),u&&S.jsx(ny,{lat:o.lat,lon:o.lon,publicKey:o.public_key})]},o.public_key)})}):S.jsxs("div",{className:"font-medium truncate",children:[n.matches[0].name||n.matches[0].public_key.slice(0,12)," ",S.jsxs("span",{className:"text-muted-foreground font-mono text-sm",children:["(",n.prefix,")"]}),n.distanceFromPrev!==null&&S.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["- ",tl(n.distanceFromPrev)]}),jt(n.matches[0].lat,n.matches[0].lon)&&S.jsx(ny,{lat:n.matches[0].lat,lon:n.matches[0].lon,publicKey:n.matches[0].public_key})]})]})]})}function ny({lat:n,lon:e,publicKey:t}){const r=i=>{i.preventDefault(),i.stopPropagation();const s=window.location.origin+window.location.pathname+zS(t);window.open(s,"_blank")};return S.jsxs("span",{className:"text-xs text-muted-foreground/70 font-mono cursor-pointer hover:text-primary hover:underline ml-1",onClick:r,title:"View on map",children:["(",n.toFixed(4),", ",e.toFixed(4),")"]})}function c5(n){let e=null,t=null;if(n.hops.length>0){const r=n.hops[n.hops.length-1];r.matches.length===1&&jt(r.matches[0].lat,r.matches[0].lon)&&(e=r.matches[0].lat,t=r.matches[0].lon)}else jt(n.sender.lat,n.sender.lon)&&(e=n.sender.lat,t=n.sender.lon);return e===null||t===null||!jt(n.receiver.lat,n.receiver.lon)?null:Hi(e,t,n.receiver.lat,n.receiver.lon)}function u5(n,e){if(!e)return n;const t=/@\[([^\]]+)\]/g,r=[];let i=0,s,o=0;for(;(s=t.exec(n))!==null;){s.index>i&&r.push(n.slice(i,s.index));const a=s[1],u=a===e;r.push(S.jsxs("span",{className:vt("rounded px-0.5",u?"bg-primary/30 text-primary font-medium":"bg-muted-foreground/20"),children:["@[",a,"]"]},o++)),i=s.index+s[0].length}return i<n.length&&r.push(n.slice(i)),r.length>0?r:n}function Xb({paths:n,onClick:e,variant:t}){const i=`(${gR(n).display})`,s=t==="header"?"font-normal text-muted-foreground/70 ml-1 text-[11px] cursor-pointer hover:text-primary hover:underline":"text-[10px] text-muted-foreground/50 ml-1 cursor-pointer hover:text-primary hover:underline";return S.jsx("span",{className:s,onClick:o=>{o.stopPropagation(),e()},title:"View message path",children:i})}function h5({messages:n,contacts:e,loading:t,loadingOlder:r=!1,hasOlderMessages:i=!1,onSenderClick:s,onLoadOlder:o,radioName:a,config:u}){const f=R.useRef(null),p=R.useRef(0),g=R.useRef(!0),[x,A]=R.useState(!1),[_,b]=R.useState(null),w=R.useRef({scrollTop:0,scrollHeight:0,clientHeight:0,wasNearTop:!1,wasNearBottom:!0});R.useLayoutEffect(()=>{if(!f.current)return;const I=f.current,K=n.length-p.current;if(g.current&&n.length>0)I.scrollTop=I.scrollHeight,g.current=!1;else if(K>0&&p.current>0){const W=I.scrollHeight-w.current.scrollHeight;w.current.wasNearTop&&W>0?I.scrollTop=w.current.scrollTop+W:w.current.wasNearBottom&&(I.scrollTop=I.scrollHeight)}p.current=n.length},[n]),R.useEffect(()=>{n.length===0&&(g.current=!0,p.current=0,w.current={scrollTop:0,scrollHeight:0,clientHeight:0,wasNearTop:!1,wasNearBottom:!0})},[n.length]);const C=R.useCallback(()=>{if(!f.current)return;const{scrollTop:I,scrollHeight:K,clientHeight:W}=f.current,U=K-I-W;w.current={scrollTop:I,scrollHeight:K,clientHeight:W,wasNearTop:I<150,wasNearBottom:U<100},A(U>100),!(!o||r||!i)&&I<100&&o()},[o,r,i]),T=R.useCallback(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[]),E=I=>I&&e.find(K=>K.public_key===I)||null,D=I=>e.find(K=>K.name===I)||null,N=(I,K,W)=>{if(I.type==="PRIV"&&K)return{name:K.name||K.public_key.slice(0,12),publicKeyOrPrefix:K.public_key,lat:K.lat,lon:K.lon};if(W){const U=D(W);if(U)return{name:W,publicKeyOrPrefix:U.public_key,lat:U.lat,lon:U.lon}}return{name:W||"Unknown",publicKeyOrPrefix:I.conversation_key||"",lat:null,lon:null}};if(t)return S.jsx("div",{className:"flex-1 overflow-y-auto p-5 text-center text-muted-foreground",children:"Loading messages..."});if(n.length===0)return S.jsx("div",{className:"flex-1 overflow-y-auto p-5 text-center text-muted-foreground",children:"No messages yet"});const F=[...n].sort((I,K)=>I.received_at-K.received_at),z=(I,K)=>I.outgoing?"__outgoing__":I.type==="PRIV"&&I.conversation_key?I.conversation_key:K||"__unknown__";return S.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[S.jsxs("div",{className:"h-full overflow-y-auto p-4 flex flex-col gap-0.5",ref:f,onScroll:C,children:[r&&S.jsx("div",{className:"text-center py-2 text-muted-foreground text-sm",children:"Loading older messages..."}),!r&&i&&S.jsx("div",{className:"text-center py-2 text-muted-foreground text-xs",children:"Scroll up for older messages"}),F.map((I,K)=>{var G;const W=I.type==="PRIV"?E(I.conversation_key):null,U=(W==null?void 0:W.type)===Lp,{sender:X,content:$}=U?{sender:null,content:I.text}:Lb(I.text),ee=I.outgoing?"You":(W==null?void 0:W.name)||X||((G=I.conversation_key)==null?void 0:G.slice(0,8))||"Unknown",le=!I.outgoing&&s&&ee!=="Unknown",Z=z(I,X),ie=F[K-1],V=ie?z(ie,Lb(ie.text).sender):null,ne=!I.outgoing&&Z!==V,q=K===0;let B=null,Q="";if(!I.outgoing){if(I.type==="PRIV"&&I.conversation_key)B=(W==null?void 0:W.name)||null,Q=I.conversation_key;else if(X){const Y=D(X);B=X,Q=(Y==null?void 0:Y.public_key)||`name:${X}`}}return S.jsxs("div",{className:vt("flex items-start max-w-[85%]",I.outgoing&&"flex-row-reverse self-end",ne&&!q&&"mt-3"),children:[!I.outgoing&&S.jsx("div",{className:"w-10 flex-shrink-0 flex items-start pt-0.5",children:ne&&Q&&S.jsx(Yx,{name:B,publicKey:Q,size:32})}),S.jsxs("div",{className:vt("py-1.5 px-3 rounded-lg min-w-0",I.outgoing?"bg-[#1e3a29]":"bg-muted"),children:[ne&&S.jsxs("div",{className:"text-[13px] font-semibold text-muted-foreground mb-0.5",children:[le?S.jsx("span",{className:"cursor-pointer hover:text-primary hover:underline",onClick:()=>s(ee),title:`Mention ${ee}`,children:ee}):ee,S.jsx("span",{className:"font-normal text-muted-foreground/70 ml-2 text-[11px]",children:Ac(I.sender_timestamp||I.received_at)}),!I.outgoing&&I.paths&&I.paths.length>0&&S.jsx(Xb,{paths:I.paths,variant:"header",onClick:()=>b({paths:I.paths,senderInfo:N(I,W,X)})})]}),S.jsxs("div",{className:"break-words whitespace-pre-wrap",children:[$.split(`
`).map((Y,ue,pe)=>S.jsxs("span",{children:[u5(Y,a),ue<pe.length-1&&S.jsx("br",{})]},ue)),!ne&&S.jsxs(S.Fragment,{children:[S.jsx("span",{className:"text-[10px] text-muted-foreground/50 ml-2",children:Ac(I.sender_timestamp||I.received_at)}),!I.outgoing&&I.paths&&I.paths.length>0&&S.jsx(Xb,{paths:I.paths,variant:"inline",onClick:()=>b({paths:I.paths,senderInfo:N(I,W,X)})})]}),I.outgoing&&(I.acked>0?` ${I.acked>1?I.acked:""}`:" ?")]})]})]},I.id)})]}),x&&S.jsx("button",{onClick:T,className:"absolute bottom-4 right-4 w-10 h-10 rounded-full bg-muted hover:bg-accent border border-border flex items-center justify-center shadow-lg transition-opacity",title:"Scroll to bottom",children:S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-muted-foreground",children:S.jsx("polyline",{points:"6 9 12 15 18 9"})})}),_&&S.jsx(o5,{open:!0,onClose:()=>b(null),paths:_.paths,senderInfo:_.senderInfo,contacts:e,config:u??null})]})}const Kb=156,f5=140,d5=156,p5=120,m5=8,g5=R.forwardRef(function({onSend:e,disabled:t,placeholder:r,isRepeaterMode:i,conversationType:s,senderName:o},a){const[u,f]=R.useState(""),[p,g]=R.useState(!1),x=R.useRef(null);R.useImperativeHandle(a,()=>({appendText:N=>{var F;f(z=>z+N),(F=x.current)==null||F.focus()}}));const A=R.useMemo(()=>{if(s==="contact")return{warningAt:f5,dangerAt:Kb,hardLimit:Kb};if(s==="channel"){const N=(o==null?void 0:o.length)??10,F=Math.max(1,d5-N-2);return{warningAt:p5,dangerAt:Math.max(1,F-m5),hardLimit:F}}return null},[s,o]),{limitState:_,warningMessage:b}=R.useMemo(()=>{if(!A)return{limitState:"normal",warningMessage:null};const N=u.length;return N>=A.hardLimit?{limitState:"error",warningMessage:"likely truncated by radio"}:N>=A.dangerAt?{limitState:"danger",warningMessage:"may impact multi-repeater hop delivery"}:N>=A.warningAt?{limitState:"warning",warningMessage:"may impact multi-repeater hop delivery"}:{limitState:"normal",warningMessage:null}},[u.length,A]),w=A?A.hardLimit-u.length:0,C=R.useCallback(async N=>{N.preventDefault();const F=u.trim();if(i){if(p||t)return;g(!0);try{await e(F),f("")}catch(z){console.error("Failed to request telemetry:",z),kt.error("Failed to request telemetry",{description:z instanceof Error?z.message:"Check radio connection"});return}finally{g(!1)}setTimeout(()=>{var z;return(z=x.current)==null?void 0:z.focus()},0)}else{if(!F||p||t)return;g(!0);try{await e(F),f("")}catch(z){console.error("Failed to send message:",z),kt.error("Failed to send message",{description:z instanceof Error?z.message:"Check radio connection"});return}finally{g(!1)}setTimeout(()=>{var z;return(z=x.current)==null?void 0:z.focus()},0)}},[u,p,t,e,i]),T=R.useCallback(N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),C(N))},[C]),E=i?!0:u.trim().length>0,D=!i&&A!==null;return S.jsxs("form",{className:"px-4 py-3 border-t border-border flex flex-col gap-1",onSubmit:C,children:[S.jsxs("div",{className:"flex gap-2",children:[S.jsx(xn,{ref:x,type:i?"password":"text",autoComplete:i?"off":void 0,value:u,onChange:N=>f(N.target.value),onKeyDown:T,placeholder:r||(i?"Enter password for admin login...":"Type a message..."),disabled:t||p,className:"flex-1 min-w-0"}),S.jsx(yn,{type:"submit",disabled:t||p||!E,className:"flex-shrink-0",children:p?i?"Logging in...":"Sending...":i?u.trim()?"Log in with password":"Log in as guest/use repeater ACLs":"Send"})]}),D&&S.jsxs("div",{className:"flex items-center justify-end gap-2 text-xs",children:[S.jsxs("span",{className:vt("tabular-nums",_==="error"||_==="danger"?"text-red-500 font-medium":_==="warning"?"text-yellow-500":"text-muted-foreground"),children:[u.length,"/",A.hardLimit,w<0&&` (${w})`]}),b&&S.jsxs("span",{className:vt(_==="error"?"text-red-500":"text-yellow-500"),children:[" ",b]})]})]})});function Yb(n){const e=x5(n),t=R.forwardRef((r,i)=>{const{children:s,...o}=r,a=R.Children.toArray(s),u=a.find(v5);if(u){const f=u.props.children,p=a.map(g=>g===u?R.Children.count(f)>1?R.Children.only(null):R.isValidElement(f)?f.props.children:null:g);return S.jsx(e,{...o,ref:i,children:R.isValidElement(f)?R.cloneElement(f,void 0,p):null})}return S.jsx(e,{...o,ref:i,children:s})});return t.displayName=`${n}.Slot`,t}function x5(n){const e=R.forwardRef((t,r)=>{const{children:i,...s}=t;if(R.isValidElement(i)){const o=b5(i),a=A5(s,i.props);return i.type!==R.Fragment&&(a.ref=r?Nh(r,o):o),R.cloneElement(i,a)}return R.Children.count(i)>1?R.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var y5=Symbol("radix.slottable");function v5(n){return R.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===y5}function A5(n,e){const t={...e};for(const r in e){const i=n[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?t[r]=(...a)=>{const u=s(...a);return i(...a),u}:i&&(t[r]=i):r==="style"?t[r]={...i,...s}:r==="className"&&(t[r]=[i,s].filter(Boolean).join(" "))}return{...n,...t}}function b5(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function w5(n){const e=n+"CollectionProvider",[t,r]=Lh(e),[i,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=b=>{const{scope:w,children:C}=b,T=Be.useRef(null),E=Be.useRef(new Map).current;return S.jsx(i,{scope:w,itemMap:E,collectionRef:T,children:C})};o.displayName=e;const a=n+"CollectionSlot",u=Yb(a),f=Be.forwardRef((b,w)=>{const{scope:C,children:T}=b,E=s(a,C),D=_i(w,E.collectionRef);return S.jsx(u,{ref:D,children:T})});f.displayName=a;const p=n+"CollectionItemSlot",g="data-radix-collection-item",x=Yb(p),A=Be.forwardRef((b,w)=>{const{scope:C,children:T,...E}=b,D=Be.useRef(null),N=_i(w,D),F=s(p,C);return Be.useEffect(()=>(F.itemMap.set(D,{ref:D,...E}),()=>void F.itemMap.delete(D))),S.jsx(x,{[g]:"",ref:N,children:T})});A.displayName=p;function _(b){const w=s(n+"CollectionConsumer",b);return Be.useCallback(()=>{const T=w.collectionRef.current;if(!T)return[];const E=Array.from(T.querySelectorAll(`[${g}]`));return Array.from(w.itemMap.values()).sort((F,z)=>E.indexOf(F.ref.current)-E.indexOf(z.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:o,Slot:f,ItemSlot:A},_,r]}var _5=R.createContext(void 0);function jS(n){const e=R.useContext(_5);return n||e||"ltr"}var sx="rovingFocusGroup.onEntryFocus",O5={bubbles:!1,cancelable:!0},Fh="RovingFocusGroup",[ry,QS,k5]=w5(Fh),[S5,HS]=Lh(Fh,[k5]),[C5,T5]=S5(Fh),WS=R.forwardRef((n,e)=>S.jsx(ry.Provider,{scope:n.__scopeRovingFocusGroup,children:S.jsx(ry.Slot,{scope:n.__scopeRovingFocusGroup,children:S.jsx(E5,{...n,ref:e})})}));WS.displayName=Fh;var E5=R.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:u,onEntryFocus:f,preventScrollOnEntryFocus:p=!1,...g}=n,x=R.useRef(null),A=_i(e,x),_=jS(s),[b,w]=Fp({prop:o,defaultProp:a??null,onChange:u,caller:Fh}),[C,T]=R.useState(!1),E=wc(f),D=QS(t),N=R.useRef(!1),[F,z]=R.useState(0);return R.useEffect(()=>{const I=x.current;if(I)return I.addEventListener(sx,E),()=>I.removeEventListener(sx,E)},[E]),S.jsx(C5,{scope:t,orientation:r,dir:_,loop:i,currentTabStopId:b,onItemFocus:R.useCallback(I=>w(I),[w]),onItemShiftTab:R.useCallback(()=>T(!0),[]),onFocusableItemAdd:R.useCallback(()=>z(I=>I+1),[]),onFocusableItemRemove:R.useCallback(()=>z(I=>I-1),[]),children:S.jsx(Vn.div,{tabIndex:C||F===0?-1:0,"data-orientation":r,...g,ref:A,style:{outline:"none",...n.style},onMouseDown:In(n.onMouseDown,()=>{N.current=!0}),onFocus:In(n.onFocus,I=>{const K=!N.current;if(I.target===I.currentTarget&&K&&!C){const W=new CustomEvent(sx,O5);if(I.currentTarget.dispatchEvent(W),!W.defaultPrevented){const U=D().filter(Z=>Z.focusable),X=U.find(Z=>Z.active),$=U.find(Z=>Z.id===b),le=[X,$,...U].filter(Boolean).map(Z=>Z.ref.current);$S(le,p)}}N.current=!1}),onBlur:In(n.onBlur,()=>T(!1))})})}),qS="RovingFocusGroupItem",VS=R.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:i=!1,tabStopId:s,children:o,...a}=n,u=ih(),f=s||u,p=T5(qS,t),g=p.currentTabStopId===f,x=QS(t),{onFocusableItemAdd:A,onFocusableItemRemove:_,currentTabStopId:b}=p;return R.useEffect(()=>{if(r)return A(),()=>_()},[r,A,_]),S.jsx(ry.ItemSlot,{scope:t,id:f,focusable:r,active:i,children:S.jsx(Vn.span,{tabIndex:g?0:-1,"data-orientation":p.orientation,...a,ref:e,onMouseDown:In(n.onMouseDown,w=>{r?p.onItemFocus(f):w.preventDefault()}),onFocus:In(n.onFocus,()=>p.onItemFocus(f)),onKeyDown:In(n.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){p.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const C=R5(w,p.orientation,p.dir);if(C!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let E=x().filter(D=>D.focusable).map(D=>D.ref.current);if(C==="last")E.reverse();else if(C==="prev"||C==="next"){C==="prev"&&E.reverse();const D=E.indexOf(w.currentTarget);E=p.loop?D5(E,D+1):E.slice(D+1)}setTimeout(()=>$S(E))}}),children:typeof o=="function"?o({isCurrentTabStop:g,hasTabStop:b!=null}):o})})});VS.displayName=qS;var P5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function B5(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function R5(n,e,t){const r=B5(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return P5[r]}function $S(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function D5(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var M5=WS,N5=VS,Zp="Tabs",[L5]=Lh(Zp,[HS]),US=HS(),[F5,_v]=L5(Zp),ZS=R.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,onValueChange:i,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:u="automatic",...f}=n,p=jS(a),[g,x]=Fp({prop:r,onChange:i,defaultProp:s??"",caller:Zp});return S.jsx(F5,{scope:t,baseId:ih(),value:g,onValueChange:x,orientation:o,dir:p,activationMode:u,children:S.jsx(Vn.div,{dir:p,"data-orientation":o,...f,ref:e})})});ZS.displayName=Zp;var GS="TabsList",XS=R.forwardRef((n,e)=>{const{__scopeTabs:t,loop:r=!0,...i}=n,s=_v(GS,t),o=US(t);return S.jsx(M5,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:r,children:S.jsx(Vn.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:e})})});XS.displayName=GS;var KS="TabsTrigger",YS=R.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,disabled:i=!1,...s}=n,o=_v(KS,t),a=US(t),u=t2(o.baseId,r),f=n2(o.baseId,r),p=r===o.value;return S.jsx(N5,{asChild:!0,...a,focusable:!i,active:p,children:S.jsx(Vn.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":f,"data-state":p?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...s,ref:e,onMouseDown:In(n.onMouseDown,g=>{!i&&g.button===0&&g.ctrlKey===!1?o.onValueChange(r):g.preventDefault()}),onKeyDown:In(n.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&o.onValueChange(r)}),onFocus:In(n.onFocus,()=>{const g=o.activationMode!=="manual";!p&&!i&&g&&o.onValueChange(r)})})})});YS.displayName=KS;var JS="TabsContent",e2=R.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,forceMount:i,children:s,...o}=n,a=_v(JS,t),u=t2(a.baseId,r),f=n2(a.baseId,r),p=r===a.value,g=R.useRef(p);return R.useEffect(()=>{const x=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(x)},[]),S.jsx(Nc,{present:i||p,children:({present:x})=>S.jsx(Vn.div,{"data-state":p?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":u,hidden:!x,id:f,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:g.current?"0s":void 0},children:x&&s})})});e2.displayName=JS;function t2(n,e){return`${n}-trigger-${e}`}function n2(n,e){return`${n}-content-${e}`}var I5=ZS,r2=XS,i2=YS,s2=e2;const Ov=I5,Gp=R.forwardRef(({className:n,...e},t)=>S.jsx(r2,{ref:t,className:vt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...e}));Gp.displayName=r2.displayName;const ni=R.forwardRef(({className:n,...e},t)=>S.jsx(i2,{ref:t,className:vt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",n),...e}));ni.displayName=i2.displayName;const ri=R.forwardRef(({className:n,...e},t)=>S.jsx(s2,{ref:t,className:vt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...e}));ri.displayName=s2.displayName;var z5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],j5=z5.reduce((n,e)=>{const t=gv(`Primitive.${e}`),r=R.forwardRef((i,s)=>{const{asChild:o,...a}=i,u=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),S.jsx(u,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{}),Q5="Label",o2=R.forwardRef((n,e)=>S.jsx(j5.label,{...n,ref:e,onMouseDown:t=>{var i;t.target.closest("button, input, select, textarea")||((i=n.onMouseDown)==null||i.call(n,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o2.displayName=Q5;var a2=o2;const H5=xv("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),$t=R.forwardRef(({className:n,...e},t)=>S.jsx(a2,{ref:t,className:vt(H5(),n),...e}));$t.displayName=a2.displayName;function W5(n){const e=R.useRef({value:n,previous:n});return R.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}function q5(n){const[e,t]=R.useState(void 0);return bc(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const u=s.borderBoxSize,f=Array.isArray(u)?u[0]:u;o=f.inlineSize,a=f.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var Xp="Checkbox",[V5]=Lh(Xp),[$5,kv]=V5(Xp);function U5(n){const{__scopeCheckbox:e,checked:t,children:r,defaultChecked:i,disabled:s,form:o,name:a,onCheckedChange:u,required:f,value:p="on",internal_do_not_use_render:g}=n,[x,A]=Fp({prop:t,defaultProp:i??!1,onChange:u,caller:Xp}),[_,b]=R.useState(null),[w,C]=R.useState(null),T=R.useRef(!1),E=_?!!o||!!_.closest("form"):!0,D={checked:x,disabled:s,setChecked:A,control:_,setControl:b,name:a,form:o,value:p,hasConsumerStoppedPropagationRef:T,required:f,defaultChecked:Yo(i)?!1:i,isFormControl:E,bubbleInput:w,setBubbleInput:C};return S.jsx($5,{scope:e,...D,children:Z5(g)?g(D):r})}var l2="CheckboxTrigger",c2=R.forwardRef(({__scopeCheckbox:n,onKeyDown:e,onClick:t,...r},i)=>{const{control:s,value:o,disabled:a,checked:u,required:f,setControl:p,setChecked:g,hasConsumerStoppedPropagationRef:x,isFormControl:A,bubbleInput:_}=kv(l2,n),b=_i(i,p),w=R.useRef(u);return R.useEffect(()=>{const C=s==null?void 0:s.form;if(C){const T=()=>g(w.current);return C.addEventListener("reset",T),()=>C.removeEventListener("reset",T)}},[s,g]),S.jsx(Vn.button,{type:"button",role:"checkbox","aria-checked":Yo(u)?"mixed":u,"aria-required":f,"data-state":p2(u),"data-disabled":a?"":void 0,disabled:a,value:o,...r,ref:b,onKeyDown:In(e,C=>{C.key==="Enter"&&C.preventDefault()}),onClick:In(t,C=>{g(T=>Yo(T)?!0:!T),_&&A&&(x.current=C.isPropagationStopped(),x.current||C.stopPropagation())})})});c2.displayName=l2;var Sv=R.forwardRef((n,e)=>{const{__scopeCheckbox:t,name:r,checked:i,defaultChecked:s,required:o,disabled:a,value:u,onCheckedChange:f,form:p,...g}=n;return S.jsx(U5,{__scopeCheckbox:t,checked:i,defaultChecked:s,disabled:a,required:o,onCheckedChange:f,name:r,form:p,value:u,internal_do_not_use_render:({isFormControl:x})=>S.jsxs(S.Fragment,{children:[S.jsx(c2,{...g,ref:e,__scopeCheckbox:t}),x&&S.jsx(d2,{__scopeCheckbox:t})]})})});Sv.displayName=Xp;var u2="CheckboxIndicator",h2=R.forwardRef((n,e)=>{const{__scopeCheckbox:t,forceMount:r,...i}=n,s=kv(u2,t);return S.jsx(Nc,{present:r||Yo(s.checked)||s.checked===!0,children:S.jsx(Vn.span,{"data-state":p2(s.checked),"data-disabled":s.disabled?"":void 0,...i,ref:e,style:{pointerEvents:"none",...n.style}})})});h2.displayName=u2;var f2="CheckboxBubbleInput",d2=R.forwardRef(({__scopeCheckbox:n,...e},t)=>{const{control:r,hasConsumerStoppedPropagationRef:i,checked:s,defaultChecked:o,required:a,disabled:u,name:f,value:p,form:g,bubbleInput:x,setBubbleInput:A}=kv(f2,n),_=_i(t,A),b=W5(s),w=q5(r);R.useEffect(()=>{const T=x;if(!T)return;const E=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(E,"checked").set,F=!i.current;if(b!==s&&N){const z=new Event("click",{bubbles:F});T.indeterminate=Yo(s),N.call(T,Yo(s)?!1:s),T.dispatchEvent(z)}},[x,b,s,i]);const C=R.useRef(Yo(s)?!1:s);return S.jsx(Vn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??C.current,required:a,disabled:u,name:f,value:p,form:g,...e,tabIndex:-1,ref:_,style:{...e.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});d2.displayName=f2;function Z5(n){return typeof n=="function"}function Yo(n){return n==="indeterminate"}function p2(n){return Yo(n)?"indeterminate":n?"checked":"unchecked"}const eo=R.forwardRef(({className:n,...e},t)=>S.jsx(Sv,{ref:t,className:vt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n),...e,children:S.jsx(h2,{className:vt("flex items-center justify-center text-current"),children:S.jsx(e4,{className:"h-4 w-4"})})}));eo.displayName=Sv.displayName;function G5({open:n,contacts:e,undecryptedCount:t,onClose:r,onSelectConversation:i,onCreateContact:s,onCreateChannel:o,onCreateHashtagChannel:a}){const[u,f]=R.useState("existing"),[p,g]=R.useState(""),[x,A]=R.useState(""),[_,b]=R.useState(""),[w,C]=R.useState(!1),[T,E]=R.useState(!1),[D,N]=R.useState(""),[F,z]=R.useState(!1),I=R.useRef(null),K=async()=>{N(""),z(!0);try{if(u==="new-contact"){if(!p.trim()||!x.trim()){N("Name and public key are required");return}await s(p.trim(),x.trim(),w)}else if(u==="new-room"){if(!p.trim()||!_.trim()){N("Room name and key are required");return}await o(p.trim(),_.trim(),w)}else if(u==="hashtag"){const $=p.trim(),ee=W($);if(ee){N(ee);return}const le=T?$:$.toLowerCase();await a(`#${le}`,w)}r()}catch($){N($ instanceof Error?$.message:"Failed to create")}finally{z(!1)}},W=$=>$?/^[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*$/.test($)?null:"Use letters, numbers, and single dashes (no leading/trailing dashes)":"Channel name is required",U=async()=>{var le;N("");const $=p.trim(),ee=W($);if(ee){N(ee);return}z(!0);try{const Z=T?$:$.toLowerCase();await a(`#${Z}`,w),g(""),(le=I.current)==null||le.focus()}catch(Z){N(Z instanceof Error?Z.message:"Failed to create")}finally{z(!1)}},X=u!=="existing"&&t>0;return S.jsx(bv,{open:n,onOpenChange:$=>!$&&r(),children:S.jsxs(qp,{className:"sm:max-w-[500px]",children:[S.jsxs(Vp,{children:[S.jsx($p,{children:"New Conversation"}),S.jsxs(Up,{className:"sr-only",children:[u==="existing"&&"Select an existing contact to start a conversation",u==="new-contact"&&"Add a new contact by entering their name and public key",u==="new-room"&&"Create a private room with a shared encryption key",u==="hashtag"&&"Join a public hashtag channel"]})]}),S.jsxs(Ov,{value:u,onValueChange:$=>f($),className:"w-full",children:[S.jsxs(Gp,{className:"grid w-full grid-cols-4",children:[S.jsx(ni,{value:"existing",children:"Existing"}),S.jsx(ni,{value:"new-contact",children:"Contact"}),S.jsx(ni,{value:"new-room",children:"Room"}),S.jsx(ni,{value:"hashtag",children:"Hashtag"})]}),S.jsx(ri,{value:"existing",className:"mt-4",children:S.jsx("div",{className:"max-h-[300px] overflow-y-auto rounded-md border",children:e.length===0?S.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No contacts available"}):e.map($=>S.jsx("div",{className:"cursor-pointer px-4 py-2 hover:bg-accent",onClick:()=>{i({type:"contact",id:$.public_key,name:ro($.name,$.public_key)}),r()},children:ro($.name,$.public_key)},$.public_key))})}),S.jsxs(ri,{value:"new-contact",className:"mt-4 space-y-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"contact-name",children:"Name"}),S.jsx(xn,{id:"contact-name",value:p,onChange:$=>g($.target.value),placeholder:"Contact name"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"contact-key",children:"Public Key"}),S.jsx(xn,{id:"contact-key",value:x,onChange:$=>A($.target.value),placeholder:"64-character hex public key"})]})]}),S.jsxs(ri,{value:"new-room",className:"mt-4 space-y-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"room-name",children:"Room Name"}),S.jsx(xn,{id:"room-name",value:p,onChange:$=>g($.target.value),placeholder:"Room name"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"room-key",children:"Room Key"}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx(xn,{id:"room-key",value:_,onChange:$=>b($.target.value),placeholder:"Pre-shared key (hex)",className:"flex-1"}),S.jsx(yn,{type:"button",variant:"outline",size:"icon",onClick:()=>{const $=new Uint8Array(16);crypto.getRandomValues($);const ee=Array.from($).map(le=>le.toString(16).padStart(2,"0")).join("");b(ee)},title:"Generate random key",children:""})]})]})]}),S.jsxs(ri,{value:"hashtag",className:"mt-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"hashtag-name",children:"Hashtag Channel"}),S.jsxs("div",{className:"flex items-center gap-1",children:[S.jsx("span",{className:"text-sm text-muted-foreground",children:"#"}),S.jsx(xn,{ref:I,id:"hashtag-name",value:p,onChange:$=>g($.target.value),placeholder:"channel-name",className:"flex-1"})]})]}),S.jsxs("div",{className:"mt-3 space-y-1",children:[S.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[S.jsx("input",{type:"checkbox",checked:T,onChange:$=>E($.target.checked),className:"w-4 h-4 rounded border-input accent-primary"}),S.jsx("span",{className:"text-sm",children:"Permit capitals in room key derivation"})]}),S.jsx("p",{className:"text-xs text-muted-foreground pl-7",children:"Not recommended; most companions normalize to lowercase"})]})]})]}),X&&S.jsxs("div",{className:"space-y-1",children:[S.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[S.jsxs($t,{htmlFor:"try-historical",className:"text-sm text-muted-foreground cursor-pointer",children:["Try decrypting ",t.toLocaleString()," stored packet",t!==1?"s":""]}),S.jsx(eo,{id:"try-historical",checked:w,onCheckedChange:$=>C($===!0)})]}),w&&S.jsx("p",{className:"text-xs text-muted-foreground text-right",children:"Messages will stream in as they decrypt in the background"})]}),D&&S.jsx("div",{className:"text-sm text-destructive",children:D}),S.jsxs(wv,{children:[S.jsx(yn,{variant:"outline",onClick:r,children:"Cancel"}),u==="hashtag"&&S.jsx(yn,{variant:"secondary",onClick:U,disabled:F,children:F?"Creating...":"Create & Add Another"}),u!=="existing"&&S.jsx(yn,{onClick:K,disabled:F,children:F?"Creating...":"Create"})]})]})})}function iy(){return iy=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},iy.apply(null,arguments)}function X5(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}let sy=[],m2=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?m2:sy).push(t=t+n[e])})();function K5(n){if(n<768)return!1;for(let e=0,t=sy.length;;){let r=e+t>>1;if(n<sy[r])t=r;else if(n>=m2[r])e=r+1;else return!0;if(e==t)return!1}}function Jb(n){return n>=127462&&n<=127487}const ew=8205;function Y5(n,e,t=!0,r=!0){return(t?g2:J5)(n,e,r)}function g2(n,e,t){if(e==n.length)return e;e&&x2(n.charCodeAt(e))&&y2(n.charCodeAt(e-1))&&e--;let r=ox(n,e);for(e+=tw(r);e<n.length;){let i=ox(n,e);if(r==ew||i==ew||t&&K5(i))e+=tw(i),r=i;else if(Jb(i)){let s=0,o=e-2;for(;o>=0&&Jb(ox(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function J5(n,e,t){for(;e>0;){let r=g2(n,e-2,t);if(r<e)return r;e--}return 0}function ox(n,e){let t=n.charCodeAt(e);if(!y2(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return x2(r)?(t-55296<<10)+(r-56320)+65536:t}function x2(n){return n>=56320&&n<57344}function y2(n){return n>=55296&&n<56320}function tw(n){return n<65536?1:2}class Lt{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=_c(this,e,t);let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(t,this.length,i,1),ms.from(i,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=_c(this,e,t);let r=[];return this.decompose(e,t,r,0),ms.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new sh(this),s=new sh(e);for(let o=t,a=t;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(a+=i.value.length,i.done||a>=r)return!0}}iter(e=1){return new sh(this,e)}iterRange(e,t=this.length){return new v2(this,e,t)}iterLines(e,t){let r;if(e==null)r=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new A2(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Lt.empty:e.length<=32?new bn(e):ms.from(bn.split(e,[]))}}class bn extends Lt{constructor(e,t=e3(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.text[s],a=i+o.length;if((t?r:a)>=e)return new t3(i,a,r,o);i=a+1,r++}}decompose(e,t,r,i){let s=e<=0&&t>=this.length?this:new bn(nw(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let o=r.pop(),a=e0(s.text,o.text.slice(),0,s.length);if(a.length<=32)r.push(new bn(a,o.length+s.length));else{let u=a.length>>1;r.push(new bn(a.slice(0,u)),new bn(a.slice(u)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof bn))return super.replace(e,t,r);[e,t]=_c(this,e,t);let i=e0(this.text,e0(r.text,nw(this.text,0,e)),t),s=this.length+r.length-(t-e);return i.length<=32?new bn(i,s):ms.from(bn.split(i,[]),s)}sliceString(e,t=this.length,r=`
`){[e,t]=_c(this,e,t);let i="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let a=this.text[o],u=s+a.length;s>e&&o&&(i+=r),e<u&&t>s&&(i+=a.slice(Math.max(0,e-s),t-s)),s=u+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,r.length==32&&(t.push(new bn(r,i)),r=[],i=-1);return i>-1&&t.push(new bn(r,i)),t}}class ms extends Lt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.children[s],a=i+o.length,u=r+o.lines-1;if((t?u:a)>=e)return o.lineInner(e,t,r,i);i=a+1,r=u+1}}decompose(e,t,r,i){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let a=this.children[s],u=o+a.length;if(e<=u&&t>=o){let f=i&((o<=e?1:0)|(u>=t?2:0));o>=e&&u<=t&&!f?r.push(a):a.decompose(e-o,t-o,r,f)}o=u+1}}replace(e,t,r){if([e,t]=_c(this,e,t),r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],a=s+o.length;if(e>=s&&t<=a){let u=o.replace(e-s,t-s,r),f=this.lines-o.lines+u.lines;if(u.lines<f>>4&&u.lines>f>>6){let p=this.children.slice();return p[i]=u,new ms(p,this.length-(t-e)+r.length)}return super.replace(s,a,u)}s=a+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r=`
`){[e,t]=_c(this,e,t);let i="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let a=this.children[s],u=o+a.length;o>e&&s&&(i+=r),e<u&&t>o&&(i+=a.sliceString(e-o,t-o,r)),o=u+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof ms))return 0;let r=0,[i,s,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==o||s==a)return r;let u=this.children[i],f=e.children[s];if(u!=f)return r+u.scanIdentical(f,t);r+=u.length+1}}static from(e,t=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let A of e)r+=A.lines;if(r<32){let A=[];for(let _ of e)_.flatten(A);return new bn(A,t)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,a=[],u=0,f=-1,p=[];function g(A){let _;if(A.lines>s&&A instanceof ms)for(let b of A.children)g(b);else A.lines>o&&(u>o||!u)?(x(),a.push(A)):A instanceof bn&&u&&(_=p[p.length-1])instanceof bn&&A.lines+_.lines<=32?(u+=A.lines,f+=A.length+1,p[p.length-1]=new bn(_.text.concat(A.text),_.length+1+A.length)):(u+A.lines>i&&x(),u+=A.lines,f+=A.length+1,p.push(A))}function x(){u!=0&&(a.push(p.length==1?p[0]:ms.from(p,f)),f=-1,u=p.length=0)}for(let A of e)g(A);return x(),a.length==1?a[0]:new ms(a,t)}}Lt.empty=new bn([""],0);function e3(n){let e=-1;for(let t of n)e+=t.length+1;return e}function e0(n,e,t=0,r=1e9){for(let i=0,s=0,o=!0;s<n.length&&i<=r;s++){let a=n[s],u=i+a.length;u>=t&&(u>r&&(a=a.slice(0,r-i)),i<t&&(a=a.slice(t-i)),o?(e[e.length-1]+=a,o=!1):e.push(a)),i=u+1}return e}function nw(n,e,t){return e0(n,[""],e,t)}class sh{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof bn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,a=i instanceof bn?i.text.length:i.children.length;if(o==(t>0?a:0)){if(r==0)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[r]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof bn){let u=i.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,u.length>Math.max(0,e))return this.value=e==0?u:t>0?u.slice(e):u.slice(0,u.length-e),this;e-=u.length}else{let u=i.children[o+(t<0?-1:0)];e>u.length?(e-=u.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(u),this.offsets.push(t>0?1:(u instanceof bn?u.text.length:u.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class v2{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new sh(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=r?i:t<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class A2{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Lt.prototype[Symbol.iterator]=function(){return this.iter()},sh.prototype[Symbol.iterator]=v2.prototype[Symbol.iterator]=A2.prototype[Symbol.iterator]=function(){return this});class t3{constructor(e,t,r,i){this.from=e,this.to=t,this.number=r,this.text=i}get length(){return this.to-this.from}}function _c(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Fn(n,e,t=!0,r=!0){return Y5(n,e,t,r)}function n3(n){return n>=56320&&n<57344}function r3(n){return n>=55296&&n<56320}function Mr(n,e){let t=n.charCodeAt(e);if(!r3(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return n3(r)?(t-55296<<10)+(r-56320)+65536:t}function Cv(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function gs(n){return n<65536?1:2}const oy=/\r\n?|\n/;var er=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(er||(er={}));class bs{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,i=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,t=!1){ay(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];i<0?e.push(r,i):e.push(i,r)}return new bs(e)}composeDesc(e){return this.empty?e:e.empty?this:b2(this,e)}mapDesc(e,t=!1){return e.empty?this:ly(this,e,t)}mapPos(e,t=-1,r=er.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],u=this.sections[o++],f=i+a;if(u<0){if(f>e)return s+(e-i);s+=a}else{if(r!=er.Simple&&f>=e&&(r==er.TrackDel&&i<e&&f>e||r==er.TrackBefore&&i<e||r==er.TrackAfter&&f>e))return null;if(f>e||f==e&&t<0&&!a)return e==i||t<0?s:s+u;s+=u}i=f}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let r=0,i=0;r<this.sections.length&&i<=t;){let s=this.sections[r++],o=this.sections[r++],a=i+s;if(o>=0&&i<=t&&a>=e)return i<e&&a>t?"cover":!0;i=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bs(e)}static create(e){return new bs(e)}}class Ln extends bs{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return ay(this,(t,r,i,s,o)=>e=e.replace(i,i+(r-t),o),!1),e}mapDesc(e,t=!1){return ly(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let i=0,s=0;i<t.length;i+=2){let o=t[i],a=t[i+1];if(a>=0){t[i]=a,t[i+1]=o;let u=i>>1;for(;r.length<u;)r.push(Lt.empty);r.push(o?e.slice(s,s+o):Lt.empty)}s+=o}return new Ln(t,r)}compose(e){return this.empty?e:e.empty?this:b2(this,e,!0)}map(e,t=!1){return e.empty?this:ly(this,e,t,!0)}iterChanges(e,t=!1){ay(this,e,t)}get desc(){return bs.create(this.sections)}filter(e){let t=[],r=[],i=[],s=new dh(this);e:for(let o=0,a=0;;){let u=o==e.length?1e9:e[o++];for(;a<u||a==u&&s.len==0;){if(s.done)break e;let p=Math.min(s.len,u-a);hr(i,p,-1);let g=s.ins==-1?-1:s.off==0?s.ins:0;hr(t,p,g),g>0&&Xo(r,t,s.text),s.forward(p),a+=p}let f=e[o++];for(;a<f;){if(s.done)break e;let p=Math.min(s.len,f-a);hr(t,p,-1),hr(i,p,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(p),a+=p}}return{changes:new Ln(t,r),filtered:bs.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],i=this.sections[t+1];i<0?e.push(r):i==0?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let i=[],s=[],o=0,a=null;function u(p=!1){if(!p&&!i.length)return;o<t&&hr(i,t-o,-1);let g=new Ln(i,s);a=a?a.compose(g.map(a)):g,i=[],s=[],o=0}function f(p){if(Array.isArray(p))for(let g of p)f(g);else if(p instanceof Ln){if(p.length!=t)throw new RangeError(`Mismatched change set length (got ${p.length}, expected ${t})`);u(),a=a?a.compose(p.map(a)):p}else{let{from:g,to:x=g,insert:A}=p;if(g>x||g<0||x>t)throw new RangeError(`Invalid change range ${g} to ${x} (in doc of length ${t})`);let _=A?typeof A=="string"?Lt.of(A.split(r||oy)):A:Lt.empty,b=_.length;if(g==x&&b==0)return;g<o&&u(),g>o&&hr(i,g-o,-1),hr(i,x-g,b),Xo(s,i,_),o=x}}return f(e),u(!a),a}static empty(e){return new Ln(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;r.length<i;)r.push(Lt.empty);r[i]=Lt.of(s.slice(1)),t.push(s[0],r[i].length)}}}return new Ln(t,r)}static createSet(e,t){return new Ln(e,t)}}function hr(n,e,t,r=!1){if(e==0&&t<=0)return;let i=n.length-2;i>=0&&t<=0&&t==n[i+1]?n[i]+=e:i>=0&&e==0&&n[i]==0?n[i+1]+=t:r?(n[i]+=e,n[i+1]+=t):n.push(e,t)}function Xo(n,e,t){if(t.length==0)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(Lt.empty);n.push(t)}}function ay(n,e,t){let r=n.inserted;for(let i=0,s=0,o=0;o<n.sections.length;){let a=n.sections[o++],u=n.sections[o++];if(u<0)i+=a,s+=a;else{let f=i,p=s,g=Lt.empty;for(;f+=a,p+=u,u&&r&&(g=g.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)a=n.sections[o++],u=n.sections[o++];e(i,f,s,p,g),i=f,s=p}}}function ly(n,e,t,r=!1){let i=[],s=r?[]:null,o=new dh(n),a=new dh(e);for(let u=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let f=Math.min(o.len,a.len);hr(i,f,-1),o.forward(f),a.forward(f)}else if(a.ins>=0&&(o.ins<0||u==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!t))){let f=a.len;for(hr(i,a.ins,-1);f;){let p=Math.min(o.len,f);o.ins>=0&&u<o.i&&o.len<=p&&(hr(i,0,o.ins),s&&Xo(s,i,o.text),u=o.i),o.forward(p),f-=p}a.next()}else if(o.ins>=0){let f=0,p=o.len;for(;p;)if(a.ins==-1){let g=Math.min(p,a.len);f+=g,p-=g,a.forward(g)}else if(a.ins==0&&a.len<p)p-=a.len,a.next();else break;hr(i,f,u<o.i?o.ins:0),s&&u<o.i&&Xo(s,i,o.text),u=o.i,o.forward(o.len-p)}else{if(o.done&&a.done)return s?Ln.createSet(i,s):bs.create(i);throw new Error("Mismatched change set lengths")}}}function b2(n,e,t=!1){let r=[],i=t?[]:null,s=new dh(n),o=new dh(e);for(let a=!1;;){if(s.done&&o.done)return i?Ln.createSet(r,i):bs.create(r);if(s.ins==0)hr(r,s.len,0,a),s.next();else if(o.len==0&&!o.done)hr(r,0,o.ins,a),i&&Xo(i,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let u=Math.min(s.len2,o.len),f=r.length;if(s.ins==-1){let p=o.ins==-1?-1:o.off?0:o.ins;hr(r,u,p,a),i&&p&&Xo(i,r,o.text)}else o.ins==-1?(hr(r,s.off?0:s.len,u,a),i&&Xo(i,r,s.textBit(u))):(hr(r,s.off?0:s.len,o.off?0:o.ins,a),i&&!o.off&&Xo(i,r,o.text));a=(s.ins>u||o.ins>=0&&o.len>u)&&(a||r.length>f),s.forward2(u),o.forward(u)}}}}class dh{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Lt.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?Lt.empty:t[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Xa{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new Xa(r,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return we.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return we.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return we.range(e.anchor,e.head)}static create(e,t,r){return new Xa(e,t,r)}}class we{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:we.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new we([this.main],0)}addRange(e,t=!0){return we.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,we.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new we(e.ranges.map(t=>Xa.fromJSON(t)),e.main)}static single(e,t=e){return new we([we.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return we.normalized(e.slice(),t);r=s.to}return new we(e,t)}static cursor(e,t=0,r,i){return Xa.create(e,e,(t==0?0:t<0?8:16)|(r==null?7:Math.min(6,r))|(i??16777215)<<6)}static range(e,t,r,i){let s=(r??16777215)<<6|(i==null?7:Math.min(6,i));return t<e?Xa.create(t,e,48|s):Xa.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let r=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,u=Math.max(s.to,o.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?we.range(u,a):we.range(a,u))}}return new we(e,t)}}function w2(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Tv=0;class je{constructor(e,t,r,i,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=i,this.id=Tv++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new je(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:Ev),!!e.static,e.enables)}of(e){return new t0([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new t0(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new t0(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function Ev(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class t0{constructor(e,t,r,i){this.dependencies=e,this.facet=t,this.type=r,this.value=i,this.id=Tv++}dynamicSlot(e){var t;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,u=!1,f=!1,p=[];for(let g of this.dependencies)g=="doc"?u=!0:g=="selection"?f=!0:(((t=e[g.id])!==null&&t!==void 0?t:1)&1)==0&&p.push(e[g.id]);return{create(g){return g.values[o]=r(g),1},update(g,x){if(u&&x.docChanged||f&&(x.docChanged||x.selection)||cy(g,p)){let A=r(g);if(a?!rw(A,g.values[o],i):!i(A,g.values[o]))return g.values[o]=A,1}return 0},reconfigure:(g,x)=>{let A,_=x.config.address[s];if(_!=null){let b=rp(x,_);if(this.dependencies.every(w=>w instanceof je?x.facet(w)===g.facet(w):w instanceof $n?x.field(w,!1)==g.field(w,!1):!0)||(a?rw(A=r(g),b,i):i(A=r(g),b)))return g.values[o]=b,0}else A=r(g);return g.values[o]=A,1}}}}function rw(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function cy(n,e){let t=!1;for(let r of e)oh(n,r)&1&&(t=!0);return t}function i3(n,e,t){let r=t.map(u=>n[u.id]),i=t.map(u=>u.type),s=r.filter(u=>!(u&1)),o=n[e.id]>>1;function a(u){let f=[];for(let p=0;p<r.length;p++){let g=rp(u,r[p]);if(i[p]==2)for(let x of g)f.push(x);else f.push(g)}return e.combine(f)}return{create(u){for(let f of r)oh(u,f);return u.values[o]=a(u),1},update(u,f){if(!cy(u,s))return 0;let p=a(u);return e.compare(p,u.values[o])?0:(u.values[o]=p,1)},reconfigure(u,f){let p=cy(u,r),g=f.config.facets[e.id],x=f.facet(e);if(g&&!p&&Ev(t,g))return u.values[o]=x,0;let A=a(u);return e.compare(A,x)?(u.values[o]=x,0):(u.values[o]=A,1)}}}const wd=je.define({static:!0});class $n{constructor(e,t,r,i,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new $n(Tv++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(wd).find(r=>r.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,i)=>{let s=r.values[t],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,i)=>{let s=r.facet(wd),o=i.facet(wd),a;return(a=s.find(u=>u.field==this))&&a!=o.find(u=>u.field==this)?(r.values[t]=a.create(r),1):i.config.address[this.id]!=null?(r.values[t]=i.field(this),0):(r.values[t]=this.create(r),1)}}}init(e){return[this,wd.of({field:this,create:e})]}get extension(){return this}}const $a={lowest:4,low:3,default:2,high:1,highest:0};function Bu(n){return e=>new _2(e,n)}const la={highest:Bu($a.highest),high:Bu($a.high),default:Bu($a.default),low:Bu($a.low),lowest:Bu($a.lowest)};class _2{constructor(e,t){this.inner=e,this.prec=t}}class Kp{of(e){return new uy(this,e)}reconfigure(e){return Kp.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class uy{constructor(e,t){this.compartment=e,this.inner=t}}class np{constructor(e,t,r,i,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let i=[],s=Object.create(null),o=new Map;for(let x of s3(e,t,o))x instanceof $n?i.push(x):(s[x.facet.id]||(s[x.facet.id]=[])).push(x);let a=Object.create(null),u=[],f=[];for(let x of i)a[x.id]=f.length<<1,f.push(A=>x.slot(A));let p=r==null?void 0:r.config.facets;for(let x in s){let A=s[x],_=A[0].facet,b=p&&p[x]||[];if(A.every(w=>w.type==0))if(a[_.id]=u.length<<1|1,Ev(b,A))u.push(r.facet(_));else{let w=_.combine(A.map(C=>C.value));u.push(r&&_.compare(w,r.facet(_))?r.facet(_):w)}else{for(let w of A)w.type==0?(a[w.id]=u.length<<1|1,u.push(w.value)):(a[w.id]=f.length<<1,f.push(C=>w.dynamicSlot(C)));a[_.id]=f.length<<1,f.push(w=>i3(w,_,A))}}let g=f.map(x=>x(a));return new np(e,o,g,a,u,s)}}function s3(n,e,t){let r=[[],[],[],[],[]],i=new Map;function s(o,a){let u=i.get(o);if(u!=null){if(u<=a)return;let f=r[u].indexOf(o);f>-1&&r[u].splice(f,1),o instanceof uy&&t.delete(o.compartment)}if(i.set(o,a),Array.isArray(o))for(let f of o)s(f,a);else if(o instanceof uy){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(o.compartment)||o.inner;t.set(o.compartment,f),s(f,a)}else if(o instanceof _2)s(o.inner,o.prec);else if(o instanceof $n)r[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof t0)r[a].push(o),o.facet.extensions&&s(o.facet.extensions,$a.default);else{let f=o.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(f,a)}}return s(n,$a.default),r.reduce((o,a)=>o.concat(a))}function oh(n,e){if(e&1)return 2;let t=e>>1,r=n.status[t];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;n.status[t]=4;let i=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|i}function rp(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const O2=je.define(),hy=je.define({combine:n=>n.some(e=>e),static:!0}),k2=je.define({combine:n=>n.length?n[0]:void 0,static:!0}),S2=je.define(),C2=je.define(),T2=je.define(),E2=je.define({combine:n=>n.length?n[0]:!1});class _s{constructor(e,t){this.type=e,this.value=t}static define(){return new o3}}class o3{of(e){return new _s(this,e)}}class a3{constructor(e){this.map=e}of(e){return new ft(this,e)}}class ft{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ft(this.type,t)}is(e){return this.type==e}static define(e={}){return new a3(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let i of e){let s=i.map(t);s&&r.push(s)}return r}}ft.reconfigure=ft.define();ft.appendConfig=ft.define();class Cn{constructor(e,t,r,i,s,o){this.startState=e,this.changes=t,this.selection=r,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&w2(r,t.newLength),s.some(a=>a.type==Cn.time)||(this.annotations=s.concat(Cn.time.of(Date.now())))}static create(e,t,r,i,s,o){return new Cn(e,t,r,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Cn.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Cn.time=_s.define();Cn.userEvent=_s.define();Cn.addToHistory=_s.define();Cn.remote=_s.define();function l3(n,e){let t=[];for(let r=0,i=0;;){let s,o;if(r<n.length&&(i==e.length||e[i]>=n[r]))s=n[r++],o=n[r++];else if(i<e.length)s=e[i++],o=e[i++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function P2(n,e,t){var r;let i,s,o;return t?(i=e.changes,s=Ln.empty(e.changes.length),o=n.changes.compose(e.changes)):(i=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(r=n.selection)===null||r===void 0?void 0:r.map(i),effects:ft.mapEffects(n.effects,i).concat(ft.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function fy(n,e,t){let r=e.selection,i=hc(e.annotations);return e.userEvent&&(i=i.concat(Cn.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ln?e.changes:Ln.of(e.changes||[],t,n.facet(k2)),selection:r&&(r instanceof we?r:we.single(r.anchor,r.head)),effects:hc(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function B2(n,e,t){let r=fy(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;r=P2(r,fy(n,e[s],o?r.changes.newLength:n.doc.length),o)}let i=Cn.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return u3(t?c3(i):i)}function c3(n){let e=n.startState,t=!0;for(let i of e.facet(S2)){let s=i(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:l3(t,s))}if(t!==!0){let i,s;if(t===!1)s=n.changes.invertedDesc,i=Ln.empty(e.doc.length);else{let o=n.changes.filter(t);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Cn.create(e,i,n.selection&&n.selection.map(s),ft.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(C2);for(let i=r.length-1;i>=0;i--){let s=r[i](n);s instanceof Cn?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Cn?n=s[0]:n=B2(e,hc(s),!1)}return n}function u3(n){let e=n.startState,t=e.facet(T2),r=n;for(let i=t.length-1;i>=0;i--){let s=t[i](n);s&&Object.keys(s).length&&(r=P2(r,fy(e,s,n.changes.newLength),!0))}return r==n?n:Cn.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}const h3=[];function hc(n){return n==null?h3:Array.isArray(n)?n:[n]}var ln=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(ln||(ln={}));const f3=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let dy;try{dy=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function d3(n){if(dy)return dy.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||f3.test(t)))return!0}return!1}function p3(n){return e=>{if(!/\S/.test(e))return ln.Space;if(d3(e))return ln.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return ln.Word;return ln.Other}}class Rt{constructor(e,t,r,i,s,o){this.config=e,this.doc=t,this.selection=r,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)oh(this,a<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return}return oh(this,r),rp(this,r)}update(...e){return B2(this,e,!0)}applyTransaction(e){let t=this.config,{base:r,compartments:i}=t;for(let a of e.effects)a.is(Kp.reconfigure)?(t&&(i=new Map,t.compartments.forEach((u,f)=>i.set(f,u)),t=null),i.set(a.value.compartment,a.value.extension)):a.is(ft.reconfigure)?(t=null,r=a.value):a.is(ft.appendConfig)&&(t=null,r=hc(r).concat(a.value));let s;t?s=e.startState.values.slice():(t=np.resolve(r,i,this),s=new Rt(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(u,f)=>f.reconfigure(u,this),null).values);let o=e.startState.facet(hy)?e.newSelection:e.newSelection.asSingle();new Rt(t,e.newDoc,o,s,(a,u)=>u.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:we.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),i=this.changes(r.changes),s=[r.range],o=hc(r.effects);for(let a=1;a<t.ranges.length;a++){let u=e(t.ranges[a]),f=this.changes(u.changes),p=f.map(i);for(let x=0;x<a;x++)s[x]=s[x].map(p);let g=i.mapDesc(f,!0);s.push(u.range.map(g)),i=i.compose(p),o=ft.mapEffects(o,p).concat(ft.mapEffects(hc(u.effects),g))}return{changes:i,selection:we.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ln?e:Ln.of(e,this.doc.length,this.facet(Rt.lineSeparator))}toText(e){return Lt.of(e.split(this.facet(Rt.lineSeparator)||oy))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(oh(this,t),rp(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let i=e[r];i instanceof $n&&this.config.address[i.id]!=null&&(t[r]=i.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],a=e[s];i.push(o.init(u=>o.spec.fromJSON(a,u)))}}return Rt.create({doc:e.doc,selection:we.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=np.resolve(e.extensions||[],new Map),r=e.doc instanceof Lt?e.doc:Lt.of((e.doc||"").split(t.staticFacet(Rt.lineSeparator)||oy)),i=e.selection?e.selection instanceof we?e.selection:we.single(e.selection.anchor,e.selection.head):we.single(0);return w2(i,r.length),t.staticFacet(hy)||(i=i.asSingle()),new Rt(t,r,i,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Rt.tabSize)}get lineBreak(){return this.facet(Rt.lineSeparator)||`
`}get readOnly(){return this.facet(E2)}phrase(e,...t){for(let r of this.facet(Rt.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(r,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>t.length?r:t[s-1]})),e}languageDataAt(e,t,r=-1){let i=[];for(let s of this.facet(O2))for(let o of s(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return p3(t.length?t[0]:"")}wordAt(e){let{text:t,from:r,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,a=e-r;for(;o>0;){let u=Fn(t,o,!1);if(s(t.slice(u,o))!=ln.Word)break;o=u}for(;a<i;){let u=Fn(t,a);if(s(t.slice(a,u))!=ln.Word)break;a=u}return o==a?null:we.range(o+r,a+r)}}Rt.allowMultipleSelections=hy;Rt.tabSize=je.define({combine:n=>n.length?n[0]:4});Rt.lineSeparator=k2;Rt.readOnly=E2;Rt.phrases=je.define({compare(n,e){let t=Object.keys(n),r=Object.keys(e);return t.length==r.length&&t.every(i=>n[i]==e[i])}});Rt.languageData=O2;Rt.changeFilter=S2;Rt.transactionFilter=C2;Rt.transactionExtender=T2;Kp.reconfigure=ft.define();function Os(n,e,t={}){let r={};for(let i of n)for(let s of Object.keys(i)){let o=i[s],a=r[s];if(a===void 0)r[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(t,s))r[s]=t[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)r[i]===void 0&&(r[i]=e[i]);return r}class na{eq(e){return this==e}range(e,t=e){return py.create(e,t,this)}}na.prototype.startSide=na.prototype.endSide=0;na.prototype.point=!1;na.prototype.mapMode=er.TrackDel;function Pv(n,e){return n==e||n.constructor==e.constructor&&n.eq(e)}let py=class R2{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new R2(e,t,r)}};function my(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Bv{constructor(e,t,r,i){this.from=e,this.to=t,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,i=0){let s=r?this.to:this.from;for(let o=i,a=s.length;;){if(o==a)return o;let u=o+a>>1,f=s[u]-e||(r?this.value[u].endSide:this.value[u].startSide)-t;if(u==o)return f>=0?o:a;f>=0?a=u:o=u+1}}between(e,t,r,i){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let r=[],i=[],s=[],o=-1,a=-1;for(let u=0;u<this.value.length;u++){let f=this.value[u],p=this.from[u]+e,g=this.to[u]+e,x,A;if(p==g){let _=t.mapPos(p,f.startSide,f.mapMode);if(_==null||(x=A=_,f.startSide!=f.endSide&&(A=t.mapPos(p,f.endSide),A<x)))continue}else if(x=t.mapPos(p,f.startSide),A=t.mapPos(g,f.endSide),x>A||x==A&&f.startSide>0&&f.endSide<=0)continue;(A-x||f.endSide-f.startSide)<0||(o<0&&(o=x),f.point&&(a=Math.max(a,A-x)),r.push(f),i.push(x-o),s.push(A-o))}return{mapped:r.length?new Bv(i,s,r,a):null,pos:o}}}class Tt{constructor(e,t,r,i){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=i}static create(e,t,r,i){return new Tt(e,t,r,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(r&&(t=t.slice().sort(my)),this.isEmpty)return t.length?Tt.of(t):this;let a=new D2(this,null,-1).goto(0),u=0,f=[],p=new so;for(;a.value||u<t.length;)if(u<t.length&&(a.from-t[u].from||a.startSide-t[u].value.startSide)>=0){let g=t[u++];p.addInner(g.from,g.to,g.value)||f.push(g)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(u==t.length||this.chunkEnd(a.chunkIndex)<t[u].from)&&(!o||i>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&p.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||i>a.to||s<a.from||o(a.from,a.to,a.value))&&(p.addInner(a.from,a.to,a.value)||f.push(py.create(a.from,a.to,a.value))),a.next());return p.finishInner(this.nextLayer.isEmpty&&!f.length?Tt.empty:this.nextLayer.update({add:f,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],i=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],u=this.chunk[o],f=e.touchesRange(a,a+u.length);if(f===!1)i=Math.max(i,u.maxPoint),t.push(u),r.push(e.mapPos(a));else if(f===!0){let{mapped:p,pos:g}=u.map(a,e);p&&(i=Math.max(i,p.maxPoint),t.push(p),r.push(g))}}let s=this.nextLayer.map(e);return t.length==0?s:new Tt(r,t,s||Tt.empty,i)}between(e,t,r){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,r)===!1)return}this.nextLayer.between(e,t,r)}}iter(e=0){return ph.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return ph.from(e).goto(t)}static compare(e,t,r,i,s=-1){let o=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=s),a=t.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=s),u=iw(o,a,r),f=new Ru(o,u,s),p=new Ru(a,u,s);r.iterGaps((g,x,A)=>sw(f,g,p,x,A,i)),r.empty&&r.length==0&&sw(f,0,p,0,0,i)}static eq(e,t,r=0,i){i==null&&(i=999999999);let s=e.filter(p=>!p.isEmpty&&t.indexOf(p)<0),o=t.filter(p=>!p.isEmpty&&e.indexOf(p)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=iw(s,o),u=new Ru(s,a,0).goto(r),f=new Ru(o,a,0).goto(r);for(;;){if(u.to!=f.to||!gy(u.active,f.active)||u.point&&(!f.point||!Pv(u.point,f.point)))return!1;if(u.to>i)return!0;u.next(),f.next()}}static spans(e,t,r,i,s=-1){let o=new Ru(e,null,s).goto(t),a=t,u=o.openStart;for(;;){let f=Math.min(o.to,r);if(o.point){let p=o.activeForPoint(o.to),g=o.pointFrom<t?p.length+1:o.point.startSide<0?p.length:Math.min(p.length,u);i.point(a,f,o.point,p,g,o.pointRank),u=Math.min(o.openEnd(f),p.length)}else f>a&&(i.span(a,f,o.active,u),u=o.openEnd(f));if(o.to>r)return u+(o.point&&o.to>r?1:0);a=o.to,o.next()}}static of(e,t=!1){let r=new so;for(let i of e instanceof py?[e]:t?m3(e):e)r.add(i.from,i.to,i.value);return r.finish()}static join(e){if(!e.length)return Tt.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let i=e[r];i!=Tt.empty;i=i.nextLayer)t=new Tt(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}Tt.empty=new Tt([],[],null,-1);function m3(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(my(e,r)>0)return n.slice().sort(my);e=r}return n}Tt.empty.nextLayer=Tt.empty;class so{finishChunk(e){this.chunks.push(new Bv(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new so)).add(e,t,r)}addInner(e,t,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(Tt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Tt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function iw(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=r.get(s.chunk[o]);a!=null&&(t?t.mapPos(a):a)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(a,a+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class D2{constructor(e,t,r,i=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class ph{constructor(e){this.heap=e}static from(e,t=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new D2(o,t,r,s));return i.length==1?i[0]:new ph(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)ax(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)ax(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),ax(this.heap,0)}}}function ax(n,e){for(let t=n[e];;){let r=(e<<1)+1;if(r>=n.length)break;let i=n[r];if(r+1<n.length&&i.compare(n[r+1])>=0&&(i=n[r+1],r++),t.compare(i)<0)break;n[r]=t,n[e]=i,e=r}}class Ru{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ph.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){_d(this.active,e),_d(this.activeTo,e),_d(this.activeRank,e),this.minActive=ow(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||i-this.activeTo[t])>0;)t++;Od(this.active,t,r),Od(this.activeTo,t,i),Od(this.activeRank,t,s),e&&Od(e,t,this.cursor.from),this.minActive=ow(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),r&&_d(r,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let i=r.length-1;i>=0&&r[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function sw(n,e,t,r,i,s){n.goto(e),t.goto(r);let o=r+i,a=r,u=r-e,f=!!s.boundChange;for(let p=!1;;){let g=n.to+u-t.to,x=g||n.endSide-t.endSide,A=x<0?n.to+u:t.to,_=Math.min(A,o);if(n.point||t.point?(n.point&&t.point&&Pv(n.point,t.point)&&gy(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(a,_,n.point,t.point),p=!1):(p&&s.boundChange(a),_>a&&!gy(n.active,t.active)&&s.compareRange(a,_,n.active,t.active),f&&_<o&&(g||n.openEnd(A)!=t.openEnd(A))&&(p=!0)),A>o)break;a=A,x<=0&&n.next(),x>=0&&t.next()}}function gy(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!Pv(n[t],e[t]))return!1;return!0}function _d(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function Od(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function ow(n,e){let t=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||n[i].endSide-n[t].endSide)<0&&(t=i,r=e[i]);return t}function Lc(n,e,t=n.length){let r=0;for(let i=0;i<t&&i<n.length;)n.charCodeAt(i)==9?(r+=e-r%e,i++):(r++,i=Fn(n,i));return r}function xy(n,e,t,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==n.length)break;s+=n.charCodeAt(i)==9?t-s%t:1,i=Fn(n,i)}return r===!0?-1:n.length}const yy="",aw=typeof Symbol>"u"?"__"+yy:Symbol.for(yy),vy=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),lw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ra{constructor(e,t){this.rules=[];let{finish:r}=t||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,u,f){let p=[],g=/^@(\w+)\b/.exec(o[0]),x=g&&g[1]=="keyframes";if(g&&a==null)return u.push(o[0]+";");for(let A in a){let _=a[A];if(/&/.test(A))s(A.split(/,\s*/).map(b=>o.map(w=>b.replace(/&/,w))).reduce((b,w)=>b.concat(w)),_,u);else if(_&&typeof _=="object"){if(!g)throw new RangeError("The value of a property ("+A+") should be a primitive value.");s(i(A),_,p,x)}else _!=null&&p.push(A.replace(/_.*/,"").replace(/[A-Z]/g,b=>"-"+b.toLowerCase())+": "+_+";")}(p.length||x)&&u.push((r&&!g&&!f?o.map(r):o).join(", ")+" {"+p.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=lw[aw]||1;return lw[aw]=e+1,yy+e.toString(36)}static mount(e,t,r){let i=e[vy],s=r&&r.nonce;i?s&&i.setNonce(s):i=new g3(e,s),i.mount(Array.isArray(t)?t:[t],e)}}let cw=new Map;class g3{constructor(e,t){let r=e.ownerDocument||e,i=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=cw.get(r);if(s)return e[vy]=s;this.sheet=new i.CSSStyleSheet,cw.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[vy]=this}mount(e,t){let r=this.sheet,i=0,s=0;for(let o=0;o<e.length;o++){let a=e[o],u=this.modules.indexOf(a);if(u<s&&u>-1&&(this.modules.splice(u,1),s--,u=-1),u==-1){if(this.modules.splice(s++,0,a),r)for(let f=0;f<a.rules.length;f++)r.insertRule(a.rules[f],i++)}else{for(;s<u;)i+=this.modules[s++].rules.length;i+=a.rules.length,s++}}if(r)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let u=0;u<this.modules.length;u++)o+=this.modules[u].getRules()+`
`;this.styleTag.textContent=o;let a=t.head||t;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var ia={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},mh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},x3=typeof navigator<"u"&&/Mac/.test(navigator.platform),y3=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Jn=0;Jn<10;Jn++)ia[48+Jn]=ia[96+Jn]=String(Jn);for(var Jn=1;Jn<=24;Jn++)ia[Jn+111]="F"+Jn;for(var Jn=65;Jn<=90;Jn++)ia[Jn]=String.fromCharCode(Jn+32),mh[Jn]=String.fromCharCode(Jn);for(var lx in ia)mh.hasOwnProperty(lx)||(mh[lx]=ia[lx]);function v3(n){var e=x3&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||y3&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?mh:ia)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Vt(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=t[r];typeof i=="string"?n.setAttribute(r,i):i!=null&&(n[r]=i)}e++}for(;e<arguments.length;e++)M2(n,arguments[e]);return n}function M2(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)M2(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let Ar=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Ay=typeof document<"u"?document:{documentElement:{style:{}}};const by=/Edge\/(\d+)/.exec(Ar.userAgent),N2=/MSIE \d/.test(Ar.userAgent),wy=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ar.userAgent),Yp=!!(N2||wy||by),uw=!Yp&&/gecko\/(\d+)/i.test(Ar.userAgent),cx=!Yp&&/Chrome\/(\d+)/.exec(Ar.userAgent),A3="webkitFontSmoothing"in Ay.documentElement.style,_y=!Yp&&/Apple Computer/.test(Ar.vendor),hw=_y&&(/Mobile\/\w+/.test(Ar.userAgent)||Ar.maxTouchPoints>2);var He={mac:hw||/Mac/.test(Ar.platform),windows:/Win/.test(Ar.platform),linux:/Linux|X11/.test(Ar.platform),ie:Yp,ie_version:N2?Ay.documentMode||6:wy?+wy[1]:by?+by[1]:0,gecko:uw,gecko_version:uw?+(/Firefox\/(\d+)/.exec(Ar.userAgent)||[0,0])[1]:0,chrome:!!cx,chrome_version:cx?+cx[1]:0,ios:hw,android:/Android\b/.test(Ar.userAgent),webkit_version:A3?+(/\bAppleWebKit\/(\d+)/.exec(Ar.userAgent)||[0,0])[1]:0,safari:_y,safari_version:_y?+(/\bVersion\/(\d+(\.\d+)?)/.exec(Ar.userAgent)||[0,0])[1]:0,tabSize:Ay.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Rv(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const ip=Object.create(null);function Dv(n,e,t){if(n==e)return!0;n||(n=ip),e||(e=ip);let r=Object.keys(n),i=Object.keys(e);if(r.length-0!=i.length-0)return!1;for(let s of r)if(s!=t&&(i.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function b3(n,e){for(let t=n.attributes.length-1;t>=0;t--){let r=n.attributes[t].name;e[r]==null&&n.removeAttribute(r)}for(let t in e){let r=e[t];t=="style"?n.style.cssText=r:n.getAttribute(t)!=r&&n.setAttribute(t,r)}}function fw(n,e,t){let r=!1;if(e)for(let i in e)t&&i in t||(r=!0,i=="style"?n.style.cssText="":n.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(r=!0,i=="style"?n.style.cssText=t[i]:n.setAttribute(i,t[i]));return r}function w3(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];e[r.name]=r.value}return e}class $i{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var tr=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(tr||(tr={}));class Je extends na{constructor(e,t,r,i){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new Ih(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new rl(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,i;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=L2(e,t);r=(s?t?-3e8:-1:5e8)-1,i=(o?t?2e8:1:-6e8)+1}return new rl(e,r,i,t,e.widget||null,!0)}static line(e){return new zh(e)}static set(e,t=!1){return Tt.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Je.none=Tt.empty;class Ih extends Je{constructor(e){let{start:t,end:r}=L2(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?Rv(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||ip}eq(e){return this==e||e instanceof Ih&&this.tagName==e.tagName&&Dv(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Ih.prototype.point=!1;class zh extends Je{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof zh&&this.spec.class==e.spec.class&&Dv(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}zh.prototype.mapMode=er.TrackBefore;zh.prototype.point=!0;class rl extends Je{constructor(e,t,r,i,s,o){super(t,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?t<=0?er.TrackBefore:er.TrackAfter:er.TrackDel}get type(){return this.startSide!=this.endSide?tr.WidgetRange:this.startSide<=0?tr.WidgetBefore:tr.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof rl&&_3(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}rl.prototype.point=!0;function L2(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return t==null&&(t=n.inclusive),r==null&&(r=n.inclusive),{start:t??e,end:r??e}}function _3(n,e){return n==e||!!(n&&e&&n.compare(e))}function fc(n,e,t,r=0){let i=t.length-1;i>=0&&t[i]+r>=n?t[i]=Math.max(t[i],e):t.push(n,e)}class gh extends na{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof gh&&this.tagName==e.tagName&&Dv(this.attributes,e.attributes)}static create(e){return new gh(e.tagName,e.attributes||ip)}static set(e,t=!1){return Tt.of(e,t)}}gh.prototype.startSide=gh.prototype.endSide=-1;function Oc(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Oy(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function ah(n,e){if(!e.anchorNode)return!1;try{return Oy(n,e.anchorNode)}catch{return!1}}function lh(n){return n.nodeType==3?yh(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function ch(n,e,t,r){return t?dw(n,e,t,r,-1)||dw(n,e,t,r,1):!1}function sa(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function sp(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function dw(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:oo(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=sa(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=i<0?oo(n):0}else return!1}}function oo(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function xh(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function O3(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function F2(n,e){let t=e.width/n.offsetWidth,r=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-n.offsetHeight)<1)&&(r=1),{scaleX:t,scaleY:r}}function k3(n,e,t,r,i,s,o,a){let u=n.ownerDocument,f=u.defaultView||window;for(let p=n,g=!1;p&&!g;)if(p.nodeType==1){let x,A=p==u.body,_=1,b=1;if(A)x=O3(f);else{if(/^(fixed|sticky)$/.test(getComputedStyle(p).position)&&(g=!0),p.scrollHeight<=p.clientHeight&&p.scrollWidth<=p.clientWidth){p=p.assignedSlot||p.parentNode;continue}let T=p.getBoundingClientRect();({scaleX:_,scaleY:b}=F2(p,T)),x={left:T.left,right:T.left+p.clientWidth*_,top:T.top,bottom:T.top+p.clientHeight*b}}let w=0,C=0;if(i=="nearest")e.top<x.top?(C=e.top-(x.top+o),t>0&&e.bottom>x.bottom+C&&(C=e.bottom-x.bottom+o)):e.bottom>x.bottom&&(C=e.bottom-x.bottom+o,t<0&&e.top-C<x.top&&(C=e.top-(x.top+o)));else{let T=e.bottom-e.top,E=x.bottom-x.top;C=(i=="center"&&T<=E?e.top+T/2-E/2:i=="start"||i=="center"&&t<0?e.top-o:e.bottom-E+o)-x.top}if(r=="nearest"?e.left<x.left?(w=e.left-(x.left+s),t>0&&e.right>x.right+w&&(w=e.right-x.right+s)):e.right>x.right&&(w=e.right-x.right+s,t<0&&e.left<x.left+w&&(w=e.left-(x.left+s))):w=(r=="center"?e.left+(e.right-e.left)/2-(x.right-x.left)/2:r=="start"==a?e.left-s:e.right-(x.right-x.left)+s)-x.left,w||C)if(A)f.scrollBy(w,C);else{let T=0,E=0;if(C){let D=p.scrollTop;p.scrollTop+=C/b,E=(p.scrollTop-D)*b}if(w){let D=p.scrollLeft;p.scrollLeft+=w/_,T=(p.scrollLeft-D)*_}e={left:e.left-T,top:e.top-E,right:e.right-T,bottom:e.bottom-E},T&&Math.abs(T-w)<1&&(r="nearest"),E&&Math.abs(E-C)<1&&(i="nearest")}if(A)break;(e.top<x.top||e.bottom>x.bottom||e.left<x.left||e.right>x.right)&&(e={left:Math.max(e.left,x.left),right:Math.min(e.right,x.right),top:Math.max(e.top,x.top),bottom:Math.min(e.bottom,x.bottom)}),p=p.assignedSlot||p.parentNode}else if(p.nodeType==11)p=p.host;else break}function S3(n){let e=n.ownerDocument,t,r;for(let i=n.parentNode;i&&!(i==e.body||t&&r);)if(i.nodeType==1)!r&&i.scrollHeight>i.clientHeight&&(r=i),!t&&i.scrollWidth>i.clientWidth&&(t=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:t,y:r}}class C3{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?oo(t):0),r,Math.min(e.focusOffset,r?oo(r):0))}set(e,t,r,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=i}}let qa=null;He.safari&&He.safari_version>=26&&(qa=!1);function I2(n){if(n.setActive)return n.setActive();if(qa)return n.focus(qa);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(qa==null?{get preventScroll(){return qa={preventScroll:!0},!0}}:void 0),!qa){qa=!1;for(let t=0;t<e.length;){let r=e[t++],i=e[t++],s=e[t++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let pw;function yh(n,e,t=e){let r=pw||(pw=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function dc(n,e,t,r){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};r&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=r);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function T3(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function E3(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,oo(t));;)if(r){if(t.nodeType!=1)return!1;let i=t.childNodes[r-1];i.contentEditable=="false"?r--:(t=i,r=oo(t))}else{if(t==n)return!0;r=sa(t),t=t.parentNode}}function z2(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function j2(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r>0)return{node:t,offset:r};if(t.nodeType==1&&r>0){if(t.contentEditable=="false")return null;t=t.childNodes[r-1],r=oo(t)}else if(t.parentNode&&!sp(t))r=sa(t),t=t.parentNode;else return null}}function Q2(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r<t.nodeValue.length)return{node:t,offset:r};if(t.nodeType==1&&r<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[r],r=0}else if(t.parentNode&&!sp(t))r=sa(t)+1,t=t.parentNode;else return null}}class ji{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new ji(e.parentNode,sa(e),t)}static after(e,t){return new ji(e.parentNode,sa(e)+1,t)}}var Zt=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Zt||(Zt={}));const il=Zt.LTR,Mv=Zt.RTL;function H2(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const P3=H2("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),B3=H2("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ky=Object.create(null),ls=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);ky[e]=t,ky[t]=-e}function W2(n){return n<=247?P3[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?B3[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const R3=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class io{get dir(){return this.level%2?Mv:il}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,i){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==r)return o;(s<0||(i!=0?i<0?a.from<t:a.to>t:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function q2(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],i=e[t];if(r.from!=i.from||r.to!=i.to||r.direction!=i.direction||!q2(r.inner,i.inner))return!1}return!0}const Ut=[];function D3(n,e,t,r,i){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,a=s<r.length?r[s].from:t,u=s?256:i;for(let f=o,p=u,g=u;f<a;f++){let x=W2(n.charCodeAt(f));x==512?x=p:x==8&&g==4&&(x=16),Ut[f]=x==4?2:x,x&7&&(g=x),p=x}for(let f=o,p=u,g=u;f<a;f++){let x=Ut[f];if(x==128)f<a-1&&p==Ut[f+1]&&p&24?x=Ut[f]=p:Ut[f]=256;else if(x==64){let A=f+1;for(;A<a&&Ut[A]==64;)A++;let _=f&&p==8||A<t&&Ut[A]==8?g==1?1:8:256;for(let b=f;b<A;b++)Ut[b]=_;f=A-1}else x==8&&g==1&&(Ut[f]=1);p=x,x&7&&(g=x)}}}function M3(n,e,t,r,i){let s=i==1?2:1;for(let o=0,a=0,u=0;o<=r.length;o++){let f=o?r[o-1].to:e,p=o<r.length?r[o].from:t;for(let g=f,x,A,_;g<p;g++)if(A=ky[x=n.charCodeAt(g)])if(A<0){for(let b=a-3;b>=0;b-=3)if(ls[b+1]==-A){let w=ls[b+2],C=w&2?i:w&4?w&1?s:i:0;C&&(Ut[g]=Ut[ls[b]]=C),a=b;break}}else{if(ls.length==189)break;ls[a++]=g,ls[a++]=x,ls[a++]=u}else if((_=Ut[g])==2||_==1){let b=_==i;u=b?0:1;for(let w=a-3;w>=0;w-=3){let C=ls[w+2];if(C&2)break;if(b)ls[w+2]|=2;else{if(C&4)break;ls[w+2]|=4}}}}}function N3(n,e,t,r){for(let i=0,s=r;i<=t.length;i++){let o=i?t[i-1].to:n,a=i<t.length?t[i].from:e;for(let u=o;u<a;){let f=Ut[u];if(f==256){let p=u+1;for(;;)if(p==a){if(i==t.length)break;p=t[i++].to,a=i<t.length?t[i].from:e}else if(Ut[p]==256)p++;else break;let g=s==1,x=(p<e?Ut[p]:r)==1,A=g==x?g?1:2:r;for(let _=p,b=i,w=b?t[b-1].to:n;_>u;)_==w&&(_=t[--b].from,w=b?t[b-1].to:n),Ut[--_]=A;u=p}else s=f,u++}}}function Sy(n,e,t,r,i,s,o){let a=r%2?2:1;if(r%2==i%2)for(let u=e,f=0;u<t;){let p=!0,g=!1;if(f==s.length||u<s[f].from){let b=Ut[u];b!=a&&(p=!1,g=b==16)}let x=!p&&a==1?[]:null,A=p?r:r+1,_=u;e:for(;;)if(f<s.length&&_==s[f].from){if(g)break e;let b=s[f];if(!p)for(let w=b.to,C=f+1;;){if(w==t)break e;if(C<s.length&&s[C].from==w)w=s[C++].to;else{if(Ut[w]==a)break e;break}}if(f++,x)x.push(b);else{b.from>u&&o.push(new io(u,b.from,A));let w=b.direction==il!=!(A%2);Cy(n,w?r+1:r,i,b.inner,b.from,b.to,o),u=b.to}_=b.to}else{if(_==t||(p?Ut[_]!=a:Ut[_]==a))break;_++}x?Sy(n,u,_,r+1,i,x,o):u<_&&o.push(new io(u,_,A)),u=_}else for(let u=t,f=s.length;u>e;){let p=!0,g=!1;if(!f||u>s[f-1].to){let b=Ut[u-1];b!=a&&(p=!1,g=b==16)}let x=!p&&a==1?[]:null,A=p?r:r+1,_=u;e:for(;;)if(f&&_==s[f-1].to){if(g)break e;let b=s[--f];if(!p)for(let w=b.from,C=f;;){if(w==e)break e;if(C&&s[C-1].to==w)w=s[--C].from;else{if(Ut[w-1]==a)break e;break}}if(x)x.push(b);else{b.to<u&&o.push(new io(b.to,u,A));let w=b.direction==il!=!(A%2);Cy(n,w?r+1:r,i,b.inner,b.from,b.to,o),u=b.from}_=b.from}else{if(_==e||(p?Ut[_-1]!=a:Ut[_-1]==a))break;_--}x?Sy(n,_,u,r+1,i,x,o):_<u&&o.push(new io(_,u,A)),u=_}}function Cy(n,e,t,r,i,s,o){let a=e%2?2:1;D3(n,i,s,r,a),M3(n,i,s,r,a),N3(i,s,r,a),Sy(n,i,s,e,t,r,o)}function L3(n,e,t){if(!n)return[new io(0,0,e==Mv?1:0)];if(e==il&&!t.length&&!R3.test(n))return V2(n.length);if(t.length)for(;n.length>Ut.length;)Ut[Ut.length]=256;let r=[],i=e==il?0:1;return Cy(n,i,i,t,0,n.length,r),r}function V2(n){return[new io(0,n,0)]}let $2="";function F3(n,e,t,r,i){var s;let o=r.head-n.from,a=io.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc),u=e[a],f=u.side(i,t);if(o==f){let x=a+=i?1:-1;if(x<0||x>=e.length)return null;u=e[a=x],o=u.side(!i,t),f=u.side(i,t)}let p=Fn(n.text,o,u.forward(i,t));(p<u.from||p>u.to)&&(p=f),$2=n.text.slice(Math.min(o,p),Math.max(o,p));let g=a==(i?e.length-1:0)?null:e[a+(i?1:-1)];return g&&p==f&&g.level+(i?0:1)<u.level?we.cursor(g.side(!i,t)+n.from,g.forward(i,t)?1:-1,g.level):we.cursor(p+n.from,u.forward(i,t)?-1:1,u.level)}function I3(n,e,t){for(let r=e;r<t;r++){let i=W2(n.charCodeAt(r));if(i==1)return il;if(i==2||i==4)return Mv}return il}const U2=je.define(),Z2=je.define(),G2=je.define(),X2=je.define(),Ty=je.define(),K2=je.define(),Y2=je.define(),Nv=je.define(),Lv=je.define(),J2=je.define({combine:n=>n.some(e=>e)}),eC=je.define({combine:n=>n.some(e=>e)}),tC=je.define();class pc{constructor(e,t="nearest",r="nearest",i=5,s=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=i,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new pc(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new pc(we.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const kd=ft.define({map:(n,e)=>n.map(e)}),nC=ft.define();function Fr(n,e,t){let r=n.facet(X2);r.length?r[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const no=je.define({combine:n=>n.length?n[0]:!0});let z3=0;const sc=je.define({combine(n){return n.filter((e,t)=>{for(let r=0;r<t;r++)if(n[r].plugin==e.plugin)return!1;return!0})}});class _n{constructor(e,t,r,i,s){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=i,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(sc.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(sc.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:r,eventObservers:i,provide:s,decorations:o}=t||{};return new _n(z3++,e,r,i,a=>{let u=[];return o&&u.push(Jp.of(f=>{let p=f.plugin(a);return p?o(p):Je.none})),s&&u.push(s(a)),u})}static fromClass(e,t){return _n.define((r,i)=>new e(r,i),t)}}class ux{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(Fr(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){Fr(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){Fr(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const rC=je.define(),Fv=je.define(),Jp=je.define(),iC=je.define(),Iv=je.define(),jh=je.define(),sC=je.define();function mw(n,e){let t=n.state.facet(sC);if(!t.length)return t;let r=t.map(s=>s instanceof Function?s(n):s),i=[];return Tt.spans(r,e.from,e.to,{point(){},span(s,o,a,u){let f=s-e.from,p=o-e.from,g=i;for(let x=a.length-1;x>=0;x--,u--){let A=a[x].spec.bidiIsolate,_;if(A==null&&(A=I3(e.text,f,p)),u>0&&g.length&&(_=g[g.length-1]).to==f&&_.direction==A)_.to=p,g=_.inner;else{let b={from:f,to:p,direction:A,inner:[]};g.push(b),g=b.inner}}}}),i}const oC=je.define();function zv(n){let e=0,t=0,r=0,i=0;for(let s of n.state.facet(oC)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(i=Math.max(i,o.bottom)))}return{left:e,right:t,top:r,bottom:i}}const Xu=je.define();class Ai{constructor(e,t,r,i){this.fromA=e,this.toA=t,this.fromB=r,this.toB=i}join(e){return new Ai(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let i=0,s=0,o=0;;){let a=i<e.length?e[i].fromB:1e9,u=s<t.length?t[s]:1e9,f=Math.min(a,u);if(f==1e9)break;let p=f+o,g=f,x=p;for(;;)if(s<t.length&&t[s]<=g){let A=t[s+1];s+=2,g=Math.max(g,A);for(let _=i;_<e.length&&e[_].fromB<=g;_++)o=e[_].toA-e[_].toB;x=Math.max(x,A+o)}else if(i<e.length&&e[i].fromB<=g){let A=e[i++];g=Math.max(g,A.toB),x=Math.max(x,A.toA),o=A.toA-A.toB}else break;r.push(new Ai(p,x,f,g))}return r}}class op{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Ln.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,a,u)=>i.push(new Ai(s,o,a,u))),this.changedRanges=i}static create(e,t,r){return new op(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const j3=[];class Tn{constructor(e,t,r=0){this.dom=e,this.length=t,this.flags=r,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return j3}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&b3(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let r=t;for(let i of this.children){if(i==e)return r;r+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let r=sa(this.dom),i=this.length?e>0:t>0;return new ji(this.parent.dom,r+(i?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof tm)return e;return null}static get(e){return e.cmTile}}class em extends Tn{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,r=null,i,s=(e==null?void 0:e.node)==t?e:null,o=0;for(let a of this.children){if(a.sync(e),o+=a.length+a.breakAfter,i=r?r.nextSibling:t.firstChild,s&&i!=a.dom&&(s.written=!0),a.dom.parentNode==t)for(;i&&i!=a.dom;)i=gw(i);else t.insertBefore(a.dom,i);r=a.dom}for(i=r?r.nextSibling:t.firstChild,s&&i&&(s.written=!0);i;)i=gw(i);this.length=o}}function gw(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class tm extends em{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=Tn.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],r=this,i=0,s=0;;)if(i==r.children.length){if(!t.length)return;r=r.parent,r.breakAfter&&s++,i=t.pop()}else{let o=r.children[i++];if(o instanceof Jo)t.push(i),r=o,i=0;else{let a=s+o.length,u=e(o,s);if(u!==void 0)return u;s=a+o.breakAfter}}}resolveBlock(e,t){let r,i=-1,s,o=-1;if(this.blockTiles((a,u)=>{let f=u+a.length;if(e>=u&&e<=f){if(a.isWidget()&&t>=-1&&t<=1){if(a.flags&32)return!0;a.flags&16&&(r=void 0)}(u<e||e==f&&(t<-1?a.length:a.covers(1)))&&(!r||!a.isWidget()&&r.isWidget())&&(r=a,i=e-u),(f>e||e==u&&(t>1?a.length:a.covers(-1)))&&(!s||!a.isWidget()&&s.isWidget())&&(s=a,o=e-u)}}),!r&&!s)throw new Error("No tile at position "+e);return r&&t<0||!s?{tile:r,offset:i}:{tile:s,offset:o}}}class Jo extends em{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let r=new Jo(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class kc extends em{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,r){let i=new kc(t||document.createElement("div"),e);return(!t||!r)&&(i.flags|=4),i}get domAttrs(){return this.attrs}resolveInline(e,t,r){let i=null,s=-1,o=null,a=-1;function u(p,g){for(let x=0,A=0;x<p.children.length&&A<=g;x++){let _=p.children[x],b=A+_.length;b>=g&&(_.isComposite()?u(_,g-A):(!o||o.isHidden&&(t>0||r&&H3(o,_)))&&(b>g||_.flags&32)?(o=_,a=g-A):(A<g||_.flags&16&&!_.isHidden)&&(i=_,s=g-A)),A=b}}u(this,e);let f=(t<0?i:o)||i||o;return f?{tile:f,offset:f==i?s:a}:null}coordsIn(e,t){let r=this.resolveInline(e,t,!0);return r?r.tile.coordsIn(Math.max(0,r.offset),t):Q3(this)}domIn(e,t){let r=this.resolveInline(e,t);if(r){let{tile:i,offset:s}=r;if(this.dom.contains(i.dom))return i.isText()?new ji(i.dom,Math.min(i.dom.nodeValue.length,s)):i.domPosFor(s,i.flags&16?1:i.flags&32?-1:t);let o=r.tile.parent,a=!1;for(let u of o.children){if(a)return new ji(u.dom,0);u==r.tile&&(a=!0)}}return new ji(this.dom,0)}}function Q3(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=lh(e);return t[t.length-1]||null}function H3(n,e){let t=n.coordsIn(0,1),r=e.coordsIn(0,1);return t&&r&&r.top<t.bottom}class Lr extends em{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let r=new Lr(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class Ka extends Tn{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let r=this.dom.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;e==0&&t<0||e==r&&t>=0?He.chrome||He.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):t<0?i--:s<r&&s++;let a=yh(this.dom,i,s).getClientRects();if(!a.length)return null;let u=a[(o?o<0:t>=0)?0:a.length-1];return He.safari&&!o&&u.width==0&&(u=Array.prototype.find.call(a,f=>f.width)||u),o?xh(u,o<0):u||null}static of(e,t){let r=new Ka(t||document.createTextNode(e),e);return t||(r.flags|=2),r}}class sl extends Tn{constructor(e,t,r,i){super(e,t,i),this.widget=r}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,r){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;if(r)return xh(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let s=this.dom.getClientRects(),o=null;if(!s.length)return null;let a=this.flags&16?!0:this.flags&32?!1:e>0;for(let u=a?s.length-1:0;o=s[u],!(e>0?u==0:u==s.length-1||o.top<o.bottom);u+=a?-1:1);return xh(o,!a)}}get overrideDOMText(){if(!this.length)return Lt.empty;let{root:e}=this;if(!e)return Lt.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,r,i,s){return s||(s=e.toDOM(t),e.editable||(s.contentEditable="false")),new sl(s,r,e,i)}}class ap extends Tn{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return Lt.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class W3{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,r){let{tile:i,index:s,beforeBreak:o,parents:a}=this;for(;e||t>0;)if(i.isComposite())if(o){if(!e)break;r&&r.break(),e--,o=!1}else if(s==i.children.length){if(!e&&!a.length)break;r&&r.leave(i),o=!!i.breakAfter,{tile:i,index:s}=a.pop(),s++}else{let u=i.children[s],f=u.breakAfter;(t>0?u.length<=e:u.length<e)&&(!r||r.skip(u,0,u.length)!==!1||!u.isComposite)?(o=!!f,s++,e-=u.length):(a.push({tile:i,index:s}),i=u,s=0,r&&u.isComposite()&&r.enter(u))}else if(s==i.length)o=!!i.breakAfter,{tile:i,index:s}=a.pop(),s++;else if(e){let u=Math.min(e,i.length-s);r&&r.skip(i,s,s+u),e-=u,s+=u}else break;return this.tile=i,this.index=s,this.beforeBreak=o,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class q3{constructor(e,t,r,i){this.from=e,this.to=t,this.wrapper=r,this.rank=i}}class V3{constructor(e,t,r){this.cache=e,this.root=t,this.blockWrappers=r,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,r,i){var s;this.flushBuffer();let o=this.ensureMarks(t,r),a=o.lastChild;if(a&&a.isText()&&!(a.flags&8)){this.cache.reused.set(a,2);let u=o.children[o.children.length-1]=new Ka(a.dom,a.text+e);u.parent=o}else o.append(i||Ka.of(e,(s=this.cache.find(Ka))===null||s===void 0?void 0:s.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let r=this.curLine;r.dom!=t.line.dom&&(r.setDOM(this.cache.reused.has(t.line)?hx(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let i=r;for(let a=t.marks.length-1;a>=0;a--){let u=t.marks[a],f=i.lastChild;if(f instanceof Lr&&f.mark.eq(u.mark))f.dom!=u.dom&&f.setDOM(hx(u.dom)),i=f;else{if(this.cache.reused.get(u)){let g=Tn.get(u.dom);g&&g.setDOM(hx(u.dom))}let p=Lr.of(u.mark,u.dom);i.append(p),i=p}this.cache.reused.set(u,2)}let s=Tn.get(e.text);s&&this.cache.reused.set(s,2);let o=new Ka(e.text,e.text.nodeValue);o.flags|=8,i.append(o)}addInlineWidget(e,t,r){let i=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);i||this.flushBuffer();let s=this.ensureMarks(t,r);!i&&!(e.flags&16)&&s.append(this.getBuffer(1)),s.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,r){this.flushBuffer(),this.ensureMarks(t,r).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var r;e||(e=aC);let i=kc.start(e,t||((r=this.cache.find(kc))===null||r===void 0?void 0:r.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=i)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var r;let i=this.curLine;for(let s=e.length-1;s>=0;s--){let o=e[s],a;if(t>0&&(a=i.lastChild)&&a instanceof Lr&&a.mark.eq(o))i=a,t--;else{let u=Lr.of(o,(r=this.cache.find(Lr,f=>f.mark.eq(o)))===null||r===void 0?void 0:r.dom);i.append(u),i=u,t=0}}return i}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!xw(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(He.ios&&xw(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(fx,0,32)||new sl(fx.toDOM(),0,fx,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new q3(e.from,e.to,e.value,e.rank),r=this.wrappers.length;for(;r>0&&(this.wrappers[r-1].rank-t.rank||this.wrappers[r-1].to-t.to)<0;)r--;this.wrappers.splice(r,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let r of this.wrappers){let i=t.lastChild;if(r.from<this.pos&&i instanceof Jo&&i.wrapper.eq(r.wrapper))t=i;else{let s=Jo.of(r.wrapper,(e=this.cache.find(Jo,o=>o.wrapper.eq(r.wrapper)))===null||e===void 0?void 0:e.dom);t.append(s),t=s}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),r=this.cache.find(ap,void 0,1);return r&&(r.flags=t),r||new ap(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class $3{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:i,lineBreak:s,done:o}=this.cursor.next(this.skipCount);if(this.skipCount=0,o)throw new Error("Ran out of text content when drawing inline views");this.text=i;let a=this.textOff=Math.min(e,i.length);return s?null:i.slice(0,a)}let t=Math.min(this.text.length,this.textOff+e),r=this.text.slice(this.textOff,t);return this.textOff=t,r}}const lp=[sl,kc,Ka,Lr,ap,Jo,tm];for(let n=0;n<lp.length;n++)lp[n].bucket=n;class U3{constructor(e){this.view=e,this.buckets=lp.map(()=>[]),this.index=lp.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,r=this.buckets[t];r.length<6?r.push(e):r[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,r=2){let i=e.bucket,s=this.buckets[i],o=this.index[i];for(let a=s.length-1;a>=0;a--){let u=(a+o)%s.length,f=s[u];if((!t||t(f))&&!this.reused.has(f))return s.splice(u,1),u<o&&this.index[i]--,this.reused.set(f,r),f}return null}findWidget(e,t,r){let i=this.buckets[0];if(i.length)for(let s=0,o=0;;s++){if(s==i.length){if(o)return null;o=1,s=0}let a=i[s];if(!this.reused.has(a)&&(o==0?a.widget.compare(e):a.widget.constructor==e.constructor&&e.updateDOM(a.dom,this.view)))return i.splice(s,1),s<this.index[0]&&this.index[0]--,a.widget==e&&a.length==t&&(a.flags&497)==r?(this.reused.set(a,1),a):(this.reused.set(a,2),new sl(a.dom,t,e,a.flags&-498|r))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class Z3{constructor(e,t,r,i,s){this.view=e,this.decorations=i,this.disallowBlockEffectsFor=s,this.openWidget=!1,this.openMarks=0,this.cache=new U3(e),this.text=new $3(e.state.doc),this.builder=new V3(this.cache,new tm(e,e.contentDOM),Tt.iter(r)),this.cache.reused.set(t,2),this.old=new W3(t),this.reuseWalker={skip:(o,a,u)=>{if(this.cache.add(o),o.isComposite())return!1},enter:o=>this.cache.add(o),leave:()=>{},break:()=>{}}}run(e,t){let r=t&&this.getCompositionContext(t.text);for(let i=0,s=0,o=0;;){let a=o<e.length?e[o++]:null,u=a?a.fromA:this.old.root.length;if(u>i){let f=u-i;this.preserve(f,!o,!a),i=u,s+=f}if(!a)break;t&&a.fromA<=t.range.fromA&&a.toA>=t.range.toA?(this.forward(a.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(s,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,r),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,a.toA),this.emit(t.range.toB,a.toB)):(this.forward(a.fromA,a.toA),this.emit(s,a.toB)),s=a.toB,i=a.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,r){let i=K3(this.old),s=this.openMarks;this.old.advance(e,r?1:-1,{skip:(o,a,u)=>{if(o.isWidget())if(this.openWidget)this.builder.continueWidget(u-a);else{let f=u>0||a<o.length?sl.of(o.widget,this.view,u-a,o.flags&496,this.cache.maybeReuse(o)):this.cache.reuse(o);f.flags&256?(f.flags&=-2,this.builder.addBlockWidget(f)):(this.builder.ensureLine(null),this.builder.addInlineWidget(f,i,s),s=i.length)}else if(o.isText())this.builder.ensureLine(null),!a&&u==o.length?this.builder.addText(o.text,i,s,this.cache.reuse(o)):(this.cache.add(o),this.builder.addText(o.text.slice(a,u),i,s)),s=i.length;else if(o.isLine())o.flags&=-2,this.cache.reused.set(o,1),this.builder.addLine(o);else if(o instanceof ap)this.cache.add(o);else if(o instanceof Lr)this.builder.ensureLine(null),this.builder.addMark(o,i,s),this.cache.reused.set(o,1),s=i.length;else return!1;this.openWidget=!1},enter:o=>{o.isLine()?this.builder.addLineStart(o.attrs,this.cache.maybeReuse(o)):(this.cache.add(o),o instanceof Lr&&i.unshift(o.mark)),this.openWidget=!1},leave:o=>{o.isLine()?i.length&&(i.length=s=0):o instanceof Lr&&(i.shift(),s=Math.min(s,i.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let r=null,i=this.builder,s=0,o=Tt.spans(this.decorations,e,t,{point:(a,u,f,p,g,x)=>{if(f instanceof rl){if(this.disallowBlockEffectsFor[x]){if(f.block)throw new RangeError("Block decorations may not be specified via plugins");if(u>this.view.state.doc.lineAt(a).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(s=p.length,g>p.length)i.continueWidget(u-a);else{let A=f.widget||(f.block?Sc.block:Sc.inline),_=G3(f),b=this.cache.findWidget(A,u-a,_)||sl.of(A,this.view,u-a,_);f.block?(f.startSide>0&&i.addLineStartIfNotCovered(r),i.addBlockWidget(b)):(i.ensureLine(r),i.addInlineWidget(b,p,g))}r=null}else r=X3(r,f);u>a&&this.text.skip(u-a)},span:(a,u,f,p)=>{for(let g=a;g<u;){let x=this.text.next(Math.min(512,u-g));x==null?(i.addLineStartIfNotCovered(r),i.addBreak(),g++):(i.ensureLine(r),i.addText(x,f,p),g+=x.length),r=null}}});i.addLineStartIfNotCovered(r),this.openWidget=o>s,this.openMarks=o}forward(e,t,r=1){t-e<=10?this.old.advance(t-e,r,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,r,this.reuseWalker))}getCompositionContext(e){let t=[],r=null;for(let i=e.parentNode;;i=i.parentNode){let s=Tn.get(i);if(i==this.view.contentDOM)break;s instanceof Lr?t.push(s):s!=null&&s.isLine()?r=s:i.nodeName=="DIV"&&!r&&i!=this.view.contentDOM?r=new kc(i,aC):t.push(Lr.of(new Ih({tagName:i.nodeName.toLowerCase(),attributes:w3(i)}),i))}return{line:r,marks:t}}}function xw(n,e){let t=r=>{for(let i of r.children)if((e?i.isText():i.length)||t(i))return!0;return!1};return t(n)}function G3(n){let e=n.isReplace?(n.startSide<0?64:0)|(n.endSide>0?128:0):n.startSide>0?32:16;return n.block&&(e|=256),e}const aC={class:"cm-line"};function X3(n,e){let t=e.spec.attributes,r=e.spec.class;return!t&&!r||(n||(n={class:"cm-line"}),t&&Rv(t,n),r&&(n.class+=" "+r)),n}function K3(n){let e=[];for(let t=n.parents.length;t>1;t--){let r=t==n.parents.length?n.tile:n.parents[t].tile;r instanceof Lr&&e.push(r.mark)}return e}function hx(n){let e=Tn.get(n);return e&&e.setDOM(n.cloneNode()),n}class Sc extends $i{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Sc.inline=new Sc("span");Sc.block=new Sc("div");const fx=new class extends $i{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class yw{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=Je.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new tm(e,e.contentDOM),this.updateInner([new Ai(0,0,0,e.state.doc.length)],null)}update(e){var t;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:p,toA:g})=>g<this.minWidthFrom||p>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?i=this.domChanged.newSel.head:!o8(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?J3(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){let{from:p,to:g}=this.hasComposition;r=new Ai(p,g,e.changes.mapPos(p,-1),e.changes.mapPos(g,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(He.ie||He.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.blockWrappers;this.updateDeco();let u=n8(o,this.decorations,e.changes);u.length&&(r=Ai.extendWithRanges(r,u));let f=i8(a,this.blockWrappers,e.changes);return f.length&&(r=Ai.extendWithRanges(r,f)),s&&!r.some(p=>p.fromA<=s.range.fromA&&p.toA>=s.range.toA)&&(r=s.range.addToSet(r.slice())),this.tile.flags&2&&r.length==0?!1:(this.updateInner(r,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:r}=this.view;r.ignore(()=>{if(t||e.length){let o=this.tile,a=new Z3(this.view,o,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=a.run(e,t),Ey(o,a.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=He.chrome||He.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(s),s&&(s.written||r.selectionRange.focusNode!=s.node||!this.tile.dom.contains(s.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.tile.children)s.isWidget()&&s.widget instanceof dx&&i.push(s.dom);r.updateGaps(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let r of t.effects)r.is(nC)&&(this.editContextFormatting=r.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:r}=this.tile,i=this.view.root.activeElement,s=i==r,o=!s&&!(this.view.state.facet(no)||r.tabIndex>-1)&&ah(r,this.view.observer.selectionRange)&&!(i&&r.contains(i));if(!(s||t||o))return;let a=this.forceSelection;this.forceSelection=!1;let u=this.view.state.selection.main,f,p;if(u.empty?p=f=this.inlineDOMNearPos(u.anchor,u.assoc||1):(p=this.inlineDOMNearPos(u.head,u.head==u.from?1:-1),f=this.inlineDOMNearPos(u.anchor,u.anchor==u.from?1:-1)),He.gecko&&u.empty&&!this.hasComposition&&Y3(f)){let x=document.createTextNode("");this.view.observer.ignore(()=>f.node.insertBefore(x,f.node.childNodes[f.offset]||null)),f=p=new ji(x,0),a=!0}let g=this.view.observer.selectionRange;(a||!g.focusNode||(!ch(f.node,f.offset,g.anchorNode,g.anchorOffset)||!ch(p.node,p.offset,g.focusNode,g.focusOffset))&&!this.suppressWidgetCursorChange(g,u))&&(this.view.observer.ignore(()=>{He.android&&He.chrome&&r.contains(g.focusNode)&&s8(g.focusNode,r)&&(r.blur(),r.focus({preventScroll:!0}));let x=Oc(this.view.root);if(x)if(u.empty){if(He.gecko){let A=e8(f.node,f.offset);if(A&&A!=3){let _=(A==1?j2:Q2)(f.node,f.offset);_&&(f=new ji(_.node,_.offset))}}x.collapse(f.node,f.offset),u.bidiLevel!=null&&x.caretBidiLevel!==void 0&&(x.caretBidiLevel=u.bidiLevel)}else if(x.extend){x.collapse(f.node,f.offset);try{x.extend(p.node,p.offset)}catch{}}else{let A=document.createRange();u.anchor>u.head&&([f,p]=[p,f]),A.setEnd(p.node,p.offset),A.setStart(f.node,f.offset),x.removeAllRanges(),x.addRange(A)}o&&this.view.root.activeElement==r&&(r.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(f,p)),this.impreciseAnchor=f.precise?null:new ji(g.anchorNode,g.anchorOffset),this.impreciseHead=p.precise?null:new ji(g.focusNode,g.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&ch(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=Oc(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let o=this.lineAt(t.head,t.assoc);if(!o)return;let a=o.posAtStart;if(t.head==a||t.head==a+o.length)return;let u=this.coordsAt(t.head,-1),f=this.coordsAt(t.head,1);if(!u||!f||u.bottom>f.top)return;let p=this.domAtPos(t.head+t.assoc,t.assoc);r.collapse(p.node,p.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let g=e.observer.selectionRange;e.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=t.from&&r.collapse(i,s)}posFromDOM(e,t){let r=this.tile.nearest(e);if(!r)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let i=r.posAtStart;if(r.isComposite()){let s;if(e==r.dom)s=r.dom.childNodes[t];else{let o=oo(e)==0?0:t==0?-1:1;for(;;){let a=e.parentNode;if(a==r.dom)break;o==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?o=-1:o=1),e=a}o<0?s=e:s=e.nextSibling}if(s==r.dom.firstChild)return i;for(;s&&!Tn.get(s);)s=s.nextSibling;if(!s)return i+r.length;for(let o=0,a=i;;o++){let u=r.children[o];if(u.dom==s)return a;a+=u.length+u.breakAfter}}else return r.isText()?e==r.dom?i+t:i+(t?r.length:0):i}domAtPos(e,t){let{tile:r,offset:i}=this.tile.resolveBlock(e,t);return r.isWidget()?r.domPosFor(e,t):r.domIn(i,t)}inlineDOMNearPos(e,t){let r,i=-1,s=!1,o,a=-1,u=!1;return this.tile.blockTiles((f,p)=>{if(f.isWidget()){if(f.flags&32&&p>=e)return!0;f.flags&16&&(s=!0)}else{let g=p+f.length;if(p<=e&&(r=f,i=e-p,s=g<e),g>=e&&!o&&(o=f,a=e-p,u=p>e),p>e&&o)return!0}}),!r&&!o?this.domAtPos(e,t):(s&&o?r=null:u&&r&&(o=null),r&&t<0||!o?r.domIn(i,t):o.domIn(a,t))}coordsAt(e,t){let{tile:r,offset:i}=this.tile.resolveBlock(e,t);return r.isWidget()?r.widget instanceof dx?null:r.coordsInWidget(i,t,!0):r.coordsIn(i,t)}lineAt(e,t){let{tile:r}=this.tile.resolveBlock(e,t);return r.isLine()?r:null}coordsForChar(e){let{tile:t,offset:r}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function i(s,o){if(s.isComposite())for(let a of s.children){if(a.length>=o){let u=i(a,o);if(u)return u}if(o-=a.length,o<0)break}else if(s.isText()&&o<s.length){let a=Fn(s.text,o);if(a==o)return null;let u=yh(s.dom,o,a).getClientRects();for(let f=0;f<u.length;f++){let p=u[f];if(f==u.length-1||p.top<p.bottom&&p.left<p.right)return p}}return null}return i(t,r)}measureVisibleLineHeights(e){let t=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,u=this.view.textDirection==Zt.LTR,f=0,p=(g,x,A)=>{for(let _=0;_<g.children.length&&!(x>i);_++){let b=g.children[_],w=x+b.length,C=b.dom.getBoundingClientRect(),{height:T}=C;if(A&&!_&&(f+=C.top-A.top),b instanceof Jo)w>r&&p(b,x,C);else if(x>=r&&(f>0&&t.push(-f),t.push(T+f),f=0,o)){let E=b.dom.lastChild,D=E?lh(E):[];if(D.length){let N=D[D.length-1],F=u?N.right-C.left:C.right-N.left;F>a&&(a=F,this.minWidth=s,this.minWidthFrom=x,this.minWidthTo=w)}}A&&_==g.children.length-1&&(f+=A.bottom-C.bottom),x=w+b.breakAfter}};return p(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?Zt.RTL:Zt.LTR}measureTextSize(){let e=this.tile.blockTiles(o=>{if(o.isLine()&&o.children.length&&o.length<=20){let a=0,u;for(let f of o.children){if(!f.isText()||/[^ -~]/.test(f.text))return;let p=lh(f.dom);if(p.length!=1)return;a+=p[0].width,u=p[0].height}if(a)return{lineHeight:o.dom.getBoundingClientRect().height,charWidth:a/o.length,textHeight:u}}});if(e)return e;let t=document.createElement("div"),r,i,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let o=lh(t.firstChild)[0];r=t.getBoundingClientRect().height,i=o&&o.width?o.width/27:7,s=o&&o.height?o.height:r,t.remove()}),{lineHeight:r,charWidth:i,textHeight:s}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],o=s?s.from-1:this.view.state.doc.length;if(o>r){let a=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(Je.replace({widget:new dx(a),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return Je.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Jp).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),r=!1,i=this.view.state.facet(Iv).map((s,o)=>{let a=typeof s=="function";return a&&(r=!0),a?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=r,t.push(Tt.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(iC).map(s=>typeof s=="function"?s(this.view):s)}scrollIntoView(e){if(e.isSnapshot){let f=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=f.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let f of this.view.state.facet(tC))try{if(f(this.view,e.range,e))return!0}catch(p){Fr(this.view.state,p,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!r)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=zv(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:a,offsetHeight:u}=this.view.scrollDOM;k3(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,u),-u),this.view.textDirection==Zt.LTR)}lineHasWidget(e){let t=r=>r.isWidget()||r.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){Ey(this.tile)}}function Ey(n,e){let t=e==null?void 0:e.get(n);if(t!=1){t==null&&n.destroy();for(let r of n.children)Ey(r,e)}}function Y3(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function lC(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let r=j2(t.focusNode,t.focusOffset),i=Q2(t.focusNode,t.focusOffset),s=r||i;if(i&&r&&i.node!=r.node){let a=Tn.get(i.node);if(!a||a.isText()&&a.text!=i.node.nodeValue)s=i;else if(n.docView.lastCompositionAfterCursor){let u=Tn.get(r.node);!u||u.isText()&&u.text!=r.node.nodeValue||(s=i)}}if(n.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function J3(n,e,t){let r=lC(n,t);if(!r)return null;let{node:i,from:s,to:o}=r,a=i.nodeValue;if(/[\n\r]/.test(a)||n.state.doc.sliceString(r.from,r.to)!=a)return null;let u=e.invertedDesc;return{range:new Ai(u.mapPos(s),u.mapPos(o),s,o),text:i}}function e8(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let t8=class{constructor(){this.changes=[]}compareRange(e,t){fc(e,t,this.changes)}comparePoint(e,t){fc(e,t,this.changes)}boundChange(e){fc(e,e,this.changes)}};function n8(n,e,t){let r=new t8;return Tt.compare(n,e,t,r),r.changes}class r8{constructor(){this.changes=[]}compareRange(e,t){fc(e,t,this.changes)}comparePoint(){}boundChange(e){fc(e,e,this.changes)}}function i8(n,e,t){let r=new r8;return Tt.compare(n,e,t,r),r.changes}function s8(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function o8(n,e){let t=!1;return e&&n.iterChangedRanges((r,i)=>{r<e.to&&i>e.from&&(t=!0)}),t}class dx extends $i{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function a8(n,e,t=1){let r=n.charCategorizer(e),i=n.doc.lineAt(e),s=e-i.from;if(i.length==0)return we.cursor(e);s==0?t=1:s==i.length&&(t=-1);let o=s,a=s;t<0?o=Fn(i.text,s,!1):a=Fn(i.text,s);let u=r(i.text.slice(o,a));for(;o>0;){let f=Fn(i.text,o,!1);if(r(i.text.slice(f,o))!=u)break;o=f}for(;a<i.length;){let f=Fn(i.text,a);if(r(i.text.slice(a,f))!=u)break;a=f}return we.range(o+i.from,a+i.from)}function l8(n,e,t,r,i){let s=Math.round((r-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let a=n.viewState.heightOracle.textHeight,u=Math.floor((i-t.top-(n.defaultLineHeight-a)*.5)/a);s+=u*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+xy(o,s,n.state.tabSize)}function Py(n,e,t){let r=n.lineBlockAt(e);if(Array.isArray(r.type)){let i;for(let s of r.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!i||s.type==tr.Text&&(i.type!=s.type||(t<0?s.from<e:s.to>e)))&&(i=s)}}return i||r}return r}function c8(n,e,t,r){let i=Py(n,e.head,e.assoc||-1),s=!r||i.type!=tr.Text||!(n.lineWrapping||i.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),a=n.textDirectionAt(i.from),u=n.posAtCoords({x:t==(a==Zt.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(u!=null)return we.cursor(u,t?-1:1)}return we.cursor(t?i.to:i.from,t?-1:1)}function vw(n,e,t,r){let i=n.state.doc.lineAt(e.head),s=n.bidiSpans(i),o=n.textDirectionAt(i.from);for(let a=e,u=null;;){let f=F3(i,s,o,a,t),p=$2;if(!f){if(i.number==(t?n.state.doc.lines:1))return a;p=`
`,i=n.state.doc.line(i.number+(t?1:-1)),s=n.bidiSpans(i),f=n.visualLineSide(i,!t)}if(u){if(!u(p))return a}else{if(!r)return f;u=r(p)}a=f}}function u8(n,e,t){let r=n.state.charCategorizer(e),i=r(t);return s=>{let o=r(s);return i==ln.Space&&(i=o),i==o}}function h8(n,e,t,r){let i=e.head,s=t?1:-1;if(i==(t?n.state.doc.length:0))return we.cursor(i,e.assoc);let o=e.goalColumn,a,u=n.contentDOM.getBoundingClientRect(),f=n.coordsAtPos(i,e.assoc||-1),p=n.documentTop;if(f)o==null&&(o=f.left-u.left),a=s<0?f.top:f.bottom;else{let _=n.viewState.lineBlockAt(i);o==null&&(o=Math.min(u.right-u.left,n.defaultCharacterWidth*(i-_.from))),a=(s<0?_.top:_.bottom)+p}let g=u.left+o,x=r??n.viewState.heightOracle.textHeight>>1,A=By(n,{x:g,y:a+x*s},!1,s);return we.cursor(A.pos,A.assoc,void 0,o)}function uh(n,e,t){for(;;){let r=0;for(let i of n)i.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let u=r||t||(e-s<o-e?-1:1);e=u<0?s:o,r=u}});if(!r)return e}}function cC(n,e){let t=null;for(let r=0;r<e.ranges.length;r++){let i=e.ranges[r],s=null;if(i.empty){let o=uh(n,i.from,0);o!=i.from&&(s=we.cursor(o,-1))}else{let o=uh(n,i.from,-1),a=uh(n,i.to,1);(o!=i.from||a!=i.to)&&(s=we.range(i.from==i.anchor?o:a,i.from==i.head?o:a))}s&&(t||(t=e.ranges.slice()),t[r]=s)}return t?we.create(t,e.mainIndex):e}function px(n,e,t){let r=uh(n.state.facet(jh).map(i=>i(n)),t.from,e.head>t.from?-1:1);return r==t.from?t:we.cursor(r,r<t.from?1:-1)}class xs{constructor(e,t){this.pos=e,this.assoc=t}}function By(n,e,t,r){let i=n.contentDOM.getBoundingClientRect(),s=i.top+n.viewState.paddingTop,{x:o,y:a}=e,u=a-s,f;for(;;){if(u<0)return new xs(0,1);if(u>n.viewState.docHeight)return new xs(n.state.doc.length,-1);if(f=n.elementAtHeight(u),r==null)break;if(f.type==tr.Text){let x=n.docView.coordsAt(r<0?f.from:f.to,r);if(x&&(r<0?x.top<=u+s:x.bottom>=u+s))break}let g=n.viewState.heightOracle.textHeight/2;u=r>0?f.bottom+g:f.top-g}if(n.viewport.from>=f.to||n.viewport.to<=f.from){if(t)return null;if(f.type==tr.Text){let g=l8(n,i,f,o,a);return new xs(g,g==f.from?1:-1)}}if(f.type!=tr.Text)return u<(f.top+f.bottom)/2?new xs(f.from,1):new xs(f.to,-1);let p=n.docView.lineAt(f.from,2);return(!p||p.length!=f.length)&&(p=n.docView.lineAt(f.from,-2)),uC(n,p,f.from,o,a)}function uC(n,e,t,r,i){let s=-1,o=null,a=1e9,u=1e9,f=i,p=i,g=(x,A)=>{for(let _=0;_<x.length;_++){let b=x[_];if(b.top==b.bottom)continue;let w=b.left>r?b.left-r:b.right<r?r-b.right:0,C=b.top>i?b.top-i:b.bottom<i?i-b.bottom:0;b.top<=p&&b.bottom>=f&&(f=Math.min(b.top,f),p=Math.max(b.bottom,p),C=0),(s<0||(C-u||w-a)<0)&&(s>=0&&u&&a<w&&o.top<=p-2&&o.bottom>=f+2?u=0:(s=A,a=w,u=C,o=b))}};if(e.isText()){for(let A=0;A<e.length;){let _=Fn(e.text,A);if(g(yh(e.dom,A,_).getClientRects(),A),!a&&!u)break;A=_}return r>(o.left+o.right)/2==(Aw(n,s+t)==Zt.LTR)?new xs(t+Fn(e.text,s),-1):new xs(t+s,1)}else{if(!e.length)return new xs(t,1);for(let b=0;b<e.children.length;b++){let w=e.children[b];if(w.flags&48)continue;let C=(w.dom.nodeType==1?w.dom:yh(w.dom,0,w.length)).getClientRects();if(g(C,b),!a&&!u)break}let x=e.children[s],A=e.posBefore(x,t);return x.isComposite()||x.isText()?uC(n,x,A,Math.max(o.left,Math.min(o.right,r)),i):r>(o.left+o.right)/2==(Aw(n,s+t)==Zt.LTR)?new xs(A+x.length,-1):new xs(A,1)}}function Aw(n,e){let t=n.state.doc.lineAt(e);return n.bidiSpans(t)[io.find(n.bidiSpans(t),e-t.from,-1,1)].dir}const Ku="";class f8{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(Rt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ku}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i);let s=this.text.length;this.readNode(i);let o=Tn.get(i),a=i.nextSibling;if(a==t){o!=null&&o.breakAfter&&!a&&r!=this.view.contentDOM&&this.lineBreak();break}let u=Tn.get(a);(o&&u?o.breakAfter:(o?o.breakAfter:sp(i))||sp(a)&&(i.nodeName!="BR"||o!=null&&o.isWidget())&&this.text.length>s)&&!p8(a,t)&&this.lineBreak(),i=a}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(a=i.exec(t))&&(s=a.index,o=a[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let u of this.points)u.node==e&&u.pos>this.text.length&&(u.pos-=o-1);r=s+o}}readNode(e){let t=Tn.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(d8(e,r.node,r.offset)?t:0))}}function d8(n,e,t){for(;;){if(!e||t<oo(e))return!1;if(e==n)return!0;t=sa(e)+1,e=e.parentNode}}function p8(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let r=Tn.get(n);if(!(r!=null&&r.isWidget()))return!1;r&&(t||(t=[])).push(r)}if(t)for(let r of t){let i=r.overrideDOMText;if(i!=null&&i.length)return!1}return!0}class bw{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class m8{constructor(e,t,r,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=hC(e.docView.tile,t,r,0))){let a=s||o?[]:x8(e),u=new f8(a,e);u.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=u.text,this.newSel=y8(a,this.bounds.from)}else{let a=e.observer.selectionRange,u=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!Oy(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),f=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Oy(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),p=e.viewport;if((He.ios||He.chrome)&&e.state.selection.main.empty&&u!=f&&(p.from>0||p.to<e.state.doc.length)){let g=Math.min(u,f),x=Math.max(u,f),A=p.from-g,_=p.to-x;(A==0||A==1||g==0)&&(_==0||_==-1||x==e.state.doc.length)&&(u=0,f=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(we.range(f,u)):this.newSel=we.single(f,u)}}}function hC(n,e,t,r){if(n.isComposite()){let i=-1,s=-1,o=-1,a=-1;for(let u=0,f=r,p=r;u<n.children.length;u++){let g=n.children[u],x=f+g.length;if(f<e&&x>t)return hC(g,e,t,f);if(x>=e&&i==-1&&(i=u,s=f),f>t&&g.dom.parentNode==n.dom){o=u,a=p;break}p=x,f=x+g.breakAfter}return{from:s,to:a<0?r+n.length:a,startDOM:(i?n.children[i-1].dom.nextSibling:null)||n.dom.firstChild,endDOM:o<n.children.length&&o>=0?n.children[o].dom:null}}else return n.isText()?{from:r,to:r+n.length,startDOM:n.dom,endDOM:n.dom.nextSibling}:null}function fC(n,e){let t,{newSel:r}=e,i=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,u=i.from,f=null;(s===8||He.android&&e.text.length<a-o)&&(u=i.to,f="end");let p=dC(n.state.doc.sliceString(o,a,Ku),e.text,u-o,f);p&&(He.chrome&&s==13&&p.toB==p.from+2&&e.text.slice(p.from,p.toB)==Ku+Ku&&p.toB--,t={from:o+p.from,to:o+p.toA,insert:Lt.of(e.text.slice(p.from,p.toB).split(Ku))})}else r&&(!n.hasFocus&&n.state.facet(no)||cp(r,i))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!i.empty&&r&&r.main.empty?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,i.to)}:(He.mac||He.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(r&&t.insert.length==2&&(r=we.single(r.main.anchor-1,r.main.head-1)),t={from:t.from,to:t.to,insert:Lt.of([t.insert.toString().replace("."," ")])}):t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,i.to))}:n.state.doc.lineAt(i.from).to<i.to&&n.docView.lineHasWidget(i.to)&&n.inputState.insertingTextAt>Date.now()-50?t={from:i.from,to:i.to,insert:n.state.toText(n.inputState.insertingText)}:He.chrome&&t&&t.from==t.to&&t.from==i.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(r&&(r=we.single(r.main.anchor-1,r.main.head-1)),t={from:i.from,to:i.to,insert:Lt.of([" "])}),t)return jv(n,t,r,s);if(r&&!cp(r,i)){let o=!1,a="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),a=n.inputState.lastSelectionOrigin,a=="select.pointer"&&(r=cC(n.state.facet(jh).map(u=>u(n)),r))),n.dispatch({selection:r,scrollIntoView:o,userEvent:a}),!0}else return!1}function jv(n,e,t,r=-1){if(He.ios&&n.inputState.flushIOSKey(e))return!0;let i=n.state.selection.main;if(He.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&n.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&dc(n.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&dc(n.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&dc(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,a=()=>o||(o=g8(n,e,t));return n.state.facet(K2).some(u=>u(n,e.from,e.to,s,a))||n.dispatch(a()),!0}function g8(n,e,t){let r,i=n.state,s=i.selection.main,o=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let u=e.from<s.from?-1:1,f=u<0?s.from:s.to,p=uh(i.facet(jh).map(g=>g(n)),f,u);e.from==p&&(o=p)}if(o>-1)r={changes:e,selection:we.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let u=s.from<e.from?i.sliceDoc(s.from,e.from):"",f=s.to>e.to?i.sliceDoc(e.to,s.to):"";r=i.replaceSelection(n.state.toText(u+e.insert.sliceString(0,void 0,n.state.lineBreak)+f))}else{let u=i.changes(e),f=t&&t.main.to<=u.newLength?t.main:void 0;if(i.selection.ranges.length>1&&(n.inputState.composing>=0||n.inputState.compositionPendingChange)&&e.to<=s.to+10&&e.to>=s.to-10){let p=n.state.sliceDoc(e.from,e.to),g,x=t&&lC(n,t.main.head);if(x){let _=e.insert.length-(e.to-e.from);g={from:x.from,to:x.to-_}}else g=n.state.doc.lineAt(s.head);let A=s.to-e.to;r=i.changeByRange(_=>{if(_.from==s.from&&_.to==s.to)return{changes:u,range:f||_.map(u)};let b=_.to-A,w=b-p.length;if(n.state.sliceDoc(w,b)!=p||b>=g.from&&w<=g.to)return{range:_};let C=i.changes({from:w,to:b,insert:e.insert}),T=_.to-s.to;return{changes:C,range:f?we.range(Math.max(0,f.anchor+T),Math.max(0,f.head+T)):_.map(C)}})}else r={changes:u,selection:f&&i.selection.replaceRange(f)}}let a="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,a+=".compose",n.inputState.compositionFirstChange&&(a+=".start",n.inputState.compositionFirstChange=!1)),i.update(r,{userEvent:a,scrollIntoView:!0})}function dC(n,e,t,r){let i=Math.min(n.length,e.length),s=0;for(;s<i&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&n.length==e.length)return null;let o=n.length,a=e.length;for(;o>0&&a>0&&n.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(r=="end"){let u=Math.max(0,s-Math.min(o,a));t-=o+u-s}if(o<s&&n.length<e.length){let u=t<=s&&t>=o?s-t:0;s-=u,a=s+(a-o),o=s}else if(a<s){let u=t<=s&&t>=a?s-t:0;s-=u,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function x8(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new bw(t,r)),(i!=t||s!=r)&&e.push(new bw(i,s))),e}function y8(n,e){if(n.length==0)return null;let t=n[0].pos,r=n.length==2?n[1].pos:t;return t>-1&&r>-1?we.single(t+e,r+e):null}function cp(n,e){return e.head==n.main.head&&e.anchor==n.main.anchor}class v8{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,He.safari&&e.contentDOM.addEventListener("input",()=>null),He.gecko&&M8(e.contentDOM.ownerDocument)}handleEvent(e){!C8(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let i of r.observers)i(this.view,t);for(let i of r.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=A8(e),r=this.handlers,i=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,a=r[s];a&&o!=!a.handlers.length&&(i.removeEventListener(s,this.handleEvent),a=null),a||i.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)s!="scroll"&&!t[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&mC.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),He.android&&He.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return He.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=pC.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||b8.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,dc(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:He.safari&&!He.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function ww(n,e){return(t,r)=>{try{return e.call(n,r,t)}catch(i){Fr(t.state,i)}}}function A8(n){let e=Object.create(null);function t(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of n){let i=r.spec,s=i&&i.plugin.domEventHandlers,o=i&&i.plugin.domEventObservers;if(s)for(let a in s){let u=s[a];u&&t(a).handlers.push(ww(r.value,u))}if(o)for(let a in o){let u=o[a];u&&t(a).observers.push(ww(r.value,u))}}for(let r in Wi)t(r).handlers.push(Wi[r]);for(let r in Oi)t(r).observers.push(Oi[r]);return e}const pC=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],b8="dthko",mC=[16,17,18,20,91,92,224,225],Sd=6;function Cd(n){return Math.max(0,n)*.7+8}function w8(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class _8{constructor(e,t,r,i){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=S3(e.contentDOM),this.atoms=e.state.facet(jh).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Rt.allowMultipleSelections)&&O8(e,t),this.dragging=S8(e,t)&&yC(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&w8(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,r=0,i=0,s=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:a}=this.scrollParents.y.getBoundingClientRect());let u=zv(this.view);e.clientX-u.left<=i+Sd?t=-Cd(i-e.clientX):e.clientX+u.right>=o-Sd&&(t=Cd(e.clientX-o)),e.clientY-u.top<=s+Sd?r=-Cd(s-e.clientY):e.clientY+u.bottom>=a-Sd&&(r=Cd(e.clientY-a)),this.setScrollSpeed(t,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,r=cC(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function O8(n,e){let t=n.state.facet(U2);return t.length?t[0](e):He.mac?e.metaKey:e.ctrlKey}function k8(n,e){let t=n.state.facet(Z2);return t.length?t[0](e):He.mac?!e.altKey:!e.ctrlKey}function S8(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=Oc(n.root);if(!r||r.rangeCount==0)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function C8(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=Tn.get(t))&&r.isWidget()&&!r.isHidden&&r.widget.ignoreEvent(e))return!1;return!0}const Wi=Object.create(null),Oi=Object.create(null),gC=He.ie&&He.ie_version<15||He.ios&&He.webkit_version<604;function T8(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),xC(n,t.value)},50)}function nm(n,e,t){for(let r of n.facet(e))t=r(t,n);return t}function xC(n,e){e=nm(n.state,Nv,e);let{state:t}=n,r,i=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(Ry!=null&&t.selection.ranges.every(u=>u.empty)&&Ry==s.toString()){let u=-1;r=t.changeByRange(f=>{let p=t.doc.lineAt(f.from);if(p.from==u)return{range:f};u=p.from;let g=t.toText((o?s.line(i++).text:e)+t.lineBreak);return{changes:{from:p.from,insert:g},range:we.cursor(f.from+g.length)}})}else o?r=t.changeByRange(u=>{let f=s.line(i++);return{changes:{from:u.from,to:u.to,insert:f.text},range:we.cursor(u.from+f.length)}}):r=t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Oi.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Wi.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);Oi.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};Oi.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Wi.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let r of n.state.facet(G2))if(t=r(n,e),t)break;if(!t&&e.button==0&&(t=P8(n,e)),t){let r=!n.hasFocus;n.inputState.startMouseSelection(new _8(n,e,t,r)),r&&n.observer.ignore(()=>{I2(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let i=n.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function _w(n,e,t,r){if(r==1)return we.cursor(e,t);if(r==2)return a8(n.state,e,t);{let i=n.docView.lineAt(e,t),s=n.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,a=i?i.posAtEnd:s.to;return a<n.state.doc.length&&a==s.to&&a++,we.range(o,a)}}const E8=He.ie&&He.ie_version<=11;let Ow=null,kw=0,Sw=0;function yC(n){if(!E8)return n.detail;let e=Ow,t=Sw;return Ow=n,Sw=Date.now(),kw=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(kw+1)%3:1}function P8(n,e){let t=n.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),r=yC(e),i=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),i=i.map(s.changes))},get(s,o,a){let u=n.posAndSideAtCoords({x:s.clientX,y:s.clientY},!1),f,p=_w(n,u.pos,u.assoc,r);if(t.pos!=u.pos&&!o){let g=_w(n,t.pos,t.assoc,r),x=Math.min(g.from,p.from),A=Math.max(g.to,p.to);p=x<p.from?we.range(x,A):we.range(A,x)}return o?i.replaceRange(i.main.extend(p.from,p.to)):a&&r==1&&i.ranges.length>1&&(f=B8(i,u.pos))?f:a?i.addRange(p):we.create([p])}}}function B8(n,e){for(let t=0;t<n.ranges.length;t++){let{from:r,to:i}=n.ranges[t];if(r<=e&&i>=e)return we.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Wi.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let i=n.docView.tile.nearest(e.target);if(i&&i.isWidget()){let s=i.posAtStart,o=s+i.length;(s>=t.to||o<=t.from)&&(t=we.range(s,o))}}let{inputState:r}=n;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",nm(n.state,Lv,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Wi.dragend=n=>(n.inputState.draggedContent=null,!1);function Cw(n,e,t,r){if(t=nm(n.state,Nv,t),!t)return;let i=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=r&&s&&k8(n,e)?{from:s.from,to:s.to}:null,a={from:i,insert:t},u=n.state.changes(o?[o,a]:a);n.focus(),n.dispatch({changes:u,selection:{anchor:u.mapPos(i,-1),head:u.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Wi.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let r=Array(t.length),i=0,s=()=>{++i==t.length&&Cw(n,e,r.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(r[o]=a.result),s()},a.readAsText(t[o])}return!0}else{let r=e.dataTransfer.getData("Text");if(r)return Cw(n,e,r,!0),!0}return!1};Wi.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=gC?null:e.clipboardData;return t?(xC(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(T8(n),!1)};function R8(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}function D8(n){let e=[],t=[],r=!1;for(let i of n.selection.ranges)i.empty||(e.push(n.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>i&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),i=o.number}r=!0}return{text:nm(n,Lv,e.join(n.lineBreak)),ranges:t,linewise:r}}let Ry=null;Wi.copy=Wi.cut=(n,e)=>{let t=Oc(n.root);if(t&&!ah(n.contentDOM,t))return!1;let{text:r,ranges:i,linewise:s}=D8(n.state);if(!r&&!s)return!1;Ry=s?r:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let o=gC?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",r),!0):(R8(n,r),!1)};const vC=_s.define();function AC(n,e){let t=[];for(let r of n.facet(Y2)){let i=r(n,e);i&&t.push(i)}return t.length?n.update({effects:t,annotations:vC.of(!0)}):null}function bC(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=AC(n.state,e);t?n.dispatch(t):n.update([])}},10)}Oi.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),bC(n)};Oi.blur=n=>{n.observer.clearSelectionRange(),bC(n)};Oi.compositionstart=Oi.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};Oi.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,He.chrome&&He.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};Oi.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Wi.beforeinput=(n,e)=>{var t,r;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(n.inputState.insertingText=e.data,n.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let a=o[0],u=n.posAtDOM(a.startContainer,a.startOffset),f=n.posAtDOM(a.endContainer,a.endOffset);return jv(n,{from:u,to:f,insert:n.state.toText(s)},null),!0}}let i;if(He.chrome&&He.android&&(i=pC.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return He.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),He.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>Oi.compositionend(n,e),20),!1};const Tw=new Set;function M8(n){Tw.has(n)||(Tw.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const Ew=["pre-wrap","normal","pre-line","break-spaces"];let Cc=!1;function Pw(){Cc=!1}class N8{constructor(e){this.lineWrapping=e,this.doc=Lt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Ew.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,r,i,s,o){let a=Ew.indexOf(e)>-1,u=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=a||Math.abs(r-this.charWidth)>.1;if(this.lineWrapping=a,this.lineHeight=t,this.charWidth=r,this.textHeight=i,this.lineLength=s,u){this.heightSamples={};for(let f=0;f<o.length;f++){let p=o[f];p<0?f++:this.heightSamples[Math.floor(p*10)]=!0}}return u}}class L8{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class zi{constructor(e,t,r,i,s){this.from=e,this.length=t,this.top=r,this.height=i,this._content=s}get type(){return typeof this._content=="number"?tr.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof rl?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new zi(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Yt=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(Yt||(Yt={}));const n0=.001;class _r{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>n0&&(Cc=!0),this.height=e)}replace(e,t,r){return _r.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,i){let s=this,o=r.doc;for(let a=i.length-1;a>=0;a--){let{fromA:u,toA:f,fromB:p,toB:g}=i[a],x=s.lineAt(u,Yt.ByPosNoHeight,r.setDoc(t),0,0),A=x.to>=f?x:s.lineAt(f,Yt.ByPosNoHeight,r,0,0);for(g+=A.to-f,f=A.to;a>0&&x.from<=i[a-1].toA;)u=i[a-1].fromA,p=i[a-1].fromB,a--,u<x.from&&(x=s.lineAt(u,Yt.ByPosNoHeight,r,0,0));p+=x.from-u,u=x.from;let _=Qv.build(r.setDoc(o),e,p,g);s=up(s,s.replace(u,f,_))}return s.updateHeight(r,0)}static empty(){return new ti(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,i=0,s=0;for(;;)if(t==r)if(i>s*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),r+=1+a.break,i-=a.size}else if(s>i*2){let a=e[r];a.break?e.splice(r,1,a.left,null,a.right):e.splice(r,1,a.left,a.right),r+=2+a.break,s-=a.size}else break;else if(i<s){let a=e[t++];a&&(i+=a.size)}else{let a=e[--r];a&&(s+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,r++),new I8(_r.of(e.slice(0,t)),o,_r.of(e.slice(r)))}}function up(n,e){return n==e?n:(n.constructor!=e.constructor&&(Cc=!0),e)}_r.prototype.size=1;const F8=Je.replace({});class wC extends _r{constructor(e,t,r){super(e,t),this.deco=r,this.spaceAbove=0}mainBlock(e,t){return new zi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,r,i){return this.spaceAbove&&e<r+this.spaceAbove?new zi(i,0,r,this.spaceAbove,F8):this.mainBlock(r,i)}lineAt(e,t,r,i,s){let o=this.mainBlock(i,s);return this.spaceAbove?this.blockAt(0,r,i,s).join(o):o}forEachLine(e,t,r,i,s,o){e<=s+this.length&&t>=s&&o(this.lineAt(0,Yt.ByPos,r,i,s))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more&&this.setMeasuredHeight(i),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ti extends wC{constructor(e,t,r){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=r}mainBlock(e,t){return new zi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,r){let i=r[0];return r.length==1&&(i instanceof ti||i instanceof Yn&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Yn?i=new ti(i.length,this.height,this.spaceAbove):i.height=this.height,this.outdated||(i.outdated=!1),i):_r.of(r)}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more?this.setMeasuredHeight(i):(r||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Yn extends _r{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,s=i-r+1,o,a=0;if(e.lineWrapping){let u=Math.min(this.height,e.lineHeight*s);o=u/s,this.length>s+1&&(a=(this.height-u)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:i,perLine:o,perChar:a}}blockAt(e,t,r,i){let{firstLine:s,lastLine:o,perLine:a,perChar:u}=this.heightMetrics(t,i);if(t.lineWrapping){let f=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),p=t.doc.lineAt(f),g=a+p.length*u,x=Math.max(r,e-g/2);return new zi(p.from,p.length,x,g,0)}else{let f=Math.max(0,Math.min(o-s,Math.floor((e-r)/a))),{from:p,length:g}=t.doc.line(s+f);return new zi(p,g,r+a*f,a,0)}}lineAt(e,t,r,i,s){if(t==Yt.ByHeight)return this.blockAt(e,r,i,s);if(t==Yt.ByPosNoHeight){let{from:A,to:_}=r.doc.lineAt(e);return new zi(A,_-A,0,0,0)}let{firstLine:o,perLine:a,perChar:u}=this.heightMetrics(r,s),f=r.doc.lineAt(e),p=a+f.length*u,g=f.number-o,x=i+a*g+u*(f.from-s-g);return new zi(f.from,f.length,Math.max(i,Math.min(x,i+this.height-p)),p,0)}forEachLine(e,t,r,i,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:a,perLine:u,perChar:f}=this.heightMetrics(r,s);for(let p=e,g=i;p<=t;){let x=r.doc.lineAt(p);if(p==e){let _=x.number-a;g+=u*_+f*(e-s-_)}let A=u+f*x.length;o(new zi(x.from,x.length,g,A,0)),g+=A,p=x.to+1}}replace(e,t,r){let i=this.length-t;if(i>0){let s=r[r.length-1];s instanceof Yn?r[r.length-1]=new Yn(s.length+i):r.push(null,new Yn(i-1))}if(e>0){let s=r[0];s instanceof Yn?r[0]=new Yn(e+s.length):r.unshift(new Yn(e-1),null)}return _r.of(r)}decomposeLeft(e,t){t.push(new Yn(e-1),null)}decomposeRight(e,t){t.push(null,new Yn(this.length-e-1))}updateHeight(e,t=0,r=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let o=[],a=Math.max(t,i.from),u=-1;for(i.from>t&&o.push(new Yn(i.from-t-1).updateHeight(e,t));a<=s&&i.more;){let p=e.doc.lineAt(a).length;o.length&&o.push(null);let g=i.heights[i.index++],x=0;g<0&&(x=-g,g=i.heights[i.index++]),u==-1?u=g:Math.abs(g-u)>=n0&&(u=-2);let A=new ti(p,g,x);A.outdated=!1,o.push(A),a+=p+1}a<=s&&o.push(null,new Yn(s-a).updateHeight(e,a));let f=_r.of(o);return(u<0||Math.abs(f.height-this.height)>=n0||Math.abs(u-this.heightMetrics(e,t).perLine)>=n0)&&(Cc=!0),up(this,f)}else(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class I8 extends _r{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,r,i,s){let o=i+this.left.height,a=s+this.left.length+this.break,u=t==Yt.ByHeight?e<o:e<a,f=u?this.left.lineAt(e,t,r,i,s):this.right.lineAt(e,t,r,o,a);if(this.break||(u?f.to<a:f.from>a))return f;let p=t==Yt.ByPosNoHeight?Yt.ByPosNoHeight:Yt.ByPos;return u?f.join(this.right.lineAt(a,p,r,o,a)):this.left.lineAt(a,p,r,i,s).join(f)}forEachLine(e,t,r,i,s,o){let a=i+this.left.height,u=s+this.left.length+this.break;if(this.break)e<u&&this.left.forEachLine(e,t,r,i,s,o),t>=u&&this.right.forEachLine(e,t,r,a,u,o);else{let f=this.lineAt(u,Yt.ByPos,r,i,s);e<f.from&&this.left.forEachLine(e,f.from-1,r,i,s,o),f.to>=e&&f.from<=t&&o(f),t>f.to&&this.right.forEachLine(f.to+1,t,r,a,u,o)}}replace(e,t,r){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of r)s.push(a);if(e>0&&Bw(s,o-1),t<this.length){let a=s.length;this.decomposeRight(t,s),Bw(s,a)}return _r.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?_r.of(this.break?[e,null,t]:[e,t]):(this.left=up(this.left,e),this.right=up(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,i){let{left:s,right:o}=this,a=t+s.length+this.break,u=null;return i&&i.from<=t+s.length&&i.more?u=s=s.updateHeight(e,t,r,i):s.updateHeight(e,t,r),i&&i.from<=a+o.length&&i.more?u=o=o.updateHeight(e,a,r,i):o.updateHeight(e,a,r),u?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Bw(n,e){let t,r;n[e]==null&&(t=n[e-1])instanceof Yn&&(r=n[e+1])instanceof Yn&&n.splice(e-1,3,new Yn(t.length+1+r.length))}const z8=5;class Qv{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof ti?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new ti(r-this.pos,-1,0)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new wC(o,i,r)):(o||s||i>=z8)&&this.addLineDeco(i,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new ti(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let r=new Yn(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof ti)return e;let t=new ti(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let i=this.ensureLine();i.length+=r,i.collapsed+=r,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof ti)&&!this.isCovered?this.nodes.push(new ti(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let i of this.nodes)i instanceof ti&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,t,r,i){let s=new Qv(r,e);return Tt.spans(t,r,i,s,0),s.finish(r)}}function j8(n,e,t){let r=new Q8;return Tt.compare(n,e,t,r,0),r.changes}class Q8{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,i){(e<t||r&&r.heightRelevant||i&&i.heightRelevant)&&fc(e,t,this.changes,5)}}function H8(n,e){let t=n.getBoundingClientRect(),r=n.ownerDocument,i=r.defaultView||window,s=Math.max(0,t.left),o=Math.min(i.innerWidth,t.right),a=Math.max(0,t.top),u=Math.min(i.innerHeight,t.bottom);for(let f=n.parentNode;f&&f!=r.body;)if(f.nodeType==1){let p=f,g=window.getComputedStyle(p);if((p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth)&&g.overflow!="visible"){let x=p.getBoundingClientRect();s=Math.max(s,x.left),o=Math.min(o,x.right),a=Math.max(a,x.top),u=Math.min(f==n.parentNode?i.innerHeight:u,x.bottom)}f=g.position=="absolute"||g.position=="fixed"?p.offsetParent:p.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:a-(t.top+e),bottom:Math.max(a,u)-(t.top+e)}}function W8(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function q8(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class mx{constructor(e,t,r,i){this.from=e,this.to=t,this.size=r,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,t){return Je.replace({widget:new V8(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class V8 extends $i{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Rw{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Dw,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Zt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Fv).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new N8(t),this.stateDeco=Mw(e),this.heightMap=_r.empty().applyChanges(this.stateDeco,Lt.empty,this.heightOracle.setDoc(e.doc),[new Ai(0,0,0,e.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Je.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let i=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new Td(s,o))}}return this.viewports=e.sort((r,i)=>r.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Dw:new Hv(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Yu(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=Mw(this.state);let i=e.changedRanges,s=Ai.extendWithRanges(i,j8(r,this.stateDeco,e?e.changes:Ln.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Pw(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Cc)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let u=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<u.from||t.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,t));let f=u.from!=this.viewport.from||u.to!=this.viewport.to;this.viewport=u,e.flags|=this.updateForViewport(),(f||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(eC)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?Zt.RTL:Zt.LTR;let o=this.heightOracle.mustRefreshForWrapping(s)||this.mustMeasureContent,a=t.getBoundingClientRect(),u=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let f=0,p=0;if(a.width&&a.height){let{scaleX:D,scaleY:N}=F2(t,a);(D>.005&&Math.abs(this.scaleX-D)>.005||N>.005&&Math.abs(this.scaleY-N)>.005)&&(this.scaleX=D,this.scaleY=N,f|=16,o=u=!0)}let g=(parseInt(r.paddingTop)||0)*this.scaleY,x=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=g||this.paddingBottom!=x)&&(this.paddingTop=g,this.paddingBottom=x,f|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(u=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=16);let A=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=A&&(this.scrollAnchorHeight=-1,this.scrollTop=A),this.scrolledToBottom=z2(e.scrollDOM);let _=(this.printing?q8:H8)(t,this.paddingTop),b=_.top-this.pixelViewport.top,w=_.bottom-this.pixelViewport.bottom;this.pixelViewport=_;let C=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(C!=this.inView&&(this.inView=C,C&&(u=!0)),!this.inView&&!this.scrollTarget&&!W8(e.dom))return 0;let T=a.width;if((this.contentDOMWidth!=T||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,f|=16),u){let D=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(D)&&(o=!0),o||i.lineWrapping&&Math.abs(T-this.contentDOMWidth)>i.charWidth){let{lineHeight:N,charWidth:F,textHeight:z}=e.docView.measureTextSize();o=N>0&&i.refresh(s,N,F,z,Math.max(5,T/F),D),o&&(e.docView.minWidth=0,f|=16)}b>0&&w>0?p=Math.max(b,w):b<0&&w<0&&(p=Math.min(b,w)),Pw();for(let N of this.viewports){let F=N.from==this.viewport.from?D:e.docView.measureVisibleLineHeights(N);this.heightMap=(o?_r.empty().applyChanges(this.stateDeco,Lt.empty,this.heightOracle,[new Ai(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new L8(N.from,F))}Cc&&(f|=2)}let E=!this.viewportIsAppropriate(this.viewport,p)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return E&&(f&2&&(f|=this.updateScaler()),this.viewport=this.getViewport(p,this.scrollTarget),f|=this.updateForViewport()),(f&2||E)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,u=new Td(i.lineAt(o-r*1e3,Yt.ByHeight,s,0,0).from,i.lineAt(a+(1-r)*1e3,Yt.ByHeight,s,0,0).to);if(t){let{head:f}=t.range;if(f<u.from||f>u.to){let p=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=i.lineAt(f,Yt.ByPos,s,0,0),x;t.y=="center"?x=(g.top+g.bottom)/2-p/2:t.y=="start"||t.y=="nearest"&&f<u.from?x=g.top:x=g.bottom-p,u=new Td(i.lineAt(x-1e3/2,Yt.ByHeight,s,0,0).from,i.lineAt(x+p+1e3/2,Yt.ByHeight,s,0,0).to)}}return u}mapViewport(e,t){let r=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new Td(this.heightMap.lineAt(r,Yt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,Yt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,Yt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,Yt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||i<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=a+Math.max(10,Math.min(r,250)))&&i>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let i of e)t.touchesRange(i.from,i.to)||r.push(new mx(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,i=r?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=Zt.LTR&&!r)return[];let a=[],u=(p,g,x,A)=>{if(g-p<s)return;let _=this.state.selection.main,b=[_.from];_.empty||b.push(_.to);for(let C of b)if(C>p&&C<g){u(p,C-10,x,A),u(C+10,g,x,A);return}let w=U8(e,C=>C.from>=x.from&&C.to<=x.to&&Math.abs(C.from-p)<s&&Math.abs(C.to-g)<s&&!b.some(T=>C.from<T&&C.to>T));if(!w){if(g<x.to&&t&&r&&t.visibleRanges.some(E=>E.from<=g&&E.to>=g)){let E=t.moveToLineBoundary(we.cursor(g),!1,!0).head;E>p&&(g=E)}let C=this.gapSize(x,p,g,A),T=r||C<2e6?C:2e6;w=new mx(p,g,C,T)}a.push(w)},f=p=>{if(p.length<o||p.type!=tr.Text)return;let g=$8(p.from,p.to,this.stateDeco);if(g.total<o)return;let x=this.scrollTarget?this.scrollTarget.range.head:null,A,_;if(r){let b=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,w,C;if(x!=null){let T=Pd(g,x),E=((this.visibleBottom-this.visibleTop)/2+b)/p.height;w=T-E,C=T+E}else w=(this.visibleTop-p.top-b)/p.height,C=(this.visibleBottom-p.top+b)/p.height;A=Ed(g,w),_=Ed(g,C)}else{let b=g.total*this.heightOracle.charWidth,w=i*this.heightOracle.charWidth,C=0;if(b>2e6)for(let F of e)F.from>=p.from&&F.from<p.to&&F.size!=F.displaySize&&F.from*this.heightOracle.charWidth+C<this.pixelViewport.left&&(C=F.size-F.displaySize);let T=this.pixelViewport.left+C,E=this.pixelViewport.right+C,D,N;if(x!=null){let F=Pd(g,x),z=((E-T)/2+w)/b;D=F-z,N=F+z}else D=(T-w)/b,N=(E+w)/b;A=Ed(g,D),_=Ed(g,N)}A>p.from&&u(p.from,A,p,g),_<p.to&&u(_,p.to,p,g)};for(let p of this.viewportLines)Array.isArray(p.type)?p.type.forEach(f):f(p);return a}gapSize(e,t,r,i){let s=Pd(i,r)-Pd(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){mx.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Je.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];Tt.spans(t,this.viewport.from,this.viewport.to,{span(s,o){r.push({from:s,to:o})},point(){}},20);let i=0;if(r.length!=this.visibleRanges.length)i=12;else for(let s=0;s<r.length&&!(i&8);s++){let o=this.visibleRanges[s],a=r[s];(o.from!=a.from||o.to!=a.to)&&(i|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(i|=8))}return this.visibleRanges=r,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Yu(this.heightMap.lineAt(e,Yt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Yu(this.heightMap.lineAt(this.scaler.fromDOM(e),Yt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Yu(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Td{constructor(e,t){this.from=e,this.to=t}}function $8(n,e,t){let r=[],i=n,s=0;return Tt.spans(t,n,e,{span(){},point(o,a){o>i&&(r.push({from:i,to:o}),s+=o-i),i=a}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function Ed({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let i=0;;i++){let{from:s,to:o}=e[i],a=o-s;if(r<=a)return s+r;r-=a}}function Pd(n,e){let t=0;for(let{from:r,to:i}of n.ranges){if(e<=i){t+=e-r;break}t+=i-r}return t/n.total}function U8(n,e){for(let t of n)if(e(t))return t}const Dw={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};function Mw(n){let e=n.facet(Jp).filter(r=>typeof r!="function"),t=n.facet(Iv).filter(r=>typeof r!="function");return t.length&&e.push(Tt.join(t)),e}class Hv{constructor(e,t,r){let i=0,s=0,o=0;this.viewports=r.map(({from:a,to:u})=>{let f=t.lineAt(a,Yt.ByPos,e,0,0).top,p=t.lineAt(u,Yt.ByPos,e,0,0).bottom;return i+=p-f,{from:a,to:u,top:f,bottom:p,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}eq(e){return e instanceof Hv?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to):!1}}function Yu(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new zi(n.from,n.length,t,r-t,Array.isArray(n._content)?n._content.map(i=>Yu(i,e)):n._content)}const Bd=je.define({combine:n=>n.join(" ")}),Dy=je.define({combine:n=>n.indexOf(!0)>-1}),My=ra.newName(),_C=ra.newName(),OC=ra.newName(),kC={"&light":"."+_C,"&dark":"."+OC};function Ny(n,e,t){return new ra(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,i=>{if(i=="&")return n;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):n+" "+r}})}const Z8=Ny("."+My,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},kC),G8={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},gx=He.ie&&He.ie_version<=11;class X8{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new C3,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(He.ie&&He.ie_version<=11||He.ios&&e.composing)&&t.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&He.android&&e.constructor.EDIT_CONTEXT!==!1&&!(He.chrome&&He.chrome_version<126)&&(this.editContext=new Y8(e),e.state.facet(no)&&(e.contentDOM.editContext=this.editContext.editContext)),gx&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(no)?r.root.activeElement!=this.dom:!ah(this.dom,i))return;let s=i.anchorNode&&r.docView.tile.nearest(i.anchorNode);if(s&&s.isWidget()&&s.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(He.ie&&He.ie_version<=11||He.android&&He.chrome)&&!r.state.selection.main.empty&&i.focusNode&&ch(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Oc(e.root);if(!t)return!1;let r=He.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&K8(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let i=ah(this.dom,r);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&E3(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,G8),gx&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),gx&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&dc(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(i=!0),t==-1?{from:t,to:r}=o:(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:i}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),i=this.selectionChanged&&ah(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new m8(this.view,e,t,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,i=fC(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!cp(this.view.state.selection,t.newSel.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let r=Nw(t,e.previousSibling||e.target.previousSibling,-1),i=Nw(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(no)!=e.state.facet(no)&&(e.view.contentDOM.editContext=e.state.facet(no)?this.editContext.editContext:null))}destroy(){var e,t,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Nw(n,e,t){for(;e;){let r=Tn.get(e);if(r&&r.parent==n)return r;let i=e.parentNode;e=i!=n.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function Lw(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor,1);return ch(o.node,o.offset,i,s)&&([t,r,i,s]=[i,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}}function K8(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return Lw(n,i)}let t=null;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),t?Lw(n,t):null}class Y8{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=r=>{let i=e.state.selection.main,{anchor:s,head:o}=i,a=this.toEditorPos(r.updateRangeStart),u=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:a,drifted:!1});let f=u-a>r.text.length;a==this.from&&s<this.from?a=s:u==this.to&&s>this.to&&(u=s);let p=dC(e.state.sliceDoc(a,u),r.text,(f?i.from:i.to)-a,f?"end":null);if(!p){let x=we.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));cp(x,i)||e.dispatch({selection:x,userEvent:"select"});return}let g={from:p.from+a,to:p.toA+a,insert:Lt.of(r.text.slice(p.from,p.toB).split(`
`))};if((He.mac||He.android)&&g.from==o-1&&/^\. ?$/.test(r.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(g={from:a,to:u,insert:Lt.of([r.text.replace("."," ")])}),this.pendingContextChange=g,!e.state.readOnly){let x=this.to-this.from+(g.to-g.from+g.insert.length);jv(e,g,we.single(this.toEditorPos(r.selectionStart,x),this.toEditorPos(r.selectionEnd,x)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),g.from<g.to&&!g.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(t.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let i=[],s=null;for(let o=this.toEditorPos(r.rangeStart),a=this.toEditorPos(r.rangeEnd);o<a;o++){let u=e.coordsForChar(o);s=u&&new DOMRect(u.left,u.top,u.right-u.left,u.bottom-u.top)||s||new DOMRect,i.push(s)}t.updateCharacterBounds(r.rangeStart,i)},this.handlers.textformatupdate=r=>{let i=[];for(let s of r.getTextFormats()){let o=s.underlineStyle,a=s.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(a)){let u=this.toEditorPos(s.rangeStart),f=this.toEditorPos(s.rangeEnd);if(u<f){let p=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(a)?1:2}px`;i.push(Je.mark({attributes:{style:p}}).range(u,f))}}}e.dispatch({effects:nC.of(Je.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(e.state)}};for(let r in this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let i=Oc(r.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,o,a,u,f)=>{if(r)return;let p=f.length-(o-s);if(i&&o>=i.to)if(i.from==s&&i.to==o&&i.insert.eq(f)){i=this.pendingContextChange=null,t+=p,this.to+=p;return}else i=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=p,this.to+=p;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+f.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),f.toString()),this.to+=p}t+=p}),i&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(r,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Ne{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(i=>i.forEach(s=>r(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||T3(e.parent)||document,this.viewState=new Rw(e.state||Rt.create(e)),e.scrollTo&&e.scrollTo.is(kd)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(sc).map(i=>new ux(i));for(let i of this.plugins)i.update(this);this.observer=new X8(this),this.inputState=new v8(this),this.inputState.ensureHandlers(this.plugins),this.docView=new yw(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof Cn?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,i,s=this.state;for(let x of e){if(x.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=x.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,u=null;e.some(x=>x.annotation(vC))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,u=AC(s,o),u||(a=1));let f=this.observer.delayedAndroidKey,p=null;if(f?(this.observer.clearDelayedAndroidKey(),p=this.observer.readChange(),(p&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(p=null)):this.observer.clear(),s.facet(Rt.phrases)!=this.state.facet(Rt.phrases))return this.setState(s);i=op.create(this,s,e),i.flags|=a;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let x of e){if(g&&(g=g.map(x.changes)),x.scrollIntoView){let{main:A}=x.state.selection;g=new pc(A.empty?A:we.cursor(A.head,A.head>A.anchor?-1:1))}for(let A of x.effects)A.is(kd)&&(g=A.value.clip(this.state))}this.viewState.update(i,g),this.bidiCache=hp.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(Xu)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(x=>x.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(Bd)!=i.state.facet(Bd)&&(this.viewState.mustMeasureContent=!0),(t||r||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!i.empty)for(let x of this.state.facet(Ty))try{x(i)}catch(A){Fr(this.state,A,"update listener")}(u||p)&&Promise.resolve().then(()=>{u&&this.state==u.startState&&this.dispatch(u),p&&!fC(this,p)&&f.force&&dc(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Rw(e),this.plugins=e.facet(sc).map(r=>new ux(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new yw(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(sc),r=e.state.facet(sc);if(t!=r){let i=[];for(let s of r){let o=t.indexOf(s);if(o<0)i.push(new ux(s));else{let a=this.plugins[o];a.mustUpdate=e,i.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(r){Fr(this.state,r,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,i=r.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(z2(r))s=-1,o=this.viewState.heightMap.height;else{let A=this.viewState.scrollAnchorAt(i);s=A.from,o=A.top}this.updateState=1;let u=this.viewState.measure(this);if(!u&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let f=[];u&4||([this.measureRequests,f]=[f,this.measureRequests]);let p=f.map(A=>{try{return A.read(this)}catch(_){return Fr(this.state,_),Fw}}),g=op.create(this,this.state,[]),x=!1;g.flags|=u,t?t.flags|=u:t=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),x=this.docView.update(g),x&&this.docViewUpdate());for(let A=0;A<f.length;A++)if(p[A]!=Fw)try{let _=f[A];_.write&&_.write(p[A],this)}catch(_){Fr(this.state,_)}if(x&&this.docView.updateSelection(!0),!g.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let _=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(_>1||_<-1){i=i+_,r.scrollTop=i/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let a of this.state.facet(Ty))a(t)}get themeClasses(){return My+" "+(this.state.facet(Dy)?OC:_C)+" "+this.state.facet(Bd)}updateAttrs(){let e=Iw(this,rC,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(no)?"true":"false",class:"cm-content",style:`${He.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Iw(this,Fv,t);let r=this.observer.ignore(()=>{let i=fw(this.contentDOM,this.contentAttrs,t),s=fw(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let i of r.effects)if(i.is(Ne.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(Xu);let e=this.state.facet(Ne.cspNonce);ra.mount(this.root,this.styleModules.concat(Z8).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return px(this,e,vw(this,e,t,r))}moveByGroup(e,t){return px(this,e,vw(this,e,t,r=>u8(this,e.head,r)))}visualLineSide(e,t){let r=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=r[t?r.length-1:0];return we.cursor(s.side(t,i)+e.from,s.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,r=!0){return c8(this,e,t,r)}moveVertically(e,t,r){return px(this,e,h8(this,e,t,r))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let r=By(this,e,t);return r&&r.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),By(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[io.find(s,e-i.from,-1,t)];return xh(r,o.dir==Zt.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(J2)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>J8)return V2(e.length);let t=this.textDirectionAt(e.from),r;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||q2(s.isolates,r=mw(this,e))))return s.order;r||(r=mw(this,e));let i=L3(e.text,t,r);return this.bidiCache.push(new hp(e.from,e.to,t,r,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||He.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{I2(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return kd.of(new pc(typeof e=="number"?we.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return kd.of(new pc(we.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return _n.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return _n.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=ra.newName(),i=[Bd.of(r),Xu.of(Ny(`.${r}`,e))];return t&&t.dark&&i.push(Dy.of(!0)),i}static baseTheme(e){return la.lowest(Xu.of(Ny("."+My,e,kC)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),i=r&&Tn.get(r)||Tn.get(e);return((t=i==null?void 0:i.root)===null||t===void 0?void 0:t.view)||null}}Ne.styleModule=Xu;Ne.inputHandler=K2;Ne.clipboardInputFilter=Nv;Ne.clipboardOutputFilter=Lv;Ne.scrollHandler=tC;Ne.focusChangeEffect=Y2;Ne.perLineTextDirection=J2;Ne.exceptionSink=X2;Ne.updateListener=Ty;Ne.editable=no;Ne.mouseSelectionStyle=G2;Ne.dragMovesSelection=Z2;Ne.clickAddsSelectionRange=U2;Ne.decorations=Jp;Ne.blockWrappers=iC;Ne.outerDecorations=Iv;Ne.atomicRanges=jh;Ne.bidiIsolatedRanges=sC;Ne.scrollMargins=oC;Ne.darkTheme=Dy;Ne.cspNonce=je.define({combine:n=>n.length?n[0]:""});Ne.contentAttributes=Fv;Ne.editorAttributes=rC;Ne.lineWrapping=Ne.contentAttributes.of({class:"cm-lineWrapping"});Ne.announce=ft.define();const J8=4096,Fw={};class hp{constructor(e,t,r,i,s,o){this.from=e,this.to=t,this.dir=r,this.isolates=i,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let r=[],i=e.length?e[e.length-1].dir:Zt.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!t.touchesRange(o.from,o.to)&&r.push(new hp(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function Iw(n,e,t){for(let r=n.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o=typeof s=="function"?s(n):s;o&&Rv(o,t)}return t}const eM=He.mac?"mac":He.windows?"win":He.linux?"linux":"key";function tM(n,e){const t=n.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let i,s,o,a;for(let u=0;u<t.length-1;++u){const f=t[u];if(/^(cmd|meta|m)$/i.test(f))a=!0;else if(/^a(lt)?$/i.test(f))i=!0;else if(/^(c|ctrl|control)$/i.test(f))s=!0;else if(/^s(hift)?$/i.test(f))o=!0;else if(/^mod$/i.test(f))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+f)}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),a&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Rd(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const nM=la.default(Ne.domEventHandlers({keydown(n,e){return CC(SC(e.state),n,e,"editor")}})),Qh=je.define({enables:nM}),zw=new WeakMap;function SC(n){let e=n.facet(Qh),t=zw.get(e);return t||zw.set(e,t=sM(e.reduce((r,i)=>r.concat(i),[]))),t}function rM(n,e,t){return CC(SC(n.state),e,n,t)}let Go=null;const iM=4e3;function sM(n,e=eM){let t=Object.create(null),r=Object.create(null),i=(o,a)=>{let u=r[o];if(u==null)r[o]=a;else if(u!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,u,f,p)=>{var g,x;let A=t[o]||(t[o]=Object.create(null)),_=a.split(/ (?!$)/).map(C=>tM(C,e));for(let C=1;C<_.length;C++){let T=_.slice(0,C).join(" ");i(T,!0),A[T]||(A[T]={preventDefault:!0,stopPropagation:!1,run:[E=>{let D=Go={view:E,prefix:T,scope:o};return setTimeout(()=>{Go==D&&(Go=null)},iM),!0}]})}let b=_.join(" ");i(b,!1);let w=A[b]||(A[b]={preventDefault:!1,stopPropagation:!1,run:((x=(g=A._any)===null||g===void 0?void 0:g.run)===null||x===void 0?void 0:x.slice())||[]});u&&w.run.push(u),f&&(w.preventDefault=!0),p&&(w.stopPropagation=!0)};for(let o of n){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let f of a){let p=t[f]||(t[f]=Object.create(null));p._any||(p._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:g}=o;for(let x in p)p[x].run.push(A=>g(A,Ly))}let u=o[e]||o.key;if(u)for(let f of a)s(f,u,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(f,"Shift-"+u,o.shift,o.preventDefault,o.stopPropagation)}return t}let Ly=null;function CC(n,e,t,r){Ly=e;let i=v3(e),s=Mr(i,0),o=gs(s)==i.length&&i!=" ",a="",u=!1,f=!1,p=!1;Go&&Go.view==t&&Go.scope==r&&(a=Go.prefix+" ",mC.indexOf(e.keyCode)<0&&(f=!0,Go=null));let g=new Set,x=w=>{if(w){for(let C of w.run)if(!g.has(C)&&(g.add(C),C(t)))return w.stopPropagation&&(p=!0),!0;w.preventDefault&&(w.stopPropagation&&(p=!0),f=!0)}return!1},A=n[r],_,b;return A&&(x(A[a+Rd(i,e,!o)])?u=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(He.windows&&e.ctrlKey&&e.altKey)&&!(He.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(_=ia[e.keyCode])&&_!=i?(x(A[a+Rd(_,e,!0)])||e.shiftKey&&(b=mh[e.keyCode])!=i&&b!=_&&x(A[a+Rd(b,e,!1)]))&&(u=!0):o&&e.shiftKey&&x(A[a+Rd(i,e,!0)])&&(u=!0),!u&&x(A._any)&&(u=!0)),f&&(u=!0),u&&p&&e.stopPropagation(),Ly=null,u}class Hh{constructor(e,t,r,i,s){this.className=e,this.left=t,this.top=r,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(r.empty){let i=e.coordsAtPos(r.head,r.assoc||1);if(!i)return[];let s=TC(e);return[new Hh(t,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return oM(e,t,r)}}function TC(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Zt.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function jw(n,e,t,r){let i=n.coordsAtPos(e,t*2);if(!i)return r;let s=n.dom.getBoundingClientRect(),o=(i.top+i.bottom)/2,a=n.posAtCoords({x:s.left+1,y:o}),u=n.posAtCoords({x:s.right-1,y:o});return a==null||u==null?r:{from:Math.max(r.from,Math.min(a,u)),to:Math.min(r.to,Math.max(a,u))}}function oM(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let r=Math.max(t.from,n.viewport.from),i=Math.min(t.to,n.viewport.to),s=n.textDirection==Zt.LTR,o=n.contentDOM,a=o.getBoundingClientRect(),u=TC(n),f=o.querySelector(".cm-line"),p=f&&window.getComputedStyle(f),g=a.left+(p?parseInt(p.paddingLeft)+Math.min(0,parseInt(p.textIndent)):0),x=a.right-(p?parseInt(p.paddingRight):0),A=Py(n,r,1),_=Py(n,i,-1),b=A.type==tr.Text?A:null,w=_.type==tr.Text?_:null;if(b&&(n.lineWrapping||A.widgetLineBreaks)&&(b=jw(n,r,1,b)),w&&(n.lineWrapping||_.widgetLineBreaks)&&(w=jw(n,i,-1,w)),b&&w&&b.from==w.from&&b.to==w.to)return T(E(t.from,t.to,b));{let N=b?E(t.from,null,b):D(A,!1),F=w?E(null,t.to,w):D(_,!0),z=[];return(b||A).to<(w||_).from-(b&&w?1:0)||A.widgetLineBreaks>1&&N.bottom+n.defaultLineHeight/2<F.top?z.push(C(g,N.bottom,x,F.top)):N.bottom<F.top&&n.elementAtHeight((N.bottom+F.top)/2).type==tr.Text&&(N.bottom=F.top=(N.bottom+F.top)/2),T(N).concat(z).concat(T(F))}function C(N,F,z,I){return new Hh(e,N-u.left,F-u.top,z-N,I-F)}function T({top:N,bottom:F,horizontal:z}){let I=[];for(let K=0;K<z.length;K+=2)I.push(C(z[K],N,z[K+1],F));return I}function E(N,F,z){let I=1e9,K=-1e9,W=[];function U(ee,le,Z,ie,V){let ne=n.coordsAtPos(ee,ee==z.to?-2:2),q=n.coordsAtPos(Z,Z==z.from?2:-2);!ne||!q||(I=Math.min(ne.top,q.top,I),K=Math.max(ne.bottom,q.bottom,K),V==Zt.LTR?W.push(s&&le?g:ne.left,s&&ie?x:q.right):W.push(!s&&ie?g:q.left,!s&&le?x:ne.right))}let X=N??z.from,$=F??z.to;for(let ee of n.visibleRanges)if(ee.to>X&&ee.from<$)for(let le=Math.max(ee.from,X),Z=Math.min(ee.to,$);;){let ie=n.state.doc.lineAt(le);for(let V of n.bidiSpans(ie)){let ne=V.from+ie.from,q=V.to+ie.from;if(ne>=Z)break;q>le&&U(Math.max(ne,le),N==null&&ne<=X,Math.min(q,Z),F==null&&q>=$,V.dir)}if(le=ie.to+1,le>=Z)break}return W.length==0&&U(X,N==null,$,F==null,n.textDirection),{top:I,bottom:K,horizontal:W}}function D(N,F){let z=a.top+(F?N.top:N.bottom);return{top:z,bottom:z,horizontal:[]}}}function aM(n,e){return n.constructor==e.constructor&&n.eq(e)}class lM{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(r0)!=e.state.facet(r0)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(r0);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,r)=>!aM(t,this.drawn[r]))){let t=this.dom.firstChild,r=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[r].constructor&&i.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e,He.safari&&He.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const r0=je.define();function EC(n){return[_n.define(e=>new lM(e,n)),r0.of(n)]}const vh=je.define({combine(n){return Os(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function cM(n={}){return[vh.of(n),uM,hM,fM,eC.of(!0)]}function PC(n){return n.startState.facet(vh)!=n.state.facet(vh)}const uM=EC({above:!0,markers(n){let{state:e}=n,t=e.facet(vh),r=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty||t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=i.empty?i:we.cursor(i.head,i.head>i.anchor?-1:1);for(let u of Hh.forRange(n,o,a))r.push(u)}}return r},update(n,e){n.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=PC(n);return t&&Qw(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){Qw(e.state,n)},class:"cm-cursorLayer"});function Qw(n,e){e.style.animationDuration=n.facet(vh).cursorBlinkRate+"ms"}const hM=EC({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Hh.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||PC(n)},class:"cm-selectionLayer"}),fM=la.highest(Ne.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),BC=ft.define({map(n,e){return n==null?null:e.mapPos(n)}}),Ju=$n.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,r)=>r.is(BC)?r.value:t,n)}}),dM=_n.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Ju);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Ju)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Ju),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let r=n.scrollDOM.getBoundingClientRect();return{left:t.left-r.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-r.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Ju)!=n&&this.view.dispatch({effects:BC.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function pM(){return[Ju,dM]}function Hw(n,e,t,r,i){e.lastIndex=0;for(let s=n.iterRange(t,r),o=t,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)i(o+a.index,a)}function mM(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let r=[];for(let{from:i,to:s}of t)i=Math.max(n.state.doc.lineAt(i).from,i-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}class gM{constructor(e){const{regexp:t,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(a,u,f,p)=>i(p,f,f+a[0].length,a,u);else if(typeof r=="function")this.addMatch=(a,u,f,p)=>{let g=r(a,u,f);g&&p(f,f+a[0].length,g)};else if(r)this.addMatch=(a,u,f,p)=>p(f,f+a[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new so,r=t.add.bind(t);for(let{from:i,to:s}of mM(e,this.maxLength))Hw(e.state.doc,this.regexp,i,s,(o,a)=>this.addMatch(a,e,o,r));return t.finish()}updateDeco(e,t){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,u)=>{u>=e.view.viewport.from&&a<=e.view.viewport.to&&(r=Math.min(a,r),i=Math.max(u,i))}),e.viewportMoved||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),r,i):t}updateRange(e,t,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),a=Math.min(s.to,i);if(a>=o){let u=e.state.doc.lineAt(o),f=u.to<a?e.state.doc.lineAt(a):u,p=Math.max(s.from,u.from),g=Math.min(s.to,f.to);if(this.boundary){for(;o>u.from;o--)if(this.boundary.test(u.text[o-1-u.from])){p=o;break}for(;a<f.to;a++)if(this.boundary.test(f.text[a-f.from])){g=a;break}}let x=[],A,_=(b,w,C)=>x.push(C.range(b,w));if(u==f)for(this.regexp.lastIndex=p-u.from;(A=this.regexp.exec(u.text))&&A.index<g-u.from;)this.addMatch(A,e,A.index+u.from,_);else Hw(e.state.doc,this.regexp,p,g,(b,w)=>this.addMatch(w,e,b,_));t=t.update({filterFrom:p,filterTo:g,filter:(b,w)=>b<p||w>g,add:x})}}return t}}const Fy=/x/.unicode!=null?"gu":"g",xM=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Fy),yM={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let xx=null;function vM(){var n;if(xx==null&&typeof document<"u"&&document.body){let e=document.body.style;xx=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return xx||!1}const i0=je.define({combine(n){let e=Os(n,{render:null,specialChars:xM,addSpecialChars:null});return(e.replaceTabs=!vM())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Fy)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Fy)),e}});function AM(n={}){return[i0.of(n),bM()]}let Ww=null;function bM(){return Ww||(Ww=_n.fromClass(class{constructor(n){this.view=n,this.decorations=Je.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(i0)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new gM({regexp:n.specialChars,decoration:(e,t,r)=>{let{doc:i}=t.state,s=Mr(e[0],0);if(s==9){let o=i.lineAt(r),a=t.state.tabSize,u=Lc(o.text,a,r-o.from);return Je.replace({widget:new kM((a-u%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Je.replace({widget:new OM(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(i0);n.startState.facet(i0)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const wM="";function _M(n){return n>=32?wM:n==10?"":String.fromCharCode(9216+n)}class OM extends $i{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=_M(this.code),r=e.state.phrase("Control character")+" "+(yM[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,t);if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class kM extends $i{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function SM(){return TM}const CM=Je.line({class:"cm-activeLine"}),TM=_n.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let r of n.state.selection.ranges){let i=n.lineBlockAt(r.head);i.from>e&&(t.push(CM.range(i.from)),e=i.from)}return Je.set(t)}},{decorations:n=>n.decorations});class EM extends $i{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?lh(e.firstChild):[];if(!t.length)return null;let r=window.getComputedStyle(e.parentNode),i=xh(t[0],r.direction!="rtl"),s=parseInt(r.lineHeight);return i.bottom-i.top>s*1.5?{left:i.left,right:i.right,top:i.top,bottom:i.top+s}:i}ignoreEvent(){return!1}}function PM(n){let e=_n.fromClass(class{constructor(t){this.view=t,this.placeholder=n?Je.set([Je.widget({widget:new EM(n),side:1}).range(0)]):Je.none}get decorations(){return this.view.state.doc.length?Je.none:this.placeholder}},{decorations:t=>t.decorations});return typeof n=="string"?[e,Ne.contentAttributes.of({"aria-placeholder":n})]:e}const Iy=2e3;function BM(n,e,t){let r=Math.min(e.line,t.line),i=Math.max(e.line,t.line),s=[];if(e.off>Iy||t.off>Iy||e.col<0||t.col<0){let o=Math.min(e.off,t.off),a=Math.max(e.off,t.off);for(let u=r;u<=i;u++){let f=n.doc.line(u);f.length<=a&&s.push(we.range(f.from+o,f.to+a))}}else{let o=Math.min(e.col,t.col),a=Math.max(e.col,t.col);for(let u=r;u<=i;u++){let f=n.doc.line(u),p=xy(f.text,o,n.tabSize,!0);if(p<0)s.push(we.cursor(f.to));else{let g=xy(f.text,a,n.tabSize);s.push(we.range(f.from+p,f.from+g))}}}return s}function RM(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function qw(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),r=n.state.doc.lineAt(t),i=t-r.from,s=i>Iy?-1:i==r.length?RM(n,e.clientX):Lc(r.text,n.state.tabSize,t-r.from);return{line:r.number,col:s,off:i}}function DM(n,e){let t=qw(n,e),r=n.state.selection;return t?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(t.line).from),o=i.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},r=r.map(i.changes)}},get(i,s,o){let a=qw(n,i);if(!a)return r;let u=BM(n.state,t,a);return u.length?o?we.create(u.concat(r.ranges)):we.create(u):r}}:null}function MM(n){let e=(t=>t.altKey&&t.button==0);return Ne.mouseSelectionStyle.of((t,r)=>e(r)?DM(t,r):null)}const NM={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},LM={style:"cursor: crosshair"};function FM(n={}){let[e,t]=NM[n.key||"Alt"],r=_n.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)},mousemove(i){this.set(t(i))}}});return[r,Ne.contentAttributes.of(i=>{var s;return!((s=i.plugin(r))===null||s===void 0)&&s.isDown?LM:null})]}const Dd="-10000px";class RC{constructor(e,t,r,i){this.facet=t,this.createTooltipView=r,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=r(o,s))}update(e,t){var r;let i=e.state.facet(this.facet),s=i.filter(u=>u);if(i===this.input){for(let u of this.tooltipViews)u.update&&u.update(e);return!1}let o=[],a=t?[]:null;for(let u=0;u<s.length;u++){let f=s[u],p=-1;if(f){for(let g=0;g<this.tooltips.length;g++){let x=this.tooltips[g];x&&x.create==f.create&&(p=g)}if(p<0)o[u]=this.createTooltipView(f,u?o[u-1]:null),a&&(a[u]=!!f.above);else{let g=o[u]=this.tooltipViews[p];a&&(a[u]=t[p]),g.update&&g.update(e)}}}for(let u of this.tooltipViews)o.indexOf(u)<0&&(this.removeTooltipView(u),(r=u.destroy)===null||r===void 0||r.call(u));return t&&(a.forEach((u,f)=>t[f]=u),t.length=a.length),this.input=i,this.tooltips=s,this.tooltipViews=o,!0}}function IM(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const yx=je.define({combine:n=>{var e,t,r;return{position:He.ios?"absolute":((e=n.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((r=n.find(i=>i.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||IM}}}),Vw=new WeakMap,Wv=_n.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(yx);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new RC(n,qv,(t,r)=>this.createTooltip(t,r),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,r=n.state.facet(yx);if(r.position!=this.position&&!this.madeAbsolute){this.position=r.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),r=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",t.dom.appendChild(i)}return t.dom.style.position=this.position,t.dom.style.top=Dd,t.dom.style.left="0px",this.container.insertBefore(t.dom,r),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(n=r.destroy)===null||n===void 0||n.call(r);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(He.safari){let o=s.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}else t=!!s.offsetParent&&s.offsetParent!=this.container.ownerDocument.body}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(n=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let r=this.view.scrollDOM.getBoundingClientRect(),i=zv(this.view);return{visible:{left:r.left+i.left,top:r.top+i.top,right:r.right-i.right,bottom:r.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(yx).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:t,space:r,scaleX:i,scaleY:s}=n,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let u=this.manager.tooltips[a],f=this.manager.tooltipViews[a],{dom:p}=f,g=n.pos[a],x=n.size[a];if(!g||u.clip!==!1&&(g.bottom<=Math.max(t.top,r.top)||g.top>=Math.min(t.bottom,r.bottom)||g.right<Math.max(t.left,r.left)-.1||g.left>Math.min(t.right,r.right)+.1)){p.style.top=Dd;continue}let A=u.arrow?f.dom.querySelector(".cm-tooltip-arrow"):null,_=A?7:0,b=x.right-x.left,w=(e=Vw.get(f))!==null&&e!==void 0?e:x.bottom-x.top,C=f.offset||jM,T=this.view.textDirection==Zt.LTR,E=x.width>r.right-r.left?T?r.left:r.right-x.width:T?Math.max(r.left,Math.min(g.left-(A?14:0)+C.x,r.right-b)):Math.min(Math.max(r.left,g.left-b+(A?14:0)-C.x),r.right-b),D=this.above[a];!u.strictSide&&(D?g.top-w-_-C.y<r.top:g.bottom+w+_+C.y>r.bottom)&&D==r.bottom-g.bottom>g.top-r.top&&(D=this.above[a]=!D);let N=(D?g.top-r.top:r.bottom-g.bottom)-_;if(N<w&&f.resize!==!1){if(N<this.view.defaultLineHeight){p.style.top=Dd;continue}Vw.set(f,w),p.style.height=(w=N)/s+"px"}else p.style.height&&(p.style.height="");let F=D?g.top-w-_-C.y:g.bottom+_+C.y,z=E+b;if(f.overlap!==!0)for(let I of o)I.left<z&&I.right>E&&I.top<F+w&&I.bottom>F&&(F=D?I.top-w-2-_:I.bottom+_+2);if(this.position=="absolute"?(p.style.top=(F-n.parent.top)/s+"px",$w(p,(E-n.parent.left)/i)):(p.style.top=F/s+"px",$w(p,E/i)),A){let I=g.left+(T?C.x:-C.x)-(E+14-7);A.style.left=I/i+"px"}f.overlap!==!0&&o.push({left:E,top:F,right:z,bottom:F+w}),p.classList.toggle("cm-tooltip-above",D),p.classList.toggle("cm-tooltip-below",!D),f.positioned&&f.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Dd}},{eventObservers:{scroll(){this.maybeMeasure()}}});function $w(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const zM=Ne.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),jM={x:0,y:0},qv=je.define({enables:[Wv,zM]}),fp=je.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class rm{static create(e){return new rm(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new RC(e,fp,(t,r)=>this.createHostedView(t,r),t=>t.dom.remove())}createHostedView(e,t){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let r of this.manager.tooltipViews){let i=r[e];if(i!==void 0){if(t===void 0)t=i;else if(t!==i)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const QM=qv.compute([fp],n=>{let e=n.facet(fp);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var r;return(r=t.end)!==null&&r!==void 0?r:t.pos})),create:rm.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class HM{constructor(e,t,r,i,s){this.view=e,this.source=t,this.field=r,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,r=e.docView.tile.nearest(t.target);if(!r)return;let i,s=1;if(r.isWidget())i=r.posAtStart;else{if(i=e.posAtCoords(t),i==null)return;let a=e.coordsAtPos(i);if(!a||t.y<a.top||t.y>a.bottom||t.x<a.left-e.defaultCharacterWidth||t.x>a.right+e.defaultCharacterWidth)return;let u=e.bidiSpans(e.state.doc.lineAt(i)).find(p=>p.from<=i&&p.to>=i),f=u&&u.dir==Zt.RTL?-1:1;s=t.x<a.left?-f:f}let o=this.source(e,i,s);if(o!=null&&o.then){let a=this.pending={pos:i};o.then(u=>{this.pending==a&&(this.pending=null,u&&!(Array.isArray(u)&&!u.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(u)?u:[u])}))},u=>Fr(e.state,u,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Wv),t=e?e.manager.tooltips.findIndex(r=>r.create==rm.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!WM(s.dom,e)||this.pending){let{pos:o}=i[0]||this.pending,a=(r=(t=i[0])===null||t===void 0?void 0:t.end)!==null&&r!==void 0?r:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!qM(this.view,o,a,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:r}=this;r&&r.dom.contains(e.relatedTarget)?this.watchTooltipLeave(r.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=r=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Md=4;function WM(n,e){let{left:t,right:r,top:i,bottom:s}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let a=o.getBoundingClientRect();i=Math.min(a.top,i),s=Math.max(a.bottom,s)}return e.clientX>=t-Md&&e.clientX<=r+Md&&e.clientY>=i-Md&&e.clientY<=s+Md}function qM(n,e,t,r,i,s){let o=n.scrollDOM.getBoundingClientRect(),a=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>r||o.right<r||o.top>i||Math.min(o.bottom,a)<i)return!1;let u=n.posAtCoords({x:r,y:i},!1);return u>=e&&u<=t}function VM(n,e={}){let t=ft.define(),r=$n.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let a of i){let u=s.changes.mapPos(a.pos,-1,er.TrackDel);if(u!=null){let f=Object.assign(Object.create(null),a);f.pos=u,f.end!=null&&(f.end=s.changes.mapPos(f.end)),o.push(f)}}i=o}for(let o of s.effects)o.is(t)&&(i=o.value),o.is($M)&&(i=[]);return i},provide:i=>fp.from(i)});return{active:r,extension:[r,_n.define(i=>new HM(i,n,r,t,e.hoverTime||300)),QM]}}function DC(n,e){let t=n.plugin(Wv);if(!t)return null;let r=t.manager.tooltips.indexOf(e);return r<0?null:t.manager.tooltipViews[r]}const $M=ft.define(),Uw=je.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Vv(n,e){let t=n.plugin(MC),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const MC=_n.fromClass(class{constructor(n){this.input=n.state.facet(Ah),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(Uw);this.top=new Nd(n,!0,e.topContainer),this.bottom=new Nd(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(Uw);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Nd(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Nd(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Ah);if(t!=this.input){let r=t.filter(u=>u),i=[],s=[],o=[],a=[];for(let u of r){let f=this.specs.indexOf(u),p;f<0?(p=u(n.view),a.push(p)):(p=this.panels[f],p.update&&p.update(n)),i.push(p),(p.top?s:o).push(p)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let u of a)u.dom.classList.add("cm-panel"),u.mount&&u.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>Ne.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Nd{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Zw(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Zw(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Zw(n){let e=n.nextSibling;return n.remove(),e}const Ah=je.define({enables:MC});function UM(n,e){let t,r=new Promise(o=>t=o),i=o=>ZM(o,e,t);n.state.field(vx,!1)?n.dispatch({effects:NC.of(i)}):n.dispatch({effects:ft.appendConfig.of(vx.init(()=>[i]))});let s=LC.of(i);return{close:s,result:r.then(o=>((n.win.queueMicrotask||(u=>n.win.setTimeout(u,10)))(()=>{n.state.field(vx).indexOf(i)>-1&&n.dispatch({effects:s})}),o))}}const vx=$n.define({create(){return[]},update(n,e){for(let t of e.effects)t.is(NC)?n=[t.value].concat(n):t.is(LC)&&(n=n.filter(r=>r!=t.value));return n},provide:n=>Ah.computeN([n],e=>e.field(n))}),NC=ft.define(),LC=ft.define();function ZM(n,e,t){let r=e.content?e.content(n,()=>o(null)):null;if(!r){if(r=Vt("form"),e.input){let a=Vt("input",e.input);/^(text|password|number|email|tel|url)$/.test(a.type)&&a.classList.add("cm-textfield"),a.name||(a.name="input"),r.appendChild(Vt("label",(e.label||"")+": ",a))}else r.appendChild(document.createTextNode(e.label||""));r.appendChild(document.createTextNode(" ")),r.appendChild(Vt("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let i=r.nodeName=="FORM"?[r]:r.querySelectorAll("form");for(let a=0;a<i.length;a++){let u=i[a];u.addEventListener("keydown",f=>{f.keyCode==27?(f.preventDefault(),o(null)):f.keyCode==13&&(f.preventDefault(),o(u))}),u.addEventListener("submit",f=>{f.preventDefault(),o(u)})}let s=Vt("div",r,Vt("button",{onclick:()=>o(null),"aria-label":n.state.phrase("close"),class:"cm-dialog-close",type:"button"},[""]));e.class&&(s.className=e.class),s.classList.add("cm-dialog");function o(a){s.contains(s.ownerDocument.activeElement)&&n.focus(),t(a)}return{dom:s,top:e.top,mount:()=>{if(e.focus){let a;typeof e.focus=="string"?a=r.querySelector(e.focus):a=r.querySelector("input")||r.querySelector("button"),a&&"select"in a?a.select():a&&"focus"in a&&a.focus()}}}}class ao extends na{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ao.prototype.elementClass="";ao.prototype.toDOM=void 0;ao.prototype.mapMode=er.TrackBefore;ao.prototype.startSide=ao.prototype.endSide=-1;ao.prototype.point=!0;const s0=je.define(),GM=je.define(),XM={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Tt.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},hh=je.define();function KM(n){return[FC(),hh.of({...XM,...n})]}const Gw=je.define({combine:n=>n.some(e=>e)});function FC(n){return[YM]}const YM=_n.fromClass(class{constructor(n){this.view=n,this.domAfter=null,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(hh).map(e=>new Kw(n,e)),this.fixed=!n.state.facet(Gw);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,r=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(r<(t.to-t.from)*.8)}if(n.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(Gw)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=Tt.iter(this.view.state.facet(s0),this.view.viewport.from),r=[],i=this.gutters.map(s=>new JM(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==tr.Text&&o){zy(t,r,a.from);for(let u of i)u.line(this.view,a,r);o=!1}else if(a.widget)for(let u of i)u.widget(this.view,a)}else if(s.type==tr.Text){zy(t,r,s.from);for(let o of i)o.line(this.view,s,r)}else if(s.widget)for(let o of i)o.widget(this.view,s);for(let s of i)s.finish();n&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(n){let e=n.startState.facet(hh),t=n.state.facet(hh),r=n.docChanged||n.heightChanged||n.viewportChanged||!Tt.eq(n.startState.facet(s0),n.state.facet(s0),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(n)&&(r=!0);else{r=!0;let i=[];for(let s of t){let o=e.indexOf(s);o<0?i.push(new Kw(this.view,s)):(this.gutters[o].update(n),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=i}return r}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:n=>Ne.scrollMargins.of(e=>{let t=e.plugin(n);if(!t||t.gutters.length==0||!t.fixed)return null;let r=t.dom.offsetWidth*e.scaleX,i=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Zt.LTR?{left:r,right:i}:{right:r,left:i}})});function Xw(n){return Array.isArray(n)?n:[n]}function zy(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class JM{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=Tt.iter(e.markers,t.from)}addElement(e,t,r){let{gutter:i}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==i.elements.length){let a=new IC(e,o,s,r);i.elements.push(a),i.dom.appendChild(a.dom)}else i.elements[this.i].update(e,o,s,r);this.height=t.bottom,this.i++}line(e,t,r){let i=[];zy(this.cursor,i,t.from),r.length&&(i=i.concat(r));let s=this.gutter.config.lineMarker(e,t,i);s&&i.unshift(s);let o=this.gutter;i.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let r=this.gutter.config.widgetMarker(e,t.widget,t),i=r?[r]:null;for(let s of e.state.facet(GM)){let o=s(e,t.widget,t);o&&(i||(i=[])).push(o)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Kw{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in t.domEventHandlers)this.dom.addEventListener(r,i=>{let s=i.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let u=s.getBoundingClientRect();o=(u.top+u.bottom)/2}else o=i.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[r](e,a,i)&&i.preventDefault()});this.markers=Xw(t.markers(e)),t.initialSpacer&&(this.spacer=new IC(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Xw(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let r=e.view.viewport;return!Tt.eq(this.markers,t,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class IC{constructor(e,t,r,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,i)}update(e,t,r,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),eN(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let r="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let a=o,u=s<t.length?t[s++]:null,f=!1;if(u){let p=u.elementClass;p&&(r+=" "+p);for(let g=o;g<this.markers.length;g++)if(this.markers[g].compare(u)){a=g,f=!0;break}}else a=this.markers.length;for(;o<a;){let p=this.markers[o++];if(p.toDOM){p.destroy(i);let g=i.nextSibling;i.remove(),i=g}}if(!u)break;u.toDOM&&(f?i=i.nextSibling:this.dom.insertBefore(u.toDOM(e),i)),f&&o++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}function eN(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const tN=je.define(),nN=je.define(),oc=je.define({combine(n){return Os(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let i in t){let s=r[i],o=t[i];r[i]=s?(a,u,f)=>s(a,u,f)||o(a,u,f):o}return r}})}});class Ax extends ao{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function bx(n,e){return n.state.facet(oc).formatNumber(e,n.state)}const rN=hh.compute([oc],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(tN)},lineMarker(e,t,r){return r.some(i=>i.toDOM)?null:new Ax(bx(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,r)=>{for(let i of e.state.facet(nN)){let s=i(e,t,r);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(oc)!=e.state.facet(oc),initialSpacer(e){return new Ax(bx(e,Yw(e.state.doc.lines)))},updateSpacer(e,t){let r=bx(t.view,Yw(t.view.state.doc.lines));return r==e.number?e:new Ax(r)},domEventHandlers:n.facet(oc).domEventHandlers,side:"before"}));function iN(n={}){return[oc.of(n),FC(),rN]}function Yw(n){let e=9;for(;e<n;)e=e*10+9;return e}const sN=new class extends ao{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},oN=s0.compute(["selection"],n=>{let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.head).from;i>t&&(t=i,e.push(sN.range(i)))}return Tt.of(e)});function aN(){return oN}const zC=1024;let lN=0;class wx{constructor(e,t){this.from=e,this.to=t}}class St{constructor(e={}){this.id=lN++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=jr.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}St.closedBy=new St({deserialize:n=>n.split(" ")});St.openedBy=new St({deserialize:n=>n.split(" ")});St.group=new St({deserialize:n=>n.split(" ")});St.isolate=new St({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});St.contextHash=new St({perNode:!0});St.lookAhead=new St({perNode:!0});St.mounted=new St({perNode:!0});class fh{constructor(e,t,r,i=!1){this.tree=e,this.overlay=t,this.parser=r,this.bracketed=i}static get(e){return e&&e.props&&e.props[St.mounted.id]}}const cN=Object.create(null);class jr{constructor(e,t,r,i=0){this.name=e,this.props=t,this.id=r,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):cN,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new jr(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(St.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let i of r.split(" "))t[i]=e[r];return r=>{for(let i=r.prop(St.group),s=-1;s<(i?i.length:0);s++){let o=t[s<0?r.name:i[s]];if(o)return o}}}}jr.none=new jr("",Object.create(null),0,8);class $v{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let i=null;for(let s of e){let o=s(r);if(o){i||(i=Object.assign({},r.props));let a=o[1],u=o[0];u.combine&&u.id in i&&(a=u.combine(i[u.id],a)),i[u.id]=a}}t.push(i?new jr(r.name,i,r.id,r.flags):r)}return new $v(t)}}const Ld=new WeakMap,Jw=new WeakMap;var dn;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",n[n.EnterBracketed=16]="EnterBracketed"})(dn||(dn={}));class wn{constructor(e,t,r,i,s){if(this.type=e,this.children=t,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=fh.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let i=r.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Qy(this.topNode,e)}cursorAt(e,t=0,r=0){let i=Ld.get(this)||this.topNode,s=new Qy(i);return s.moveTo(e,t),Ld.set(this,s._tree),s}get topNode(){return new zr(this,0,0,null)}resolve(e,t=0){let r=bh(Ld.get(this)||this.topNode,e,t,!1);return Ld.set(this,r),r}resolveInner(e,t=0){let r=bh(Jw.get(this)||this.topNode,e,t,!0);return Jw.set(this,r),r}resolveStack(e,t=0){return fN(this,e,t)}iterate(e){let{enter:t,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,a=(o&dn.IncludeAnonymous)>0;for(let u=this.cursor(o|dn.IncludeAnonymous);;){let f=!1;if(u.from<=s&&u.to>=i&&(!a&&u.type.isAnonymous||t(u)!==!1)){if(u.firstChild())continue;f=!0}for(;f&&r&&(a||!u.type.isAnonymous)&&r(u),!u.nextSibling();){if(!u.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Gv(jr.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,i)=>new wn(this.type,t,r,i,this.propValues),e.makeTree||((t,r,i)=>new wn(jr.none,t,r,i)))}static build(e){return dN(e)}}wn.empty=new wn(jr.none,[],[],0);class Uv{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Uv(this.buffer,this.index)}}class oa{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return jr.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,i,s){let{buffer:o}=this,a=-1;for(let u=e;u!=t&&!(jC(s,i,o[u+1],o[u+2])&&(a=u,r>0));u=o[u+3]);return a}slice(e,t,r){let i=this.buffer,s=new Uint16Array(t-e),o=0;for(let a=e,u=0;a<t;){s[u++]=i[a++],s[u++]=i[a++]-r;let f=s[u++]=i[a++]-r;s[u++]=i[a++]-e,o=Math.max(o,f)}return new oa(s,o,this.set)}}function jC(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function bh(n,e,t,r){for(var i;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof zr&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:dn.IgnoreOverlays;if(r)for(let o=n,a=o.parent;a;o=a,a=o.parent)o instanceof zr&&o.index<0&&((i=a.enter(e,t,s))===null||i===void 0?void 0:i.from)!=o.from&&(n=a);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class QC{cursor(e=0){return new Qy(this,e)}getChild(e,t=null,r=null){let i=e_(this,e,t,r);return i.length?i[0]:null}getChildren(e,t=null,r=null){return e_(this,e,t,r)}resolve(e,t=0){return bh(this,e,t,!1)}resolveInner(e,t=0){return bh(this,e,t,!0)}matchContext(e){return jy(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(r=t,t=i.prevSibling):t=i}return r}get node(){return this}get next(){return this.parent}}class zr extends QC{constructor(e,t,r,i){super(),this._tree=e,this.from=t,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,i,s=0){var o;for(let a=this;;){for(let{children:u,positions:f}=a._tree,p=t>0?u.length:-1;e!=p;e+=t){let g=u[e],x=f[e]+a.from;if(!(!(s&dn.EnterBracketed&&g instanceof wn&&((o=fh.get(g))===null||o===void 0?void 0:o.overlay)===null&&(x>=r||x+g.length<=r))&&!jC(i,r,x,x+g.length))){if(g instanceof oa){if(s&dn.ExcludeBuffers)continue;let A=g.findChild(0,g.buffer.length,t,r-x,i);if(A>-1)return new ys(new uN(a,g,e,x),null,A)}else if(s&dn.IncludeAnonymous||!g.type.isAnonymous||Zv(g)){let A;if(!(s&dn.IgnoreMounts)&&(A=fh.get(g))&&!A.overlay)return new zr(A.tree,x,e,a);let _=new zr(g,x,e,a);return s&dn.IncludeAnonymous||!_.type.isAnonymous?_:_.nextChild(t<0?g.children.length-1:0,t,r,i,s)}}}if(s&dn.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,r=0){let i;if(!(r&dn.IgnoreOverlays)&&(i=fh.get(this._tree))&&i.overlay){let s=e-this.from,o=r&dn.EnterBracketed&&i.bracketed;for(let{from:a,to:u}of i.overlay)if((t>0||o?a<=s:a<s)&&(t<0||o?u>=s:u>s))return new zr(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function e_(n,e,t,r){let i=n.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=i.type.is(t),!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function jy(n,e,t=e.length-1){for(let r=n;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class uN{constructor(e,t,r,i){this.parent=e,this.buffer=t,this.index=r,this.start=i}}class ys extends QC{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new ys(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,r=0){if(r&dn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new ys(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ys(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new ys(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1];e.push(r.slice(i,s,o)),t.push(0)}return new wn(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function HC(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let r=t instanceof zr&&t.index<0?null:t.parent,i=n.slice();return r?i[e]=r:i.splice(e,1),new hN(i,t)}class hN{constructor(e,t){this.heads=e,this.node=t}get next(){return HC(this.heads)}}function fN(n,e,t){let r=n.resolveInner(e,t),i=null;for(let s=r instanceof zr?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(i||(i=[r])).push(o.resolve(e,t)),s=o}else{let o=fh.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new zr(o.tree,o.overlay[0].from+s.from,-1,s);(i||(i=[r])).push(bh(a,e,t,!1))}}return i?HC(i):r}class Qy{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~dn.EnterBracketed,e instanceof zr)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof zr?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&dn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&dn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&dn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=i)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let a=r._tree.children[s];if(this.mode&dn.IncludeAnonymous||a instanceof oa||!a.type.isAnonymous||Zv(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;t=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)t=new ys(this.buffer,t,this.stack[i]);return this.bufferNode=new ys(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return jy(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return jy(this._tree,e,i);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function Zv(n){return n.children.some(e=>e instanceof oa||!e.type.isAnonymous||Zv(e))}function dN(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:i=zC,reused:s=[],minRepeatType:o=r.types.length}=n,a=Array.isArray(t)?new Uv(t,t.length):t,u=r.types,f=0,p=0;function g(N,F,z,I,K,W){let{id:U,start:X,end:$,size:ee}=a,le=p,Z=f;if(ee<0)if(a.next(),ee==-1){let B=s[U];z.push(B),I.push(X-N);return}else if(ee==-3){f=U;return}else if(ee==-4){p=U;return}else throw new RangeError(`Unrecognized record size: ${ee}`);let ie=u[U],V,ne,q=X-N;if($-X<=i&&(ne=w(a.pos-F,K))){let B=new Uint16Array(ne.size-ne.skip),Q=a.pos-ne.size,G=B.length;for(;a.pos>Q;)G=C(ne.start,B,G);V=new oa(B,$-ne.start,r),q=ne.start-N}else{let B=a.pos-ee;a.next();let Q=[],G=[],Y=U>=o?U:-1,ue=0,pe=$;for(;a.pos>B;)Y>=0&&a.id==Y&&a.size>=0?(a.end<=pe-i&&(_(Q,G,X,ue,a.end,pe,Y,le,Z),ue=Q.length,pe=a.end),a.next()):W>2500?x(X,B,Q,G):g(X,B,Q,G,Y,W+1);if(Y>=0&&ue>0&&ue<Q.length&&_(Q,G,X,ue,X,pe,Y,le,Z),Q.reverse(),G.reverse(),Y>-1&&ue>0){let ve=A(ie,Z);V=Gv(ie,Q,G,0,Q.length,0,$-X,ve,ve)}else V=b(ie,Q,G,$-X,le-$,Z)}z.push(V),I.push(q)}function x(N,F,z,I){let K=[],W=0,U=-1;for(;a.pos>F;){let{id:X,start:$,end:ee,size:le}=a;if(le>4)a.next();else{if(U>-1&&$<U)break;U<0&&(U=ee-i),K.push(X,$,ee),W++,a.next()}}if(W){let X=new Uint16Array(W*4),$=K[K.length-2];for(let ee=K.length-3,le=0;ee>=0;ee-=3)X[le++]=K[ee],X[le++]=K[ee+1]-$,X[le++]=K[ee+2]-$,X[le++]=le;z.push(new oa(X,K[2]-$,r)),I.push($-N)}}function A(N,F){return(z,I,K)=>{let W=0,U=z.length-1,X,$;if(U>=0&&(X=z[U])instanceof wn){if(!U&&X.type==N&&X.length==K)return X;($=X.prop(St.lookAhead))&&(W=I[U]+X.length+$)}return b(N,z,I,K,W,F)}}function _(N,F,z,I,K,W,U,X,$){let ee=[],le=[];for(;N.length>I;)ee.push(N.pop()),le.push(F.pop()+z-K);N.push(b(r.types[U],ee,le,W-K,X-W,$)),F.push(K-z)}function b(N,F,z,I,K,W,U){if(W){let X=[St.contextHash,W];U=U?[X].concat(U):[X]}if(K>25){let X=[St.lookAhead,K];U=U?[X].concat(U):[X]}return new wn(N,F,z,I,U)}function w(N,F){let z=a.fork(),I=0,K=0,W=0,U=z.end-i,X={size:0,start:0,skip:0};e:for(let $=z.pos-N;z.pos>$;){let ee=z.size;if(z.id==F&&ee>=0){X.size=I,X.start=K,X.skip=W,W+=4,I+=4,z.next();continue}let le=z.pos-ee;if(ee<0||le<$||z.start<U)break;let Z=z.id>=o?4:0,ie=z.start;for(z.next();z.pos>le;){if(z.size<0)if(z.size==-3||z.size==-4)Z+=4;else break e;else z.id>=o&&(Z+=4);z.next()}K=ie,I+=ee,W+=Z}return(F<0||I==N)&&(X.size=I,X.start=K,X.skip=W),X.size>4?X:void 0}function C(N,F,z){let{id:I,start:K,end:W,size:U}=a;if(a.next(),U>=0&&I<o){let X=z;if(U>4){let $=a.pos-(U-4);for(;a.pos>$;)z=C(N,F,z)}F[--z]=X,F[--z]=W-N,F[--z]=K-N,F[--z]=I}else U==-3?f=I:U==-4&&(p=I);return z}let T=[],E=[];for(;a.pos>0;)g(n.start||0,n.bufferStart||0,T,E,-1,0);let D=(e=n.length)!==null&&e!==void 0?e:T.length?E[0]+T[0].length:0;return new wn(u[n.topID],T.reverse(),E.reverse(),D)}const t_=new WeakMap;function o0(n,e){if(!n.isAnonymous||e instanceof oa||e.type!=n)return 1;let t=t_.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof wn)){t=1;break}t+=o0(n,r)}t_.set(e,t)}return t}function Gv(n,e,t,r,i,s,o,a,u){let f=0;for(let _=r;_<i;_++)f+=o0(n,e[_]);let p=Math.ceil(f*1.5/8),g=[],x=[];function A(_,b,w,C,T){for(let E=w;E<C;){let D=E,N=b[E],F=o0(n,_[E]);for(E++;E<C;E++){let z=o0(n,_[E]);if(F+z>=p)break;F+=z}if(E==D+1){if(F>p){let z=_[D];A(z.children,z.positions,0,z.children.length,b[D]+T);continue}g.push(_[D])}else{let z=b[E-1]+_[E-1].length-N;g.push(Gv(n,_,b,D,E,N,z,null,u))}x.push(N+T-s)}}return A(e,t,r,i,0),(a||u)(g,x,o)}class pN{constructor(){this.map=new WeakMap}setBuffer(e,t,r){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,r)}getBuffer(e,t){let r=this.map.get(e);return r&&r.get(t)}set(e,t){e instanceof ys?this.setBuffer(e.context.buffer,e.index,t):e instanceof zr&&this.map.set(e.tree,t)}get(e){return e instanceof ys?this.getBuffer(e.context.buffer,e.index):e instanceof zr?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Ja{constructor(e,t,r,i,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let i=[new Ja(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,r=128){if(!t.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let a=0,u=0,f=0;;a++){let p=a<t.length?t[a]:null,g=p?p.fromA:1e9;if(g-u>=r)for(;o&&o.from<g;){let x=o;if(u>=x.from||g<=x.to||f){let A=Math.max(x.from,u)-f,_=Math.min(x.to,g)-f;x=A>=_?null:new Ja(A,_,x.tree,x.offset+f,a>0,!!p)}if(x&&i.push(x),o.to>g)break;o=s<e.length?e[s++]:null}if(!p)break;u=p.toA,f=p.toA-p.toB}return i}}class WC{startParse(e,t,r){return typeof e=="string"&&(e=new mN(e)),r=r?r.length?r.map(i=>new wx(i.from,i.to)):[new wx(0,0)]:[new wx(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let i=this.startParse(e,t,r);for(;;){let s=i.advance();if(s)return s}}}class mN{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new St({perNode:!0});let gN=0;class vi{constructor(e,t,r,i){this.name=e,this.set=t,this.base=r,this.modified=i,this.id=gN++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let r=typeof e=="string"?e:"?";if(e instanceof vi&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let i=new vi(r,[],null,[]);if(i.set.push(i),t)for(let s of t.set)i.set.push(s);return i}static defineModifier(e){let t=new dp(e);return r=>r.modified.indexOf(t)>-1?r:dp.get(r.base||r,r.modified.concat(t).sort((i,s)=>i.id-s.id))}}let xN=0;class dp{constructor(e){this.name=e,this.instances=[],this.id=xN++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(a=>a.base==e&&yN(t,a.modified));if(r)return r;let i=[],s=new vi(e.name,i,e,t);for(let a of t)a.instances.push(s);let o=vN(t);for(let a of e.set)if(!a.modified.length)for(let u of o)i.push(dp.get(a,u));return s}}function yN(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function vN(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,i=e.length;r<i;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}function qC(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let i of t.split(" "))if(i){let s=[],o=2,a=i;for(let g=0;;){if(a=="..."&&g>0&&g+3==i.length){o=1;break}let x=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!x)throw new RangeError("Invalid path: "+i);if(s.push(x[0]=="*"?"":x[0][0]=='"'?JSON.parse(x[0]):x[0]),g+=x[0].length,g==i.length)break;let A=i[g++];if(g==i.length&&A=="!"){o=0;break}if(A!="/")throw new RangeError("Invalid path: "+i);a=i.slice(g)}let u=s.length-1,f=s[u];if(!f)throw new RangeError("Invalid path: "+i);let p=new wh(r,o,u>0?s.slice(0,u):null);e[f]=p.sort(e[f])}}return VC.add(e)}const VC=new St({combine(n,e){let t,r,i;for(;n||e;){if(!n||e&&n.depth>=e.depth?(i=e,e=e.next):(i=n,n=n.next),t&&t.mode==i.mode&&!i.context&&!t.context)continue;let s=new wh(i.tags,i.mode,i.context);t?t.next=s:r=s,t=s}return r}});class wh{constructor(e,t,r,i){this.tags=e,this.mode=t,this.context=r,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}wh.empty=new wh([],2,null);function $C(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let a of s)for(let u of a.set){let f=t[u.id];if(f){o=o?o+" "+f:f;break}}return o},scope:r}}function AN(n,e){let t=null;for(let r of n){let i=r.style(e);i&&(t=t?t+" "+i:i)}return t}function bN(n,e,t,r=0,i=n.length){let s=new wN(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,i,"",s.highlighters),s.flush(i)}class wN{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,i,s){let{type:o,from:a,to:u}=e;if(a>=r||u<=t)return;o.isTop&&(s=this.highlighters.filter(A=>!A.scope||A.scope(o)));let f=i,p=_N(e)||wh.empty,g=AN(s,p.tags);if(g&&(f&&(f+=" "),f+=g,p.mode==1&&(i+=(i?" ":"")+g)),this.startSpan(Math.max(t,a),f),p.opaque)return;let x=e.tree&&e.tree.prop(St.mounted);if(x&&x.overlay){let A=e.node.enter(x.overlay[0].from+a,1),_=this.highlighters.filter(w=>!w.scope||w.scope(x.tree.type)),b=e.firstChild();for(let w=0,C=a;;w++){let T=w<x.overlay.length?x.overlay[w]:null,E=T?T.from+a:u,D=Math.max(t,C),N=Math.min(r,E);if(D<N&&b)for(;e.from<N&&(this.highlightRange(e,D,N,i,s),this.startSpan(Math.min(N,e.to),f),!(e.to>=E||!e.nextSibling())););if(!T||E>r)break;C=T.to+a,C>t&&(this.highlightRange(A.cursor(),Math.max(t,T.from+a),Math.min(r,C),"",_),this.startSpan(Math.min(r,C),f))}b&&e.parent()}else if(e.firstChild()){x&&(i="");do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,i,s),this.startSpan(Math.min(r,e.to),f)}while(e.nextSibling());e.parent()}}}function _N(n){let e=n.type.prop(VC);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const Me=vi.define,Fd=Me(),Uo=Me(),n_=Me(Uo),r_=Me(Uo),Zo=Me(),Id=Me(Zo),_x=Me(Zo),fs=Me(),za=Me(fs),cs=Me(),us=Me(),Hy=Me(),Du=Me(Hy),zd=Me(),fe={comment:Fd,lineComment:Me(Fd),blockComment:Me(Fd),docComment:Me(Fd),name:Uo,variableName:Me(Uo),typeName:n_,tagName:Me(n_),propertyName:r_,attributeName:Me(r_),className:Me(Uo),labelName:Me(Uo),namespace:Me(Uo),macroName:Me(Uo),literal:Zo,string:Id,docString:Me(Id),character:Me(Id),attributeValue:Me(Id),number:_x,integer:Me(_x),float:Me(_x),bool:Me(Zo),regexp:Me(Zo),escape:Me(Zo),color:Me(Zo),url:Me(Zo),keyword:cs,self:Me(cs),null:Me(cs),atom:Me(cs),unit:Me(cs),modifier:Me(cs),operatorKeyword:Me(cs),controlKeyword:Me(cs),definitionKeyword:Me(cs),moduleKeyword:Me(cs),operator:us,derefOperator:Me(us),arithmeticOperator:Me(us),logicOperator:Me(us),bitwiseOperator:Me(us),compareOperator:Me(us),updateOperator:Me(us),definitionOperator:Me(us),typeOperator:Me(us),controlOperator:Me(us),punctuation:Hy,separator:Me(Hy),bracket:Du,angleBracket:Me(Du),squareBracket:Me(Du),paren:Me(Du),brace:Me(Du),content:fs,heading:za,heading1:Me(za),heading2:Me(za),heading3:Me(za),heading4:Me(za),heading5:Me(za),heading6:Me(za),contentSeparator:Me(fs),list:Me(fs),quote:Me(fs),emphasis:Me(fs),strong:Me(fs),link:Me(fs),monospace:Me(fs),strikethrough:Me(fs),inserted:Me(),deleted:Me(),changed:Me(),invalid:Me(),meta:zd,documentMeta:Me(zd),annotation:Me(zd),processingInstruction:Me(zd),definition:vi.defineModifier("definition"),constant:vi.defineModifier("constant"),function:vi.defineModifier("function"),standard:vi.defineModifier("standard"),local:vi.defineModifier("local"),special:vi.defineModifier("special")};for(let n in fe){let e=fe[n];e instanceof vi&&(e.name=n)}$C([{tag:fe.link,class:"tok-link"},{tag:fe.heading,class:"tok-heading"},{tag:fe.emphasis,class:"tok-emphasis"},{tag:fe.strong,class:"tok-strong"},{tag:fe.keyword,class:"tok-keyword"},{tag:fe.atom,class:"tok-atom"},{tag:fe.bool,class:"tok-bool"},{tag:fe.url,class:"tok-url"},{tag:fe.labelName,class:"tok-labelName"},{tag:fe.inserted,class:"tok-inserted"},{tag:fe.deleted,class:"tok-deleted"},{tag:fe.literal,class:"tok-literal"},{tag:fe.string,class:"tok-string"},{tag:fe.number,class:"tok-number"},{tag:[fe.regexp,fe.escape,fe.special(fe.string)],class:"tok-string2"},{tag:fe.variableName,class:"tok-variableName"},{tag:fe.local(fe.variableName),class:"tok-variableName tok-local"},{tag:fe.definition(fe.variableName),class:"tok-variableName tok-definition"},{tag:fe.special(fe.variableName),class:"tok-variableName2"},{tag:fe.definition(fe.propertyName),class:"tok-propertyName tok-definition"},{tag:fe.typeName,class:"tok-typeName"},{tag:fe.namespace,class:"tok-namespace"},{tag:fe.className,class:"tok-className"},{tag:fe.macroName,class:"tok-macroName"},{tag:fe.propertyName,class:"tok-propertyName"},{tag:fe.operator,class:"tok-operator"},{tag:fe.comment,class:"tok-comment"},{tag:fe.meta,class:"tok-meta"},{tag:fe.invalid,class:"tok-invalid"},{tag:fe.punctuation,class:"tok-punctuation"}]);var Ox;const ac=new St;function ON(n){return je.define({combine:n?e=>e.concat(n):void 0})}const kN=new St;class Qi{constructor(e,t,r=[],i=""){this.data=e,this.name=i,Rt.prototype.hasOwnProperty("tree")||Object.defineProperty(Rt.prototype,"tree",{get(){return qn(this)}}),this.parser=t,this.extension=[aa.of(this),Rt.languageData.of((s,o,a)=>{let u=i_(s,o,a),f=u.type.prop(ac);if(!f)return[];let p=s.facet(f),g=u.type.prop(kN);if(g){let x=u.resolve(o-u.from,a);for(let A of g)if(A.test(x,s)){let _=s.facet(A.facet);return A.type=="replace"?_:_.concat(p)}}return p})].concat(r)}isActiveAt(e,t,r=-1){return i_(e,t,r).type.prop(ac)==this.data}findRegions(e){let t=e.facet(aa);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(ac)==this.data){r.push({from:o,to:o+s.length});return}let a=s.prop(St.mounted);if(a){if(a.tree.prop(ac)==this.data){if(a.overlay)for(let u of a.overlay)r.push({from:u.from+o,to:u.to+o});else r.push({from:o,to:o+s.length});return}else if(a.overlay){let u=r.length;if(i(a.tree,a.overlay[0].from+o),r.length>u)return}}for(let u=0;u<s.children.length;u++){let f=s.children[u];f instanceof wn&&i(f,s.positions[u]+o)}};return i(qn(e),0),r}get allowsNesting(){return!0}}Qi.setState=ft.define();function i_(n,e,t){let r=n.facet(aa),i=qn(n).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,t,dn.ExcludeBuffers|dn.EnterBracketed))s.type.isTop&&(i=s);return i}class pp extends Qi{constructor(e,t,r){super(e,t,[],r),this.parser=t}static define(e){let t=ON(e.languageData);return new pp(t,e.parser.configure({props:[ac.add(r=>r.isTop?t:void 0)]}),e.name)}configure(e,t){return new pp(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function qn(n){let e=n.field(Qi.state,!1);return e?e.tree:wn.empty}class SN{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let Mu=null;class mp{constructor(e,t,r=[],i,s,o,a,u){this.parser=e,this.state=t,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=u,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new mp(e,t,[],wn.empty,0,r,[],null)}startParse(){return this.parser.startParse(new SN(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=wn.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Ja.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Ja.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Mu;Mu=this;try{return e()}finally{Mu=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=s_(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let u=[];if(e.iterChangedRanges((f,p,g,x)=>u.push({fromA:f,toA:p,fromB:g,toB:x})),r=Ja.applyChanges(r,u),i=wn.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let f of this.skipped){let p=e.mapPos(f.from,1),g=e.mapPos(f.to,-1);p<g&&a.push({from:p,to:g})}}}return new mp(this.parser,t,r,i,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=s_(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends WC{createParse(t,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let u=Mu;if(u){for(let f of i)u.tempSkipped.push(f);e&&(u.scheduleOn=u.scheduleOn?Promise.all([u.scheduleOn,e]):e)}return this.parsedPos=o,new wn(jr.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Mu}}function s_(n,e,t){return Ja.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Tc{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new Tc(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=mp.create(e.facet(aa).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new Tc(r)}}Qi.state=$n.define({create:Tc.init,update(n,e){for(let t of e.effects)if(t.is(Qi.setState))return t.value;return e.startState.facet(aa)!=e.state.facet(aa)?Tc.init(e.state):n.apply(e)}});let UC=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(UC=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const kx=typeof navigator<"u"&&(!((Ox=navigator.scheduling)===null||Ox===void 0)&&Ox.isInputPending)?()=>navigator.scheduling.isInputPending():null,CN=_n.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Qi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Qi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=UC(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(Qi.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!kx?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<i&&r.doc.length>i+1e3,u=s.context.work(()=>kx&&kx()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-t,(u||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Qi.setState.of(new Tc(s.context))})),this.chunkBudget>0&&!(u&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Fr(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),aa=je.define({combine(n){return n.length?n[0]:null},enables:n=>[Qi.state,CN,Ne.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class TN{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const EN=je.define(),Wh=je.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function gp(n){let e=n.facet(Wh);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function _h(n,e){let t="",r=n.tabSize,i=n.facet(Wh)[0];if(i=="	"){for(;e>=r;)t+="	",e-=r;i=" "}for(let s=0;s<e;s++)t+=i;return t}function Xv(n,e){n instanceof Rt&&(n=new im(n));for(let r of n.state.facet(EN)){let i=r(n,e);if(i!==void 0)return i}let t=qn(n.state);return t.length>=e?PN(n,t,e):null}class im{constructor(e,t={}){this.state=e,this.options=t,this.unit=gp(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,t);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return Lc(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const ZC=new St;function PN(n,e,t){let r=e.resolveStack(t),i=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(i!=r.node){let s=[];for(let o=i;o&&!(o.from<r.node.from||o.to>r.node.to||o.from==r.node.from&&o.type==r.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return GC(r,n,t)}function GC(n,e,t){for(let r=n;r;r=r.next){let i=RN(r.node);if(i)return i(Kv.create(e,t,r))}return 0}function BN(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function RN(n){let e=n.type.prop(ZC);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(St.closedBy))){let i=n.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>XC(o,!0,1,void 0,s&&!BN(o)?i.from:void 0)}return n.parent==null?DN:null}function DN(){return 0}class Kv extends im{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new Kv(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(MN(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return GC(this.context.next,this.base,this.pos)}}function MN(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function NN(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let i=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let a=t.to;;){let u=e.childAfter(a);if(!u||u==r)return null;if(!u.type.isSkipped){if(u.from>=o)return null;let f=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+f}}a=u.to}}function Sx({closing:n,align:e=!0,units:t=1}){return r=>XC(r,e,t,n)}function XC(n,e,t,r,i){let s=n.textAfter,o=s.match(/^\s*/)[0].length,a=r&&s.slice(o,o+r.length)==r||i==n.pos+o,u=e?NN(n):null;return u?a?n.column(u.from):n.column(u.to):n.baseIndent+(a?0:n.unit*t)}const LN=200;function FN(){return Rt.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:r}=n.newSelection.main,i=t.lineAt(r);if(r>i.from+LN)return n;let s=t.sliceString(i.from,r);if(!e.some(f=>f.test(s)))return n;let{state:o}=n,a=-1,u=[];for(let{head:f}of o.selection.ranges){let p=o.doc.lineAt(f);if(p.from==a)continue;a=p.from;let g=Xv(o,p.from);if(g==null)continue;let x=/^\s*/.exec(p.text)[0],A=_h(o,g);x!=A&&u.push({from:p.from,to:p.from+x.length,insert:A})}return u.length?[n,{changes:u,sequential:!0}]:n})}const IN=je.define(),KC=new St;function zN(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function jN(n,e,t){let r=qn(n);if(r.length<t)return null;let i=r.resolveStack(t,1),s=null;for(let o=i;o;o=o.next){let a=o.node;if(a.to<=t||a.from>t)continue;if(s&&a.from<e)break;let u=a.type.prop(KC);if(u&&(a.to<r.length-50||r.length==n.doc.length||!QN(a))){let f=u(a,n);f&&f.from<=t&&f.from>=e&&f.to>t&&(s=f)}}return s}function QN(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function xp(n,e,t){for(let r of n.facet(IN)){let i=r(n,e,t);if(i)return i}return jN(n,e,t)}function YC(n,e){let t=e.mapPos(n.from,1),r=e.mapPos(n.to,-1);return t>=r?void 0:{from:t,to:r}}const sm=ft.define({map:YC}),qh=ft.define({map:YC});function JC(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(r=>r.from<=t&&r.to>=t)||e.push(n.lineBlockAt(t));return e}const ol=$n.define({create(){return Je.none},update(n,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,r)=>n=o_(n,t,r)),n=n.map(e.changes);for(let t of e.effects)if(t.is(sm)&&!HN(n,t.value.from,t.value.to)){let{preparePlaceholder:r}=e.state.facet(nT),i=r?Je.replace({widget:new GN(r(e.state,t.value))}):a_;n=n.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(qh)&&(n=n.update({filter:(r,i)=>t.value.from!=r||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(n=o_(n,e.selection.main.head)),n},provide:n=>Ne.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(r,i)=>{t.push(r,i)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let r=n[t++],i=n[t++];if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(a_.range(r,i))}return Je.set(e,!0)}});function o_(n,e,t=e){let r=!1;return n.between(e,t,(i,s)=>{i<t&&s>e&&(r=!0)}),r?n.update({filterFrom:e,filterTo:t,filter:(i,s)=>i>=t||s<=e}):n}function yp(n,e,t){var r;let i=null;return(r=n.field(ol,!1))===null||r===void 0||r.between(e,t,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function HN(n,e,t){let r=!1;return n.between(e,e,(i,s)=>{i==e&&s==t&&(r=!0)}),r}function eT(n,e){return n.field(ol,!1)?e:e.concat(ft.appendConfig.of(rT()))}const WN=n=>{for(let e of JC(n)){let t=xp(n.state,e.from,e.to);if(t)return n.dispatch({effects:eT(n.state,[sm.of(t),tT(n,t)])}),!0}return!1},qN=n=>{if(!n.state.field(ol,!1))return!1;let e=[];for(let t of JC(n)){let r=yp(n.state,t.from,t.to);r&&e.push(qh.of(r),tT(n,r,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function tT(n,e,t=!0){let r=n.state.doc.lineAt(e.from).number,i=n.state.doc.lineAt(e.to).number;return Ne.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${i}.`)}const VN=n=>{let{state:e}=n,t=[];for(let r=0;r<e.doc.length;){let i=n.lineBlockAt(r),s=xp(e,i.from,i.to);s&&t.push(sm.of(s)),r=(s?n.lineBlockAt(s.to):i).to+1}return t.length&&n.dispatch({effects:eT(n.state,t)}),!!t.length},$N=n=>{let e=n.state.field(ol,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(r,i)=>{t.push(qh.of({from:r,to:i}))}),n.dispatch({effects:t}),!0},UN=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:WN},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:qN},{key:"Ctrl-Alt-[",run:VN},{key:"Ctrl-Alt-]",run:$N}],ZN={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},nT=je.define({combine(n){return Os(n,ZN)}});function rT(n){return[ol,YN]}function iT(n,e){let{state:t}=n,r=t.facet(nT),i=o=>{let a=n.lineBlockAt(n.posAtDOM(o.target)),u=yp(n.state,a.from,a.to);u&&n.dispatch({effects:qh.of(u)}),o.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,i,e);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const a_=Je.replace({widget:new class extends $i{toDOM(n){return iT(n,null)}}});class GN extends $i{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return iT(e,this.value)}}const XN={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Cx extends ao{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function KN(n={}){let e={...XN,...n},t=new Cx(e,!0),r=new Cx(e,!1),i=_n.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(aa)!=o.state.facet(aa)||o.startState.field(ol,!1)!=o.state.field(ol,!1)||qn(o.startState)!=qn(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new so;for(let u of o.viewportLineBlocks){let f=yp(o.state,u.from,u.to)?r:xp(o.state,u.from,u.to)?t:null;f&&a.add(u.from,u.from,f)}return a.finish()}}),{domEventHandlers:s}=e;return[i,KM({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(i))===null||a===void 0?void 0:a.markers)||Tt.empty},initialSpacer(){return new Cx(e,!1)},domEventHandlers:{...s,click:(o,a,u)=>{if(s.click&&s.click(o,a,u))return!0;let f=yp(o.state,a.from,a.to);if(f)return o.dispatch({effects:qh.of(f)}),!0;let p=xp(o.state,a.from,a.to);return p?(o.dispatch({effects:sm.of(p)}),!0):!1}}}),rT()]}const YN=Ne.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Vh{constructor(e,t){this.specs=e;let r;function i(a){let u=ra.newName();return(r||(r=Object.create(null)))["."+u]=a,u}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,o=t.scope;this.scope=o instanceof Qi?a=>a.prop(ac)==o.data:o?a=>a==o:void 0,this.style=$C(e.map(a=>({tag:a.tag,class:a.class||i(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=r?new ra(r):null,this.themeType=t.themeType}static define(e,t){return new Vh(e,t||{})}}const Wy=je.define(),sT=je.define({combine(n){return n.length?[n[0]]:null}});function Tx(n){let e=n.facet(Wy);return e.length?e:n.facet(sT)}function oT(n,e){let t=[e6],r;return n instanceof Vh&&(n.module&&t.push(Ne.styleModule.of(n.module)),r=n.themeType),e!=null&&e.fallback?t.push(sT.of(n)):r?t.push(Wy.computeN([Ne.darkTheme],i=>i.facet(Ne.darkTheme)==(r=="dark")?[n]:[])):t.push(Wy.of(n)),t}class JN{constructor(e){this.markCache=Object.create(null),this.tree=qn(e.state),this.decorations=this.buildDeco(e,Tx(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=qn(e.state),r=Tx(e.state),i=r!=Tx(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!i&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return Je.none;let r=new so;for(let{from:i,to:s}of e.visibleRanges)bN(this.tree,t,(o,a,u)=>{r.add(o,a,this.markCache[u]||(this.markCache[u]=Je.mark({class:u})))},i,s);return r.finish()}}const e6=la.high(_n.fromClass(JN,{decorations:n=>n.decorations})),t6=Vh.define([{tag:fe.meta,color:"#404740"},{tag:fe.link,textDecoration:"underline"},{tag:fe.heading,textDecoration:"underline",fontWeight:"bold"},{tag:fe.emphasis,fontStyle:"italic"},{tag:fe.strong,fontWeight:"bold"},{tag:fe.strikethrough,textDecoration:"line-through"},{tag:fe.keyword,color:"#708"},{tag:[fe.atom,fe.bool,fe.url,fe.contentSeparator,fe.labelName],color:"#219"},{tag:[fe.literal,fe.inserted],color:"#164"},{tag:[fe.string,fe.deleted],color:"#a11"},{tag:[fe.regexp,fe.escape,fe.special(fe.string)],color:"#e40"},{tag:fe.definition(fe.variableName),color:"#00f"},{tag:fe.local(fe.variableName),color:"#30a"},{tag:[fe.typeName,fe.namespace],color:"#085"},{tag:fe.className,color:"#167"},{tag:[fe.special(fe.variableName),fe.macroName],color:"#256"},{tag:fe.definition(fe.propertyName),color:"#00c"},{tag:fe.comment,color:"#940"},{tag:fe.invalid,color:"#f00"}]),n6=Ne.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),aT=1e4,lT="()[]{}",cT=je.define({combine(n){return Os(n,{afterCursor:!0,brackets:lT,maxScanDistance:aT,renderMatch:s6})}}),r6=Je.mark({class:"cm-matchingBracket"}),i6=Je.mark({class:"cm-nonmatchingBracket"});function s6(n){let e=[],t=n.matched?r6:i6;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const o6=$n.define({create(){return Je.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],r=e.state.facet(cT);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=vs(e.state,i.head,-1,r)||i.head>0&&vs(e.state,i.head-1,1,r)||r.afterCursor&&(vs(e.state,i.head,1,r)||i.head<e.state.doc.length&&vs(e.state,i.head+1,-1,r));s&&(t=t.concat(r.renderMatch(s,e.state)))}return Je.set(t,!0)},provide:n=>Ne.decorations.from(n)}),a6=[o6,n6];function l6(n={}){return[cT.of(n),a6]}const c6=new St;function qy(n,e,t){let r=n.prop(e<0?St.openedBy:St.closedBy);if(r)return r;if(n.name.length==1){let i=t.indexOf(n.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function Vy(n){let e=n.type.prop(c6);return e?e(n.node):n}function vs(n,e,t,r={}){let i=r.maxScanDistance||aT,s=r.brackets||lT,o=qn(n),a=o.resolveInner(e,t);for(let u=a;u;u=u.parent){let f=qy(u.type,t,s);if(f&&u.from<u.to){let p=Vy(u);if(p&&(t>0?e>=p.from&&e<p.to:e>p.from&&e<=p.to))return u6(n,e,t,u,p,f,s)}}return h6(n,e,t,o,a.type,i,s)}function u6(n,e,t,r,i,s,o){let a=r.parent,u={from:i.from,to:i.to},f=0,p=a==null?void 0:a.cursor();if(p&&(t<0?p.childBefore(r.from):p.childAfter(r.to)))do if(t<0?p.to<=r.from:p.from>=r.to){if(f==0&&s.indexOf(p.type.name)>-1&&p.from<p.to){let g=Vy(p);return{start:u,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(qy(p.type,t,o))f++;else if(qy(p.type,-t,o)){if(f==0){let g=Vy(p);return{start:u,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}f--}}while(t<0?p.prevSibling():p.nextSibling());return{start:u,matched:!1}}function h6(n,e,t,r,i,s,o){let a=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),u=o.indexOf(a);if(u<0||u%2==0!=t>0)return null;let f={from:t<0?e-1:e,to:t>0?e+1:e},p=n.doc.iterRange(e,t>0?n.doc.length:0),g=0;for(let x=0;!p.next().done&&x<=s;){let A=p.value;t<0&&(x+=A.length);let _=e+x*t;for(let b=t>0?0:A.length-1,w=t>0?A.length:-1;b!=w;b+=t){let C=o.indexOf(A[b]);if(!(C<0||r.resolveInner(_+b,1).type!=i))if(C%2==0==t>0)g++;else{if(g==1)return{start:f,end:{from:_+b,to:_+b+1},matched:C>>1==u>>1};g--}}t>0&&(x+=A.length)}return p.done?{start:f,matched:!1}:null}const f6=Object.create(null),l_=[jr.none],c_=[],u_=Object.create(null),d6=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])d6[n]=p6(f6,e);function Ex(n,e){c_.indexOf(n)>-1||(c_.push(n),console.warn(e))}function p6(n,e){let t=[];for(let a of e.split(" ")){let u=[];for(let f of a.split(".")){let p=n[f]||fe[f];p?typeof p=="function"?u.length?u=u.map(p):Ex(f,`Modifier ${f} used at start of tag`):u.length?Ex(f,`Tag ${f} used as modifier`):u=Array.isArray(p)?p:[p]:Ex(f,`Unknown highlighting tag ${f}`)}for(let f of u)t.push(f)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),i=r+" "+t.map(a=>a.id),s=u_[i];if(s)return s.id;let o=u_[i]=jr.define({id:l_.length,name:r,props:[qC({[r]:t})]});return l_.push(o),o.id}Zt.RTL,Zt.LTR;const m6=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=Jv(n.state,t.from);return r.line?g6(n):r.block?y6(n):!1};function Yv(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let i=n(e,t);return i?(r(t.update(i)),!0):!1}}const g6=Yv(b6,0),x6=Yv(uT,0),y6=Yv((n,e)=>uT(n,e,A6(e)),0);function Jv(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Nu=50;function v6(n,{open:e,close:t},r,i){let s=n.sliceDoc(r-Nu,r),o=n.sliceDoc(i,i+Nu),a=/\s*$/.exec(s)[0].length,u=/^\s*/.exec(o)[0].length,f=s.length-a;if(s.slice(f-e.length,f)==e&&o.slice(u,u+t.length)==t)return{open:{pos:r-a,margin:a&&1},close:{pos:i+u,margin:u&&1}};let p,g;i-r<=2*Nu?p=g=n.sliceDoc(r,i):(p=n.sliceDoc(r,r+Nu),g=n.sliceDoc(i-Nu,i));let x=/^\s*/.exec(p)[0].length,A=/\s*$/.exec(g)[0].length,_=g.length-A-t.length;return p.slice(x,x+e.length)==e&&g.slice(_,_+t.length)==t?{open:{pos:r+x+e.length,margin:/\s/.test(p.charAt(x+e.length))?1:0},close:{pos:i-A-t.length,margin:/\s/.test(g.charAt(_-1))?1:0}}:null}function A6(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),i=t.to<=r.to?r:n.doc.lineAt(t.to);i.from>r.from&&i.from==t.to&&(i=t.to==r.to+1?r:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=i.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return e}function uT(n,e,t=e.selection.ranges){let r=t.map(s=>Jv(e,s.from).block);if(!r.every(s=>s))return null;let i=t.map((s,o)=>v6(e,r[o],s.from,s.to));if(n!=2&&!i.every(s=>s))return{changes:e.changes(t.map((s,o)=>i[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(n!=1&&i.some(s=>s)){let s=[];for(let o=0,a;o<i.length;o++)if(a=i[o]){let u=r[o],{open:f,close:p}=a;s.push({from:f.pos-u.open.length,to:f.pos+f.margin},{from:p.pos-p.margin,to:p.pos+u.close.length})}return{changes:s}}return null}function b6(n,e,t=e.selection.ranges){let r=[],i=-1;for(let{from:s,to:o}of t){let a=r.length,u=1e9,f=Jv(e,s).line;if(f){for(let p=s;p<=o;){let g=e.doc.lineAt(p);if(g.from>i&&(s==o||o>g.from)){i=g.from;let x=/^\s*/.exec(g.text)[0].length,A=x==g.length,_=g.text.slice(x,x+f.length)==f?x:-1;x<g.text.length&&x<u&&(u=x),r.push({line:g,comment:_,token:f,indent:x,empty:A,single:!1})}p=g.to+1}if(u<1e9)for(let p=a;p<r.length;p++)r[p].indent<r[p].line.text.length&&(r[p].indent=u);r.length==a+1&&(r[a].single=!0)}}if(n!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:u,indent:f,empty:p,single:g}of r)(g||!p)&&s.push({from:a.from+f,insert:u+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:u}of r)if(a>=0){let f=o.from+a,p=f+u.length;o.text[p-o.from]==" "&&p++,s.push({from:f,to:p})}return{changes:s}}return null}const $y=_s.define(),w6=_s.define(),_6=je.define(),hT=je.define({combine(n){return Os(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,i)=>e(r,i)||t(r,i)})}}),fT=$n.define({create(){return As.empty},update(n,e){let t=e.state.facet(hT),r=e.annotation($y);if(r){let u=Ir.fromTransaction(e,r.selection),f=r.side,p=f==0?n.undone:n.done;return u?p=vp(p,p.length,t.minDepth,u):p=mT(p,e.startState.selection),new As(f==0?r.rest:p,f==0?p:r.rest)}let i=e.annotation(w6);if((i=="full"||i=="before")&&(n=n.isolate()),e.annotation(Cn.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=Ir.fromTransaction(e),o=e.annotation(Cn.time),a=e.annotation(Cn.userEvent);return s?n=n.addChanges(s,o,a,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,a,t.newGroupDelay)),(i=="full"||i=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new As(n.done.map(Ir.fromJSON),n.undone.map(Ir.fromJSON))}});function O6(n={}){return[fT,hT.of(n),Ne.domEventHandlers({beforeinput(e,t){let r=e.inputType=="historyUndo"?dT:e.inputType=="historyRedo"?Uy:null;return r?(e.preventDefault(),r(t)):!1}})]}function om(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let i=t.field(fT,!1);if(!i)return!1;let s=i.pop(n,t,e);return s?(r(s),!0):!1}}const dT=om(0,!1),Uy=om(1,!1),k6=om(0,!0),S6=om(1,!0);class Ir{constructor(e,t,r,i,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new Ir(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new Ir(e.changes&&Ln.fromJSON(e.changes),[],e.mapped&&bs.fromJSON(e.mapped),e.startSelection&&we.fromJSON(e.startSelection),e.selectionsAfter.map(we.fromJSON))}static fromTransaction(e,t){let r=bi;for(let i of e.startState.facet(_6)){let s=i(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new Ir(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,bi)}static selection(e){return new Ir(void 0,bi,void 0,void 0,e)}}function vp(n,e,t,r){let i=e+1>t+20?e-t-1:0,s=n.slice(i,e);return s.push(r),s}function C6(n,e){let t=[],r=!1;return n.iterChangedRanges((i,s)=>t.push(i,s)),e.iterChangedRanges((i,s,o,a)=>{for(let u=0;u<t.length;){let f=t[u++],p=t[u++];a>=f&&o<=p&&(r=!0)}}),r}function T6(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length===0}function pT(n,e){return n.length?e.length?n.concat(e):n:e}const bi=[],E6=200;function mT(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-E6));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),vp(n,n.length-1,1e9,t.setSelAfter(r)))}else return[Ir.selection([e])]}function P6(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Px(n,e){if(!n.length)return n;let t=n.length,r=bi;for(;t;){let i=B6(n[t-1],e,r);if(i.changes&&!i.changes.empty||i.effects.length){let s=n.slice(0,t);return s[t-1]=i,s}else e=i.mapped,t--,r=i.selectionsAfter}return r.length?[Ir.selection(r)]:bi}function B6(n,e,t){let r=pT(n.selectionsAfter.length?n.selectionsAfter.map(a=>a.map(e)):bi,t);if(!n.changes)return Ir.selection(r);let i=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new Ir(i,ft.mapEffects(n.effects,e),o,n.startSelection.map(s),r)}const R6=/^(input\.type|delete)($|\.)/;class As{constructor(e,t,r=0,i=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=i}isolate(){return this.prevTime?new As(this.done,this.undone):this}addChanges(e,t,r,i,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!r||R6.test(r))&&(!a.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,C6(a.changes,e.changes))||r=="input.type.compose")?o=vp(o,o.length-1,i.minDepth,new Ir(e.changes.compose(a.changes),pT(ft.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,bi)):o=vp(o,o.length,i.minDepth,e),new As(o,bi,t,r)}addSelection(e,t,r,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:bi;return s.length>0&&t-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&T6(s[s.length-1],e)?this:new As(mT(this.done,e),this.undone,t,r)}addMapping(e){return new As(Px(this.done,e),Px(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],o=s.selectionsAfter[0]||t.selection;if(r&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:$y.of({side:e,rest:P6(i),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let a=i.length==1?bi:i.slice(0,i.length-1);return s.mapped&&(a=Px(a,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:$y.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}As.empty=new As(bi,bi);const D6=[{key:"Mod-z",run:dT,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Uy,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Uy,preventDefault:!0},{key:"Mod-u",run:k6,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:S6,preventDefault:!0}];function Fc(n,e){return we.create(n.ranges.map(e),n.mainIndex)}function Ui(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Zi({state:n,dispatch:e},t){let r=Fc(n.selection,t);return r.eq(n.selection,!0)?!1:(e(Ui(n,r)),!0)}function am(n,e){return we.cursor(e?n.to:n.from)}function gT(n,e){return Zi(n,t=>t.empty?n.moveByChar(t,e):am(t,e))}function fr(n){return n.textDirectionAt(n.state.selection.main.head)==Zt.LTR}const xT=n=>gT(n,!fr(n)),yT=n=>gT(n,fr(n));function vT(n,e){return Zi(n,t=>t.empty?n.moveByGroup(t,e):am(t,e))}const M6=n=>vT(n,!fr(n)),N6=n=>vT(n,fr(n));function L6(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function lm(n,e,t){let r=qn(n).resolveInner(e.head),i=t?St.closedBy:St.openedBy;for(let u=e.head;;){let f=t?r.childAfter(u):r.childBefore(u);if(!f)break;L6(n,f,i)?r=f:u=t?f.to:f.from}let s=r.type.prop(i),o,a;return s&&(o=t?vs(n,r.from,1):vs(n,r.to,-1))&&o.matched?a=t?o.end.to:o.end.from:a=t?r.to:r.from,we.cursor(a,t?-1:1)}const F6=n=>Zi(n,e=>lm(n.state,e,!fr(n))),I6=n=>Zi(n,e=>lm(n.state,e,fr(n)));function AT(n,e){return Zi(n,t=>{if(!t.empty)return am(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}const bT=n=>AT(n,!1),wT=n=>AT(n,!0);function _T(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0,i;if(e){for(let s of n.state.facet(Ne.scrollMargins)){let o=s(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(r=Math.max(o==null?void 0:o.bottom,r))}i=n.scrollDOM.clientHeight-t-r}else i=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,i-5)}}function OT(n,e){let t=_T(n),{state:r}=n,i=Fc(r.selection,o=>o.empty?n.moveVertically(o,e,t.height):am(o,e));if(i.eq(r.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(r.selection.main.head),a=n.scrollDOM.getBoundingClientRect(),u=a.top+t.marginTop,f=a.bottom-t.marginBottom;o&&o.top>u&&o.bottom<f&&(s=Ne.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-u}))}return n.dispatch(Ui(r,i),{effects:s}),!0}const h_=n=>OT(n,!1),Zy=n=>OT(n,!0);function ca(n,e,t){let r=n.lineBlockAt(e.head),i=n.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?r.to:r.from)&&(i=n.moveToLineBoundary(e,t,!1)),!t&&i.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(i=we.cursor(r.from+s))}return i}const z6=n=>Zi(n,e=>ca(n,e,!0)),j6=n=>Zi(n,e=>ca(n,e,!1)),Q6=n=>Zi(n,e=>ca(n,e,!fr(n))),H6=n=>Zi(n,e=>ca(n,e,fr(n))),W6=n=>Zi(n,e=>we.cursor(n.lineBlockAt(e.head).from,1)),q6=n=>Zi(n,e=>we.cursor(n.lineBlockAt(e.head).to,-1));function V6(n,e,t){let r=!1,i=Fc(n.selection,s=>{let o=vs(n,s.head,-1)||vs(n,s.head,1)||s.head>0&&vs(n,s.head-1,1)||s.head<n.doc.length&&vs(n,s.head+1,-1);if(!o||!o.end)return s;r=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return we.cursor(a)});return r?(e(Ui(n,i)),!0):!1}const $6=({state:n,dispatch:e})=>V6(n,e);function ki(n,e){let t=Fc(n.state.selection,r=>{let i=e(r);return we.range(r.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Ui(n.state,t)),!0)}function kT(n,e){return ki(n,t=>n.moveByChar(t,e))}const ST=n=>kT(n,!fr(n)),CT=n=>kT(n,fr(n));function TT(n,e){return ki(n,t=>n.moveByGroup(t,e))}const U6=n=>TT(n,!fr(n)),Z6=n=>TT(n,fr(n)),G6=n=>ki(n,e=>lm(n.state,e,!fr(n))),X6=n=>ki(n,e=>lm(n.state,e,fr(n)));function ET(n,e){return ki(n,t=>n.moveVertically(t,e))}const PT=n=>ET(n,!1),BT=n=>ET(n,!0);function RT(n,e){return ki(n,t=>n.moveVertically(t,e,_T(n).height))}const f_=n=>RT(n,!1),d_=n=>RT(n,!0),K6=n=>ki(n,e=>ca(n,e,!0)),Y6=n=>ki(n,e=>ca(n,e,!1)),J6=n=>ki(n,e=>ca(n,e,!fr(n))),eL=n=>ki(n,e=>ca(n,e,fr(n))),tL=n=>ki(n,e=>we.cursor(n.lineBlockAt(e.head).from)),nL=n=>ki(n,e=>we.cursor(n.lineBlockAt(e.head).to)),p_=({state:n,dispatch:e})=>(e(Ui(n,{anchor:0})),!0),m_=({state:n,dispatch:e})=>(e(Ui(n,{anchor:n.doc.length})),!0),g_=({state:n,dispatch:e})=>(e(Ui(n,{anchor:n.selection.main.anchor,head:0})),!0),x_=({state:n,dispatch:e})=>(e(Ui(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),rL=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),iL=({state:n,dispatch:e})=>{let t=cm(n).map(({from:r,to:i})=>we.range(r,Math.min(i+1,n.doc.length)));return e(n.update({selection:we.create(t),userEvent:"select"})),!0},sL=({state:n,dispatch:e})=>{let t=Fc(n.selection,r=>{let i=qn(n),s=i.resolveStack(r.from,1);if(r.empty){let o=i.resolveStack(r.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:a}=o;if((a.from<r.from&&a.to>=r.to||a.to>r.to&&a.from<=r.from)&&o.next)return we.range(a.to,a.from)}return r});return t.eq(n.selection)?!1:(e(Ui(n,t)),!0)};function DT(n,e){let{state:t}=n,r=t.selection,i=t.selection.ranges.slice();for(let s of t.selection.ranges){let o=t.doc.lineAt(s.head);if(e?o.to<n.state.doc.length:o.from>0)for(let a=s;;){let u=n.moveVertically(a,e);if(u.head<o.from||u.head>o.to){i.some(f=>f.head==u.head)||i.push(u);break}else{if(u.head==a.head)break;a=u}}}return i.length==r.ranges.length?!1:(n.dispatch(Ui(t,we.create(i,i.length-1))),!0)}const oL=n=>DT(n,!1),aL=n=>DT(n,!0),lL=({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=we.create([t.main]):t.main.empty||(r=we.create([we.cursor(t.main.head)])),r?(e(Ui(n,r)),!0):!1};function $h(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,i=r.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let u=e(s);u<o?(t="delete.backward",u=jd(n,u,!1)):u>o&&(t="delete.forward",u=jd(n,u,!0)),o=Math.min(o,u),a=Math.max(a,u)}else o=jd(n,o,!1),a=jd(n,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:we.cursor(o,o<s.head?-1:1)}});return i.changes.empty?!1:(n.dispatch(r.update(i,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?Ne.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function jd(n,e,t){if(n instanceof Ne)for(let r of n.state.facet(Ne.atomicRanges).map(i=>i(n)))r.between(e,e,(i,s)=>{i<e&&s>e&&(e=t?s:i)});return e}const MT=(n,e,t)=>$h(n,r=>{let i=r.from,{state:s}=n,o=s.doc.lineAt(i),a,u;if(t&&!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,i-o.from))){if(a[a.length-1]=="	")return i-1;let f=Lc(a,s.tabSize),p=f%gp(s)||gp(s);for(let g=0;g<p&&a[a.length-1-g]==" ";g++)i--;u=i}else u=Fn(o.text,i-o.from,e,e)+o.from,u==i&&o.number!=(e?s.doc.lines:1)?u+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(u-o.from,i-o.from))&&(u=Fn(o.text,u-o.from,!1,!1)+o.from);return u}),Gy=n=>MT(n,!1,!0),NT=n=>MT(n,!0,!1),LT=(n,e)=>$h(n,t=>{let r=t.head,{state:i}=n,s=i.doc.lineAt(r),o=i.charCategorizer(r);for(let a=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?i.doc.lines:1)&&(r+=e?1:-1);break}let u=Fn(s.text,r-s.from,e)+s.from,f=s.text.slice(Math.min(r,u)-s.from,Math.max(r,u)-s.from),p=o(f);if(a!=null&&p!=a)break;(f!=" "||r!=t.head)&&(a=p),r=u}return r}),FT=n=>LT(n,!1),cL=n=>LT(n,!0),uL=n=>$h(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),hL=n=>$h(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),fL=n=>$h(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),dL=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Lt.of(["",""])},range:we.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},pL=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||r.from==0||r.from==n.doc.length)return{range:r};let i=r.from,s=n.doc.lineAt(i),o=i==s.from?i-1:Fn(s.text,i-s.from,!1)+s.from,a=i==s.to?i+1:Fn(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:n.doc.slice(i,a).append(n.doc.slice(o,i))},range:we.cursor(a)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function cm(n){let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:i.from,to:s.to,ranges:[r]});t=s.number+1}return e}function IT(n,e,t){if(n.readOnly)return!1;let r=[],i=[];for(let s of cm(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),a=o.length+1;if(t){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let u of s.ranges)i.push(we.range(Math.min(n.doc.length,u.anchor+a),Math.min(n.doc.length,u.head+a)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let u of s.ranges)i.push(we.range(u.anchor-a,u.head-a))}}return r.length?(e(n.update({changes:r,scrollIntoView:!0,selection:we.create(i,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const mL=({state:n,dispatch:e})=>IT(n,e,!1),gL=({state:n,dispatch:e})=>IT(n,e,!0);function zT(n,e,t){if(n.readOnly)return!1;let r=[];for(let s of cm(n))t?r.push({from:s.from,insert:n.doc.slice(s.from,s.to)+n.lineBreak}):r.push({from:s.to,insert:n.lineBreak+n.doc.slice(s.from,s.to)});let i=n.changes(r);return e(n.update({changes:i,selection:n.selection.map(i,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const xL=({state:n,dispatch:e})=>zT(n,e,!1),yL=({state:n,dispatch:e})=>zT(n,e,!0),vL=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(cm(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),r=Fc(e.selection,i=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(i.head),a=n.coordsAtPos(i.head,i.assoc||1);a&&(s=o.bottom+n.documentTop-a.bottom+n.defaultLineHeight/2)}return n.moveVertically(i,!0,s)}).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function AL(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=qn(n).resolveInner(e),r=t.childBefore(e),i=t.childAfter(e),s;return r&&i&&r.to<=e&&i.from>=e&&(s=r.type.prop(St.closedBy))&&s.indexOf(i.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(i.from).from&&!/\S/.test(n.sliceDoc(r.to,i.from))?{from:r.to,to:i.from}:null}const y_=jT(!1),bL=jT(!0);function jT(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(i=>{let{from:s,to:o}=i,a=e.doc.lineAt(s),u=!n&&s==o&&AL(e,s);n&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let f=new im(e,{simulateBreak:s,simulateDoubleBreak:!!u}),p=Xv(f,s);for(p==null&&(p=Lc(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;u?{from:s,to:o}=u:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let g=["",_h(e,p)];return u&&g.push(_h(e,f.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:Lt.of(g)},range:we.cursor(s+1+g[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function eA(n,e){let t=-1;return n.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let a=n.doc.lineAt(o);a.number>t&&(r.empty||r.to>a.from)&&(e(a,i,r),t=a.number),o=a.to+1}let s=n.changes(i);return{changes:i,range:we.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const wL=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new im(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),i=eA(n,(s,o,a)=>{let u=Xv(r,s.from);if(u==null)return;/\S/.test(s.text)||(u=0);let f=/^\s*/.exec(s.text)[0],p=_h(n,u);(f!=p||a.from<s.from+f.length)&&(t[s.from]=u,o.push({from:s.from,to:s.from+f.length,insert:p}))});return i.changes.empty||e(n.update(i,{userEvent:"indent"})),!0},QT=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(eA(n,(t,r)=>{r.push({from:t.from,insert:n.facet(Wh)})}),{userEvent:"input.indent"})),!0),HT=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(eA(n,(t,r)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let s=Lc(i,n.tabSize),o=0,a=_h(n,Math.max(0,s-gp(n)));for(;o<i.length&&o<a.length&&i.charCodeAt(o)==a.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+i.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),_L=n=>(n.setTabFocusMode(),!0),OL=[{key:"Ctrl-b",run:xT,shift:ST,preventDefault:!0},{key:"Ctrl-f",run:yT,shift:CT},{key:"Ctrl-p",run:bT,shift:PT},{key:"Ctrl-n",run:wT,shift:BT},{key:"Ctrl-a",run:W6,shift:tL},{key:"Ctrl-e",run:q6,shift:nL},{key:"Ctrl-d",run:NT},{key:"Ctrl-h",run:Gy},{key:"Ctrl-k",run:uL},{key:"Ctrl-Alt-h",run:FT},{key:"Ctrl-o",run:dL},{key:"Ctrl-t",run:pL},{key:"Ctrl-v",run:Zy}],kL=[{key:"ArrowLeft",run:xT,shift:ST,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:M6,shift:U6,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Q6,shift:J6,preventDefault:!0},{key:"ArrowRight",run:yT,shift:CT,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:N6,shift:Z6,preventDefault:!0},{mac:"Cmd-ArrowRight",run:H6,shift:eL,preventDefault:!0},{key:"ArrowUp",run:bT,shift:PT,preventDefault:!0},{mac:"Cmd-ArrowUp",run:p_,shift:g_},{mac:"Ctrl-ArrowUp",run:h_,shift:f_},{key:"ArrowDown",run:wT,shift:BT,preventDefault:!0},{mac:"Cmd-ArrowDown",run:m_,shift:x_},{mac:"Ctrl-ArrowDown",run:Zy,shift:d_},{key:"PageUp",run:h_,shift:f_},{key:"PageDown",run:Zy,shift:d_},{key:"Home",run:j6,shift:Y6,preventDefault:!0},{key:"Mod-Home",run:p_,shift:g_},{key:"End",run:z6,shift:K6,preventDefault:!0},{key:"Mod-End",run:m_,shift:x_},{key:"Enter",run:y_,shift:y_},{key:"Mod-a",run:rL},{key:"Backspace",run:Gy,shift:Gy,preventDefault:!0},{key:"Delete",run:NT,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:FT,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:cL,preventDefault:!0},{mac:"Mod-Backspace",run:hL,preventDefault:!0},{mac:"Mod-Delete",run:fL,preventDefault:!0}].concat(OL.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),SL=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:F6,shift:G6},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:I6,shift:X6},{key:"Alt-ArrowUp",run:mL},{key:"Shift-Alt-ArrowUp",run:xL},{key:"Alt-ArrowDown",run:gL},{key:"Shift-Alt-ArrowDown",run:yL},{key:"Mod-Alt-ArrowUp",run:oL},{key:"Mod-Alt-ArrowDown",run:aL},{key:"Escape",run:lL},{key:"Mod-Enter",run:bL},{key:"Alt-l",mac:"Ctrl-l",run:iL},{key:"Mod-i",run:sL,preventDefault:!0},{key:"Mod-[",run:HT},{key:"Mod-]",run:QT},{key:"Mod-Alt-\\",run:wL},{key:"Shift-Mod-k",run:vL},{key:"Shift-Mod-\\",run:$6},{key:"Mod-/",run:m6},{key:"Alt-A",run:x6},{key:"Ctrl-m",mac:"Shift-Alt-m",run:_L}].concat(kL),CL={key:"Tab",run:QT,shift:HT},v_=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Ec{constructor(e,t,r=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?a=>s(v_(a)):v_,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Mr(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Cv(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=gs(e);let i=this.normalize(t);if(i.length)for(let s=0,o=r;;s++){let a=i.charCodeAt(s),u=this.match(a,o,this.bufferPos+this.bufferStart);if(s==i.length-1){if(u)return this.value=u,this;break}o==r&&s<t.length&&t.charCodeAt(s)==a&&o++}}}match(e,t,r){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:r}:(this.matches[s]++,a=!0)),a||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:r}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(Ec.prototype[Symbol.iterator]=function(){return this});const WT={from:-1,to:-1,match:/.*/.exec("")},tA="gm"+(/x/.unicode==null?"":"u");class qT{constructor(e,t,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=WT,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new VT(e,t,r,i,s);this.re=new RegExp(t,tA+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=Ap(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,i=r+t[0].length;if(this.matchPos=Ap(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Bx=new WeakMap;class mc{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let i=Bx.get(e);if(!i||i.from>=r||i.to<=t){let a=new mc(t,e.sliceString(t,r));return Bx.set(e,a),a}if(i.from==t&&i.to==r)return i;let{text:s,from:o}=i;return o>t&&(s=e.sliceString(t,o)+s,o=t),i.to<r&&(s+=e.sliceString(i.to,r)),Bx.set(e,new mc(o,s)),new mc(t,s.slice(t-o,r-o))}}class VT{constructor(e,t,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=WT,this.matchPos=Ap(e,i),this.re=new RegExp(t,tA+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=mc.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,i=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this.matchPos=Ap(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=mc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(qT.prototype[Symbol.iterator]=VT.prototype[Symbol.iterator]=function(){return this});function TL(n){try{return new RegExp(n,tA),!0}catch{return!1}}function Ap(n,e){if(e>=n.length)return e;let t=n.lineAt(e),r;for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}const EL=n=>{let{state:e}=n,t=String(e.doc.lineAt(n.state.selection.main.head).number),{close:r,result:i}=UM(n,{label:e.phrase("Go to line"),input:{type:"text",name:"line",value:t},focus:!0,submitLabel:e.phrase("go")});return i.then(s=>{let o=s&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(s.elements.line.value);if(!o){n.dispatch({effects:r});return}let a=e.doc.lineAt(e.selection.main.head),[,u,f,p,g]=o,x=p?+p.slice(1):0,A=f?+f:a.number;if(f&&g){let w=A/100;u&&(w=w*(u=="-"?-1:1)+a.number/e.doc.lines),A=Math.round(e.doc.lines*w)}else f&&u&&(A=A*(u=="-"?-1:1)+a.number);let _=e.doc.line(Math.max(1,Math.min(e.doc.lines,A))),b=we.cursor(_.from+Math.max(0,Math.min(x,_.length)));n.dispatch({effects:[r,Ne.scrollIntoView(b.from,{y:"center"})],selection:b})}),!0},PL={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},BL=je.define({combine(n){return Os(n,PL,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function RL(n){return[FL,LL]}const DL=Je.mark({class:"cm-selectionMatch"}),ML=Je.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function A_(n,e,t,r){return(t==0||n(e.sliceDoc(t-1,t))!=ln.Word)&&(r==e.doc.length||n(e.sliceDoc(r,r+1))!=ln.Word)}function NL(n,e,t,r){return n(e.sliceDoc(t,t+1))==ln.Word&&n(e.sliceDoc(r-1,r))==ln.Word}const LL=_n.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(BL),{state:t}=n,r=t.selection;if(r.ranges.length>1)return Je.none;let i=r.main,s,o=null;if(i.empty){if(!e.highlightWordAroundCursor)return Je.none;let u=t.wordAt(i.head);if(!u)return Je.none;o=t.charCategorizer(i.head),s=t.sliceDoc(u.from,u.to)}else{let u=i.to-i.from;if(u<e.minSelectionLength||u>200)return Je.none;if(e.wholeWords){if(s=t.sliceDoc(i.from,i.to),o=t.charCategorizer(i.head),!(A_(o,t,i.from,i.to)&&NL(o,t,i.from,i.to)))return Je.none}else if(s=t.sliceDoc(i.from,i.to),!s)return Je.none}let a=[];for(let u of n.visibleRanges){let f=new Ec(t.doc,s,u.from,u.to);for(;!f.next().done;){let{from:p,to:g}=f.value;if((!o||A_(o,t,p,g))&&(i.empty&&p<=i.from&&g>=i.to?a.push(ML.range(p,g)):(p>=i.to||g<=i.from)&&a.push(DL.range(p,g)),a.length>e.maxMatches))return Je.none}}return Je.set(a)}},{decorations:n=>n.decorations}),FL=Ne.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),IL=({state:n,dispatch:e})=>{let{selection:t}=n,r=we.create(t.ranges.map(i=>n.wordAt(i.head)||we.cursor(i.head)),t.mainIndex);return r.eq(t)?!1:(e(n.update({selection:r})),!0)};function zL(n,e){let{main:t,ranges:r}=n.selection,i=n.wordAt(t.head),s=i&&i.from==t.from&&i.to==t.to;for(let o=!1,a=new Ec(n.doc,e,r[r.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new Ec(n.doc,e,0,Math.max(0,r[r.length-1].from-1)),o=!0}else{if(o&&r.some(u=>u.from==a.value.from))continue;if(s){let u=n.wordAt(a.value.from);if(!u||u.from!=a.value.from||u.to!=a.value.to)continue}return a.value}}const jL=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return IL({state:n,dispatch:e});let r=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=r))return!1;let i=zL(n,r);return i?(e(n.update({selection:n.selection.addRange(we.range(i.from,i.to),!1),effects:Ne.scrollIntoView(i.to)})),!0):!1},Ic=je.define({combine(n){return Os(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new eF(e),scrollToMatch:e=>Ne.scrollIntoView(e)})}});class $T{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||TL(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new $L(this):new WL(this)}getCursor(e,t=0,r){let i=e.doc?e:Rt.create({doc:e});return r==null&&(r=i.doc.length),this.regexp?ic(this,i,t,r):rc(this,i,t,r)}}class UT{constructor(e){this.spec=e}}function QL(n,e,t){return(r,i,s,o)=>{if(t&&!t(r,i,s,o))return!1;let a=r>=o&&i<=o+s.length?s.slice(r-o,i-o):e.doc.sliceString(r,i);return n(a,e,r,i)}}function rc(n,e,t,r){let i;return n.wholeWord&&(i=HL(e.doc,e.charCategorizer(e.selection.main.head))),n.test&&(i=QL(n.test,e,i)),new Ec(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:s=>s.toLowerCase(),i)}function HL(n,e){return(t,r,i,s)=>((s>t||s+i.length<r)&&(s=Math.max(0,t-2),i=n.sliceString(s,Math.min(n.length,r+2))),(e(bp(i,t-s))!=ln.Word||e(wp(i,t-s))!=ln.Word)&&(e(wp(i,r-s))!=ln.Word||e(bp(i,r-s))!=ln.Word))}class WL extends UT{constructor(e){super(e)}nextMatch(e,t,r){let i=rc(this.spec,e,r,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);i=rc(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==t&&i.value.to==r?null:i.value}prevMatchInRange(e,t,r){for(let i=r;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),o=rc(this.spec,e,s,i),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==t)return null;i-=1e4}}prevMatch(e,t,r){let i=this.prevMatchInRange(e,0,t);return i||(i=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=t||i.to!=r)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=rc(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=rc(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function qL(n,e,t){return(r,i,s)=>(!t||t(r,i,s))&&n(s[0],e,r,i)}function ic(n,e,t,r){let i;return n.wholeWord&&(i=VL(e.charCategorizer(e.selection.main.head))),n.test&&(i=qL(n.test,e,i)),new qT(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:i},t,r)}function bp(n,e){return n.slice(Fn(n,e,!1),e)}function wp(n,e){return n.slice(e,Fn(n,e))}function VL(n){return(e,t,r)=>!r[0].length||(n(bp(r.input,r.index))!=ln.Word||n(wp(r.input,r.index))!=ln.Word)&&(n(wp(r.input,r.index+r[0].length))!=ln.Word||n(bp(r.input,r.index+r[0].length))!=ln.Word)}class $L extends UT{nextMatch(e,t,r){let i=ic(this.spec,e,r,e.doc.length).next();return i.done&&(i=ic(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=1;;i++){let s=Math.max(t,r-i*1e4),o=ic(this.spec,e,s,r),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==t||a.from>s+10))return a;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if(r=="&")return e.match[0];if(r=="$")return"$";for(let i=r.length;i>0;i--){let s=+r.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+r.slice(i)}return t})}matchAll(e,t){let r=ic(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=ic(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Oh=ft.define(),nA=ft.define(),ea=$n.define({create(n){return new Rx(Xy(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Oh)?n=new Rx(t.value.create(),n.panel):t.is(nA)&&(n=new Rx(n.query,t.value?rA:null));return n},provide:n=>Ah.from(n,e=>e.panel)});class Rx{constructor(e,t){this.query=e,this.panel=t}}const UL=Je.mark({class:"cm-searchMatch"}),ZL=Je.mark({class:"cm-searchMatch cm-searchMatch-selected"}),GL=_n.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(ea))}update(n){let e=n.state.field(ea);(e!=n.startState.field(ea)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Je.none;let{view:t}=this,r=new so;for(let i=0,s=t.visibleRanges,o=s.length;i<o;i++){let{from:a,to:u}=s[i];for(;i<o-1&&u>s[i+1].from-500;)u=s[++i].to;n.highlight(t.state,a,u,(f,p)=>{let g=t.state.selection.ranges.some(x=>x.from==f&&x.to==p);r.add(f,p,g?ZL:UL)})}return r.finish()}},{decorations:n=>n.decorations});function Uh(n){return e=>{let t=e.state.field(ea,!1);return t&&t.query.spec.valid?n(e,t):XT(e)}}const _p=Uh((n,{query:e})=>{let{to:t}=n.state.selection.main,r=e.nextMatch(n.state,t,t);if(!r)return!1;let i=we.single(r.from,r.to),s=n.state.facet(Ic);return n.dispatch({selection:i,effects:[iA(n,r),s.scrollToMatch(i.main,n)],userEvent:"select.search"}),GT(n),!0}),Op=Uh((n,{query:e})=>{let{state:t}=n,{from:r}=t.selection.main,i=e.prevMatch(t,r,r);if(!i)return!1;let s=we.single(i.from,i.to),o=n.state.facet(Ic);return n.dispatch({selection:s,effects:[iA(n,i),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),GT(n),!0}),XL=Uh((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:we.create(t.map(r=>we.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),KL=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:r,to:i}=t.main,s=[],o=0;for(let a=new Ec(n.doc,n.sliceDoc(r,i));!a.next().done;){if(s.length>1e3)return!1;a.value.from==r&&(o=s.length),s.push(we.range(a.value.from,a.value.to))}return e(n.update({selection:we.create(s,o),userEvent:"select.search.matches"})),!0},b_=Uh((n,{query:e})=>{let{state:t}=n,{from:r,to:i}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,r,r);if(!s)return!1;let o=s,a=[],u,f,p=[];o.from==r&&o.to==i&&(f=t.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:f}),o=e.nextMatch(t,o.from,o.to),p.push(Ne.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(r).number)+".")));let g=n.state.changes(a);return o&&(u=we.single(o.from,o.to).map(g),p.push(iA(n,o)),p.push(t.facet(Ic).scrollToMatch(u.main,n))),n.dispatch({changes:g,selection:u,effects:p,userEvent:"input.replace"}),!0}),YL=Uh((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(i=>{let{from:s,to:o}=i;return{from:s,to:o,insert:e.getReplacement(i)}});if(!t.length)return!1;let r=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:Ne.announce.of(r),userEvent:"input.replace.all"}),!0});function rA(n){return n.state.facet(Ic).createPanel(n)}function Xy(n,e){var t,r,i,s,o;let a=n.selection.main,u=a.empty||a.to>a.from+100?"":n.sliceDoc(a.from,a.to);if(e&&!u)return e;let f=n.facet(Ic);return new $T({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:f.literal)?u:u.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:f.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:f.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:f.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:f.wholeWord})}function ZT(n){let e=Vv(n,rA);return e&&e.dom.querySelector("[main-field]")}function GT(n){let e=ZT(n);e&&e==n.root.activeElement&&e.select()}const XT=n=>{let e=n.state.field(ea,!1);if(e&&e.panel){let t=ZT(n);if(t&&t!=n.root.activeElement){let r=Xy(n.state,e.query.spec);r.valid&&n.dispatch({effects:Oh.of(r)}),t.focus(),t.select()}}else n.dispatch({effects:[nA.of(!0),e?Oh.of(Xy(n.state,e.query.spec)):ft.appendConfig.of(nF)]});return!0},KT=n=>{let e=n.state.field(ea,!1);if(!e||!e.panel)return!1;let t=Vv(n,rA);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:nA.of(!1)}),!0},JL=[{key:"Mod-f",run:XT,scope:"editor search-panel"},{key:"F3",run:_p,shift:Op,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:_p,shift:Op,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:KT,scope:"editor search-panel"},{key:"Mod-Shift-l",run:KL},{key:"Mod-Alt-g",run:EL},{key:"Mod-d",run:jL,preventDefault:!0}];class eF{constructor(e){this.view=e;let t=this.query=e.state.field(ea).query.spec;this.commit=this.commit.bind(this),this.searchField=Vt("input",{value:t.search,placeholder:Jr(e,"Find"),"aria-label":Jr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Vt("input",{value:t.replace,placeholder:Jr(e,"Replace"),"aria-label":Jr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Vt("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Vt("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Vt("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(i,s,o){return Vt("button",{class:"cm-button",name:i,onclick:s,type:"button"},o)}this.dom=Vt("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,r("next",()=>_p(e),[Jr(e,"next")]),r("prev",()=>Op(e),[Jr(e,"previous")]),r("select",()=>XL(e),[Jr(e,"all")]),Vt("label",null,[this.caseField,Jr(e,"match case")]),Vt("label",null,[this.reField,Jr(e,"regexp")]),Vt("label",null,[this.wordField,Jr(e,"by word")]),...e.state.readOnly?[]:[Vt("br"),this.replaceField,r("replace",()=>b_(e),[Jr(e,"replace")]),r("replaceAll",()=>YL(e),[Jr(e,"replace all")])],Vt("button",{name:"close",onclick:()=>KT(e),"aria-label":Jr(e,"close"),type:"button"},[""])])}commit(){let e=new $T({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Oh.of(e)}))}keydown(e){rM(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Op:_p)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),b_(this.view))}update(e){for(let t of e.transactions)for(let r of t.effects)r.is(Oh)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Ic).top}}function Jr(n,e){return n.state.phrase(e)}const Qd=30,Hd=/[\s\.,:;?!]/;function iA(n,{from:e,to:t}){let r=n.state.doc.lineAt(e),i=n.state.doc.lineAt(t).to,s=Math.max(r.from,e-Qd),o=Math.min(i,t+Qd),a=n.state.sliceDoc(s,o);if(s!=r.from){for(let u=0;u<Qd;u++)if(!Hd.test(a[u+1])&&Hd.test(a[u])){a=a.slice(u);break}}if(o!=i){for(let u=a.length-1;u>a.length-Qd;u--)if(!Hd.test(a[u-1])&&Hd.test(a[u])){a=a.slice(0,u);break}}return Ne.announce.of(`${n.state.phrase("current match")}. ${a} ${n.state.phrase("on line")} ${r.number}.`)}const tF=Ne.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),nF=[ea,la.low(GL),tF];class YT{constructor(e,t,r,i){this.state=e,this.pos=t,this.explicit=r,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=qn(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),i=t.text.slice(r-t.from,this.pos-t.from),s=i.search(eE(e,!1));return s<0?null:{from:r+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,r){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function w_(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function rF(n){let e=Object.create(null),t=Object.create(null);for(let{label:i}of n){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let r=w_(e)+w_(t)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function JT(n){let e=n.map(i=>typeof i=="string"?{label:i}:i),[t,r]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:rF(e);return i=>{let s=i.matchBefore(r);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function iF(n,e){return t=>{for(let r=qn(t.state).resolveInner(t.pos,-1);r;r=r.parent){if(n.indexOf(r.name)>-1)return null;if(r.type.isTop)break}return e(t)}}class __{constructor(e,t,r,i){this.completion=e,this.source=t,this.match=r,this.score=i}}function el(n){return n.selection.main.from}function eE(n,e){var t;let{source:r}=n,i=e&&r[0]!="^",s=r[r.length-1]!="$";return!i&&!s?n:new RegExp(`${i?"^":""}(?:${r})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const sA=_s.define();function sF(n,e,t,r){let{main:i}=n.selection,s=t-i.from,o=r-i.from;return{...n.changeByRange(a=>{if(a!=i&&t!=r&&n.sliceDoc(a.from+s,a.from+o)!=n.sliceDoc(t,r))return{range:a};let u=n.toText(e);return{changes:{from:a.from+s,to:r==i.from?a.to:a.from+o,insert:u},range:we.cursor(a.from+s+u.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const O_=new WeakMap;function oF(n){if(!Array.isArray(n))return n;let e=O_.get(n);return e||O_.set(n,e=JT(n)),e}const kp=ft.define(),kh=ft.define();class aF{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let r=Mr(e,t),i=gs(r);this.chars.push(r);let s=e.slice(t,t+i),o=s.toUpperCase();this.folded.push(Mr(o==s?s.toLowerCase():o,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:r,any:i,precise:s,byWord:o}=this;if(t.length==1){let T=Mr(e,0),E=gs(T),D=E==e.length?0:-100;if(T!=t[0])if(T==r[0])D+=-200;else return null;return this.ret(D,[0,E])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let u=t.length,f=0;if(a<0){for(let T=0,E=Math.min(e.length,200);T<E&&f<u;){let D=Mr(e,T);(D==t[f]||D==r[f])&&(i[f++]=T),T+=gs(D)}if(f<u)return null}let p=0,g=0,x=!1,A=0,_=-1,b=-1,w=/[a-z]/.test(e),C=!0;for(let T=0,E=Math.min(e.length,200),D=0;T<E&&g<u;){let N=Mr(e,T);a<0&&(p<u&&N==t[p]&&(s[p++]=T),A<u&&(N==t[A]||N==r[A]?(A==0&&(_=T),b=T+1,A++):A=0));let F,z=N<255?N>=48&&N<=57||N>=97&&N<=122?2:N>=65&&N<=90?1:0:(F=Cv(N))!=F.toLowerCase()?1:F!=F.toUpperCase()?2:0;(!T||z==1&&w||D==0&&z!=0)&&(t[g]==N||r[g]==N&&(x=!0)?o[g++]=T:o.length&&(C=!1)),D=z,T+=gs(N)}return g==u&&o[0]==0&&C?this.result(-100+(x?-200:0),o,e):A==u&&_==0?this.ret(-200-e.length+(b==e.length?0:-100),[0,b]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):A==u?this.ret(-900-e.length,[_,b]):g==u?this.result(-100+(x?-200:0)+-700+(C?0:-1100),o,e):t.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,t,r){let i=[],s=0;for(let o of t){let a=o+(this.astral?gs(Mr(r,o)):1);s&&i[s-1]==o?i[s-1]=a:(i[s++]=o,i[s++]=a)}return this.ret(e-r.length,i)}}class lF{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),r=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const Wn=je.define({combine(n){return Os(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:cF,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>r=>k_(e(r),t(r)),optionClass:(e,t)=>r=>k_(e(r),t(r)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function k_(n,e){return n?e?n+" "+e:n:e}function cF(n,e,t,r,i,s){let o=n.textDirection==Zt.RTL,a=o,u=!1,f="top",p,g,x=e.left-i.left,A=i.right-e.right,_=r.right-r.left,b=r.bottom-r.top;if(a&&x<Math.min(_,A)?a=!1:!a&&A<Math.min(_,x)&&(a=!0),_<=(a?x:A))p=Math.max(i.top,Math.min(t.top,i.bottom-b))-e.top,g=Math.min(400,a?x:A);else{u=!0,g=Math.min(400,(o?e.right:i.right-e.left)-30);let T=i.bottom-e.bottom;T>=b||T>e.top?p=t.bottom-e.top:(f="bottom",p=e.bottom-t.top)}let w=(e.bottom-e.top)/s.offsetHeight,C=(e.right-e.left)/s.offsetWidth;return{style:`${f}: ${p/w}px; max-width: ${g/C}px`,class:"cm-completionInfo-"+(u?o?"left-narrow":"right-narrow":a?"left":"right")}}function uF(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),t.type&&r.classList.add(...t.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(t,r,i,s){let o=document.createElement("span");o.className="cm-completionLabel";let a=t.displayLabel||t.label,u=0;for(let f=0;f<s.length;){let p=s[f++],g=s[f++];p>u&&o.appendChild(document.createTextNode(a.slice(u,p)));let x=o.appendChild(document.createElement("span"));x.appendChild(document.createTextNode(a.slice(p,g))),x.className="cm-completionMatchedText",u=g}return u<a.length&&o.appendChild(document.createTextNode(a.slice(u))),o},position:50},{render(t){if(!t.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=t.detail,r},position:80}),e.sort((t,r)=>t.position-r.position).map(t=>t.render)}function Dx(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let i=Math.floor(e/t);return{from:i*t,to:(i+1)*t}}let r=Math.floor((n-e)/t);return{from:n-(r+1)*t,to:n-r*t}}class hF{constructor(e,t,r){this.view=e,this.stateField=t,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:u=>this.placeInfo(u),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:s,selected:o}=i.open,a=e.state.facet(Wn);this.optionContent=uF(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=Dx(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",u=>{let{options:f}=e.state.field(t).open;for(let p=u.target,g;p&&p!=this.dom;p=p.parentNode)if(p.nodeName=="LI"&&(g=/-(\d+)$/.exec(p.id))&&+g[1]<f.length){this.applyCompletion(e,f[+g[1]]),u.preventDefault();return}}),this.dom.addEventListener("focusout",u=>{let f=e.state.field(this.stateField,!1);f&&f.tooltip&&e.state.facet(Wn).closeOnBlur&&u.relatedTarget!=e.contentDOM&&e.dispatch({effects:kh.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let r=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=i){let{options:s,selected:o,disabled:a}=r.open;(!i.open||i.open.options!=s)&&(this.range=Dx(s.length,o,e.state.facet(Wn).maxRenderedOptions),this.showOptions(s,r.id)),this.updateSel(),a!=((t=i.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of t.split(" "))r&&this.dom.classList.add(r);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Dx(t.options.length,t.selected,this.view.state.facet(Wn).maxRenderedOptions),this.showOptions(t.options,e.id));let r=this.updateSelectedOption(t.selected);if(r){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:s}=i;if(!s)return;let o=typeof s=="string"?document.createTextNode(s):s(i);if(!o)return;"then"in o?o.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,i)}).catch(a=>Fr(this.view.state,a,"completion info")):(this.addInfoPane(o,i),r.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",r.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;r.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let r=this.list.firstChild,i=this.range.from;r;r=r.nextSibling,i++)r.nodeName!="LI"||!r.id?i--:i==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),t=r):r.hasAttribute("aria-selected")&&(r.removeAttribute("aria-selected"),r.removeAttribute("aria-describedby"));return t&&dF(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return i.top>Math.min(s.bottom,t.bottom)-10||i.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(Wn).positionInfo(this.view,t,i,r,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,r){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",o=>{o.target==i&&o.preventDefault()});let s=null;for(let o=r.from;o<r.to;o++){let{completion:a,match:u}=e[o],{section:f}=a;if(f){let x=typeof f=="string"?f:f.name;if(x!=s&&(o>r.from||r.from==0))if(s=x,typeof f!="string"&&f.header)i.appendChild(f.header(f));else{let A=i.appendChild(document.createElement("completion-section"));A.textContent=x}}const p=i.appendChild(document.createElement("li"));p.id=t+"-"+o,p.setAttribute("role","option");let g=this.optionClass(a);g&&(p.className=g);for(let x of this.optionContent){let A=x(a,this.view.state,this.view,u);A&&p.appendChild(A)}}return r.from&&i.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function fF(n,e){return t=>new hF(t,n,e)}function dF(n,e){let t=n.getBoundingClientRect(),r=e.getBoundingClientRect(),i=t.height/n.offsetHeight;r.top<t.top?n.scrollTop-=(t.top-r.top)/i:r.bottom>t.bottom&&(n.scrollTop+=(r.bottom-t.bottom)/i)}function S_(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function pF(n,e){let t=[],r=null,i=null,s=p=>{t.push(p);let{section:g}=p.completion;if(g){r||(r=[]);let x=typeof g=="string"?g:g.name;r.some(A=>A.name==x)||r.push(typeof g=="string"?{name:x}:g)}},o=e.facet(Wn);for(let p of n)if(p.hasResult()){let g=p.result.getMatch;if(p.result.filter===!1)for(let x of p.result.options)s(new __(x,p.source,g?g(x):[],1e9-t.length));else{let x=e.sliceDoc(p.from,p.to),A,_=o.filterStrict?new lF(x):new aF(x);for(let b of p.result.options)if(A=_.match(b.label)){let w=b.displayLabel?g?g(b,A.matched):[]:A.matched,C=A.score+(b.boost||0);if(s(new __(b,p.source,w,C)),typeof b.section=="object"&&b.section.rank==="dynamic"){let{name:T}=b.section;i||(i=Object.create(null)),i[T]=Math.max(C,i[T]||-1e9)}}}}if(r){let p=Object.create(null),g=0,x=(A,_)=>(A.rank==="dynamic"&&_.rank==="dynamic"?i[_.name]-i[A.name]:0)||(typeof A.rank=="number"?A.rank:1e9)-(typeof _.rank=="number"?_.rank:1e9)||(A.name<_.name?-1:1);for(let A of r.sort(x))g-=1e5,p[A.name]=g;for(let A of t){let{section:_}=A.completion;_&&(A.score+=p[typeof _=="string"?_:_.name])}}let a=[],u=null,f=o.compareCompletions;for(let p of t.sort((g,x)=>x.score-g.score||f(g.completion,x.completion))){let g=p.completion;!u||u.label!=g.label||u.detail!=g.detail||u.type!=null&&g.type!=null&&u.type!=g.type||u.apply!=g.apply||u.boost!=g.boost?a.push(p):S_(p.completion)>S_(u)&&(a[a.length-1]=p),u=p.completion}return a}class lc{constructor(e,t,r,i,s,o){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=i,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new lc(this.options,C_(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,i,s,o){if(i&&!o&&e.some(f=>f.isPending))return i.setDisabled();let a=pF(e,t);if(!a.length)return i&&e.some(f=>f.isPending)?i.setDisabled():null;let u=t.facet(Wn).selectOnOpen?0:-1;if(i&&i.selected!=u&&i.selected!=-1){let f=i.options[i.selected].completion;for(let p=0;p<a.length;p++)if(a[p].completion==f){u=p;break}}return new lc(a,C_(r,u),{pos:e.reduce((f,p)=>p.hasResult()?Math.min(f,p.from):f,1e8),create:AF,above:s.aboveCursor},i?i.timestamp:Date.now(),u,!1)}map(e){return new lc(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new lc(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Sp{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new Sp(yF,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,r=t.facet(Wn),s=(r.override||t.languageDataAt("autocomplete",el(t)).map(oF)).map(u=>(this.active.find(p=>p.source==u)||new wi(u,this.active.some(p=>p.state!=0)?1:0)).update(e,r));s.length==this.active.length&&s.every((u,f)=>u==this.active[f])&&(s=this.active);let o=this.open,a=e.effects.some(u=>u.is(oA));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(u=>u.hasResult()&&e.changes.touchesRange(u.from,u.to))||!mF(s,this.active)||a?o=lc.build(s,t,this.id,o,r,a):o&&o.disabled&&!s.some(u=>u.isPending)&&(o=null),!o&&s.every(u=>!u.isPending)&&s.some(u=>u.hasResult())&&(s=s.map(u=>u.hasResult()?new wi(u.source,0):u));for(let u of e.effects)u.is(nE)&&(o=o&&o.setSelected(u.value,this.id));return s==this.active&&o==this.open?this:new Sp(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?gF:xF}}function mF(n,e){if(n==e)return!0;for(let t=0,r=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;r<e.length&&!e[r].hasResult();)r++;let i=t==n.length,s=r==e.length;if(i||s)return i==s;if(n[t++].result!=e[r++].result)return!1}}const gF={"aria-autocomplete":"list"},xF={};function C_(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const yF=[];function tE(n,e){if(n.isUserEvent("input.complete")){let r=n.annotation(sA);if(r&&e.activateOnCompletion(r))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class wi{constructor(e,t,r=!1){this.source=e,this.state=t,this.explicit=r}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let r=tE(e,t),i=this;(r&8||r&16&&this.touches(e))&&(i=new wi(i.source,0)),r&4&&i.state==0&&(i=new wi(this.source,1)),i=i.updateFor(e,r);for(let s of e.effects)if(s.is(kp))i=new wi(i.source,1,s.value);else if(s.is(kh))i=new wi(i.source,0);else if(s.is(oA))for(let o of s.value)o.source==i.source&&(i=o);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(el(e.state))}}class gc extends wi{constructor(e,t,r,i,s,o){super(e,3,t),this.limit=r,this.result=i,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,t){var r;if(!(t&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=el(e.state);if(a>o||!i||t&2&&(el(e.startState)==this.from||a<this.limit))return new wi(this.source,t&4?1:0);let u=e.changes.mapPos(this.limit);return vF(i.validFor,e.state,s,o)?new gc(this.source,this.explicit,u,i,s,o):i.update&&(i=i.update(i,s,o,new YT(e.state,a,!1)))?new gc(this.source,this.explicit,u,i,i.from,(r=i.to)!==null&&r!==void 0?r:el(e.state)):new wi(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new gc(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new wi(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function vF(n,e,t,r){if(!n)return!1;let i=e.sliceDoc(t,r);return typeof n=="function"?n(i,t,r,e):eE(n,!0).test(i)}const oA=ft.define({map(n,e){return n.map(t=>t.map(e))}}),nE=ft.define(),Nr=$n.define({create(){return Sp.start()},update(n,e){return n.update(e)},provide:n=>[qv.from(n,e=>e.tooltip),Ne.contentAttributes.from(n,e=>e.attrs)]});function aA(n,e){const t=e.completion.apply||e.completion.label;let r=n.state.field(Nr).active.find(i=>i.source==e.source);return r instanceof gc?(typeof t=="string"?n.dispatch({...sF(n.state,t,r.from,r.to),annotations:sA.of(e.completion)}):t(n,e.completion,r.from,r.to),!0):!1}const AF=fF(Nr,aA);function Wd(n,e="option"){return t=>{let r=t.state.field(Nr,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<t.state.facet(Wn).interactionDelay)return!1;let i=1,s;e=="page"&&(s=DC(t,r.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=r.open.options,a=r.open.selected>-1?r.open.selected+i*(n?1:-1):n?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),t.dispatch({effects:nE.of(a)}),!0}}const bF=n=>{let e=n.state.field(Nr,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Wn).interactionDelay?!1:aA(n,e.open.options[e.open.selected])},Mx=n=>n.state.field(Nr,!1)?(n.dispatch({effects:kp.of(!0)}),!0):!1,wF=n=>{let e=n.state.field(Nr,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:kh.of(null)}),!0)};class _F{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const OF=50,kF=1e3,SF=_n.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(Nr).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(Nr),t=n.state.facet(Wn);if(!n.selectionSet&&!n.docChanged&&n.startState.field(Nr)==e)return;let r=n.transactions.some(s=>{let o=tE(s,t);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(r||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>OF&&Date.now()-o.time>kF){for(let a of o.context.abortListeners)try{a()}catch(u){Fr(this.view.state,u)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(s=>s.effects.some(o=>o.is(kp)))&&(this.pendingStart=!0);let i=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of n.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(Nr);for(let t of e.active)t.isPending&&!this.running.some(r=>r.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Wn).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=el(e),r=new YT(e,t,n.explicit,this.view),i=new _F(n,r);this.running.push(i),Promise.resolve(n.source(r)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:kh.of(null)}),Fr(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Wn).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Wn),r=this.view.state.field(Nr);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let a=el(s.updates.length?s.updates[0].startState:this.view.state),u=Math.min(a,s.done.from+(s.active.explicit?0:1)),f=new gc(s.active.source,s.active.explicit,u,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:a);for(let p of s.updates)f=f.update(p,t);if(f.hasResult()){e.push(f);continue}}let o=r.active.find(a=>a.source==s.active.source);if(o&&o.isPending)if(s.done==null){let a=new wi(s.active.source,0);for(let u of s.updates)a=a.update(u,t);a.isPending||e.push(a)}else this.startQuery(o)}(e.length||r.open&&r.open.disabled)&&this.view.dispatch({effects:oA.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(Nr,!1);if(e&&e.tooltip&&this.view.state.facet(Wn).closeOnBlur){let t=e.open&&DC(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:kh.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:kp.of(!1)}),20),this.composing=0}}}),CF=typeof navigator=="object"&&/Win/.test(navigator.platform),TF=la.highest(Ne.domEventHandlers({keydown(n,e){let t=e.state.field(Nr,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(CF&&n.altKey)||n.metaKey)return!1;let r=t.open.options[t.open.selected],i=t.active.find(o=>o.source==r.source),s=r.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(n.key)>-1&&aA(e,r),!1}})),rE=Ne.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class EF{constructor(e,t,r,i){this.field=e,this.line=t,this.from=r,this.to=i}}class lA{constructor(e,t,r){this.field=e,this.from=t,this.to=r}map(e){let t=e.mapPos(this.from,-1,er.TrackDel),r=e.mapPos(this.to,1,er.TrackDel);return t==null||r==null?null:new lA(this.field,t,r)}}class cA{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let r=[],i=[t],s=e.doc.lineAt(t),o=/^\s*/.exec(s.text)[0];for(let u of this.lines){if(r.length){let f=o,p=/^\t*/.exec(u)[0].length;for(let g=0;g<p;g++)f+=e.facet(Wh);i.push(t+f.length-p),u=f+u.slice(p)}r.push(u),t+=u.length+1}let a=this.fieldPositions.map(u=>new lA(u.field,i[u.line]+u.from,i[u.line]+u.to));return{text:r,ranges:a}}static parse(e){let t=[],r=[],i=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let a=s[1]?+s[1]:null,u=s[2]||s[3]||"",f=-1,p=u.replace(/\\[{}]/g,g=>g[1]);for(let g=0;g<t.length;g++)(a!=null?t[g].seq==a:p&&t[g].name==p)&&(f=g);if(f<0){let g=0;for(;g<t.length&&(a==null||t[g].seq!=null&&t[g].seq<a);)g++;t.splice(g,0,{seq:a,name:p}),f=g;for(let x of i)x.field>=f&&x.field++}for(let g of i)if(g.line==r.length&&g.from>s.index){let x=s[2]?3+(s[1]||"").length:2;g.from-=x,g.to-=x}i.push(new EF(f,r.length,s.index,s.index+p.length)),o=o.slice(0,s.index)+u+o.slice(s.index+s[0].length)}o=o.replace(/\\([{}])/g,(a,u,f)=>{for(let p of i)p.line==r.length&&p.from>f&&(p.from--,p.to--);return u}),r.push(o)}return new cA(r,i)}}let PF=Je.widget({widget:new class extends $i{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),BF=Je.mark({class:"cm-snippetField"});class zc{constructor(e,t){this.ranges=e,this.active=t,this.deco=Je.set(e.map(r=>(r.from==r.to?PF:BF).range(r.from,r.to)),!0)}map(e){let t=[];for(let r of this.ranges){let i=r.map(e);if(!i)return null;t.push(i)}return new zc(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(r=>r.field==this.active&&r.from<=t.from&&r.to>=t.to))}}const Zh=ft.define({map(n,e){return n&&n.map(e)}}),RF=ft.define(),Sh=$n.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Zh))return t.value;if(t.is(RF)&&n)return new zc(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>Ne.decorations.from(n,e=>e?e.deco:Je.none)});function uA(n,e){return we.create(n.filter(t=>t.field==e).map(t=>we.range(t.from,t.to)))}function DF(n){let e=cA.parse(n);return(t,r,i,s)=>{let{text:o,ranges:a}=e.instantiate(t.state,i),{main:u}=t.state.selection,f={changes:{from:i,to:s==u.from?u.to:s,insert:Lt.of(o)},scrollIntoView:!0,annotations:r?[sA.of(r),Cn.userEvent.of("input.complete")]:void 0};if(a.length&&(f.selection=uA(a,0)),a.some(p=>p.field>0)){let p=new zc(a,0),g=f.effects=[Zh.of(p)];t.state.field(Sh,!1)===void 0&&g.push(ft.appendConfig.of([Sh,IF,zF,rE]))}t.dispatch(t.state.update(f))}}function iE(n){return({state:e,dispatch:t})=>{let r=e.field(Sh,!1);if(!r||n<0&&r.active==0)return!1;let i=r.active+n,s=n>0&&!r.ranges.some(o=>o.field==i+n);return t(e.update({selection:uA(r.ranges,i),effects:Zh.of(s?null:new zc(r.ranges,i)),scrollIntoView:!0})),!0}}const MF=({state:n,dispatch:e})=>n.field(Sh,!1)?(e(n.update({effects:Zh.of(null)})),!0):!1,NF=iE(1),LF=iE(-1),FF=[{key:"Tab",run:NF,shift:LF},{key:"Escape",run:MF}],T_=je.define({combine(n){return n.length?n[0]:FF}}),IF=la.highest(Qh.compute([T_],n=>n.facet(T_)));function $s(n,e){return{...e,apply:DF(n)}}const zF=Ne.domEventHandlers({mousedown(n,e){let t=e.state.field(Sh,!1),r;if(!t||(r=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let i=t.ranges.find(s=>s.from<=r&&s.to>=r);return!i||i.field==t.active?!1:(e.dispatch({selection:uA(t.ranges,i.field),effects:Zh.of(t.ranges.some(s=>s.field>i.field)?new zc(t.ranges,i.field):null),scrollIntoView:!0}),!0)}}),Ch={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Ya=ft.define({map(n,e){let t=e.mapPos(n,-1,er.TrackAfter);return t??void 0}}),hA=new class extends na{};hA.startSide=1;hA.endSide=-1;const sE=$n.define({create(){return Tt.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:r=>r>=t.from&&r<=t.to})}for(let t of e.effects)t.is(Ya)&&(n=n.update({add:[hA.range(t.value,t.value+1)]}));return n}});function jF(){return[HF,sE]}const Nx="()[]{}<>";function oE(n){for(let e=0;e<Nx.length;e+=2)if(Nx.charCodeAt(e)==n)return Nx.charAt(e+1);return Cv(n<128?n:n+1)}function aE(n,e){return n.languageDataAt("closeBrackets",e)[0]||Ch}const QF=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),HF=Ne.inputHandler.of((n,e,t,r)=>{if((QF?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let i=n.state.selection.main;if(r.length>2||r.length==2&&gs(Mr(r,0))==1||e!=i.from||t!=i.to)return!1;let s=VF(n.state,r);return s?(n.dispatch(s),!0):!1}),WF=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=aE(n,n.selection.main.head).brackets||Ch.brackets,i=null,s=n.changeByRange(o=>{if(o.empty){let a=$F(n.doc,o.head);for(let u of r)if(u==a&&um(n.doc,o.head)==oE(Mr(u,0)))return{changes:{from:o.head-u.length,to:o.head+u.length},range:we.cursor(o.head-u.length)}}return{range:i=o}});return i||e(n.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},qF=[{key:"Backspace",run:WF}];function VF(n,e){let t=aE(n,n.selection.main.head),r=t.brackets||Ch.brackets;for(let i of r){let s=oE(Mr(i,0));if(e==i)return s==i?GF(n,i,r.indexOf(i+i+i)>-1,t):UF(n,i,s,t.before||Ch.before);if(e==s&&lE(n,n.selection.main.from))return ZF(n,i,s)}return null}function lE(n,e){let t=!1;return n.field(sE).between(0,n.doc.length,r=>{r==e&&(t=!0)}),t}function um(n,e){let t=n.sliceString(e,e+2);return t.slice(0,gs(Mr(t,0)))}function $F(n,e){let t=n.sliceString(e-2,e);return gs(Mr(t,0))==t.length?t:t.slice(1)}function UF(n,e,t,r){let i=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Ya.of(o.to+e.length),range:we.range(o.anchor+e.length,o.head+e.length)};let a=um(n.doc,o.head);return!a||/\s/.test(a)||r.indexOf(a)>-1?{changes:{insert:e+t,from:o.head},effects:Ya.of(o.head+e.length),range:we.cursor(o.head+e.length)}:{range:i=o}});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function ZF(n,e,t){let r=null,i=n.changeByRange(s=>s.empty&&um(n.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:we.cursor(s.head+t.length)}:r={range:s});return r?null:n.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function GF(n,e,t,r){let i=r.stringPrefixes||Ch.stringPrefixes,s=null,o=n.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:e,from:a.to}],effects:Ya.of(a.to+e.length),range:we.range(a.anchor+e.length,a.head+e.length)};let u=a.head,f=um(n.doc,u),p;if(f==e){if(E_(n,u))return{changes:{insert:e+e,from:u},effects:Ya.of(u+e.length),range:we.cursor(u+e.length)};if(lE(n,u)){let x=t&&n.sliceDoc(u,u+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:u,to:u+x.length,insert:x},range:we.cursor(u+x.length)}}}else{if(t&&n.sliceDoc(u-2*e.length,u)==e+e&&(p=P_(n,u-2*e.length,i))>-1&&E_(n,p))return{changes:{insert:e+e+e+e,from:u},effects:Ya.of(u+e.length),range:we.cursor(u+e.length)};if(n.charCategorizer(u)(f)!=ln.Word&&P_(n,u,i)>-1&&!XF(n,u,e,i))return{changes:{insert:e+e,from:u},effects:Ya.of(u+e.length),range:we.cursor(u+e.length)}}return{range:s=a}});return s?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function E_(n,e){let t=qn(n).resolveInner(e+1);return t.parent&&t.from==e}function XF(n,e,t,r){let i=qn(n).resolveInner(e,-1),s=r.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=n.sliceDoc(i.from,Math.min(i.to,i.from+t.length+s)),u=a.indexOf(t);if(!u||u>-1&&r.indexOf(a.slice(0,u))>-1){let p=i.firstChild;for(;p&&p.from==i.from&&p.to-p.from>t.length+u;){if(n.sliceDoc(p.to-t.length,p.to)==t)return!1;p=p.firstChild}return!0}let f=i.to==e&&i.parent;if(!f)break;i=f}return!1}function P_(n,e,t){let r=n.charCategorizer(e);if(r(n.sliceDoc(e-1,e))!=ln.Word)return e;for(let i of t){let s=e-i.length;if(n.sliceDoc(s,e)==i&&r(n.sliceDoc(s-1,s))!=ln.Word)return s}return-1}function KF(n={}){return[TF,Nr,Wn.of(n),SF,YF,rE]}const cE=[{key:"Ctrl-Space",run:Mx},{mac:"Alt-`",run:Mx},{mac:"Alt-i",run:Mx},{key:"Escape",run:wF},{key:"ArrowDown",run:Wd(!0)},{key:"ArrowUp",run:Wd(!1)},{key:"PageDown",run:Wd(!0,"page")},{key:"PageUp",run:Wd(!1,"page")},{key:"Enter",run:bF}],YF=la.highest(Qh.computeN([Wn],n=>n.facet(Wn).defaultKeymap?[cE]:[]));class B_{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class Ua{constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}static init(e,t,r){let i=r.facet(Th).markerFilter;i&&(e=i(e,r));let s=e.slice().sort((A,_)=>A.from-_.from||A.to-_.to),o=new so,a=[],u=0,f=r.doc.iter(),p=0,g=r.doc.length;for(let A=0;;){let _=A==s.length?null:s[A];if(!_&&!a.length)break;let b,w;if(a.length)b=u,w=a.reduce((E,D)=>Math.min(E,D.to),_&&_.from>b?_.from:1e8);else{if(b=_.from,b>g)break;w=_.to,a.push(_),A++}for(;A<s.length;){let E=s[A];if(E.from==b&&(E.to>E.from||E.to==b))a.push(E),A++,w=Math.min(E.to,w);else{w=Math.min(E.from,w);break}}w=Math.min(w,g);let C=!1;if(a.some(E=>E.from==b&&(E.to==w||w==g))&&(C=b==w,!C&&w-b<10)){let E=b-(p+f.value.length);E>0&&(f.next(E),p=b);for(let D=b;;){if(D>=w){C=!0;break}if(!f.lineBreak&&p+f.value.length>D)break;D=p+f.value.length,p+=f.value.length,f.next()}}let T=hI(a);if(C)o.add(b,b,Je.widget({widget:new aI(T),diagnostics:a.slice()}));else{let E=a.reduce((D,N)=>N.markClass?D+" "+N.markClass:D,"");o.add(b,w,Je.mark({class:"cm-lintRange cm-lintRange-"+T+E,diagnostics:a.slice(),inclusiveEnd:a.some(D=>D.to>w)}))}if(u=w,u==g)break;for(let E=0;E<a.length;E++)a[E].to<=u&&a.splice(E--,1)}let x=o.finish();return new Ua(x,t,Pc(x))}}function Pc(n,e=null,t=0){let r=null;return n.between(t,1e9,(i,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!r)r=new B_(i,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(r.diagnostic)<0)return!1;r=new B_(r.from,s,r.diagnostic)}}),r}function JF(n,e){let t=e.pos,r=e.end||t,i=n.state.facet(Th).hideOn(n,t,r);if(i!=null)return i;let s=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(uE))||n.changes.touchesRange(s.from,Math.max(s.to,r)))}function eI(n,e){return n.field(ii,!1)?e:e.concat(ft.appendConfig.of(fI))}const uE=ft.define(),fA=ft.define(),hE=ft.define(),ii=$n.define({create(){return new Ua(Je.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),r=null,i=n.panel;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);r=Pc(t,n.selected.diagnostic,s)||Pc(t,null,s)}!t.size&&i&&e.state.facet(Th).autoPanel&&(i=null),n=new Ua(t,i,r)}for(let t of e.effects)if(t.is(uE)){let r=e.state.facet(Th).autoPanel?t.value.length?Eh.open:null:n.panel;n=Ua.init(t.value,r,e.state)}else t.is(fA)?n=new Ua(n.diagnostics,t.value?Eh.open:null,n.selected):t.is(hE)&&(n=new Ua(n.diagnostics,n.panel,t.value));return n},provide:n=>[Ah.from(n,e=>e.panel),Ne.decorations.from(n,e=>e.diagnostics)]}),tI=Je.mark({class:"cm-lintRange cm-lintRange-active"});function nI(n,e,t){let{diagnostics:r}=n.state.field(ii),i,s=-1,o=-1;r.between(e-(t<0?1:0),e+(t>0?1:0),(u,f,{spec:p})=>{if(e>=u&&e<=f&&(u==f||(e>u||t>0)&&(e<f||t<0)))return i=p.diagnostics,s=u,o=f,!1});let a=n.state.facet(Th).tooltipFilter;return i&&a&&(i=a(i,n.state)),i?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:rI(n,i)}}}:null}function rI(n,e){return Vt("ul",{class:"cm-tooltip-lint"},e.map(t=>dE(n,t,!1)))}const iI=n=>{let e=n.state.field(ii,!1);(!e||!e.panel)&&n.dispatch({effects:eI(n.state,[fA.of(!0)])});let t=Vv(n,Eh.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},R_=n=>{let e=n.state.field(ii,!1);return!e||!e.panel?!1:(n.dispatch({effects:fA.of(!1)}),!0)},sI=n=>{let e=n.state.field(ii,!1);if(!e)return!1;let t=n.state.selection.main,r=e.diagnostics.iter(t.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==t.from&&r.to==t.to)?!1:(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},oI=[{key:"Mod-Shift-m",run:iI,preventDefault:!0},{key:"F8",run:sI}],Th=je.define({combine(n){return{sources:n.map(e=>e.source).filter(e=>e!=null),...Os(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:D_,tooltipFilter:D_,needsRefresh:(e,t)=>e?t?r=>e(r)||t(r):e:t,hideOn:(e,t)=>e?t?(r,i,s)=>e(r,i,s)||t(r,i,s):e:t,autoPanel:(e,t)=>e||t})}}});function D_(n,e){return n?e?(t,r)=>e(n(t,r),r):n:e}function fE(n){let e=[];if(n)e:for(let{name:t}of n){for(let r=0;r<t.length;r++){let i=t[r];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function dE(n,e,t){var r;let i=t?fE(e.actions):[];return Vt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Vt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(r=e.actions)===null||r===void 0?void 0:r.map((s,o)=>{let a=!1,u=A=>{if(A.preventDefault(),a)return;a=!0;let _=Pc(n.state.field(ii).diagnostics,e);_&&s.apply(n,_.from,_.to)},{name:f}=s,p=i[o]?f.indexOf(i[o]):-1,g=p<0?f:[f.slice(0,p),Vt("u",f.slice(p,p+1)),f.slice(p+1)],x=s.markClass?" "+s.markClass:"";return Vt("button",{type:"button",class:"cm-diagnosticAction"+x,onclick:u,onmousedown:u,"aria-label":` Action: ${f}${p<0?"":` (access key "${i[o]})"`}.`},g)}),e.source&&Vt("div",{class:"cm-diagnosticSource"},e.source))}class aI extends $i{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Vt("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class M_{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=dE(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Eh{constructor(e){this.view=e,this.items=[];let t=i=>{if(!(i.ctrlKey||i.altKey||i.metaKey)){if(i.keyCode==27)R_(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=fE(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==i.keyCode){let u=Pc(this.view.state.field(ii).diagnostics,s);u&&s.actions[a].apply(e,u.from,u.to)}}else return;i.preventDefault()}},r=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=Vt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:r}),this.dom=Vt("div",{class:"cm-panel-lint"},this.list,Vt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>R_(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(ii).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(ii),r=0,i=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(a,u,{spec:f})=>{for(let p of f.diagnostics){if(o.has(p))continue;o.add(p);let g=-1,x;for(let A=r;A<this.items.length;A++)if(this.items[A].diagnostic==p){g=A;break}g<0?(x=new M_(this.view,p),this.items.splice(r,0,x),i=!0):(x=this.items[g],g>r&&(this.items.splice(r,g-r),i=!0)),t&&x.diagnostic==t.diagnostic?x.dom.hasAttribute("aria-selected")||(x.dom.setAttribute("aria-selected","true"),s=x):x.dom.hasAttribute("aria-selected")&&x.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new M_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:u})=>{let f=u.height/this.list.offsetHeight;a.top<u.top?this.list.scrollTop-=(u.top-a.top)/f:a.bottom>u.bottom&&(this.list.scrollTop+=(a.bottom-u.bottom)/f)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)t();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(ii),r=Pc(t.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:hE.of(r)})}static open(e){return new Eh(e)}}function lI(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function qd(n){return lI(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const cI=Ne.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:qd("#d11")},".cm-lintRange-warning":{backgroundImage:qd("orange")},".cm-lintRange-info":{backgroundImage:qd("#999")},".cm-lintRange-hint":{backgroundImage:qd("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function uI(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function hI(n){let e="hint",t=1;for(let r of n){let i=uI(r.severity);i>t&&(t=i,e=r.severity)}return e}const fI=[ii,Ne.decorations.compute([ii],n=>{let{selected:e,panel:t}=n.field(ii);return!e||!t||e.from==e.to?Je.none:Je.set([tI.range(e.from,e.to)])}),VM(nI,{hideOn:JF}),cI];var N_=function(e){e===void 0&&(e={});var{crosshairCursor:t=!1}=e,r=[];e.closeBracketsKeymap!==!1&&(r=r.concat(qF)),e.defaultKeymap!==!1&&(r=r.concat(SL)),e.searchKeymap!==!1&&(r=r.concat(JL)),e.historyKeymap!==!1&&(r=r.concat(D6)),e.foldKeymap!==!1&&(r=r.concat(UN)),e.completionKeymap!==!1&&(r=r.concat(cE)),e.lintKeymap!==!1&&(r=r.concat(oI));var i=[];return e.lineNumbers!==!1&&i.push(iN()),e.highlightActiveLineGutter!==!1&&i.push(aN()),e.highlightSpecialChars!==!1&&i.push(AM()),e.history!==!1&&i.push(O6()),e.foldGutter!==!1&&i.push(KN()),e.drawSelection!==!1&&i.push(cM()),e.dropCursor!==!1&&i.push(pM()),e.allowMultipleSelections!==!1&&i.push(Rt.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&i.push(FN()),e.syntaxHighlighting!==!1&&i.push(oT(t6,{fallback:!0})),e.bracketMatching!==!1&&i.push(l6()),e.closeBrackets!==!1&&i.push(jF()),e.autocompletion!==!1&&i.push(KF()),e.rectangularSelection!==!1&&i.push(MM()),t!==!1&&i.push(FM()),e.highlightActiveLine!==!1&&i.push(SM()),e.highlightSelectionMatches!==!1&&i.push(RL()),e.tabSize&&typeof e.tabSize=="number"&&i.push(Wh.of(" ".repeat(e.tabSize))),i.concat([Qh.of(r.flat())]).filter(Boolean)};const dI="#e5c07b",L_="#e06c75",pI="#56b6c2",mI="#ffffff",a0="#abb2bf",Ky="#7d8799",gI="#61afef",xI="#98c379",F_="#d19a66",yI="#c678dd",vI="#21252b",I_="#2c313a",z_="#282c34",Lx="#353a42",AI="#3E4451",j_="#528bff",bI=Ne.theme({"&":{color:a0,backgroundColor:z_},".cm-content":{caretColor:j_},".cm-cursor, .cm-dropCursor":{borderLeftColor:j_},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:AI},".cm-panels":{backgroundColor:vI,color:a0},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:z_,color:Ky,border:"none"},".cm-activeLineGutter":{backgroundColor:I_},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Lx},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Lx,borderBottomColor:Lx},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:I_,color:a0}}},{dark:!0}),wI=Vh.define([{tag:fe.keyword,color:yI},{tag:[fe.name,fe.deleted,fe.character,fe.propertyName,fe.macroName],color:L_},{tag:[fe.function(fe.variableName),fe.labelName],color:gI},{tag:[fe.color,fe.constant(fe.name),fe.standard(fe.name)],color:F_},{tag:[fe.definition(fe.name),fe.separator],color:a0},{tag:[fe.typeName,fe.className,fe.number,fe.changed,fe.annotation,fe.modifier,fe.self,fe.namespace],color:dI},{tag:[fe.operator,fe.operatorKeyword,fe.url,fe.escape,fe.regexp,fe.link,fe.special(fe.string)],color:pI},{tag:[fe.meta,fe.comment],color:Ky},{tag:fe.strong,fontWeight:"bold"},{tag:fe.emphasis,fontStyle:"italic"},{tag:fe.strikethrough,textDecoration:"line-through"},{tag:fe.link,color:Ky,textDecoration:"underline"},{tag:fe.heading,fontWeight:"bold",color:L_},{tag:[fe.atom,fe.bool,fe.special(fe.variableName)],color:F_},{tag:[fe.processingInstruction,fe.string,fe.inserted],color:xI},{tag:fe.invalid,color:mI}]),pE=[bI,oT(wI)];var _I=Ne.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),OI=function(e){e===void 0&&(e={});var{indentWithTab:t=!0,editable:r=!0,readOnly:i=!1,theme:s="light",placeholder:o="",basicSetup:a=!0}=e,u=[];switch(t&&u.unshift(Qh.of([CL])),a&&(typeof a=="boolean"?u.unshift(N_()):u.unshift(N_(a))),o&&u.unshift(PM(o)),s){case"light":u.push(_I);break;case"dark":u.push(pE);break;case"none":break;default:u.push(s);break}return r===!1&&u.push(Ne.editable.of(!1)),i&&u.push(Rt.readOnly.of(!0)),[...u]},kI=n=>({line:n.state.doc.lineAt(n.state.selection.main.from),lineCount:n.state.doc.lines,lineBreak:n.state.lineBreak,length:n.state.doc.length,readOnly:n.state.readOnly,tabSize:n.state.tabSize,selection:n.state.selection,selectionAsSingle:n.state.selection.asSingle().main,ranges:n.state.selection.ranges,selectionCode:n.state.sliceDoc(n.state.selection.main.from,n.state.selection.main.to),selections:n.state.selection.ranges.map(e=>n.state.sliceDoc(e.from,e.to)),selectedText:n.state.selection.ranges.some(e=>!e.empty)});class SI{constructor(e,t){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=t,this.timeoutMS=t,this.callbacks.push(e)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var e=this.callbacks.slice();this.callbacks.length=0,e.forEach(t=>{try{t()}catch(r){console.error("TimeoutLatch callback error:",r)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}}class Q_{constructor(){this.interval=null,this.latches=new Set}add(e){this.latches.add(e),this.start()}remove(e){this.latches.delete(e),this.latches.size===0&&this.stop()}start(){this.interval===null&&(this.interval=setInterval(()=>{this.latches.forEach(e=>{e.tick(),e.isDone&&this.remove(e)})},1))}stop(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}}var Fx=null,CI=()=>typeof window>"u"?new Q_:(Fx||(Fx=new Q_),Fx),H_=_s.define(),TI=200,EI=[];function PI(n){var{value:e,selection:t,onChange:r,onStatistics:i,onCreateEditor:s,onUpdate:o,extensions:a=EI,autoFocus:u,theme:f="light",height:p=null,minHeight:g=null,maxHeight:x=null,width:A=null,minWidth:_=null,maxWidth:b=null,placeholder:w="",editable:C=!0,readOnly:T=!1,indentWithTab:E=!0,basicSetup:D=!0,root:N,initialState:F}=n,[z,I]=R.useState(),[K,W]=R.useState(),[U,X]=R.useState(),$=R.useState(()=>({current:null}))[0],ee=R.useState(()=>({current:null}))[0],le=Ne.theme({"&":{height:p,minHeight:g,maxHeight:x,width:A,minWidth:_,maxWidth:b},"& .cm-scroller":{height:"100% !important"}}),Z=Ne.updateListener.of(ne=>{if(ne.docChanged&&typeof r=="function"&&!ne.transactions.some(Q=>Q.annotation(H_))){$.current?$.current.reset():($.current=new SI(()=>{if(ee.current){var Q=ee.current;ee.current=null,Q()}$.current=null},TI),CI().add($.current));var q=ne.state.doc,B=q.toString();r(B,ne)}i&&i(kI(ne))}),ie=OI({theme:f,editable:C,readOnly:T,placeholder:w,indentWithTab:E,basicSetup:D}),V=[Z,le,...ie];return o&&typeof o=="function"&&V.push(Ne.updateListener.of(o)),V=V.concat(a),R.useLayoutEffect(()=>{if(z&&!U){var ne={doc:e,selection:t,extensions:V},q=F?Rt.fromJSON(F.json,ne,F.fields):Rt.create(ne);if(X(q),!K){var B=new Ne({state:q,parent:z,root:N});W(B),s&&s(B,q)}}return()=>{K&&(X(void 0),W(void 0))}},[z,U]),R.useEffect(()=>{n.container&&I(n.container)},[n.container]),R.useEffect(()=>()=>{K&&(K.destroy(),W(void 0)),$.current&&($.current.cancel(),$.current=null)},[K]),R.useEffect(()=>{u&&K&&K.focus()},[u,K]),R.useEffect(()=>{K&&K.dispatch({effects:ft.reconfigure.of(V)})},[f,a,p,g,x,A,_,b,w,C,T,E,D,r,o]),R.useEffect(()=>{if(e!==void 0){var ne=K?K.state.doc.toString():"";if(K&&e!==ne){var q=$.current&&!$.current.isDone,B=()=>{K&&e!==K.state.doc.toString()&&K.dispatch({changes:{from:0,to:K.state.doc.toString().length,insert:e||""},annotations:[H_.of(!0)]})};q?ee.current=B:B()}}},[e,K]),{state:U,setState:X,view:K,setView:W,container:z,setContainer:I}}var BI=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],mE=R.forwardRef((n,e)=>{var{className:t,value:r="",selection:i,extensions:s=[],onChange:o,onStatistics:a,onCreateEditor:u,onUpdate:f,autoFocus:p,theme:g="light",height:x,minHeight:A,maxHeight:_,width:b,minWidth:w,maxWidth:C,basicSetup:T,placeholder:E,indentWithTab:D,editable:N,readOnly:F,root:z,initialState:I}=n,K=X5(n,BI),W=R.useRef(null),{state:U,view:X,container:$,setContainer:ee}=PI({root:z,value:r,autoFocus:p,theme:g,height:x,minHeight:A,maxHeight:_,width:b,minWidth:w,maxWidth:C,basicSetup:T,placeholder:E,indentWithTab:D,editable:N,readOnly:F,selection:i,onChange:o,onStatistics:a,onCreateEditor:u,onUpdate:f,extensions:s,initialState:I});R.useImperativeHandle(e,()=>({editor:W.current,state:U,view:X}),[W,$,U,X]);var le=R.useCallback(ie=>{W.current=ie,ee(ie)},[ee]);if(typeof r!="string")throw new Error("value must be typeof string but got "+typeof r);var Z=typeof g=="string"?"cm-theme-"+g:"cm-theme";return S.jsx("div",iy({ref:le,className:""+Z+(t?" "+t:"")},K))});mE.displayName="CodeMirror";var W_={};class Cp{constructor(e,t,r,i,s,o,a,u,f,p=0,g){this.p=e,this.stack=t,this.state=r,this.reducePos=i,this.pos=s,this.score=o,this.buffer=a,this.bufferBase=u,this.curContext=f,this.lookAhead=p,this.parent=g}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,r=0){let i=e.parser.context;return new Cp(e,[],t,r,r,0,[],0,i?new q_(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let r=e>>19,i=e&65535,{parser:s}=this.p,o=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),a=s.dynamicPrecedence(i);if(a&&(this.score+=a),r==0){this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(i,this.reducePos);return}let u=this.stack.length-(r-1)*3-(e&262144?6:0),f=u?this.stack[u-2]:this.p.ranges[0].from,p=this.reducePos-f;p>=2e3&&!(!((t=this.p.parser.nodeSet.types[i])===null||t===void 0)&&t.isAnonymous)&&(f==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=p):this.p.lastBigReductionSize<p&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=f,this.p.lastBigReductionSize=p));let g=u?this.stack[u-1]:0,x=this.bufferBase+this.buffer.length-g;if(i<s.minRepeatTerm||e&131072){let A=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,f,A,x+4,!0)}if(e&262144)this.state=this.stack[u];else{let A=this.stack[u-3];this.state=s.getGoto(A,i,!0)}for(;this.stack.length>u;)this.stack.pop();this.reduceContext(i,f)}storeNode(e,t,r,i=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(t==r)return;if(o.buffer[a-2]>=t){o.buffer[a-2]=r;return}}}if(!s||this.pos==r)this.buffer.push(e,t,r,i);else{let o=this.buffer.length;if(o>0&&(this.buffer[o-4]!=0||this.buffer[o-1]<0)){let a=!1;for(let u=o;u>0&&this.buffer[u-2]>r;u-=4)if(this.buffer[u-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>r;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,i>4&&(i-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=r,this.buffer[o+3]=i}}shift(e,t,r,i){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let s=e,{parser:o}=this.p;this.pos=i;let a=o.stateFlag(s,1);!a&&(i>r||t<=o.maxNode)&&(this.reducePos=i),this.pushState(s,a?r:Math.min(r,this.reducePos)),this.shiftContext(t,r),t<=o.maxNode&&this.buffer.push(t,r,i,4)}else this.pos=i,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,i,4)}apply(e,t,r,i){e&65536?this.reduce(e):this.shift(e,t,r,i)}useNode(e,t){let r=this.p.reused.length-1;(r<0||this.p.reused[r]!=e)&&(this.p.reused.push(e),r++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(r,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let r=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new Cp(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,r,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let r=e<=this.p.parser.maxNode;r&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,r?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new RI(this);;){let r=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(r==0)return!1;if((r&65536)==0)return!0;t.reduce(r)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&i.push(t[s],o);if(this.stack.length<120)for(let s=0;i.length<8&&s<t.length;s+=2){let o=t[s+1];i.some((a,u)=>u&1&&a==o)||i.push(t[s],o)}t=i}let r=[];for(let i=0;i<t.length&&r.length<4;i+=2){let s=t[i+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[i],this.pos),o.reducePos=this.pos,o.score-=200,r.push(o)}return r}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let r=t>>19,i=t&65535,s=this.stack.length-r*3;if(s<0||e.getGoto(this.stack[s],i,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],r=(i,s)=>{if(!t.includes(i))return t.push(i),e.allActions(i,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-s;if(a>1){let u=o&65535,f=this.stack.length-a*3;if(f>=0&&e.getGoto(this.stack[f],u,!1)>=0)return a<<19|65536|u}}else{let a=r(o,s+1);if(a!=null)return a}})};return r(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new q_(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class q_{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class RI{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,r=e>>19;r==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(r-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}}class Tp{constructor(e,t,r){this.stack=e,this.pos=t,this.index=r,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Tp(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Tp(this.stack,this.pos,this.index)}}function Vd(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let r=0,i=0;r<n.length;){let s=0;for(;;){let o=n.charCodeAt(r++),a=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let u=o-32;if(u>=46&&(u-=46,a=!0),s+=u,a)break;s*=46}t?t[i++]=s:t=new e(s)}return t}class l0{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const V_=new l0;class DI{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=V_,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let r=this.range,i=this.rangeIndex,s=this.pos+e;for(;s<r.from;){if(!i)return null;let o=this.ranges[--i];s-=r.from-o.to,r=o}for(;t<0?s>r.to:s>=r.to;){if(i==this.ranges.length-1)return null;let o=this.ranges[++i];s+=o.from-r.to,r=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,r,i;if(t>=0&&t<this.chunk.length)r=this.pos+e,i=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(r=s,r>=this.chunk2Pos&&r<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(r-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=r;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=r),r+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-r)),i=this.chunk2.charCodeAt(0)}}return r>=this.token.lookAhead&&(this.token.lookAhead=r+1),i}acceptToken(e,t=0){let r=t?this.resolveOffset(t,-1):this.pos;if(r==null||r<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=r}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=V_,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let r="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(r+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return r}}class xc{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:r}=t.p;MI(this.data,e,t,this.id,r.data,r.tokenPrecTable)}}xc.prototype.contextual=xc.prototype.fallback=xc.prototype.extend=!1;xc.prototype.fallback=xc.prototype.extend=!1;class hm{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function MI(n,e,t,r,i,s){let o=0,a=1<<r,{dialect:u}=t.p.parser;e:for(;(a&n[o])!=0;){let f=n[o+1];for(let A=o+3;A<f;A+=2)if((n[A+1]&a)>0){let _=n[A];if(u.allows(_)&&(e.token.value==-1||e.token.value==_||NI(_,e.token.value,i,s))){e.acceptToken(_);break}}let p=e.next,g=0,x=n[o+2];if(e.next<0&&x>g&&n[f+x*3-3]==65535){o=n[f+x*3-1];continue e}for(;g<x;){let A=g+x>>1,_=f+A+(A<<1),b=n[_],w=n[_+1]||65536;if(p<b)x=A;else if(p>=w)g=A+1;else{o=n[_+2],e.advance();continue e}}break}}function $_(n,e,t){for(let r=e,i;(i=n[r])!=65535;r++)if(i==t)return r-e;return-1}function NI(n,e,t,r){let i=$_(t,r,e);return i<0||$_(t,r,n)<i}const ei=typeof process<"u"&&W_&&/\bparse\b/.test(W_.LOG);let Ix=null;function U_(n,e,t){let r=n.cursor(dn.IncludeAnonymous);for(r.moveTo(e);;)if(!(t<0?r.childBefore(e):r.childAfter(e)))for(;;){if((t<0?r.to<e:r.from>e)&&!r.type.isError)return t<0?Math.max(0,Math.min(r.to-1,e-25)):Math.min(n.length,Math.max(r.from+1,e+25));if(t<0?r.prevSibling():r.nextSibling())break;if(!r.parent())return t<0?0:n.length}}class LI{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?U_(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?U_(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let r=this.trees[t],i=this.index[t];if(i==r.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=r.children[i],o=this.start[t]+r.positions[i];if(o>e)return this.nextStart=o,null;if(s instanceof wn){if(o==e){if(o<this.safeFrom)return null;let a=o+s.length;if(a<=this.safeTo){let u=s.prop(St.lookAhead);if(!u||a+u<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class FI{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(r=>new l0)}getActions(e){let t=0,r=null,{parser:i}=e.p,{tokenizers:s}=i,o=i.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,u=0;for(let f=0;f<s.length;f++){if((1<<f&o)==0)continue;let p=s[f],g=this.tokens[f];if(!(r&&!p.fallback)&&((p.contextual||g.start!=e.pos||g.mask!=o||g.context!=a)&&(this.updateCachedToken(g,p,e),g.mask=o,g.context=a),g.lookAhead>g.end+25&&(u=Math.max(g.lookAhead,u)),g.value!=0)){let x=t;if(g.extended>-1&&(t=this.addActions(e,g.extended,g.end,t)),t=this.addActions(e,g.value,g.end,t),!p.extend&&(r=g,t>x))break}}for(;this.actions.length>t;)this.actions.pop();return u&&e.setLookAhead(u),!r&&e.pos==this.stream.end&&(r=new l0,r.value=e.p.parser.eofTerm,r.start=r.end=e.pos,t=this.addActions(e,r.value,r.end,t)),this.mainToken=r,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new l0,{pos:r,p:i}=e;return t.start=r,t.end=Math.min(r+1,i.stream.end),t.value=r==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,r){let i=this.stream.clipPos(r.pos);if(t.token(this.stream.reset(i,e),r),e.value>-1){let{parser:s}=r.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let a=s.specializers[o](this.stream.read(e.start,e.end),r);if(a>=0&&r.p.parser.dialect.allows(a>>1)){(a&1)==0?e.value=a>>1:e.extended=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,r,i){for(let s=0;s<i;s+=3)if(this.actions[s]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=r,i}addActions(e,t,r,i){let{state:s}=e,{parser:o}=e.p,{data:a}=o;for(let u=0;u<2;u++)for(let f=o.stateSlot(s,u?2:1);;f+=3){if(a[f]==65535)if(a[f+1]==1)f=to(a,f+2);else{i==0&&a[f+1]==2&&(i=this.putAction(to(a,f+2),t,r,i));break}a[f]==t&&(i=this.putAction(to(a,f+1),t,r,i))}return i}}class II{constructor(e,t,r,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new DI(t,i),this.tokens=new FI(e,this.stream),this.topTerm=e.top[1];let{from:s}=i[0];this.stacks=[Cp.start(this,e.top[0],s)],this.fragments=r.length&&this.stream.end-s>e.bufferLength*4?new LI(r,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,r=this.stacks=[],i,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let a=e[o];for(;;){if(this.tokens.mainToken=null,a.pos>t)r.push(a);else{if(this.advanceStack(a,r,e))continue;{i||(i=[],s=[]),i.push(a);let u=this.tokens.getMainToken(a);s.push(u.value,u.end)}}break}}if(!r.length){let o=i&&QI(i);if(o)return ei&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw ei&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&i){let o=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,s,r);if(o)return ei&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(r.length>o)for(r.sort((a,u)=>u.score-a.score);r.length>o;)r.pop();r.some(a=>a.reducePos>t)&&this.recovering--}else if(r.length>1){e:for(let o=0;o<r.length-1;o++){let a=r[o];for(let u=o+1;u<r.length;u++){let f=r[u];if(a.sameState(f)||a.buffer.length>500&&f.buffer.length>500)if((a.score-f.score||a.buffer.length-f.buffer.length)>0)r.splice(u--,1);else{r.splice(o--,1);continue e}}}r.length>12&&(r.sort((o,a)=>a.score-o.score),r.splice(12,r.length-12))}this.minStackPos=r[0].pos;for(let o=1;o<r.length;o++)r[o].pos<this.minStackPos&&(this.minStackPos=r[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,r){let i=e.pos,{parser:s}=this,o=ei?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let f=e.curContext&&e.curContext.tracker.strict,p=f?e.curContext.hash:0;for(let g=this.fragments.nodeAt(i);g;){let x=this.parser.nodeSet.types[g.type.id]==g.type?s.getGoto(e.state,g.type.id):-1;if(x>-1&&g.length&&(!f||(g.prop(St.contextHash)||0)==p))return e.useNode(g,x),ei&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(g.type.id)})`),!0;if(!(g instanceof wn)||g.children.length==0||g.positions[0]>0)break;let A=g.children[0];if(A instanceof wn&&g.positions[0]==0)g=A;else break}}let a=s.stateSlot(e.state,4);if(a>0)return e.reduce(a),ei&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(a&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let u=this.tokens.getActions(e);for(let f=0;f<u.length;){let p=u[f++],g=u[f++],x=u[f++],A=f==u.length||!r,_=A?e:e.split(),b=this.tokens.mainToken;if(_.apply(p,g,b?b.start:_.pos,x),ei&&console.log(o+this.stackID(_)+` (via ${(p&65536)==0?"shift":`reduce of ${s.getName(p&65535)}`} for ${s.getName(g)} @ ${i}${_==e?"":", split"})`),A)return!0;_.pos>i?t.push(_):r.push(_)}return!1}advanceFully(e,t){let r=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>r)return Z_(e,t),!0}}runRecovery(e,t,r){let i=null,s=!1;for(let o=0;o<e.length;o++){let a=e[o],u=t[o<<1],f=t[(o<<1)+1],p=ei?this.stackID(a)+" -> ":"";if(a.deadEnd&&(s||(s=!0,a.restart(),ei&&console.log(p+this.stackID(a)+" (restarted)"),this.advanceFully(a,r))))continue;let g=a.split(),x=p;for(let A=0;A<10&&g.forceReduce()&&(ei&&console.log(x+this.stackID(g)+" (via force-reduce)"),!this.advanceFully(g,r));A++)ei&&(x=this.stackID(g)+" -> ");for(let A of a.recoverByInsert(u))ei&&console.log(p+this.stackID(A)+" (via recover-insert)"),this.advanceFully(A,r);this.stream.end>a.pos?(f==a.pos&&(f++,u=0),a.recoverByDelete(u,f),ei&&console.log(p+this.stackID(a)+` (via recover-delete ${this.parser.getName(u)})`),Z_(a,r)):(!i||i.score<g.score)&&(i=g)}return i}stackToTree(e){return e.close(),wn.build({buffer:Tp.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Ix||(Ix=new WeakMap)).get(e);return t||Ix.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Z_(n,e){for(let t=0;t<e.length;t++){let r=e[t];if(r.pos==n.pos&&r.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class zI{constructor(e,t,r){this.source=e,this.flags=t,this.disabled=r}allows(e){return!this.disabled||this.disabled[e]==0}}const zx=n=>n;class jI{constructor(e){this.start=e.start,this.shift=e.shift||zx,this.reduce=e.reduce||zx,this.reuse=e.reuse||zx,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Ep extends WC{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let a=0;a<e.repeatNodeCount;a++)t.push("");let r=Object.keys(e.topRules).map(a=>e.topRules[a][1]),i=[];for(let a=0;a<t.length;a++)i.push([]);function s(a,u,f){i[a].push([u,u.deserialize(String(f))])}if(e.nodeProps)for(let a of e.nodeProps){let u=a[0];typeof u=="string"&&(u=St[u]);for(let f=1;f<a.length;){let p=a[f++];if(p>=0)s(p,u,a[f++]);else{let g=a[f+-p];for(let x=-p;x>0;x--)s(a[f++],u,g);f++}}}this.nodeSet=new $v(t.map((a,u)=>jr.define({name:u>=this.minRepeatTerm?void 0:a,id:u,props:i[u],top:r.indexOf(u)>-1,error:u==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(u)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=zC;let o=Vd(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(G_),this.states=Vd(e.states,Uint32Array),this.data=Vd(e.stateData),this.goto=Vd(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(a=>typeof a=="number"?new xc(o,a):a),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,r){let i=new II(this,e,t,r);for(let s of this.wrappers)i=s(i,e,t,r);return i}getGoto(e,t,r=!1){let i=this.goto;if(t>=i[0])return-1;for(let s=i[t+1];;){let o=i[s++],a=o&1,u=i[s++];if(a&&r)return u;for(let f=s+(o>>1);s<f;s++)if(i[s]==e)return u;if(a)return-1}}hasAction(e,t){let r=this.data;for(let i=0;i<2;i++)for(let s=this.stateSlot(e,i?2:1),o;;s+=3){if((o=r[s])==65535)if(r[s+1]==1)o=r[s=to(r,s+2)];else{if(r[s+1]==2)return to(r,s+2);break}if(o==t||o==0)return to(r,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,r=>r==t?!0:null)}allActions(e,t){let r=this.stateSlot(e,4),i=r?t(r):void 0;for(let s=this.stateSlot(e,1);i==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=to(this.data,s+2);else break;i=t(to(this.data,s+1))}return i}nextStates(e){let t=[];for(let r=this.stateSlot(e,1);;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=to(this.data,r+2);else break;if((this.data[r+2]&1)==0){let i=this.data[r+1];t.some((s,o)=>o&1&&s==i)||t.push(this.data[r],i)}}return t}configure(e){let t=Object.assign(Object.create(Ep.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let r=this.topRules[e.top];if(!r)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=r}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(r=>{let i=e.tokenizers.find(s=>s.from==r);return i?i.to:r})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((r,i)=>{let s=e.specializers.find(a=>a.from==r.external);if(!s)return r;let o=Object.assign(Object.assign({},r),{external:s.to});return t.specializers[i]=G_(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),r=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(r[o]=!0)}let i=null;for(let s=0;s<t.length;s++)if(!r[s])for(let o=this.dialects[t[s]],a;(a=this.data[o++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[a]=1;return new zI(e,r,i)}static deserialize(e){return new Ep(e)}}function to(n,e){return n[e]|n[e+1]<<16}function QI(n){let e=null;for(let t of n){let r=t.p.stoppedAt;(t.pos==t.p.stream.end||r!=null&&t.pos>r)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function G_(n){if(n.external){let e=n.extend?1:0;return(t,r)=>n.external(t,r)<<1|e}return n.get}const HI=1,gE=194,xE=195,WI=196,X_=197,qI=198,VI=199,$I=200,UI=2,yE=3,K_=201,ZI=24,GI=25,XI=49,KI=50,YI=55,JI=56,ez=57,tz=59,nz=60,rz=61,iz=62,sz=63,oz=65,az=238,lz=71,cz=241,uz=242,hz=243,fz=244,dz=245,pz=246,mz=247,gz=248,vE=72,xz=249,yz=250,vz=251,Az=252,bz=253,wz=254,_z=255,Oz=256,kz=73,Sz=77,Cz=263,Tz=112,Ez=130,Pz=151,Bz=152,Rz=155,al=10,Ph=13,dA=32,fm=9,pA=35,Dz=40,Mz=46,Yy=123,Y_=125,AE=39,bE=34,J_=92,Nz=111,Lz=120,Fz=78,Iz=117,zz=85,jz=new Set([GI,XI,KI,Cz,oz,Ez,JI,ez,az,iz,sz,vE,kz,Sz,nz,rz,Pz,Bz,Rz,Tz]);function jx(n){return n==al||n==Ph}function Qx(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}const Qz=new hm((n,e)=>{let t;if(n.next<0)n.acceptToken(VI);else if(e.context.flags&c0)jx(n.next)&&n.acceptToken(qI,1);else if(((t=n.peek(-1))<0||jx(t))&&e.canShift(X_)){let r=0;for(;n.next==dA||n.next==fm;)n.advance(),r++;(n.next==al||n.next==Ph||n.next==pA)&&n.acceptToken(X_,-r)}else jx(n.next)&&n.acceptToken(WI,1)},{contextual:!0}),Hz=new hm((n,e)=>{let t=e.context;if(t.flags)return;let r=n.peek(-1);if(r==al||r==Ph){let i=0,s=0;for(;;){if(n.next==dA)i++;else if(n.next==fm)i+=8-i%8;else break;n.advance(),s++}i!=t.indent&&n.next!=al&&n.next!=Ph&&n.next!=pA&&(i<t.indent?n.acceptToken(xE,-s):n.acceptToken(gE))}}),c0=1,wE=2,Xs=4,Ks=8,Ys=16,Js=32;function u0(n,e,t){this.parent=n,this.indent=e,this.flags=t,this.hash=(n?n.hash+n.hash<<8:0)+e+(e<<4)+t+(t<<6)}const Wz=new u0(null,0,0);function qz(n){let e=0;for(let t=0;t<n.length;t++)e+=n.charCodeAt(t)==fm?8-e%8:1;return e}const eO=new Map([[cz,0],[uz,Xs],[hz,Ks],[fz,Ks|Xs],[dz,Ys],[pz,Ys|Xs],[mz,Ys|Ks],[gz,Ys|Ks|Xs],[xz,Js],[yz,Js|Xs],[vz,Js|Ks],[Az,Js|Ks|Xs],[bz,Js|Ys],[wz,Js|Ys|Xs],[_z,Js|Ys|Ks],[Oz,Js|Ys|Ks|Xs]].map(([n,e])=>[n,e|wE])),Vz=new jI({start:Wz,reduce(n,e,t,r){return n.flags&c0&&jz.has(e)||(e==lz||e==vE)&&n.flags&wE?n.parent:n},shift(n,e,t,r){return e==gE?new u0(n,qz(r.read(r.pos,t.pos)),0):e==xE?n.parent:e==ZI||e==YI||e==tz||e==yE?new u0(n,0,c0):eO.has(e)?new u0(n,0,eO.get(e)|n.flags&c0):n},hash(n){return n.hash}}),$z=new hm(n=>{for(let e=0;e<5;e++){if(n.next!="print".charCodeAt(e))return;n.advance()}if(!/\w/.test(String.fromCharCode(n.next)))for(let e=0;;e++){let t=n.peek(e);if(!(t==dA||t==fm)){t!=Dz&&t!=Mz&&t!=al&&t!=Ph&&t!=pA&&n.acceptToken(HI);return}}}),Uz=new hm((n,e)=>{let{flags:t}=e.context,r=t&Xs?bE:AE,i=(t&Ks)>0,s=!(t&Ys),o=(t&Js)>0,a=n.pos;for(;!(n.next<0);)if(o&&n.next==Yy)if(n.peek(1)==Yy)n.advance(2);else{if(n.pos==a){n.acceptToken(yE,1);return}break}else if(s&&n.next==J_){if(n.pos==a){n.advance();let u=n.next;u>=0&&(n.advance(),Zz(n,u)),n.acceptToken(UI);return}break}else if(n.next==J_&&!s&&n.peek(1)>-1)n.advance(2);else if(n.next==r&&(!i||n.peek(1)==r&&n.peek(2)==r)){if(n.pos==a){n.acceptToken(K_,i?3:1);return}break}else if(n.next==al){if(i)n.advance();else if(n.pos==a){n.acceptToken(K_);return}break}else n.advance();n.pos>a&&n.acceptToken($I)});function Zz(n,e){if(e==Nz)for(let t=0;t<2&&n.next>=48&&n.next<=55;t++)n.advance();else if(e==Lz)for(let t=0;t<2&&Qx(n.next);t++)n.advance();else if(e==Iz)for(let t=0;t<4&&Qx(n.next);t++)n.advance();else if(e==zz)for(let t=0;t<8&&Qx(n.next);t++)n.advance();else if(e==Fz&&n.next==Yy){for(n.advance();n.next>=0&&n.next!=Y_&&n.next!=AE&&n.next!=bE&&n.next!=al;)n.advance();n.next==Y_&&n.advance()}}const Gz=qC({'async "*" "**" FormatConversion FormatSpec':fe.modifier,"for while if elif else try except finally return raise break continue with pass assert await yield match case":fe.controlKeyword,"in not and or is del":fe.operatorKeyword,"from def class global nonlocal lambda":fe.definitionKeyword,import:fe.moduleKeyword,"with as print":fe.keyword,Boolean:fe.bool,None:fe.null,VariableName:fe.variableName,"CallExpression/VariableName":fe.function(fe.variableName),"FunctionDefinition/VariableName":fe.function(fe.definition(fe.variableName)),"ClassDefinition/VariableName":fe.definition(fe.className),PropertyName:fe.propertyName,"CallExpression/MemberExpression/PropertyName":fe.function(fe.propertyName),Comment:fe.lineComment,Number:fe.number,String:fe.string,FormatString:fe.special(fe.string),Escape:fe.escape,UpdateOp:fe.updateOperator,"ArithOp!":fe.arithmeticOperator,BitOp:fe.bitwiseOperator,CompareOp:fe.compareOperator,AssignOp:fe.definitionOperator,Ellipsis:fe.punctuation,At:fe.meta,"( )":fe.paren,"[ ]":fe.squareBracket,"{ }":fe.brace,".":fe.derefOperator,", ;":fe.separator}),Xz={__proto__:null,await:44,or:54,and:56,in:60,not:62,is:64,if:70,else:72,lambda:76,yield:94,from:96,async:102,for:104,None:162,True:164,False:164,del:178,pass:182,break:186,continue:190,return:194,raise:202,import:206,as:208,global:212,nonlocal:214,assert:218,type:223,elif:236,while:240,try:246,except:248,finally:250,with:254,def:258,class:268,match:279,case:285},Kz=Ep.deserialize({version:14,states:"##jO`QeOOP$}OSOOO&WQtO'#HUOOQS'#Co'#CoOOQS'#Cp'#CpO'vQdO'#CnO*UQtO'#HTOOQS'#HU'#HUOOQS'#DU'#DUOOQS'#HT'#HTO*rQdO'#D_O+VQdO'#DfO+gQdO'#DjO+zOWO'#DuO,VOWO'#DvO.[QtO'#GuOOQS'#Gu'#GuO'vQdO'#GtO0ZQtO'#GtOOQS'#Eb'#EbO0rQdO'#EcOOQS'#Gs'#GsO0|QdO'#GrOOQV'#Gr'#GrO1XQdO'#FYOOQS'#G^'#G^O1^QdO'#FXOOQV'#IS'#ISOOQV'#Gq'#GqOOQV'#Fq'#FqQ`QeOOO'vQdO'#CqO1lQdO'#C}O1sQdO'#DRO2RQdO'#HYO2cQtO'#EVO'vQdO'#EWOOQS'#EY'#EYOOQS'#E['#E[OOQS'#E^'#E^O2wQdO'#E`O3_QdO'#EdO3rQdO'#EfO3zQtO'#EfO1XQdO'#EiO0rQdO'#ElO1XQdO'#EnO0rQdO'#EtO0rQdO'#EwO4VQdO'#EyO4^QdO'#FOO4iQdO'#EzO0rQdO'#FOO1XQdO'#FQO1XQdO'#FVO4nQdO'#F[P4uOdO'#GpPOOO)CBd)CBdOOQS'#Ce'#CeOOQS'#Cf'#CfOOQS'#Cg'#CgOOQS'#Ch'#ChOOQS'#Ci'#CiOOQS'#Cj'#CjOOQS'#Cl'#ClO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO'vQdO,59OO5TQdO'#DoOOQS,5:Y,5:YO5hQdO'#HdOOQS,5:],5:]O5uQ!fO,5:]O5zQtO,59YO1lQdO,59bO1lQdO,59bO1lQdO,59bO8jQdO,59bO8oQdO,59bO8vQdO,59jO8}QdO'#HTO:TQdO'#HSOOQS'#HS'#HSOOQS'#D['#D[O:lQdO,59aO'vQdO,59aO:zQdO,59aOOQS,59y,59yO;PQdO,5:RO'vQdO,5:ROOQS,5:Q,5:QO;_QdO,5:QO;dQdO,5:XO'vQdO,5:XO'vQdO,5:VOOQS,5:U,5:UO;uQdO,5:UO;zQdO,5:WOOOW'#Fy'#FyO<POWO,5:aOOQS,5:a,5:aO<[QdO'#HwOOOW'#Dw'#DwOOOW'#Fz'#FzO<lOWO,5:bOOQS,5:b,5:bOOQS'#F}'#F}O<zQtO,5:iO?lQtO,5=`O@VQ#xO,5=`O@vQtO,5=`OOQS,5:},5:}OA_QeO'#GWOBqQdO,5;^OOQV,5=^,5=^OB|QtO'#IPOCkQdO,5;tOOQS-E:[-E:[OOQV,5;s,5;sO4dQdO'#FQOOQV-E9o-E9oOCsQtO,59]OEzQtO,59iOFeQdO'#HVOFpQdO'#HVO1XQdO'#HVOF{QdO'#DTOGTQdO,59mOGYQdO'#HZO'vQdO'#HZO0rQdO,5=tOOQS,5=t,5=tO0rQdO'#EROOQS'#ES'#ESOGwQdO'#GPOHXQdO,58|OHXQdO,58|O*xQdO,5:oOHgQtO'#H]OOQS,5:r,5:rOOQS,5:z,5:zOHzQdO,5;OOI]QdO'#IOO1XQdO'#H}OOQS,5;Q,5;QOOQS'#GT'#GTOIqQtO,5;QOJPQdO,5;QOJUQdO'#IQOOQS,5;T,5;TOJdQdO'#H|OOQS,5;W,5;WOJuQdO,5;YO4iQdO,5;`O4iQdO,5;cOJ}QtO'#ITO'vQdO'#ITOKXQdO,5;eO4VQdO,5;eO0rQdO,5;jO1XQdO,5;lOK^QeO'#EuOLjQgO,5;fO!!kQdO'#IUO4iQdO,5;jO!!vQdO,5;lO!#OQdO,5;qO!#ZQtO,5;vO'vQdO,5;vPOOO,5=[,5=[P!#bOSO,5=[P!#jOdO,5=[O!&bQtO1G.jO!&iQtO1G.jO!)YQtO1G.jO!)dQtO1G.jO!+}QtO1G.jO!,bQtO1G.jO!,uQdO'#HcO!-TQtO'#GuO0rQdO'#HcO!-_QdO'#HbOOQS,5:Z,5:ZO!-gQdO,5:ZO!-lQdO'#HeO!-wQdO'#HeO!.[QdO,5>OOOQS'#Ds'#DsOOQS1G/w1G/wOOQS1G.|1G.|O!/[QtO1G.|O!/cQtO1G.|O1lQdO1G.|O!0OQdO1G/UOOQS'#DZ'#DZO0rQdO,59tOOQS1G.{1G.{O!0VQdO1G/eO!0gQdO1G/eO!0oQdO1G/fO'vQdO'#H[O!0tQdO'#H[O!0yQtO1G.{O!1ZQdO,59iO!2aQdO,5=zO!2qQdO,5=zO!2yQdO1G/mO!3OQtO1G/mOOQS1G/l1G/lO!3`QdO,5=uO!4VQdO,5=uO0rQdO1G/qO!4tQdO1G/sO!4yQtO1G/sO!5ZQtO1G/qOOQS1G/p1G/pOOQS1G/r1G/rOOOW-E9w-E9wOOQS1G/{1G/{O!5kQdO'#HxO0rQdO'#HxO!5|QdO,5>cOOOW-E9x-E9xOOQS1G/|1G/|OOQS-E9{-E9{O!6[Q#xO1G2zO!6{QtO1G2zO'vQdO,5<jOOQS,5<j,5<jOOQS-E9|-E9|OOQS,5<r,5<rOOQS-E:U-E:UOOQV1G0x1G0xO1XQdO'#GRO!7dQtO,5>kOOQS1G1`1G1`O!8RQdO1G1`OOQS'#DV'#DVO0rQdO,5=qOOQS,5=q,5=qO!8WQdO'#FrO!8cQdO,59oO!8kQdO1G/XO!8uQtO,5=uOOQS1G3`1G3`OOQS,5:m,5:mO!9fQdO'#GtOOQS,5<k,5<kOOQS-E9}-E9}O!9wQdO1G.hOOQS1G0Z1G0ZO!:VQdO,5=wO!:gQdO,5=wO0rQdO1G0jO0rQdO1G0jO!:xQdO,5>jO!;ZQdO,5>jO1XQdO,5>jO!;lQdO,5>iOOQS-E:R-E:RO!;qQdO1G0lO!;|QdO1G0lO!<RQdO,5>lO!<aQdO,5>lO!<oQdO,5>hO!=VQdO,5>hO!=hQdO'#EpO0rQdO1G0tO!=sQdO1G0tO!=xQgO1G0zO!AvQgO1G0}O!EqQdO,5>oO!E{QdO,5>oO!FTQtO,5>oO0rQdO1G1PO!F_QdO1G1PO4iQdO1G1UO!!vQdO1G1WOOQV,5;a,5;aO!FdQfO,5;aO!FiQgO1G1QO!JjQdO'#GZO4iQdO1G1QO4iQdO1G1QO!JzQdO,5>pO!KXQdO,5>pO1XQdO,5>pOOQV1G1U1G1UO!KaQdO'#FSO!KrQ!fO1G1WO!KzQdO1G1WOOQV1G1]1G1]O4iQdO1G1]O!LPQdO1G1]O!LXQdO'#F^OOQV1G1b1G1bO!#ZQtO1G1bPOOO1G2v1G2vP!L^OSO1G2vOOQS,5=},5=}OOQS'#Dp'#DpO0rQdO,5=}O!LfQdO,5=|O!LyQdO,5=|OOQS1G/u1G/uO!MRQdO,5>PO!McQdO,5>PO!MkQdO,5>PO!NOQdO,5>PO!N`QdO,5>POOQS1G3j1G3jOOQS7+$h7+$hO!8kQdO7+$pO#!RQdO1G.|O#!YQdO1G.|OOQS1G/`1G/`OOQS,5<`,5<`O'vQdO,5<`OOQS7+%P7+%PO#!aQdO7+%POOQS-E9r-E9rOOQS7+%Q7+%QO#!qQdO,5=vO'vQdO,5=vOOQS7+$g7+$gO#!vQdO7+%PO##OQdO7+%QO##TQdO1G3fOOQS7+%X7+%XO##eQdO1G3fO##mQdO7+%XOOQS,5<_,5<_O'vQdO,5<_O##rQdO1G3aOOQS-E9q-E9qO#$iQdO7+%]OOQS7+%_7+%_O#$wQdO1G3aO#%fQdO7+%_O#%kQdO1G3gO#%{QdO1G3gO#&TQdO7+%]O#&YQdO,5>dO#&sQdO,5>dO#&sQdO,5>dOOQS'#Dx'#DxO#'UO&jO'#DzO#'aO`O'#HyOOOW1G3}1G3}O#'fQdO1G3}O#'nQdO1G3}O#'yQ#xO7+(fO#(jQtO1G2UP#)TQdO'#GOOOQS,5<m,5<mOOQS-E:P-E:POOQS7+&z7+&zOOQS1G3]1G3]OOQS,5<^,5<^OOQS-E9p-E9pOOQS7+$s7+$sO#)bQdO,5=`O#){QdO,5=`O#*^QtO,5<aO#*qQdO1G3cOOQS-E9s-E9sOOQS7+&U7+&UO#+RQdO7+&UO#+aQdO,5<nO#+uQdO1G4UOOQS-E:Q-E:QO#,WQdO1G4UOOQS1G4T1G4TOOQS7+&W7+&WO#,iQdO7+&WOOQS,5<p,5<pO#,tQdO1G4WOOQS-E:S-E:SOOQS,5<l,5<lO#-SQdO1G4SOOQS-E:O-E:OO1XQdO'#EqO#-jQdO'#EqO#-uQdO'#IRO#-}QdO,5;[OOQS7+&`7+&`O0rQdO7+&`O#.SQgO7+&fO!JmQdO'#GXO4iQdO7+&fO4iQdO7+&iO#2QQtO,5<tO'vQdO,5<tO#2[QdO1G4ZOOQS-E:W-E:WO#2fQdO1G4ZO4iQdO7+&kO0rQdO7+&kOOQV7+&p7+&pO!KrQ!fO7+&rO!KzQdO7+&rO`QeO1G0{OOQV-E:X-E:XO4iQdO7+&lO4iQdO7+&lOOQV,5<u,5<uO#2nQdO,5<uO!JmQdO,5<uOOQV7+&l7+&lO#2yQgO7+&lO#6tQdO,5<vO#7PQdO1G4[OOQS-E:Y-E:YO#7^QdO1G4[O#7fQdO'#IWO#7tQdO'#IWO1XQdO'#IWOOQS'#IW'#IWO#8PQdO'#IVOOQS,5;n,5;nO#8XQdO,5;nO0rQdO'#FUOOQV7+&r7+&rO4iQdO7+&rOOQV7+&w7+&wO4iQdO7+&wO#8^QfO,5;xOOQV7+&|7+&|POOO7+(b7+(bO#8cQdO1G3iOOQS,5<c,5<cO#8qQdO1G3hOOQS-E9u-E9uO#9UQdO,5<dO#9aQdO,5<dO#9tQdO1G3kOOQS-E9v-E9vO#:UQdO1G3kO#:^QdO1G3kO#:nQdO1G3kO#:UQdO1G3kOOQS<<H[<<H[O#:yQtO1G1zOOQS<<Hk<<HkP#;WQdO'#FtO8vQdO1G3bO#;eQdO1G3bO#;jQdO<<HkOOQS<<Hl<<HlO#;zQdO7+)QOOQS<<Hs<<HsO#<[QtO1G1yP#<{QdO'#FsO#=YQdO7+)RO#=jQdO7+)RO#=rQdO<<HwO#=wQdO7+({OOQS<<Hy<<HyO#>nQdO,5<bO'vQdO,5<bOOQS-E9t-E9tOOQS<<Hw<<HwOOQS,5<g,5<gO0rQdO,5<gO#>sQdO1G4OOOQS-E9y-E9yO#?^QdO1G4OO<[QdO'#H{OOOO'#D{'#D{OOOO'#F|'#F|O#?oO&jO,5:fOOOW,5>e,5>eOOOW7+)i7+)iO#?zQdO7+)iO#@SQdO1G2zO#@mQdO1G2zP'vQdO'#FuO0rQdO<<IpO1XQdO1G2YP1XQdO'#GSO#AOQdO7+)pO#AaQdO7+)pOOQS<<Ir<<IrP1XQdO'#GUP0rQdO'#GQOOQS,5;],5;]O#ArQdO,5>mO#BQQdO,5>mOOQS1G0v1G0vOOQS<<Iz<<IzOOQV-E:V-E:VO4iQdO<<JQOOQV,5<s,5<sO4iQdO,5<sOOQV<<JQ<<JQOOQV<<JT<<JTO#BYQtO1G2`P#BdQdO'#GYO#BkQdO7+)uO#BuQgO<<JVO4iQdO<<JVOOQV<<J^<<J^O4iQdO<<J^O!KrQ!fO<<J^O#FpQgO7+&gOOQV<<JW<<JWO#FzQgO<<JWOOQV1G2a1G2aO1XQdO1G2aO#JuQdO1G2aO4iQdO<<JWO1XQdO1G2bP0rQdO'#G[O#KQQdO7+)vO#K_QdO7+)vOOQS'#FT'#FTO0rQdO,5>rO#KgQdO,5>rO#KrQdO,5>rO#K}QdO,5>qO#L`QdO,5>qOOQS1G1Y1G1YOOQS,5;p,5;pOOQV<<Jc<<JcO#LhQdO1G1dOOQS7+)T7+)TP#LmQdO'#FwO#L}QdO1G2OO#MbQdO1G2OO#MrQdO1G2OP#M}QdO'#FxO#N[QdO7+)VO#NlQdO7+)VO#NlQdO7+)VO#NtQdO7+)VO$ UQdO7+(|O8vQdO7+(|OOQSAN>VAN>VO$ oQdO<<LmOOQSAN>cAN>cO0rQdO1G1|O$!PQtO1G1|P$!ZQdO'#FvOOQS1G2R1G2RP$!hQdO'#F{O$!uQdO7+)jO$#`QdO,5>gOOOO-E9z-E9zOOOW<<MT<<MTO$#nQdO7+(fOOQSAN?[AN?[OOQS7+'t7+'tO$$XQdO<<M[OOQS,5<q,5<qO$$jQdO1G4XOOQS-E:T-E:TOOQVAN?lAN?lOOQV1G2_1G2_O4iQdOAN?qO$$xQgOAN?qOOQVAN?xAN?xO4iQdOAN?xOOQV<<JR<<JRO4iQdOAN?rO4iQdO7+'{OOQV7+'{7+'{O1XQdO7+'{OOQVAN?rAN?rOOQS7+'|7+'|O$(sQdO<<MbOOQS1G4^1G4^O0rQdO1G4^OOQS,5<w,5<wO$)QQdO1G4]OOQS-E:Z-E:ZOOQU'#G_'#G_O$)cQfO7+'OO$)nQdO'#F_O$*uQdO7+'jO$+VQdO7+'jOOQS7+'j7+'jO$+bQdO<<LqO$+rQdO<<LqO$+rQdO<<LqO$+zQdO'#H^OOQS<<Lh<<LhO$,UQdO<<LhOOQS7+'h7+'hOOQS'#D|'#D|OOOO1G4R1G4RO$,oQdO1G4RO$,wQdO1G4RP!=hQdO'#GVOOQVG25]G25]O4iQdOG25]OOQVG25dG25dOOQVG25^G25^OOQV<<Kg<<KgO4iQdO<<KgOOQS7+)x7+)xP$-SQdO'#G]OOQU-E:]-E:]OOQV<<Jj<<JjO$-vQtO'#FaOOQS'#Fc'#FcO$.WQdO'#FbO$.xQdO'#FbOOQS'#Fb'#FbO$.}QdO'#IYO$)nQdO'#FiO$)nQdO'#FiO$/fQdO'#FjO$)nQdO'#FkO$/mQdO'#IZOOQS'#IZ'#IZO$0[QdO,5;yOOQS<<KU<<KUO$0dQdO<<KUO$0tQdOANB]O$1UQdOANB]O$1^QdO'#H_OOQS'#H_'#H_O1sQdO'#DcO$1wQdO,5=xOOQSANBSANBSOOOO7+)m7+)mO$2`QdO7+)mOOQVLD*wLD*wOOQVANARANARO5uQ!fO'#GaO$2hQtO,5<SO$)nQdO'#FmOOQS,5<W,5<WOOQS'#Fd'#FdO$3YQdO,5;|O$3_QdO,5;|OOQS'#Fg'#FgO$)nQdO'#G`O$4PQdO,5<QO$4kQdO,5>tO$4{QdO,5>tO1XQdO,5<PO$5^QdO,5<TO$5cQdO,5<TO$)nQdO'#I[O$5hQdO'#I[O$5mQdO,5<UOOQS,5<V,5<VO0rQdO'#FpOOQU1G1e1G1eO4iQdO1G1eOOQSAN@pAN@pO$5rQdOG27wO$6SQdO,59}OOQS1G3d1G3dOOOO<<MX<<MXOOQS,5<{,5<{OOQS-E:_-E:_O$6XQtO'#FaO$6`QdO'#I]O$6nQdO'#I]O$6vQdO,5<XOOQS1G1h1G1hO$6{QdO1G1hO$7QQdO,5<zOOQS-E:^-E:^O$7lQdO,5=OO$8TQdO1G4`OOQS-E:b-E:bOOQS1G1k1G1kOOQS1G1o1G1oO$8eQdO,5>vO$)nQdO,5>vOOQS1G1p1G1pOOQS,5<[,5<[OOQU7+'P7+'PO$+zQdO1G/iO$)nQdO,5<YO$8sQdO,5>wO$8zQdO,5>wOOQS1G1s1G1sOOQS7+'S7+'SP$)nQdO'#GdO$9SQdO1G4bO$9^QdO1G4bO$9fQdO1G4bOOQS7+%T7+%TO$9tQdO1G1tO$:SQtO'#FaO$:ZQdO,5<}OOQS,5<},5<}O$:iQdO1G4cOOQS-E:a-E:aO$)nQdO,5<|O$:pQdO,5<|O$:uQdO7+)|OOQS-E:`-E:`O$;PQdO7+)|O$)nQdO,5<ZP$)nQdO'#GcO$;XQdO1G2hO$)nQdO1G2hP$;gQdO'#GbO$;nQdO<<MhO$;xQdO1G1uO$<WQdO7+(SO8vQdO'#C}O8vQdO,59bO8vQdO,59bO8vQdO,59bO$<fQtO,5=`O8vQdO1G.|O0rQdO1G/XO0rQdO7+$pP$<yQdO'#GOO'vQdO'#GtO$=WQdO,59bO$=]QdO,59bO$=dQdO,59mO$=iQdO1G/UO1sQdO'#DRO8vQdO,59j",stateData:"$>S~O%cOS%^OSSOS%]PQ~OPdOVaOfoOhYOopOs!POvqO!PrO!Q{O!T!SO!U!RO!XZO!][O!h`O!r`O!s`O!t`O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO#l!QO#o!TO#s!UO#u!VO#z!WO#}hO$P!XO%oRO%pRO%tSO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O~O%]!YO~OV!aO_!aOa!bOh!iO!X!kO!f!mO%j![O%k!]O%l!^O%m!_O%n!_O%o!`O%p!`O%q!aO%r!aO%s!aO~Ok%xXl%xXm%xXn%xXo%xXp%xXs%xXz%xX{%xX!x%xX#g%xX%[%xX%_%xX%z%xXg%xX!T%xX!U%xX%{%xX!W%xX![%xX!Q%xX#[%xXt%xX!m%xX~P%SOfoOhYO!XZO!][O!h`O!r`O!s`O!t`O%oRO%pRO%tSO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O~Oz%wX{%wX#g%wX%[%wX%_%wX%z%wX~Ok!pOl!qOm!oOn!oOo!rOp!sOs!tO!x%wX~P)pOV!zOg!|Oo0cOv0qO!PrO~P'vOV#OOo0cOv0qO!W#PO~P'vOV#SOa#TOo0cOv0qO![#UO~P'vOQ#XO%`#XO%a#ZO~OQ#^OR#[O%`#^O%a#`O~OV%iX_%iXa%iXh%iXk%iXl%iXm%iXn%iXo%iXp%iXs%iXz%iX!X%iX!f%iX%j%iX%k%iX%l%iX%m%iX%n%iX%o%iX%p%iX%q%iX%r%iX%s%iXg%iX!T%iX!U%iX~O&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O&c^O&d^O&e^O&f^O&g^O&h^O&i^O&j^O{%iX!x%iX#g%iX%[%iX%_%iX%z%iX%{%iX!W%iX![%iX!Q%iX#[%iXt%iX!m%iX~P,eOz#dO{%hX!x%hX#g%hX%[%hX%_%hX%z%hX~Oo0cOv0qO~P'vO#g#gO%[#iO%_#iO~O%uWO~O!T#nO#u!VO#z!WO#}hO~OopO~P'vOV#sOa#tO%uWO{wP~OV#xOo0cOv0qO!Q#yO~P'vO{#{O!x$QO%z#|O#g!yX%[!yX%_!yX~OV#xOo0cOv0qO#g#SX%[#SX%_#SX~P'vOo0cOv0qO#g#WX%[#WX%_#WX~P'vOh$WO%uWO~O!f$YO!r$YO%uWO~OV$eO~P'vO!U$gO#s$hO#u$iO~O{$jO~OV$qO~P'vOS$sO%[$rO%_$rO%c$tO~OV$}Oa$}Og%POo0cOv0qO~P'vOo0cOv0qO{%SO~P'vO&Y%UO~Oa!bOh!iO!X!kO!f!mOVba_bakbalbambanbaobapbasbazba{ba!xba#gba%[ba%_ba%jba%kba%lba%mba%nba%oba%pba%qba%rba%sba%zbagba!Tba!Uba%{ba!Wba![ba!Qba#[batba!mba~On%ZO~Oo%ZO~P'vOo0cO~P'vOk0eOl0fOm0dOn0dOo0mOp0nOs0rOg%wX!T%wX!U%wX%{%wX!W%wX![%wX!Q%wX#[%wX!m%wX~P)pO%{%]Og%vXz%vX!T%vX!U%vX!W%vX{%vX~Og%_Oz%`O!T%dO!U%cO~Og%_O~Oz%gO!T%dO!U%cO!W&SX~O!W%kO~Oz%lO{%nO!T%dO!U%cO![%}X~O![%rO~O![%sO~OQ#XO%`#XO%a%uO~OV%wOo0cOv0qO!PrO~P'vOQ#^OR#[O%`#^O%a%zO~OV!qa_!qaa!qah!qak!qal!qam!qan!qao!qap!qas!qaz!qa{!qa!X!qa!f!qa!x!qa#g!qa%[!qa%_!qa%j!qa%k!qa%l!qa%m!qa%n!qa%o!qa%p!qa%q!qa%r!qa%s!qa%z!qag!qa!T!qa!U!qa%{!qa!W!qa![!qa!Q!qa#[!qat!qa!m!qa~P#yOz%|O{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~P%SOV&OOopOvqO{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~P'vOz%|O{%ha!x%ha#g%ha%[%ha%_%ha%z%ha~OPdOVaOopOvqO!PrO!Q{O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO#g$zX%[$zX%_$zX~P'vO#g#gO%[&TO%_&TO~O!f&UOh&sX%[&sXz&sX#[&sX#g&sX%_&sX#Z&sXg&sX~Oh!iO%[&WO~Okealeameaneaoeapeaseazea{ea!xea#gea%[ea%_ea%zeagea!Tea!Uea%{ea!Wea![ea!Qea#[eatea!mea~P%SOsqazqa{qa#gqa%[qa%_qa%zqa~Ok!pOl!qOm!oOn!oOo!rOp!sO!xqa~PEcO%z&YOz%yX{%yX~O%uWOz%yX{%yX~Oz&]O{wX~O{&_O~Oz%lO#g%}X%[%}X%_%}Xg%}X{%}X![%}X!m%}X%z%}X~OV0lOo0cOv0qO!PrO~P'vO%z#|O#gUa%[Ua%_Ua~Oz&hO#g&PX%[&PX%_&PXn&PX~P%SOz&kO!Q&jO#g#Wa%[#Wa%_#Wa~Oz&lO#[&nO#g&rX%[&rX%_&rXg&rX~O!f$YO!r$YO#Z&qO%uWO~O#Z&qO~Oz&sO#g&tX%[&tX%_&tX~Oz&uO#g&pX%[&pX%_&pX{&pX~O!X&wO%z&xO~Oz&|On&wX~P%SOn'PO~OPdOVaOopOvqO!PrO!Q{O!{tO!}uO#PvO#RwO#TxO#XyO#ZzO#^|O#_|O#a}O#c!OO%['UO~P'vOt'YO#p'WO#q'XOP#naV#naf#nah#nao#nas#nav#na!P#na!Q#na!T#na!U#na!X#na!]#na!h#na!r#na!s#na!t#na!{#na!}#na#P#na#R#na#T#na#X#na#Z#na#^#na#_#na#a#na#c#na#l#na#o#na#s#na#u#na#z#na#}#na$P#na%X#na%o#na%p#na%t#na%u#na&Z#na&[#na&]#na&^#na&_#na&`#na&a#na&b#na&c#na&d#na&e#na&f#na&g#na&h#na&i#na&j#na%Z#na%_#na~Oz'ZO#[']O{&xX~Oh'_O!X&wO~Oh!iO{$jO!X&wO~O{'eO~P%SO%['hO%_'hO~OS'iO%['hO%_'hO~OV!aO_!aOa!bOh!iO!X!kO!f!mO%l!^O%m!_O%n!_O%o!`O%p!`O%q!aO%r!aO%s!aOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~O%k!]O~P!#uO%kWi~P!#uOV!aO_!aOa!bOh!iO!X!kO!f!mO%o!`O%p!`O%q!aO%r!aO%s!aOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%kWi%lWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~O%m!_O%n!_O~P!&pO%mWi%nWi~P!&pOa!bOh!iO!X!kO!f!mOkWilWimWinWioWipWisWizWi{Wi!xWi#gWi%[Wi%_Wi%jWi%kWi%lWi%mWi%nWi%oWi%pWi%zWigWi!TWi!UWi%{Wi!WWi![Wi!QWi#[WitWi!mWi~OV!aO_!aO%q!aO%r!aO%s!aO~P!)nOVWi_Wi%qWi%rWi%sWi~P!)nO!T%dO!U%cOg&VXz&VX~O%z'kO%{'kO~P,eOz'mOg&UX~Og'oO~Oz'pO{'rO!W&XX~Oo0cOv0qOz'pO{'sO!W&XX~P'vO!W'uO~Om!oOn!oOo!rOp!sOkjisjizji{ji!xji#gji%[ji%_ji%zji~Ol!qO~P!.aOlji~P!.aOk0eOl0fOm0dOn0dOo0mOp0nO~Ot'wO~P!/jOV'|Og'}Oo0cOv0qO~P'vOg'}Oz(OO~Og(QO~O!U(SO~Og(TOz(OO!T%dO!U%cO~P%SOk0eOl0fOm0dOn0dOo0mOp0nOgqa!Tqa!Uqa%{qa!Wqa![qa!Qqa#[qatqa!mqa~PEcOV'|Oo0cOv0qO!W&Sa~P'vOz(WO!W&Sa~O!W(XO~Oz(WO!T%dO!U%cO!W&Sa~P%SOV(]Oo0cOv0qO![%}a#g%}a%[%}a%_%}ag%}a{%}a!m%}a%z%}a~P'vOz(^O![%}a#g%}a%[%}a%_%}ag%}a{%}a!m%}a%z%}a~O![(aO~Oz(^O!T%dO!U%cO![%}a~P%SOz(dO!T%dO!U%cO![&Ta~P%SOz(gO{&lX![&lX!m&lX%z&lX~O{(kO![(mO!m(nO%z(jO~OV&OOopOvqO{%hi!x%hi#g%hi%[%hi%_%hi%z%hi~P'vOz(pO{%hi!x%hi#g%hi%[%hi%_%hi%z%hi~O!f&UOh&sa%[&saz&sa#[&sa#g&sa%_&sa#Z&sag&sa~O%[(uO~OV#sOa#tO%uWO~Oz&]O{wa~OopOvqO~P'vOz(^O#g%}a%[%}a%_%}ag%}a{%}a![%}a!m%}a%z%}a~P%SOz(zO#g%hX%[%hX%_%hX%z%hX~O%z#|O#gUi%[Ui%_Ui~O#g&Pa%[&Pa%_&Pan&Pa~P'vOz(}O#g&Pa%[&Pa%_&Pan&Pa~O%uWO#g&ra%[&ra%_&rag&ra~Oz)SO#g&ra%[&ra%_&rag&ra~Og)VO~OV)WOh$WO%uWO~O#Z)XO~O%uWO#g&ta%[&ta%_&ta~Oz)ZO#g&ta%[&ta%_&ta~Oo0cOv0qO#g&pa%[&pa%_&pa{&pa~P'vOz)^O#g&pa%[&pa%_&pa{&pa~OV)`Oa)`O%uWO~O%z)eO~Ot)hO#j)gOP#hiV#hif#hih#hio#his#hiv#hi!P#hi!Q#hi!T#hi!U#hi!X#hi!]#hi!h#hi!r#hi!s#hi!t#hi!{#hi!}#hi#P#hi#R#hi#T#hi#X#hi#Z#hi#^#hi#_#hi#a#hi#c#hi#l#hi#o#hi#s#hi#u#hi#z#hi#}#hi$P#hi%X#hi%o#hi%p#hi%t#hi%u#hi&Z#hi&[#hi&]#hi&^#hi&_#hi&`#hi&a#hi&b#hi&c#hi&d#hi&e#hi&f#hi&g#hi&h#hi&i#hi&j#hi%Z#hi%_#hi~Ot)iOP#kiV#kif#kih#kio#kis#kiv#ki!P#ki!Q#ki!T#ki!U#ki!X#ki!]#ki!h#ki!r#ki!s#ki!t#ki!{#ki!}#ki#P#ki#R#ki#T#ki#X#ki#Z#ki#^#ki#_#ki#a#ki#c#ki#l#ki#o#ki#s#ki#u#ki#z#ki#}#ki$P#ki%X#ki%o#ki%p#ki%t#ki%u#ki&Z#ki&[#ki&]#ki&^#ki&_#ki&`#ki&a#ki&b#ki&c#ki&d#ki&e#ki&f#ki&g#ki&h#ki&i#ki&j#ki%Z#ki%_#ki~OV)kOn&wa~P'vOz)lOn&wa~Oz)lOn&wa~P%SOn)pO~O%Y)tO~Ot)wO#p'WO#q)vOP#niV#nif#nih#nio#nis#niv#ni!P#ni!Q#ni!T#ni!U#ni!X#ni!]#ni!h#ni!r#ni!s#ni!t#ni!{#ni!}#ni#P#ni#R#ni#T#ni#X#ni#Z#ni#^#ni#_#ni#a#ni#c#ni#l#ni#o#ni#s#ni#u#ni#z#ni#}#ni$P#ni%X#ni%o#ni%p#ni%t#ni%u#ni&Z#ni&[#ni&]#ni&^#ni&_#ni&`#ni&a#ni&b#ni&c#ni&d#ni&e#ni&f#ni&g#ni&h#ni&i#ni&j#ni%Z#ni%_#ni~OV)zOo0cOv0qO{$jO~P'vOo0cOv0qO{&xa~P'vOz*OO{&xa~OV*SOa*TOg*WO%q*UO%uWO~O{$jO&{*YO~Oh'_O~Oh!iO{$jO~O%[*_O~O%[*aO%_*aO~OV$}Oa$}Oo0cOv0qOg&Ua~P'vOz*dOg&Ua~Oo0cOv0qO{*gO!W&Xa~P'vOz*hO!W&Xa~Oo0cOv0qOz*hO{*kO!W&Xa~P'vOo0cOv0qOz*hO!W&Xa~P'vOz*hO{*kO!W&Xa~Om0dOn0dOo0mOp0nOgjikjisjizji!Tji!Uji%{ji!Wji{ji![ji#gji%[ji%_ji!Qji#[jitji!mji%zji~Ol0fO~P!NkOlji~P!NkOV'|Og*pOo0cOv0qO~P'vOn*rO~Og*pOz*tO~Og*uO~OV'|Oo0cOv0qO!W&Si~P'vOz*vO!W&Si~O!W*wO~OV(]Oo0cOv0qO![%}i#g%}i%[%}i%_%}ig%}i{%}i!m%}i%z%}i~P'vOz*zO!T%dO!U%cO![&Ti~Oz*}O![%}i#g%}i%[%}i%_%}ig%}i{%}i!m%}i%z%}i~O![+OO~Oa+QOo0cOv0qO![&Ti~P'vOz*zO![&Ti~O![+SO~OV+UOo0cOv0qO{&la![&la!m&la%z&la~P'vOz+VO{&la![&la!m&la%z&la~O!]+YO&n+[O![!nX~O![+^O~O{(kO![+_O~O{(kO![+_O!m+`O~OV&OOopOvqO{%hq!x%hq#g%hq%[%hq%_%hq%z%hq~P'vOz$ri{$ri!x$ri#g$ri%[$ri%_$ri%z$ri~P%SOV&OOopOvqO~P'vOV&OOo0cOv0qO#g%ha%[%ha%_%ha%z%ha~P'vOz+aO#g%ha%[%ha%_%ha%z%ha~Oz$ia#g$ia%[$ia%_$ian$ia~P%SO#g&Pi%[&Pi%_&Pin&Pi~P'vOz+dO#g#Wq%[#Wq%_#Wq~O#[+eOz$va#g$va%[$va%_$vag$va~O%uWO#g&ri%[&ri%_&rig&ri~Oz+gO#g&ri%[&ri%_&rig&ri~OV+iOh$WO%uWO~O%uWO#g&ti%[&ti%_&ti~Oo0cOv0qO#g&pi%[&pi%_&pi{&pi~P'vO{#{Oz#eX!W#eX~Oz+mO!W&uX~O!W+oO~Ot+rO#j)gOP#hqV#hqf#hqh#hqo#hqs#hqv#hq!P#hq!Q#hq!T#hq!U#hq!X#hq!]#hq!h#hq!r#hq!s#hq!t#hq!{#hq!}#hq#P#hq#R#hq#T#hq#X#hq#Z#hq#^#hq#_#hq#a#hq#c#hq#l#hq#o#hq#s#hq#u#hq#z#hq#}#hq$P#hq%X#hq%o#hq%p#hq%t#hq%u#hq&Z#hq&[#hq&]#hq&^#hq&_#hq&`#hq&a#hq&b#hq&c#hq&d#hq&e#hq&f#hq&g#hq&h#hq&i#hq&j#hq%Z#hq%_#hq~On$|az$|a~P%SOV)kOn&wi~P'vOz+yOn&wi~Oz,TO{$jO#[,TO~O#q,VOP#nqV#nqf#nqh#nqo#nqs#nqv#nq!P#nq!Q#nq!T#nq!U#nq!X#nq!]#nq!h#nq!r#nq!s#nq!t#nq!{#nq!}#nq#P#nq#R#nq#T#nq#X#nq#Z#nq#^#nq#_#nq#a#nq#c#nq#l#nq#o#nq#s#nq#u#nq#z#nq#}#nq$P#nq%X#nq%o#nq%p#nq%t#nq%u#nq&Z#nq&[#nq&]#nq&^#nq&_#nq&`#nq&a#nq&b#nq&c#nq&d#nq&e#nq&f#nq&g#nq&h#nq&i#nq&j#nq%Z#nq%_#nq~O#[,WOz%Oa{%Oa~Oo0cOv0qO{&xi~P'vOz,YO{&xi~O{#{O%z,[Og&zXz&zX~O%uWOg&zXz&zX~Oz,`Og&yX~Og,bO~O%Y,eO~O!T%dO!U%cOg&Viz&Vi~OV$}Oa$}Oo0cOv0qOg&Ui~P'vO{,hOz$la!W$la~Oo0cOv0qO{,iOz$la!W$la~P'vOo0cOv0qO{*gO!W&Xi~P'vOz,lO!W&Xi~Oo0cOv0qOz,lO!W&Xi~P'vOz,lO{,oO!W&Xi~Og$hiz$hi!W$hi~P%SOV'|Oo0cOv0qO~P'vOn,qO~OV'|Og,rOo0cOv0qO~P'vOV'|Oo0cOv0qO!W&Sq~P'vOz$gi![$gi#g$gi%[$gi%_$gig$gi{$gi!m$gi%z$gi~P%SOV(]Oo0cOv0qO~P'vOa+QOo0cOv0qO![&Tq~P'vOz,sO![&Tq~O![,tO~OV(]Oo0cOv0qO![%}q#g%}q%[%}q%_%}qg%}q{%}q!m%}q%z%}q~P'vO{,uO~OV+UOo0cOv0qO{&li![&li!m&li%z&li~P'vOz,zO{&li![&li!m&li%z&li~O!]+YO&n+[O![!na~O{(kO![,}O~OV&OOo0cOv0qO#g%hi%[%hi%_%hi%z%hi~P'vOz-OO#g%hi%[%hi%_%hi%z%hi~O%uWO#g&rq%[&rq%_&rqg&rq~Oz-RO#g&rq%[&rq%_&rqg&rq~OV)`Oa)`O%uWO!W&ua~Oz-TO!W&ua~On$|iz$|i~P%SOV)kO~P'vOV)kOn&wq~P'vOt-XOP#myV#myf#myh#myo#mys#myv#my!P#my!Q#my!T#my!U#my!X#my!]#my!h#my!r#my!s#my!t#my!{#my!}#my#P#my#R#my#T#my#X#my#Z#my#^#my#_#my#a#my#c#my#l#my#o#my#s#my#u#my#z#my#}#my$P#my%X#my%o#my%p#my%t#my%u#my&Z#my&[#my&]#my&^#my&_#my&`#my&a#my&b#my&c#my&d#my&e#my&f#my&g#my&h#my&i#my&j#my%Z#my%_#my~O%Z-]O%_-]O~P`O#q-^OP#nyV#nyf#nyh#nyo#nys#nyv#ny!P#ny!Q#ny!T#ny!U#ny!X#ny!]#ny!h#ny!r#ny!s#ny!t#ny!{#ny!}#ny#P#ny#R#ny#T#ny#X#ny#Z#ny#^#ny#_#ny#a#ny#c#ny#l#ny#o#ny#s#ny#u#ny#z#ny#}#ny$P#ny%X#ny%o#ny%p#ny%t#ny%u#ny&Z#ny&[#ny&]#ny&^#ny&_#ny&`#ny&a#ny&b#ny&c#ny&d#ny&e#ny&f#ny&g#ny&h#ny&i#ny&j#ny%Z#ny%_#ny~Oz-aO{$jO#[-aO~Oo0cOv0qO{&xq~P'vOz-dO{&xq~O%z,[Og&zaz&za~O{#{Og&zaz&za~OV*SOa*TO%q*UO%uWOg&ya~Oz-hOg&ya~O$S-lO~OV$}Oa$}Oo0cOv0qO~P'vOo0cOv0qO{-mOz$li!W$li~P'vOo0cOv0qOz$li!W$li~P'vO{-mOz$li!W$li~Oo0cOv0qO{*gO~P'vOo0cOv0qO{*gO!W&Xq~P'vOz-pO!W&Xq~Oo0cOv0qOz-pO!W&Xq~P'vOs-sO!T%dO!U%cOg&Oq!W&Oq![&Oqz&Oq~P!/jOa+QOo0cOv0qO![&Ty~P'vOz$ji![$ji~P%SOa+QOo0cOv0qO~P'vOV+UOo0cOv0qO~P'vOV+UOo0cOv0qO{&lq![&lq!m&lq%z&lq~P'vO{(kO![-xO!m-yO%z-wO~OV&OOo0cOv0qO#g%hq%[%hq%_%hq%z%hq~P'vO%uWO#g&ry%[&ry%_&ryg&ry~OV)`Oa)`O%uWO!W&ui~Ot-}OP#m!RV#m!Rf#m!Rh#m!Ro#m!Rs#m!Rv#m!R!P#m!R!Q#m!R!T#m!R!U#m!R!X#m!R!]#m!R!h#m!R!r#m!R!s#m!R!t#m!R!{#m!R!}#m!R#P#m!R#R#m!R#T#m!R#X#m!R#Z#m!R#^#m!R#_#m!R#a#m!R#c#m!R#l#m!R#o#m!R#s#m!R#u#m!R#z#m!R#}#m!R$P#m!R%X#m!R%o#m!R%p#m!R%t#m!R%u#m!R&Z#m!R&[#m!R&]#m!R&^#m!R&_#m!R&`#m!R&a#m!R&b#m!R&c#m!R&d#m!R&e#m!R&f#m!R&g#m!R&h#m!R&i#m!R&j#m!R%Z#m!R%_#m!R~Oo0cOv0qO{&xy~P'vOV*SOa*TO%q*UO%uWOg&yi~O$S-lO%Z.VO%_.VO~OV.aOh._O!X.^O!].`O!h.YO!s.[O!t.[O%p.XO%uWO&Z]O&[]O&]]O&^]O&_]O&`]O&a]O&b]O~Oo0cOv0qOz$lq!W$lq~P'vO{.fOz$lq!W$lq~Oo0cOv0qO{*gO!W&Xy~P'vOz.gO!W&Xy~Oo0cOv.kO~P'vOs-sO!T%dO!U%cOg&Oy!W&Oy![&Oyz&Oy~P!/jO{(kO![.nO~O{(kO![.nO!m.oO~OV*SOa*TO%q*UO%uWO~Oh.tO!f.rOz$TX#[$TX%j$TXg$TX~Os$TX{$TX!W$TX![$TX~P$-bO%o.vO%p.vOs$UXz$UX{$UX#[$UX%j$UX!W$UXg$UX![$UX~O!h.xO~Oz.|O#[/OO%j.yOs&|X{&|X!W&|Xg&|X~Oa/RO~P$)zOh.tOs&}Xz&}X{&}X#[&}X%j&}X!W&}Xg&}X![&}X~Os/VO{$jO~Oo0cOv0qOz$ly!W$ly~P'vOo0cOv0qO{*gO!W&X!R~P'vOz/ZO!W&X!R~Og&RXs&RX!T&RX!U&RX!W&RX![&RXz&RX~P!/jOs-sO!T%dO!U%cOg&Qa!W&Qa![&Qaz&Qa~O{(kO![/^O~O!f.rOh$[as$[az$[a{$[a#[$[a%j$[a!W$[ag$[a![$[a~O!h/eO~O%o.vO%p.vOs$Uaz$Ua{$Ua#[$Ua%j$Ua!W$Uag$Ua![$Ua~O%j.yOs$Yaz$Ya{$Ya#[$Ya!W$Yag$Ya![$Ya~Os&|a{&|a!W&|ag&|a~P$)nOz/jOs&|a{&|a!W&|ag&|a~O!W/mO~Og/mO~O{/oO~O![/pO~Oo0cOv0qO{*gO!W&X!Z~P'vO{/sO~O%z/tO~P$-bOz/uO#[/OO%j.yOg'PX~Oz/uOg'PX~Og/wO~O!h/xO~O#[/OOs%Saz%Sa{%Sa%j%Sa!W%Sag%Sa![%Sa~O#[/OO%j.yOs%Waz%Wa{%Wa!W%Wag%Wa~Os&|i{&|i!W&|ig&|i~P$)nOz/zO#[/OO%j.yO!['Oa~Og'Pa~P$)nOz0SOg'Pa~Oa0UO!['Oi~P$)zOz0WO!['Oi~Oz0WO#[/OO%j.yO!['Oi~O#[/OO%j.yOg$biz$bi~O%z0ZO~P$-bO#[/OO%j.yOg%Vaz%Va~Og'Pi~P$)nO{0^O~Oa0UO!['Oq~P$)zOz0`O!['Oq~O#[/OO%j.yOz%Ui![%Ui~Oa0UO~P$)zOa0UO!['Oy~P$)zO#[/OO%j.yOg$ciz$ci~O#[/OO%j.yOz%Uq![%Uq~Oz+aO#g%ha%[%ha%_%ha%z%ha~P%SOV&OOo0cOv0qO~P'vOn0hO~Oo0hO~P'vO{0iO~Ot0jO~P!/jO&]&Z&j&h&i&g&f&d&e&c&b&`&a&_&^&[%u~",goto:"!=j'QPPPPPP'RP'Z*s+[+t,_,y-fP.SP'Z.r.r'ZPPP'Z2[PPPPPP2[5PPP5PP7b7k=sPP=v>h>kPP'Z'ZPP>zPP'Z'ZPP'Z'Z'Z'Z'Z?O?w'ZP?zP@QDXGuGyPG|HWH['ZPPPH_Hk'RP'R'RP'RP'RP'RP'RP'R'R'RP'RPP'RPP'RP'RPHqH}IVPI^IdPI^PI^I^PPPI^PKrPK{LVL]KrPI^LfPI^PLmLsPLwM]MzNeLwLwNkNxLwLwLwLw! ^! d! g! l! o! y!!P!!]!!o!!u!#P!#V!#s!#y!$P!$Z!$a!$g!$y!%T!%Z!%a!%k!%q!%w!%}!&T!&Z!&e!&k!&u!&{!'U!'[!'k!'s!'}!(UPPPPPPPPPPP!([!(_!(e!(n!(x!)TPPPPPPPPPPPP!-u!/Z!3^!6oPP!6w!7W!7a!8Y!8P!8c!8i!8l!8o!8r!8z!9jPPPPPPPPPPPPPPPPP!9m!9q!9wP!:]!:a!:m!:v!;S!;j!;m!;p!;v!;|!<S!<VP!<_!<h!=d!=g]eOn#g$j)t,P'}`OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0r{!cQ#c#p$R$d$p%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g}!dQ#c#p$R$d$p$u%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!P!eQ#c#p$R$d$p$u$v%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!R!fQ#c#p$R$d$p$u$v$w%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!T!gQ#c#p$R$d$p$u$v$w$x%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!V!hQ#c#p$R$d$p$u$v$w$x$y%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g!Z!hQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v0g'}TOTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0r&eVOYZ[dnprxy}!P!Q!U!i!k!o!p!q!s!t#[#d#g#y#{#}$Q$h$j$}%S%Z%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0n0r%oXOYZ[dnrxy}!P!Q!U!i!k#[#d#g#y#{#}$Q$h$j$}%S%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,s,u,w,y,z-O-d-f-m-p.f.g/V/Z0i0j0kQ#vqQ/[.kR0o0q't`OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rh#jhz{$W$Z&l&q)S)X+f+g-RW#rq&].k0qQ$]|Q$a!OQ$n!VQ$o!WW$|!i'm*d,gS&[#s#tQ'S$iQ(s&UQ)U&nU)Y&s)Z+jW)a&w+m-T-{Q*Q']W*R'_,`-h.TQ+l)`S,_*S*TQ-Q+eQ-_,TQ-c,WQ.R-al.W-l.^._.a.z.|/R/j/o/t/y0U0Z0^Q/S.`Q/a.tQ/l/OU0P/u0S0[X0V/z0W0_0`R&Z#r!_!wYZ!P!Q!k%S%`%g'p'r's(O(W)g*g*h*k*q*t*v,h,i,k,l,o-m-p.f.g/ZR%^!vQ!{YQ%x#[Q&d#}Q&g$QR,{+YT.j-s/s!Y!jQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v0gQ&X#kQ'c$oR*^'dR'l$|Q%V!mR/_.r'|_OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rS#a_#b!P.[-l.^._.`.a.t.z.|/R/j/o/t/u/y/z0S0U0W0Z0[0^0_0`'|_OTYZ[adnoprtxy}!P!Q!R!U!X!c!d!e!f!g!h!i!k!o!p!q!s!t!z#O#S#T#[#d#g#x#y#{#}$Q$e$g$h$j$q$}%S%Z%^%`%c%g%l%n%w%|&O&Z&_&h&j&k&u&x&|'P'W'Z'l'm'p'r's'w'|(O(S(W(](^(d(g(p(r(z(})^)e)g)k)l)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+Q+U+V+Y+a+c+d+k+x+y,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0l0n0rT#a_#bT#^^#_R(o%xa(l%x(n(o+`,{-y-z.oT+[(k+]R-z,{Q$PsQ+l)aQ,^*RR-e,_X#}s$O$P&fQ&y$aQ'a$nQ'd$oR)s'SQ)b&wV-S+m-T-{ZgOn$j)t,PXkOn)t,PQ$k!TQ&z$bQ&{$cQ'^$mQ'b$oQ)q'RQ)x'WQ){'XQ)|'YQ*Z'`S*]'c'dQ+s)gQ+u)hQ+v)iQ+z)oS+|)r*[Q,Q)vQ,R)wS,S)y)zQ,d*^Q-V+rQ-W+tQ-Y+{S-Z+},OQ-`,UQ-b,VQ-|-XQ.O-[Q.P-^Q.Q-_Q.p-}Q.q.RQ/W.dR/r/XWkOn)t,PR#mjQ'`$nS)r'S'aR,O)sQ,]*RR-f,^Q*['`Q+})rR-[,OZiOjn)t,PQ'f$pR*`'gT-j,e-ku.c-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^t.c-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^Q/S.`X0V/z0W0_0`!P.Z-l.^._.`.a.t.z.|/R/j/o/t/u/y/z0S0U0W0Z0[0^0_0`Q.w.YR/f.xg.z.].{/b/i/n/|0O0Q0]0a0bu.b-l.^._.a.t.z.|/R/j/o/t/u/y0S0U0Z0[0^X.u.W.b/a0PR/c.tV0R/u0S0[R/X.dQnOS#on,PR,P)tQ&^#uR(x&^S%m#R#wS(_%m(bT(b%p&`Q%a!yQ%h!}W(P%a%h(U(YQ(U%eR(Y%jQ&i$RR)O&iQ(e%qQ*{(`T+R(e*{Q'n%OR*e'nS'q%R%SY*i'q*j,m-q.hU*j'r's'tU,m*k*l*mS-q,n,oR.h-rQ#Y]R%t#YQ#_^R%y#_Q(h%vS+W(h+XR+X(iQ+](kR,|+]Q#b_R%{#bQ#ebQ%}#cW&Q#e%}({+bQ({&cR+b0gQ$OsS&e$O&fR&f$PQ&v$_R)_&vQ&V#jR(t&VQ&m$VS)T&m+hR+h)UQ$Z{R&p$ZQ&t$]R)[&tQ+n)bR-U+nQ#hfR&S#hQ)f&zR+q)fQ&}$dS)m&})nR)n'OQ'V$kR)u'VQ'[$lS*P'[,ZR,Z*QQ,a*VR-i,aWjOn)t,PR#ljQ-k,eR.U-kd.{.]/b/i/n/|0O0Q0]0a0bR/h.{U.s.W/a0PR/`.sQ/{/nS0X/{0YR0Y/|S/v/b/cR0T/vQ.}.]R/k.}R!ZPXmOn)t,PWlOn)t,PR'T$jYfOn$j)t,PR&R#g[sOn#g$j)t,PR&d#}&dQOYZ[dnprxy}!P!Q!U!i!k!o!p!q!s!t#[#d#g#y#{#}$Q$h$j$}%S%Z%^%`%g%l%n%w%|&Z&_&j&k&u&x'P'W'Z'l'm'p'r's'w(O(W(^(d(g(p(r(z)^)e)g)p)t)z*O*Y*d*g*h*k*q*r*t*v*y*z*}+U+V+Y+a+d+k,P,X,Y,],g,h,i,k,l,o,q,s,u,w,y,z-O-d-f-m-p-s.f.g/V/Z/s0c0d0e0f0h0i0j0k0n0rQ!nTQ#caQ#poU$Rt%c(SS$d!R$gQ$p!XQ$u!cQ$v!dQ$w!eQ$x!fQ$y!gQ$z!hQ%e!zQ%j#OQ%p#SQ%q#TQ&`#xQ'O$eQ'g$qQ(q&OU(|&h(}+cW)j&|)l+x+yQ*o'|Q*x(]Q+w)kQ,v+QR0g0lQ!yYQ!}ZQ$b!PQ$c!QQ%R!kQ't%S^'{%`%g(O(W*q*t*v^*f'p*h,k,l-p.g/ZQ*l'rQ*m'sQ+t)gQ,j*gQ,n*kQ-n,hQ-o,iQ-r,oQ.e-mR/Y.f[bOn#g$j)t,P!^!vYZ!P!Q!k%S%`%g'p'r's(O(W)g*g*h*k*q*t*v,h,i,k,l,o-m-p.f.g/ZQ#R[Q#fdS#wrxQ$UyW$_}$Q'P)pS$l!U$hW${!i'm*d,gS%v#[+Y`&P#d%|(p(r(z+a-O0kQ&a#yQ&b#{Q&c#}Q'j$}Q'z%^W([%l(^*y*}Q(`%nQ(i%wQ(v&ZS(y&_0iQ)P&jQ)Q&kU)]&u)^+kQ)d&xQ)y'WY)}'Z*O,X,Y-dQ*b'lS*n'w0jW+P(d*z,s,wW+T(g+V,y,zQ+p)eQ,U)zQ,c*YQ,x+UQ-P+dQ-e,]Q-v,uQ.S-fR/q/VhUOn#d#g$j%|&_'w(p(r)t,P%U!uYZ[drxy}!P!Q!U!i!k#[#y#{#}$Q$h$}%S%^%`%g%l%n%w&Z&j&k&u&x'P'W'Z'l'm'p'r's(O(W(^(d(g(z)^)e)g)p)z*O*Y*d*g*h*k*q*t*v*y*z*}+U+V+Y+a+d+k,X,Y,],g,h,i,k,l,o,s,u,w,y,z-O-d-f-m-p.f.g/V/Z0i0j0kQ#qpW%W!o!s0d0nQ%X!pQ%Y!qQ%[!tQ%f0cS'v%Z0hQ'x0eQ'y0fQ,p*rQ-u,qS.i-s/sR0p0rU#uq.k0qR(w&][cOn#g$j)t,PZ!xY#[#}$Q+YQ#W[Q#zrR$TxQ%b!yQ%i!}Q%o#RQ'j${Q(V%eQ(Z%jQ(c%pQ(f%qQ*|(`Q,f*bQ-t,pQ.m-uR/].lQ$StQ(R%cR*s(SQ.l-sR/}/sR#QZR#V[R%Q!iQ%O!iV*c'm*d,g!Z!lQ!n#c#p$R$d$p$u$v$w$x$y$z%e%j%p%q&`'O'g(q(|)j*o*x+w,v0gR%T!kT#]^#_Q%x#[R,{+YQ(m%xS+_(n(oQ,}+`Q-x,{S.n-y-zR/^.oT+Z(k+]Q$`}Q&g$QQ)o'PR+{)pQ$XzQ)W&qR+i)XQ$XzQ&o$WQ)W&qR+i)XQ#khW$Vz$W&q)XQ$[{Q&r$ZZ)R&l)S+f+g-RR$^|R)c&wXlOn)t,PQ$f!RR'Q$gQ$m!UR'R$hR*X'_Q*V'_V-g,`-h.TQ.d-lQ/P.^R/Q._U.]-l.^._Q/U.aQ/b.tQ/g.zU/i.|/j/yQ/n/RQ/|/oQ0O/tU0Q/u0S0[Q0]0UQ0a0ZR0b0^R/T.`R/d.t",nodeNames:" print Escape { Comment Script AssignStatement * BinaryExpression BitOp BitOp BitOp BitOp ArithOp ArithOp @ ArithOp ** UnaryExpression ArithOp BitOp AwaitExpression await ) ( ParenthesizedExpression BinaryExpression or and CompareOp in not is UnaryExpression ConditionalExpression if else LambdaExpression lambda ParamList VariableName AssignOp , : NamedExpression AssignOp YieldExpression yield from TupleExpression ComprehensionExpression async for LambdaExpression ] [ ArrayExpression ArrayComprehensionExpression } { DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression CallExpression ArgList AssignOp MemberExpression . PropertyName Number String FormatString FormatReplacement FormatSelfDoc FormatConversion FormatSpec FormatReplacement FormatSelfDoc ContinuedString Ellipsis None Boolean TypeDef AssignOp UpdateStatement UpdateOp ExpressionStatement DeleteStatement del PassStatement pass BreakStatement break ContinueStatement continue ReturnStatement return YieldStatement PrintStatement RaiseStatement raise ImportStatement import as ScopeStatement global nonlocal AssertStatement assert TypeDefinition type TypeParamList TypeParam StatementGroup ; IfStatement Body elif WhileStatement while ForStatement TryStatement try except finally WithStatement with FunctionDefinition def ParamList AssignOp TypeDef ClassDefinition class DecoratedStatement Decorator At MatchStatement match MatchBody MatchClause case CapturePattern LiteralPattern ArithOp ArithOp AsPattern OrPattern LogicOp AttributePattern SequencePattern MappingPattern StarPattern ClassPattern PatternArgList KeywordPattern KeywordPattern Guard",maxTerm:277,context:Vz,nodeProps:[["isolate",-5,4,71,72,73,77,""],["group",-15,6,85,87,88,90,92,94,96,98,99,100,102,105,108,110,"Statement Statement",-22,8,18,21,25,40,49,50,56,57,60,61,62,63,64,67,70,71,72,79,80,81,82,"Expression",-10,114,116,119,121,122,126,128,133,135,138,"Statement",-9,143,144,147,148,150,151,152,153,154,"Pattern"],["openedBy",23,"(",54,"[",58,"{"],["closedBy",24,")",55,"]",59,"}"]],propSources:[Gz],skippedNodes:[0,4],repeatNodeCount:34,tokenData:"!2|~R!`OX%TXY%oY[%T[]%o]p%Tpq%oqr'ars)Yst*xtu%Tuv,dvw-hwx.Uxy/tyz0[z{0r{|2S|}2p}!O3W!O!P4_!P!Q:Z!Q!R;k!R![>_![!]Do!]!^Es!^!_FZ!_!`Gk!`!aHX!a!b%T!b!cIf!c!dJU!d!eK^!e!hJU!h!i!#f!i!tJU!t!u!,|!u!wJU!w!x!.t!x!}JU!}#O!0S#O#P&o#P#Q!0j#Q#R!1Q#R#SJU#S#T%T#T#UJU#U#VK^#V#YJU#Y#Z!#f#Z#fJU#f#g!,|#g#iJU#i#j!.t#j#oJU#o#p!1n#p#q!1s#q#r!2a#r#s!2f#s$g%T$g;'SJU;'S;=`KW<%lOJU`%YT&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T`%lP;=`<%l%To%v]&n`%c_OX%TXY%oY[%T[]%o]p%Tpq%oq#O%T#O#P&o#P#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To&tX&n`OY%TYZ%oZ]%T]^%o^#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc'f[&n`O!_%T!_!`([!`#T%T#T#U(r#U#f%T#f#g(r#g#h(r#h#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc(cTmR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc(yT!mR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk)aV&n`&[ZOr%Trs)vs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk){V&n`Or%Trs*bs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk*iT&n`&^ZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To+PZS_&n`OY*xYZ%TZ]*x]^%T^#o*x#o#p+r#p#q*x#q#r+r#r;'S*x;'S;=`,^<%lO*x_+wTS_OY+rZ]+r^;'S+r;'S;=`,W<%lO+r_,ZP;=`<%l+ro,aP;=`<%l*xj,kV%rQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj-XT!xY&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj-oV%lQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk.]V&n`&ZZOw%Twx.rx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk.wV&n`Ow%Twx/^x#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk/eT&n`&]ZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk/{ThZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc0cTgR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk0yXVZ&n`Oz%Tz{1f{!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk1mVaR&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk2ZV%oZ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc2wTzR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To3_W%pZ&n`O!_%T!_!`-Q!`!a3w!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Td4OT&{S&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk4fX!fQ&n`O!O%T!O!P5R!P!Q%T!Q![6T![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk5WV&n`O!O%T!O!P5m!P#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk5tT!rZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti6[a!hX&n`O!Q%T!Q![6T![!g%T!g!h7a!h!l%T!l!m9s!m#R%T#R#S6T#S#X%T#X#Y7a#Y#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti7fZ&n`O{%T{|8X|}%T}!O8X!O!Q%T!Q![8s![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti8^V&n`O!Q%T!Q![8s![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti8z]!hX&n`O!Q%T!Q![8s![!l%T!l!m9s!m#R%T#R#S8s#S#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti9zT!hX&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk:bX%qR&n`O!P%T!P!Q:}!Q!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj;UV%sQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti;ro!hX&n`O!O%T!O!P=s!P!Q%T!Q![>_![!d%T!d!e?q!e!g%T!g!h7a!h!l%T!l!m9s!m!q%T!q!rA]!r!z%T!z!{Bq!{#R%T#R#S>_#S#U%T#U#V?q#V#X%T#X#Y7a#Y#^%T#^#_9s#_#c%T#c#dA]#d#l%T#l#mBq#m#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti=xV&n`O!Q%T!Q![6T![#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti>fc!hX&n`O!O%T!O!P=s!P!Q%T!Q![>_![!g%T!g!h7a!h!l%T!l!m9s!m#R%T#R#S>_#S#X%T#X#Y7a#Y#^%T#^#_9s#_#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti?vY&n`O!Q%T!Q!R@f!R!S@f!S#R%T#R#S@f#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Ti@mY!hX&n`O!Q%T!Q!R@f!R!S@f!S#R%T#R#S@f#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiAbX&n`O!Q%T!Q!YA}!Y#R%T#R#SA}#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiBUX!hX&n`O!Q%T!Q!YA}!Y#R%T#R#SA}#S#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiBv]&n`O!Q%T!Q![Co![!c%T!c!iCo!i#R%T#R#SCo#S#T%T#T#ZCo#Z#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TiCv]!hX&n`O!Q%T!Q![Co![!c%T!c!iCo!i#R%T#R#SCo#S#T%T#T#ZCo#Z#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%ToDvV{_&n`O!_%T!_!`E]!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TcEdT%{R&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkEzT#gZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkFbXmR&n`O!^%T!^!_F}!_!`([!`!a([!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TjGUV%mQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkGrV%zZ&n`O!_%T!_!`([!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkH`WmR&n`O!_%T!_!`([!`!aHx!a#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TjIPV%nQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkIoV_Q#}P&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%ToJ_]&n`&YS%uZO!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUoKZP;=`<%lJUoKge&n`&YS%uZOr%Trs)Ysw%Twx.Ux!Q%T!Q![JU![!c%T!c!tJU!t!uLx!u!}JU!}#R%T#R#SJU#S#T%T#T#fJU#f#gLx#g#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUoMRa&n`&YS%uZOr%TrsNWsw%Twx! vx!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUkN_V&n`&`ZOr%TrsNts#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%TkNyV&n`Or%Trs! `s#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk! gT&n`&bZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk! }V&n`&_ZOw%Twx!!dx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!!iV&n`Ow%Twx!#Ox#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!#VT&n`&aZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!#oe&n`&YS%uZOr%Trs!%Qsw%Twx!&px!Q%T!Q![JU![!c%T!c!tJU!t!u!(`!u!}JU!}#R%T#R#SJU#S#T%T#T#fJU#f#g!(`#g#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!%XV&n`&dZOr%Trs!%ns#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!%sV&n`Or%Trs!&Ys#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!&aT&n`&fZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!&wV&n`&cZOw%Twx!'^x#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!'cV&n`Ow%Twx!'xx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!(PT&n`&eZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!(ia&n`&YS%uZOr%Trs!)nsw%Twx!+^x!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!)uV&n`&hZOr%Trs!*[s#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!*aV&n`Or%Trs!*vs#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!*}T&n`&jZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!+eV&n`&gZOw%Twx!+zx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!,PV&n`Ow%Twx!,fx#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tk!,mT&n`&iZO#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%To!-Vi&n`&YS%uZOr%TrsNWsw%Twx! vx!Q%T!Q![JU![!c%T!c!dJU!d!eLx!e!hJU!h!i!(`!i!}JU!}#R%T#R#SJU#S#T%T#T#UJU#U#VLx#V#YJU#Y#Z!(`#Z#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUo!.}a&n`&YS%uZOr%Trs)Ysw%Twx.Ux!Q%T!Q![JU![!c%T!c!}JU!}#R%T#R#SJU#S#T%T#T#oJU#p#q%T#r$g%T$g;'SJU;'S;=`KW<%lOJUk!0ZT!XZ&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tc!0qT!WR&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%Tj!1XV%kQ&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T~!1sO!]~k!1zV%jR&n`O!_%T!_!`-Q!`#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T~!2fO![~i!2mT%tX&n`O#o%T#p#q%T#r;'S%T;'S;=`%i<%lO%T",tokenizers:[$z,Hz,Qz,Uz,0,1,2,3,4],topRules:{Script:[0,5]},specialized:[{term:221,get:n=>Xz[n]||-1}],tokenPrec:7668}),tO=new pN,_E=new Set(["Script","Body","FunctionDefinition","ClassDefinition","LambdaExpression","ForStatement","MatchClause"]);function $d(n){return(e,t,r)=>{if(r)return!1;let i=e.node.getChild("VariableName");return i&&t(i,n),!0}}const Yz={FunctionDefinition:$d("function"),ClassDefinition:$d("class"),ForStatement(n,e,t){if(t){for(let r=n.node.firstChild;r;r=r.nextSibling)if(r.name=="VariableName")e(r,"variable");else if(r.name=="in")break}},ImportStatement(n,e){var t,r;let{node:i}=n,s=((t=i.firstChild)===null||t===void 0?void 0:t.name)=="from";for(let o=i.getChild("import");o;o=o.nextSibling)o.name=="VariableName"&&((r=o.nextSibling)===null||r===void 0?void 0:r.name)!="as"&&e(o,s?"variable":"namespace")},AssignStatement(n,e){for(let t=n.node.firstChild;t;t=t.nextSibling)if(t.name=="VariableName")e(t,"variable");else if(t.name==":"||t.name=="AssignOp")break},ParamList(n,e){for(let t=null,r=n.node.firstChild;r;r=r.nextSibling)r.name=="VariableName"&&(!t||!/\*|AssignOp/.test(t.name))&&e(r,"variable"),t=r},CapturePattern:$d("variable"),AsPattern:$d("variable"),__proto__:null};function OE(n,e){let t=tO.get(e);if(t)return t;let r=[],i=!0;function s(o,a){let u=n.sliceString(o.from,o.to);r.push({label:u,type:a})}return e.cursor(dn.IncludeAnonymous).iterate(o=>{if(o.name){let a=Yz[o.name];if(a&&a(o,s,i)||!i&&_E.has(o.name))return!1;i=!1}else if(o.to-o.from>8192){for(let a of OE(n,o.node))r.push(a);return!1}}),tO.set(e,r),r}const nO=/^[\w\xa1-\uffff][\w\d\xa1-\uffff]*$/,kE=["String","FormatString","Comment","PropertyName"];function Jz(n){let e=qn(n.state).resolveInner(n.pos,-1);if(kE.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&nO.test(n.state.sliceDoc(e.from,e.to));if(!t&&!n.explicit)return null;let r=[];for(let i=e;i;i=i.parent)_E.has(i.name)&&(r=r.concat(OE(n.state.doc,i)));return{options:r,from:t?e.from:n.pos,validFor:nO}}const e9=["__annotations__","__builtins__","__debug__","__doc__","__import__","__name__","__loader__","__package__","__spec__","False","None","True"].map(n=>({label:n,type:"constant"})).concat(["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EncodingWarning","EnvironmentError","Exception","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","ModuleNotFoundError","NameError","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError"].map(n=>({label:n,type:"type"}))).concat(["bool","bytearray","bytes","classmethod","complex","float","frozenset","int","list","map","memoryview","object","range","set","staticmethod","str","super","tuple","type"].map(n=>({label:n,type:"class"}))).concat(["abs","aiter","all","anext","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","license","locals","max","min","next","oct","open","ord","pow","print","property","quit","repr","reversed","round","setattr","slice","sorted","sum","vars","zip"].map(n=>({label:n,type:"function"}))),t9=[$s("def ${name}(${params}):\n	${}",{label:"def",detail:"function",type:"keyword"}),$s("for ${name} in ${collection}:\n	${}",{label:"for",detail:"loop",type:"keyword"}),$s("while ${}:\n	${}",{label:"while",detail:"loop",type:"keyword"}),$s("try:\n	${}\nexcept ${error}:\n	${}",{label:"try",detail:"/ except block",type:"keyword"}),$s(`if \${}:
	
`,{label:"if",detail:"block",type:"keyword"}),$s("if ${}:\n	${}\nelse:\n	${}",{label:"if",detail:"/ else block",type:"keyword"}),$s("class ${name}:\n	def __init__(self, ${params}):\n			${}",{label:"class",detail:"definition",type:"keyword"}),$s("import ${module}",{label:"import",detail:"statement",type:"keyword"}),$s("from ${module} import ${names}",{label:"from",detail:"import",type:"keyword"})],n9=iF(kE,JT(e9.concat(t9)));function Hx(n){let{node:e,pos:t}=n,r=n.lineIndent(t,-1),i=null;for(;;){let s=e.childBefore(t);if(s)if(s.name=="Comment")t=s.from;else if(s.name=="Body"||s.name=="MatchBody")n.baseIndentFor(s)+n.unit<=r&&(i=s),e=s;else if(s.name=="MatchClause")e=s;else if(s.type.is("Statement"))e=s;else break;else break}return i}function Wx(n,e){let t=n.baseIndentFor(e),r=n.lineAt(n.pos,-1),i=r.from+r.text.length;return/^\s*($|#)/.test(r.text)&&n.node.to<i+100&&!/\S/.test(n.state.sliceDoc(i,n.node.to))&&n.lineIndent(n.pos,-1)<=t||/^\s*(else:|elif |except |finally:|case\s+[^=:]+:)/.test(n.textAfter)&&n.lineIndent(n.pos,-1)>t?null:t+n.unit}const qx=pp.define({name:"python",parser:Kz.configure({props:[ZC.add({Body:n=>{var e;let t=/^\s*(#|$)/.test(n.textAfter)&&Hx(n)||n.node;return(e=Wx(n,t))!==null&&e!==void 0?e:n.continue()},MatchBody:n=>{var e;let t=Hx(n);return(e=Wx(n,t||n.node))!==null&&e!==void 0?e:n.continue()},IfStatement:n=>/^\s*(else:|elif )/.test(n.textAfter)?n.baseIndent:n.continue(),"ForStatement WhileStatement":n=>/^\s*else:/.test(n.textAfter)?n.baseIndent:n.continue(),TryStatement:n=>/^\s*(except[ :]|finally:|else:)/.test(n.textAfter)?n.baseIndent:n.continue(),MatchStatement:n=>/^\s*case /.test(n.textAfter)?n.baseIndent+n.unit:n.continue(),"TupleExpression ComprehensionExpression ParamList ArgList ParenthesizedExpression":Sx({closing:")"}),"DictionaryExpression DictionaryComprehensionExpression SetExpression SetComprehensionExpression":Sx({closing:"}"}),"ArrayExpression ArrayComprehensionExpression":Sx({closing:"]"}),MemberExpression:n=>n.baseIndent+n.unit,"String FormatString":()=>null,Script:n=>{var e;let t=Hx(n);return(e=t&&Wx(n,t))!==null&&e!==void 0?e:n.continue()}}),KC.add({"ArrayExpression DictionaryExpression SetExpression TupleExpression":zN,Body:(n,e)=>({from:n.from+1,to:n.to-(n.to==e.doc.length?0:1)}),"String FormatString":(n,e)=>({from:e.doc.lineAt(n.from).to,to:n.to})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"'''",'"""'],stringPrefixes:["f","fr","rf","r","u","b","br","rb","F","FR","RF","R","U","B","BR","RB"]},commentTokens:{line:"#"},indentOnInput:/^\s*([\}\]\)]|else:|elif |except |finally:|case\s+[^:]*:?)$/}});function r9(){return new TN(qx,[qx.data.of({autocomplete:Jz}),qx.data.of({autocomplete:n9})])}var i9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],s9=i9.reduce((n,e)=>{const t=gv(`Primitive.${e}`),r=R.forwardRef((i,s)=>{const{asChild:o,...a}=i,u=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),S.jsx(u,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{}),o9="Separator",rO="horizontal",a9=["horizontal","vertical"],SE=R.forwardRef((n,e)=>{const{decorative:t,orientation:r=rO,...i}=n,s=l9(r)?r:rO,a=t?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return S.jsx(s9.div,{"data-orientation":s,...a,...i,ref:e})});SE.displayName=o9;function l9(n){return a9.includes(n)}var CE=SE;const $o=R.forwardRef(({className:n,orientation:e="horizontal",decorative:t=!0,...r},i)=>S.jsx(CE,{ref:i,decorative:t,orientation:e,className:vt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",n),...r}));$o.displayName=CE.displayName;const Vx=[{name:"USA/Canada",freq:910.525,bw:62.5,sf:7,cr:5},{name:"Australia",freq:915.8,bw:250,sf:10,cr:5},{name:"Australia (narrow)",freq:916.575,bw:62.5,sf:7,cr:8},{name:"Australia SA, WA",freq:923.125,bw:62.5,sf:8,cr:8},{name:"Australia QLD",freq:923.125,bw:62.5,sf:8,cr:5},{name:"New Zealand",freq:917.375,bw:250,sf:11,cr:5},{name:"New Zealand (narrow)",freq:917.375,bw:62.5,sf:7,cr:5},{name:"EU/UK/Switzerland Long Range",freq:869.525,bw:250,sf:11,cr:5},{name:"EU/UK/Switzerland Medium Range",freq:869.525,bw:250,sf:10,cr:5},{name:"EU/UK/Switzerland Narrow",freq:869.618,bw:62.5,sf:8,cr:8},{name:"Czech Republic (Narrow)",freq:869.432,bw:62.5,sf:7,cr:5},{name:"EU 433MHz Long Range",freq:433.65,bw:250,sf:11,cr:5},{name:"Portugal 433MHz",freq:433.375,bw:62.5,sf:9,cr:6},{name:"Portugal 868MHz",freq:869.618,bw:62.5,sf:7,cr:6},{name:"Vietnam",freq:920.25,bw:250,sf:11,cr:5}];function c9({open:n,config:e,health:t,appSettings:r,onClose:i,onSave:s,onSaveAppSettings:o,onSetPrivateKey:a,onReboot:u,onAdvertise:f,onHealthRefresh:p,onRefreshAppSettings:g}){const[x,A]=R.useState("radio"),[_,b]=R.useState(""),[w,C]=R.useState(""),[T,E]=R.useState(""),[D,N]=R.useState(""),[F,z]=R.useState(""),[I,K]=R.useState(""),[W,U]=R.useState(""),[X,$]=R.useState(""),[ee,le]=R.useState(""),[Z,ie]=R.useState(""),[V,ne]=R.useState(!1),[q,B]=R.useState(!1),[Q,G]=R.useState(!1),[Y,ue]=R.useState(!1),[pe,ve]=R.useState(""),[xe,ye]=R.useState("14"),[Pe,Ke]=R.useState(!1),[nt,Ce]=R.useState(!1),[Ge,pt]=R.useState("0"),bt=`def bot(
    sender_name: str | None,
    sender_key: str | None,
    message_text: str,
    is_dm: bool,
    channel_key: str | None,
    channel_name: str | None,
    sender_timestamp: int | None,
    path: str | None,
) -> str | list[str] | None:
    """
    Process incoming messages and optionally return a reply.

    Args:
        sender_name: Display name of sender (may be None)
        sender_key: 64-char hex public key (None for channel msgs)
        message_text: The message content
        is_dm: True for direct messages, False for channel
        channel_key: 32-char hex key for channels, None for DMs
        channel_name: Channel name with hash (e.g. "#bot"), None for DMs
        sender_timestamp: Sender's timestamp (unix seconds, may be None)
        path: Hex-encoded routing path (may be None)

    Returns:
        None for no reply, a string for a single reply,
        or a list of strings to send multiple messages in order
    """
    # Example: Only respond in #bot channel to "!pling" command
    if channel_name == "#bot" and "!pling" in message_text.lower():
        return "[BOT] Plong!"
    return None`,[ot,mt]=R.useState([]),[et,tt]=R.useState(null),[at,qe]=R.useState(null),[Dt,Jt]=R.useState("");R.useEffect(()=>{e&&(b(e.name),C(String(e.lat)),E(String(e.lon)),N(String(e.tx_power)),z(String(e.radio.freq)),K(String(e.radio.bw)),U(String(e.radio.sf)),$(String(e.radio.cr)))},[e]),R.useEffect(()=>{r&&(ie(String(r.max_radio_contacts)),Ce(r.auto_decrypt_dm_on_advert),pt(String(r.advert_interval)),mt(r.bots||[]))},[r]),R.useEffect(()=>{n&&g()},[n,g]);const dr=R.useMemo(()=>{const ae=parseFloat(F),De=parseFloat(I),wt=parseInt(W,10),Gt=parseInt(X,10);for(const On of Vx)if(On.freq===ae&&On.bw===De&&On.sf===wt&&On.cr===Gt)return On.name;return"custom"},[F,I,W,X]),en=ae=>{if(ae==="custom")return;const De=Vx.find(wt=>wt.name===ae);De&&(z(String(De.freq)),K(String(De.bw)),U(String(De.sf)),$(String(De.cr)))},vn=()=>{if(!navigator.geolocation){kt.error("Geolocation not supported",{description:"Your browser does not support geolocation"});return}ue(!0),navigator.geolocation.getCurrentPosition(ae=>{C(ae.coords.latitude.toFixed(6)),E(ae.coords.longitude.toFixed(6)),ue(!1),kt.success("Location updated")},ae=>{ue(!1),kt.error("Failed to get location",{description:ae.message})},{enableHighAccuracy:!0,timeout:1e4})},En=async()=>{ve(""),ne(!0);try{const ae={lat:parseFloat(w),lon:parseFloat(T),tx_power:parseInt(D,10),radio:{freq:parseFloat(F),bw:parseFloat(I),sf:parseInt(W,10),cr:parseInt(X,10)}};await s(ae),kt.success("Radio config saved, rebooting..."),ne(!1),B(!0),await u(),i()}catch(ae){ve(ae instanceof Error?ae.message:"Failed to save"),ne(!1)}finally{B(!1)}},Zn=async()=>{ve(""),ne(!0);try{await s({name:_});const De=parseInt(Ge,10);!isNaN(De)&&De!==(r==null?void 0:r.advert_interval)&&await o({advert_interval:De}),kt.success("Identity settings saved")}catch(ae){ve(ae instanceof Error?ae.message:"Failed to save")}finally{ne(!1)}},rn=async()=>{ve(""),ne(!0);try{const ae=parseInt(Z,10);!isNaN(ae)&&ae!==(r==null?void 0:r.max_radio_contacts)&&await o({max_radio_contacts:ae}),kt.success("Serial settings saved")}catch(ae){ve(ae instanceof Error?ae.message:"Failed to save")}finally{ne(!1)}},Qt=async()=>{if(!ee.trim()){ve("Private key is required");return}ve(""),ne(!0);try{await a(ee.trim()),le(""),kt.success("Private key set, rebooting..."),ne(!1),B(!0),await u(),i()}catch(ae){ve(ae instanceof Error?ae.message:"Failed to set private key"),ne(!1)}finally{B(!1)}},sn=async()=>{if(confirm("Are you sure you want to reboot the radio? The connection will drop temporarily.")){ve(""),B(!0);try{await u(),i()}catch(ae){ve(ae instanceof Error?ae.message:"Failed to reboot radio")}finally{B(!1)}}},pr=async()=>{G(!0);try{await f()}finally{G(!1)}},zn=async()=>{const ae=parseInt(xe,10);if(isNaN(ae)||ae<1){kt.error("Invalid retention days",{description:"Retention days must be at least 1"});return}Ke(!0);try{const De=await dt.runMaintenance(ae);kt.success("Database cleanup complete",{description:`Deleted ${De.packets_deleted} old packet${De.packets_deleted===1?"":"s"}`}),await p()}catch(De){console.error("Failed to run maintenance:",De),kt.error("Database cleanup failed",{description:De instanceof Error?De.message:"Unknown error"})}finally{Ke(!1)}},Ae=async()=>{ne(!0),ve("");try{await o({auto_decrypt_dm_on_advert:nt}),kt.success("Database settings saved")}catch(ae){console.error("Failed to save database settings:",ae),ve(ae instanceof Error?ae.message:"Failed to save"),kt.error("Failed to save settings")}finally{ne(!1)}},Te=async()=>{ne(!0),ve("");try{await o({bots:ot}),kt.success("Bot settings saved")}catch(ae){console.error("Failed to save bot settings:",ae);const De=ae instanceof Error?ae.message:"Failed to save";ve(De),kt.error(De)}finally{ne(!1)}},Ie=()=>{const ae={id:crypto.randomUUID(),name:`Bot ${ot.length+1}`,enabled:!1,code:bt};mt([...ot,ae]),tt(ae.id)},xt=ae=>{const De=ot.find(wt=>wt.id===ae);De&&De.code.trim()&&De.code!==bt&&!confirm(`Delete "${De.name}"? This will remove all its code.`)||(mt(ot.filter(wt=>wt.id!==ae)),et===ae&&tt(null))},se=ae=>{mt(ot.map(De=>De.id===ae?{...De,enabled:!De.enabled}:De))},be=(ae,De)=>{mt(ot.map(wt=>wt.id===ae?{...wt,code:De}:wt))},Oe=ae=>{qe(ae.id),Jt(ae.name)},Le=()=>{at&&Dt.trim()&&mt(ot.map(ae=>ae.id===at?{...ae,name:Dt.trim()}:ae)),qe(null),Jt("")},lt=ae=>{mt(ot.map(De=>De.id===ae?{...De,code:bt}:De))};return S.jsx(bv,{open:n,onOpenChange:ae=>!ae&&i(),children:S.jsxs(qp,{className:"sm:max-w-[50vw] sm:min-w-[500px] max-h-[90vh] overflow-y-auto",children:[S.jsxs(Vp,{children:[S.jsx($p,{children:"Radio & Settings"}),S.jsxs(Up,{className:"sr-only",children:[x==="radio"&&"Configure radio frequency, power, and location settings",x==="identity"&&"Manage radio name, public key, private key, and advertising settings",x==="serial"&&"View serial port connection and configure contact sync",x==="database"&&"View database statistics and clean up old packets",x==="advertise"&&"Send a flood advertisement to announce your presence",x==="bot"&&"Configure automatic message bot with Python code"]})]}),e?S.jsxs(Ov,{value:x,onValueChange:ae=>A(ae),className:"w-full",children:[S.jsxs(Gp,{className:"grid w-full grid-cols-6",children:[S.jsx(ni,{value:"radio",children:"Radio"}),S.jsx(ni,{value:"identity",children:"Identity"}),S.jsx(ni,{value:"serial",children:"Serial"}),S.jsx(ni,{value:"database",children:"Database"}),S.jsx(ni,{value:"advertise",children:"Advertise"}),S.jsx(ni,{value:"bot",children:"Bot"})]}),S.jsxs(ri,{value:"radio",className:"space-y-4 mt-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"preset",children:"Preset"}),S.jsxs("select",{id:"preset",value:dr,onChange:ae=>en(ae.target.value),className:"w-full h-10 px-3 rounded-md border border-input bg-background text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[S.jsx("option",{value:"custom",children:"Custom"}),Vx.map(ae=>S.jsx("option",{value:ae.name,children:ae.name},ae.name))]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"freq",children:"Frequency (MHz)"}),S.jsx(xn,{id:"freq",type:"number",step:"any",value:F,onChange:ae=>z(ae.target.value)})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"bw",children:"Bandwidth (kHz)"}),S.jsx(xn,{id:"bw",type:"number",step:"any",value:I,onChange:ae=>K(ae.target.value)})]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"sf",children:"Spreading Factor"}),S.jsx(xn,{id:"sf",type:"number",min:"7",max:"12",value:W,onChange:ae=>U(ae.target.value)})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"cr",children:"Coding Rate"}),S.jsx(xn,{id:"cr",type:"number",min:"5",max:"8",value:X,onChange:ae=>$(ae.target.value)})]})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"tx-power",children:"TX Power (dBm)"}),S.jsx(xn,{id:"tx-power",type:"number",value:D,onChange:ae=>N(ae.target.value)})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"max-tx",children:"Max TX Power"}),S.jsx(xn,{id:"max-tx",type:"number",value:e.max_tx_power,disabled:!0})]})]}),S.jsx($o,{}),S.jsxs("div",{className:"space-y-2",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx($t,{children:"Location"}),S.jsx(yn,{type:"button",variant:"outline",size:"sm",onClick:vn,disabled:Y,children:Y?"Getting...":" Use My Location"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"lat",className:"text-xs text-muted-foreground",children:"Latitude"}),S.jsx(xn,{id:"lat",type:"number",step:"any",value:w,onChange:ae=>C(ae.target.value)})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"lon",className:"text-xs text-muted-foreground",children:"Longitude"}),S.jsx(xn,{id:"lon",type:"number",step:"any",value:T,onChange:ae=>E(ae.target.value)})]})]})]}),pe&&S.jsx("div",{className:"text-sm text-destructive",children:pe}),S.jsx(yn,{onClick:En,disabled:V||q,className:"w-full",children:V||q?"Saving & Rebooting...":"Save Radio Config & Reboot"})]}),S.jsxs(ri,{value:"identity",className:"space-y-4 mt-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"public-key",children:"Public Key"}),S.jsx(xn,{id:"public-key",value:e.public_key,disabled:!0,className:"font-mono text-xs"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"name",children:"Radio Name"}),S.jsx(xn,{id:"name",value:_,onChange:ae=>b(ae.target.value)})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"advert-interval",children:"Periodic Advertising Interval"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(xn,{id:"advert-interval",type:"number",min:"0",value:Ge,onChange:ae=>pt(ae.target.value),className:"w-28"}),S.jsx("span",{className:"text-sm text-muted-foreground",children:"seconds (0 = off)"})]}),S.jsx("p",{className:"text-xs text-muted-foreground",children:"How often to automatically advertise presence. Set to 0 to disable. Recommended: 86400 (24 hours) or higher."})]}),S.jsx(yn,{onClick:Zn,disabled:V,className:"w-full",children:V?"Saving...":"Save Identity Settings"}),S.jsx($o,{}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"private-key",children:"Set Private Key (write-only)"}),S.jsx(xn,{id:"private-key",type:"password",autoComplete:"off",value:ee,onChange:ae=>le(ae.target.value),placeholder:"64-character hex private key"}),S.jsx(yn,{onClick:Qt,disabled:V||q||!ee.trim(),className:"w-full",children:V||q?"Setting & Rebooting...":"Set Private Key & Reboot"})]}),pe&&S.jsx("div",{className:"text-sm text-destructive",children:pe})]}),S.jsxs(ri,{value:"serial",className:"space-y-4 mt-4",children:[S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{children:"Serial Port"}),t!=null&&t.serial_port?S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),S.jsx("code",{className:"px-2 py-1 bg-muted rounded text-foreground text-sm",children:t.serial_port})]}):S.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[S.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-500"}),S.jsx("span",{children:"Not connected"})]})]}),S.jsx($o,{}),S.jsxs("div",{className:"space-y-2",children:[S.jsx($t,{htmlFor:"max-contacts",children:"Max Contacts on Radio"}),S.jsx(xn,{id:"max-contacts",type:"number",min:"1",max:"1000",value:Z,onChange:ae=>ie(ae.target.value)}),S.jsx("p",{className:"text-xs text-muted-foreground",children:"Recent non-repeater contacts loaded to radio for DM auto-ACK (1-1000)"})]}),S.jsx(yn,{onClick:rn,disabled:V,className:"w-full",children:V?"Saving...":"Save Settings"}),S.jsx($o,{}),S.jsx(yn,{variant:"outline",onClick:sn,disabled:q||V,className:"w-full border-red-500/50 text-red-400 hover:bg-red-500/10",children:q?"Rebooting...":"Reboot Radio"}),pe&&S.jsx("div",{className:"text-sm text-destructive",children:pe})]}),S.jsxs(ri,{value:"database",className:"space-y-4 mt-4",children:[S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm text-muted-foreground",children:"Database size"}),S.jsxs("span",{className:"font-medium",children:[(t==null?void 0:t.database_size_mb)??"?"," MB"]})]}),t!=null&&t.oldest_undecrypted_timestamp?S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm text-muted-foreground",children:"Oldest undecrypted packet"}),S.jsxs("span",{className:"font-medium",children:[Ac(t.oldest_undecrypted_timestamp),S.jsxs("span",{className:"text-muted-foreground ml-1",children:["(",Math.floor((Date.now()/1e3-t.oldest_undecrypted_timestamp)/86400)," ","days old)"]})]})]}):S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-sm text-muted-foreground",children:"Oldest undecrypted packet"}),S.jsx("span",{className:"text-muted-foreground",children:"None"})]})]}),S.jsx($o,{}),S.jsxs("div",{className:"space-y-3",children:[S.jsx($t,{children:"Cleanup Old Packets"}),S.jsx("p",{className:"text-xs text-muted-foreground",children:"Delete undecrypted packets older than the specified days. This helps manage storage for packets that couldn't be decrypted (unknown channel keys)."}),S.jsxs("div",{className:"flex gap-2 items-end",children:[S.jsxs("div",{className:"space-y-1",children:[S.jsx($t,{htmlFor:"retention-days",className:"text-xs",children:"Days to retain"}),S.jsx(xn,{id:"retention-days",type:"number",min:"1",max:"365",value:xe,onChange:ae=>ye(ae.target.value),className:"w-24"})]}),S.jsx(yn,{variant:"outline",onClick:zn,disabled:Pe,children:Pe?"Cleaning...":"Cleanup"})]})]}),S.jsx($o,{}),S.jsxs("div",{className:"space-y-3",children:[S.jsx($t,{children:"DM Decryption"}),S.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[S.jsx("input",{type:"checkbox",checked:nt,onChange:ae=>Ce(ae.target.checked),className:"w-4 h-4 rounded border-input accent-primary"}),S.jsx("span",{className:"text-sm",children:"Auto-decrypt historical DMs when new contact advertises"})]}),S.jsx("p",{className:"text-xs text-muted-foreground",children:"When enabled, the server will automatically try to decrypt stored DM packets when a new contact sends an advertisement. This may cause brief delays on large packet backlogs."})]}),pe&&S.jsx("div",{className:"text-sm text-destructive",children:pe}),S.jsx(yn,{onClick:Ae,disabled:V,className:"w-full",children:V?"Saving...":"Save Settings"})]}),S.jsx(ri,{value:"advertise",className:"space-y-4 mt-4",children:S.jsxs("div",{className:"text-center py-8",children:[S.jsx("p",{className:"text-muted-foreground mb-6",children:"Send a flood advertisement to announce your presence on the mesh network."}),S.jsx(yn,{size:"lg",onClick:pr,disabled:Q||!(t!=null&&t.radio_connected),className:"bg-green-600 hover:bg-green-700 text-white px-12 py-6 text-lg",children:Q?"Sending...":"Send Advertisement"}),!(t!=null&&t.radio_connected)&&S.jsx("p",{className:"text-sm text-destructive mt-4",children:"Radio not connected"})]})}),S.jsxs(ri,{value:"bot",className:"space-y-4 mt-4",children:[S.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-md",children:S.jsxs("p",{className:"text-sm text-red-500",children:[S.jsx("strong",{children:"Experimental:"})," This is an alpha feature and introduces automated message sending to your radio; unexpected behavior may occur. Use with caution, and please report any bugs!"]})}),S.jsx("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-md",children:S.jsxs("p",{className:"text-sm text-yellow-500",children:[S.jsx("strong",{children:"Security Warning:"})," This feature executes arbitrary Python code on the server. Only enable if you understand the security implications."]})}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx($t,{children:"Bots"}),S.jsx(yn,{type:"button",variant:"outline",size:"sm",onClick:Ie,children:"+ New Bot"})]}),ot.length===0?S.jsxs("div",{className:"text-center py-8 border border-dashed border-input rounded-md",children:[S.jsx("p",{className:"text-muted-foreground mb-4",children:"No bots configured"}),S.jsx(yn,{type:"button",variant:"outline",onClick:Ie,children:"Create your first bot"})]}):S.jsx("div",{className:"space-y-2",children:ot.map(ae=>S.jsxs("div",{className:"border border-input rounded-md overflow-hidden",children:[S.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-muted/50 cursor-pointer hover:bg-muted/80",onClick:De=>{De.target.closest("input, button")||tt(et===ae.id?null:ae.id)},children:[S.jsx("span",{className:"text-muted-foreground",children:et===ae.id?"":""}),at===ae.id?S.jsx("input",{type:"text",value:Dt,onChange:De=>Jt(De.target.value),onBlur:Le,onKeyDown:De=>{De.key==="Enter"&&Le(),De.key==="Escape"&&(qe(null),Jt(""))},autoFocus:!0,className:"px-2 py-0.5 text-sm bg-background border border-input rounded flex-1 max-w-[200px]",onClick:De=>De.stopPropagation()}):S.jsx("span",{className:"text-sm font-medium flex-1 hover:text-primary cursor-text",onClick:De=>{De.stopPropagation(),Oe(ae)},title:"Click to rename",children:ae.name}),S.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",onClick:De=>De.stopPropagation(),children:[S.jsx("input",{type:"checkbox",checked:ae.enabled,onChange:()=>se(ae.id),className:"w-4 h-4 rounded border-input accent-primary"}),S.jsx("span",{className:"text-xs text-muted-foreground",children:"Enabled"})]}),S.jsx(yn,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground hover:text-destructive",onClick:De=>{De.stopPropagation(),xt(ae.id)},title:"Delete bot",children:""})]}),et===ae.id&&S.jsxs("div",{className:"p-3 space-y-3 border-t border-input",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("p",{className:"text-xs text-muted-foreground",children:["Define a ",S.jsx("code",{className:"bg-muted px-1 rounded",children:"bot()"})," function that receives message data and optionally returns a reply."]}),S.jsx(yn,{type:"button",variant:"outline",size:"sm",onClick:()=>lt(ae.id),children:"Reset to Example"})]}),S.jsx(mE,{value:ae.code,onChange:De=>be(ae.id,De),extensions:[r9()],theme:pE,height:"256px",basicSetup:{lineNumbers:!0,foldGutter:!1,highlightActiveLine:!0},className:"rounded-md border border-input overflow-hidden text-sm"})]})]},ae.id))}),S.jsx($o,{}),S.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Available:"})," Standard Python libraries and any modules installed in the server environment."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Limits:"})," 10 second timeout per bot."]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Note:"})," Bots only respond to incoming messages, not your own. For channel messages, ",S.jsx("code",{children:"sender_key"})," is ",S.jsx("code",{children:"None"}),". Multiple enabled bots run serially."]})]}),pe&&S.jsx("div",{className:"text-sm text-destructive",children:pe}),S.jsx(yn,{onClick:Te,disabled:V,className:"w-full",children:V?"Saving...":"Save Bot Settings"})]})]}):S.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Loading configuration..."})]})})}var Us={},Lu={},Kn={},iO;function oi(){if(iO)return Kn;iO=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.RequestType=Kn.AdvertFlags=Kn.DeviceRole=Kn.PayloadVersion=Kn.ControlSubType=Kn.PayloadType=Kn.RouteType=void 0;var n;(function(a){a[a.TransportFlood=0]="TransportFlood",a[a.Flood=1]="Flood",a[a.Direct=2]="Direct",a[a.TransportDirect=3]="TransportDirect"})(n||(Kn.RouteType=n={}));var e;(function(a){a[a.Request=0]="Request",a[a.Response=1]="Response",a[a.TextMessage=2]="TextMessage",a[a.Ack=3]="Ack",a[a.Advert=4]="Advert",a[a.GroupText=5]="GroupText",a[a.GroupData=6]="GroupData",a[a.AnonRequest=7]="AnonRequest",a[a.Path=8]="Path",a[a.Trace=9]="Trace",a[a.Multipart=10]="Multipart",a[a.Control=11]="Control",a[a.RawCustom=15]="RawCustom"})(e||(Kn.PayloadType=e={}));var t;(function(a){a[a.NodeDiscoverReq=128]="NodeDiscoverReq",a[a.NodeDiscoverResp=144]="NodeDiscoverResp"})(t||(Kn.ControlSubType=t={}));var r;(function(a){a[a.Version1=0]="Version1",a[a.Version2=1]="Version2",a[a.Version3=2]="Version3",a[a.Version4=3]="Version4"})(r||(Kn.PayloadVersion=r={}));var i;(function(a){a[a.Unknown=0]="Unknown",a[a.ChatNode=1]="ChatNode",a[a.Repeater=2]="Repeater",a[a.RoomServer=3]="RoomServer",a[a.Sensor=4]="Sensor"})(i||(Kn.DeviceRole=i={}));var s;(function(a){a[a.HasLocation=16]="HasLocation",a[a.HasFeature1=32]="HasFeature1",a[a.HasFeature2=64]="HasFeature2",a[a.HasName=128]="HasName"})(s||(Kn.AdvertFlags=s={}));var o;return(function(a){a[a.GetStats=1]="GetStats",a[a.Keepalive=2]="Keepalive",a[a.GetTelemetryData=3]="GetTelemetryData",a[a.GetMinMaxAvgData=4]="GetMinMaxAvgData",a[a.GetAccessList=5]="GetAccessList"})(o||(Kn.RequestType=o={})),Kn}var ja={},sO;function nr(){if(sO)return ja;sO=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.byteToHex=n,ja.bytesToHex=e,ja.numberToHex=t,ja.hexToBytes=r;function n(i){return i.toString(16).padStart(2,"0").toUpperCase()}function e(i){return Array.from(i).map(n).join("")}function t(i,s=8){return(i>>>0).toString(16).padStart(s,"0").toUpperCase()}function r(i){const s=i.replace(/\s/g,"").toUpperCase();if(!/^[0-9A-F]*$/.test(s))throw new Error("Invalid hex string: invalid characters at position 0");if(s.length%2!==0)throw new Error("Invalid hex string: odd length");const o=new Uint8Array(s.length/2);for(let a=0;a<s.length;a+=2)o[a/2]=parseInt(s.substr(a,2),16);return o}return ja}var Zs={},oO;function Bh(){if(oO)return Zs;oO=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.getRouteTypeName=e,Zs.getPayloadTypeName=t,Zs.getPayloadVersionName=r,Zs.getDeviceRoleName=i,Zs.getRequestTypeName=s,Zs.getControlSubTypeName=o;const n=oi();function e(a){switch(a){case n.RouteType.Flood:return"Flood";case n.RouteType.Direct:return"Direct";case n.RouteType.TransportFlood:return"TransportFlood";case n.RouteType.TransportDirect:return"TransportDirect";default:return`Unknown (${a})`}}function t(a){switch(a){case n.PayloadType.RawCustom:return"RawCustom";case n.PayloadType.Trace:return"Trace";case n.PayloadType.Advert:return"Advert";case n.PayloadType.GroupText:return"GroupText";case n.PayloadType.GroupData:return"GroupData";case n.PayloadType.Request:return"Request";case n.PayloadType.Response:return"Response";case n.PayloadType.TextMessage:return"TextMessage";case n.PayloadType.AnonRequest:return"AnonRequest";case n.PayloadType.Ack:return"Ack";case n.PayloadType.Path:return"Path";case n.PayloadType.Multipart:return"Multipart";case n.PayloadType.Control:return"Control";default:return`Unknown (0x${a.toString(16)})`}}function r(a){switch(a){case n.PayloadVersion.Version1:return"Version 1";case n.PayloadVersion.Version2:return"Version 2";case n.PayloadVersion.Version3:return"Version 3";case n.PayloadVersion.Version4:return"Version 4";default:return`Unknown (${a})`}}function i(a){switch(a){case n.DeviceRole.Unknown:return"Unknown";case n.DeviceRole.ChatNode:return"Chat Node";case n.DeviceRole.Repeater:return"Repeater";case n.DeviceRole.RoomServer:return"Room Server";case n.DeviceRole.Sensor:return"Sensor";default:return`Unknown (${a})`}}function s(a){switch(a){case n.RequestType.GetStats:return"Get Stats";case n.RequestType.Keepalive:return"Keepalive (deprecated)";case n.RequestType.GetTelemetryData:return"Get Telemetry Data";case n.RequestType.GetMinMaxAvgData:return"Get Min/Max/Avg Data";case n.RequestType.GetAccessList:return"Get Access List";default:return`Unknown (${a})`}}function o(a){switch(a){case n.ControlSubType.NodeDiscoverReq:return"Node Discover Request";case n.ControlSubType.NodeDiscoverResp:return"Node Discover Response";default:return`Unknown (0x${a.toString(16)})`}}return Zs}var Fu={},Iu={},h0={exports:{}};function Jy(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var f0={exports:{}};const u9={},h9=Object.freeze(Object.defineProperty({__proto__:null,default:u9},Symbol.toStringTag,{value:"Module"})),Pp=Lk(h9);var f9=f0.exports,aO;function Et(){return aO||(aO=1,(function(n,e){(function(t,r){n.exports=r()})(f9,function(){var t=t||(function(r,i){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof Wg<"u"&&Wg.crypto&&(s=Wg.crypto),!s&&typeof Jy=="function")try{s=Pp}catch{}var o=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||(function(){function T(){}return function(E){var D;return T.prototype=E,D=new T,T.prototype=null,D}})(),u={},f=u.lib={},p=f.Base=(function(){return{extend:function(T){var E=a(this);return T&&E.mixIn(T),(!E.hasOwnProperty("init")||this.init===E.init)&&(E.init=function(){E.$super.init.apply(this,arguments)}),E.init.prototype=E,E.$super=this,E},create:function(){var T=this.extend();return T.init.apply(T,arguments),T},init:function(){},mixIn:function(T){for(var E in T)T.hasOwnProperty(E)&&(this[E]=T[E]);T.hasOwnProperty("toString")&&(this.toString=T.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),g=f.WordArray=p.extend({init:function(T,E){T=this.words=T||[],E!=i?this.sigBytes=E:this.sigBytes=T.length*4},toString:function(T){return(T||A).stringify(this)},concat:function(T){var E=this.words,D=T.words,N=this.sigBytes,F=T.sigBytes;if(this.clamp(),N%4)for(var z=0;z<F;z++){var I=D[z>>>2]>>>24-z%4*8&255;E[N+z>>>2]|=I<<24-(N+z)%4*8}else for(var K=0;K<F;K+=4)E[N+K>>>2]=D[K>>>2];return this.sigBytes+=F,this},clamp:function(){var T=this.words,E=this.sigBytes;T[E>>>2]&=4294967295<<32-E%4*8,T.length=r.ceil(E/4)},clone:function(){var T=p.clone.call(this);return T.words=this.words.slice(0),T},random:function(T){for(var E=[],D=0;D<T;D+=4)E.push(o());return new g.init(E,T)}}),x=u.enc={},A=x.Hex={stringify:function(T){for(var E=T.words,D=T.sigBytes,N=[],F=0;F<D;F++){var z=E[F>>>2]>>>24-F%4*8&255;N.push((z>>>4).toString(16)),N.push((z&15).toString(16))}return N.join("")},parse:function(T){for(var E=T.length,D=[],N=0;N<E;N+=2)D[N>>>3]|=parseInt(T.substr(N,2),16)<<24-N%8*4;return new g.init(D,E/2)}},_=x.Latin1={stringify:function(T){for(var E=T.words,D=T.sigBytes,N=[],F=0;F<D;F++){var z=E[F>>>2]>>>24-F%4*8&255;N.push(String.fromCharCode(z))}return N.join("")},parse:function(T){for(var E=T.length,D=[],N=0;N<E;N++)D[N>>>2]|=(T.charCodeAt(N)&255)<<24-N%4*8;return new g.init(D,E)}},b=x.Utf8={stringify:function(T){try{return decodeURIComponent(escape(_.stringify(T)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(T){return _.parse(unescape(encodeURIComponent(T)))}},w=f.BufferedBlockAlgorithm=p.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(T){typeof T=="string"&&(T=b.parse(T)),this._data.concat(T),this._nDataBytes+=T.sigBytes},_process:function(T){var E,D=this._data,N=D.words,F=D.sigBytes,z=this.blockSize,I=z*4,K=F/I;T?K=r.ceil(K):K=r.max((K|0)-this._minBufferSize,0);var W=K*z,U=r.min(W*4,F);if(W){for(var X=0;X<W;X+=z)this._doProcessBlock(N,X);E=N.splice(0,W),D.sigBytes-=U}return new g.init(E,U)},clone:function(){var T=p.clone.call(this);return T._data=this._data.clone(),T},_minBufferSize:0});f.Hasher=w.extend({cfg:p.extend(),init:function(T){this.cfg=this.cfg.extend(T),this.reset()},reset:function(){w.reset.call(this),this._doReset()},update:function(T){return this._append(T),this._process(),this},finalize:function(T){T&&this._append(T);var E=this._doFinalize();return E},blockSize:16,_createHelper:function(T){return function(E,D){return new T.init(D).finalize(E)}},_createHmacHelper:function(T){return function(E,D){return new C.HMAC.init(T,D).finalize(E)}}});var C=u.algo={};return u})(Math);return t})})(f0)),f0.exports}var d0={exports:{}},d9=d0.exports,lO;function dm(){return lO||(lO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(d9,function(t){return(function(r){var i=t,s=i.lib,o=s.Base,a=s.WordArray,u=i.x64={};u.Word=o.extend({init:function(f,p){this.high=f,this.low=p}}),u.WordArray=o.extend({init:function(f,p){f=this.words=f||[],p!=r?this.sigBytes=p:this.sigBytes=f.length*8},toX32:function(){for(var f=this.words,p=f.length,g=[],x=0;x<p;x++){var A=f[x];g.push(A.high),g.push(A.low)}return a.create(g,this.sigBytes)},clone:function(){for(var f=o.clone.call(this),p=f.words=this.words.slice(0),g=p.length,x=0;x<g;x++)p[x]=p[x].clone();return f}})})(),t})})(d0)),d0.exports}var p0={exports:{}},p9=p0.exports,cO;function m9(){return cO||(cO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(p9,function(t){return(function(){if(typeof ArrayBuffer=="function"){var r=t,i=r.lib,s=i.WordArray,o=s.init,a=s.init=function(u){if(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),(u instanceof Int8Array||typeof Uint8ClampedArray<"u"&&u instanceof Uint8ClampedArray||u instanceof Int16Array||u instanceof Uint16Array||u instanceof Int32Array||u instanceof Uint32Array||u instanceof Float32Array||u instanceof Float64Array)&&(u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength)),u instanceof Uint8Array){for(var f=u.byteLength,p=[],g=0;g<f;g++)p[g>>>2]|=u[g]<<24-g%4*8;o.call(this,p,f)}else o.apply(this,arguments)};a.prototype=s}})(),t.lib.WordArray})})(p0)),p0.exports}var m0={exports:{}},g9=m0.exports,uO;function x9(){return uO||(uO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(g9,function(t){return(function(){var r=t,i=r.lib,s=i.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(u){for(var f=u.words,p=u.sigBytes,g=[],x=0;x<p;x+=2){var A=f[x>>>2]>>>16-x%4*8&65535;g.push(String.fromCharCode(A))}return g.join("")},parse:function(u){for(var f=u.length,p=[],g=0;g<f;g++)p[g>>>1]|=u.charCodeAt(g)<<16-g%2*16;return s.create(p,f*2)}},o.Utf16LE={stringify:function(u){for(var f=u.words,p=u.sigBytes,g=[],x=0;x<p;x+=2){var A=a(f[x>>>2]>>>16-x%4*8&65535);g.push(String.fromCharCode(A))}return g.join("")},parse:function(u){for(var f=u.length,p=[],g=0;g<f;g++)p[g>>>1]|=a(u.charCodeAt(g)<<16-g%2*16);return s.create(p,f*2)}};function a(u){return u<<8&4278255360|u>>>8&16711935}})(),t.enc.Utf16})})(m0)),m0.exports}var g0={exports:{}},y9=g0.exports,hO;function ul(){return hO||(hO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(y9,function(t){return(function(){var r=t,i=r.lib,s=i.WordArray,o=r.enc;o.Base64={stringify:function(u){var f=u.words,p=u.sigBytes,g=this._map;u.clamp();for(var x=[],A=0;A<p;A+=3)for(var _=f[A>>>2]>>>24-A%4*8&255,b=f[A+1>>>2]>>>24-(A+1)%4*8&255,w=f[A+2>>>2]>>>24-(A+2)%4*8&255,C=_<<16|b<<8|w,T=0;T<4&&A+T*.75<p;T++)x.push(g.charAt(C>>>6*(3-T)&63));var E=g.charAt(64);if(E)for(;x.length%4;)x.push(E);return x.join("")},parse:function(u){var f=u.length,p=this._map,g=this._reverseMap;if(!g){g=this._reverseMap=[];for(var x=0;x<p.length;x++)g[p.charCodeAt(x)]=x}var A=p.charAt(64);if(A){var _=u.indexOf(A);_!==-1&&(f=_)}return a(u,f,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(u,f,p){for(var g=[],x=0,A=0;A<f;A++)if(A%4){var _=p[u.charCodeAt(A-1)]<<A%4*2,b=p[u.charCodeAt(A)]>>>6-A%4*2,w=_|b;g[x>>>2]|=w<<24-x%4*8,x++}return s.create(g,x)}})(),t.enc.Base64})})(g0)),g0.exports}var x0={exports:{}},v9=x0.exports,fO;function A9(){return fO||(fO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(v9,function(t){return(function(){var r=t,i=r.lib,s=i.WordArray,o=r.enc;o.Base64url={stringify:function(u,f){f===void 0&&(f=!0);var p=u.words,g=u.sigBytes,x=f?this._safe_map:this._map;u.clamp();for(var A=[],_=0;_<g;_+=3)for(var b=p[_>>>2]>>>24-_%4*8&255,w=p[_+1>>>2]>>>24-(_+1)%4*8&255,C=p[_+2>>>2]>>>24-(_+2)%4*8&255,T=b<<16|w<<8|C,E=0;E<4&&_+E*.75<g;E++)A.push(x.charAt(T>>>6*(3-E)&63));var D=x.charAt(64);if(D)for(;A.length%4;)A.push(D);return A.join("")},parse:function(u,f){f===void 0&&(f=!0);var p=u.length,g=f?this._safe_map:this._map,x=this._reverseMap;if(!x){x=this._reverseMap=[];for(var A=0;A<g.length;A++)x[g.charCodeAt(A)]=A}var _=g.charAt(64);if(_){var b=u.indexOf(_);b!==-1&&(p=b)}return a(u,p,x)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(u,f,p){for(var g=[],x=0,A=0;A<f;A++)if(A%4){var _=p[u.charCodeAt(A-1)]<<A%4*2,b=p[u.charCodeAt(A)]>>>6-A%4*2,w=_|b;g[x>>>2]|=w<<24-x%4*8,x++}return s.create(g,x)}})(),t.enc.Base64url})})(x0)),x0.exports}var y0={exports:{}},b9=y0.exports,dO;function hl(){return dO||(dO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(b9,function(t){return(function(r){var i=t,s=i.lib,o=s.WordArray,a=s.Hasher,u=i.algo,f=[];(function(){for(var b=0;b<64;b++)f[b]=r.abs(r.sin(b+1))*4294967296|0})();var p=u.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(b,w){for(var C=0;C<16;C++){var T=w+C,E=b[T];b[T]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}var D=this._hash.words,N=b[w+0],F=b[w+1],z=b[w+2],I=b[w+3],K=b[w+4],W=b[w+5],U=b[w+6],X=b[w+7],$=b[w+8],ee=b[w+9],le=b[w+10],Z=b[w+11],ie=b[w+12],V=b[w+13],ne=b[w+14],q=b[w+15],B=D[0],Q=D[1],G=D[2],Y=D[3];B=g(B,Q,G,Y,N,7,f[0]),Y=g(Y,B,Q,G,F,12,f[1]),G=g(G,Y,B,Q,z,17,f[2]),Q=g(Q,G,Y,B,I,22,f[3]),B=g(B,Q,G,Y,K,7,f[4]),Y=g(Y,B,Q,G,W,12,f[5]),G=g(G,Y,B,Q,U,17,f[6]),Q=g(Q,G,Y,B,X,22,f[7]),B=g(B,Q,G,Y,$,7,f[8]),Y=g(Y,B,Q,G,ee,12,f[9]),G=g(G,Y,B,Q,le,17,f[10]),Q=g(Q,G,Y,B,Z,22,f[11]),B=g(B,Q,G,Y,ie,7,f[12]),Y=g(Y,B,Q,G,V,12,f[13]),G=g(G,Y,B,Q,ne,17,f[14]),Q=g(Q,G,Y,B,q,22,f[15]),B=x(B,Q,G,Y,F,5,f[16]),Y=x(Y,B,Q,G,U,9,f[17]),G=x(G,Y,B,Q,Z,14,f[18]),Q=x(Q,G,Y,B,N,20,f[19]),B=x(B,Q,G,Y,W,5,f[20]),Y=x(Y,B,Q,G,le,9,f[21]),G=x(G,Y,B,Q,q,14,f[22]),Q=x(Q,G,Y,B,K,20,f[23]),B=x(B,Q,G,Y,ee,5,f[24]),Y=x(Y,B,Q,G,ne,9,f[25]),G=x(G,Y,B,Q,I,14,f[26]),Q=x(Q,G,Y,B,$,20,f[27]),B=x(B,Q,G,Y,V,5,f[28]),Y=x(Y,B,Q,G,z,9,f[29]),G=x(G,Y,B,Q,X,14,f[30]),Q=x(Q,G,Y,B,ie,20,f[31]),B=A(B,Q,G,Y,W,4,f[32]),Y=A(Y,B,Q,G,$,11,f[33]),G=A(G,Y,B,Q,Z,16,f[34]),Q=A(Q,G,Y,B,ne,23,f[35]),B=A(B,Q,G,Y,F,4,f[36]),Y=A(Y,B,Q,G,K,11,f[37]),G=A(G,Y,B,Q,X,16,f[38]),Q=A(Q,G,Y,B,le,23,f[39]),B=A(B,Q,G,Y,V,4,f[40]),Y=A(Y,B,Q,G,N,11,f[41]),G=A(G,Y,B,Q,I,16,f[42]),Q=A(Q,G,Y,B,U,23,f[43]),B=A(B,Q,G,Y,ee,4,f[44]),Y=A(Y,B,Q,G,ie,11,f[45]),G=A(G,Y,B,Q,q,16,f[46]),Q=A(Q,G,Y,B,z,23,f[47]),B=_(B,Q,G,Y,N,6,f[48]),Y=_(Y,B,Q,G,X,10,f[49]),G=_(G,Y,B,Q,ne,15,f[50]),Q=_(Q,G,Y,B,W,21,f[51]),B=_(B,Q,G,Y,ie,6,f[52]),Y=_(Y,B,Q,G,I,10,f[53]),G=_(G,Y,B,Q,le,15,f[54]),Q=_(Q,G,Y,B,F,21,f[55]),B=_(B,Q,G,Y,$,6,f[56]),Y=_(Y,B,Q,G,q,10,f[57]),G=_(G,Y,B,Q,U,15,f[58]),Q=_(Q,G,Y,B,V,21,f[59]),B=_(B,Q,G,Y,K,6,f[60]),Y=_(Y,B,Q,G,Z,10,f[61]),G=_(G,Y,B,Q,z,15,f[62]),Q=_(Q,G,Y,B,ee,21,f[63]),D[0]=D[0]+B|0,D[1]=D[1]+Q|0,D[2]=D[2]+G|0,D[3]=D[3]+Y|0},_doFinalize:function(){var b=this._data,w=b.words,C=this._nDataBytes*8,T=b.sigBytes*8;w[T>>>5]|=128<<24-T%32;var E=r.floor(C/4294967296),D=C;w[(T+64>>>9<<4)+15]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,w[(T+64>>>9<<4)+14]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,b.sigBytes=(w.length+1)*4,this._process();for(var N=this._hash,F=N.words,z=0;z<4;z++){var I=F[z];F[z]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}return N},clone:function(){var b=a.clone.call(this);return b._hash=this._hash.clone(),b}});function g(b,w,C,T,E,D,N){var F=b+(w&C|~w&T)+E+N;return(F<<D|F>>>32-D)+w}function x(b,w,C,T,E,D,N){var F=b+(w&T|C&~T)+E+N;return(F<<D|F>>>32-D)+w}function A(b,w,C,T,E,D,N){var F=b+(w^C^T)+E+N;return(F<<D|F>>>32-D)+w}function _(b,w,C,T,E,D,N){var F=b+(C^(w|~T))+E+N;return(F<<D|F>>>32-D)+w}i.MD5=a._createHelper(p),i.HmacMD5=a._createHmacHelper(p)})(Math),t.MD5})})(y0)),y0.exports}var v0={exports:{}},w9=v0.exports,pO;function TE(){return pO||(pO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(w9,function(t){return(function(){var r=t,i=r.lib,s=i.WordArray,o=i.Hasher,a=r.algo,u=[],f=a.SHA1=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(p,g){for(var x=this._hash.words,A=x[0],_=x[1],b=x[2],w=x[3],C=x[4],T=0;T<80;T++){if(T<16)u[T]=p[g+T]|0;else{var E=u[T-3]^u[T-8]^u[T-14]^u[T-16];u[T]=E<<1|E>>>31}var D=(A<<5|A>>>27)+C+u[T];T<20?D+=(_&b|~_&w)+1518500249:T<40?D+=(_^b^w)+1859775393:T<60?D+=(_&b|_&w|b&w)-1894007588:D+=(_^b^w)-899497514,C=w,w=b,b=_<<30|_>>>2,_=A,A=D}x[0]=x[0]+A|0,x[1]=x[1]+_|0,x[2]=x[2]+b|0,x[3]=x[3]+w|0,x[4]=x[4]+C|0},_doFinalize:function(){var p=this._data,g=p.words,x=this._nDataBytes*8,A=p.sigBytes*8;return g[A>>>5]|=128<<24-A%32,g[(A+64>>>9<<4)+14]=Math.floor(x/4294967296),g[(A+64>>>9<<4)+15]=x,p.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});r.SHA1=o._createHelper(f),r.HmacSHA1=o._createHmacHelper(f)})(),t.SHA1})})(v0)),v0.exports}var A0={exports:{}},_9=A0.exports,mO;function Gh(){return mO||(mO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(_9,function(t){return(function(r){var i=t,s=i.lib,o=s.WordArray,a=s.Hasher,u=i.algo,f=[],p=[];(function(){function A(C){for(var T=r.sqrt(C),E=2;E<=T;E++)if(!(C%E))return!1;return!0}function _(C){return(C-(C|0))*4294967296|0}for(var b=2,w=0;w<64;)A(b)&&(w<8&&(f[w]=_(r.pow(b,1/2))),p[w]=_(r.pow(b,1/3)),w++),b++})();var g=[],x=u.SHA256=a.extend({_doReset:function(){this._hash=new o.init(f.slice(0))},_doProcessBlock:function(A,_){for(var b=this._hash.words,w=b[0],C=b[1],T=b[2],E=b[3],D=b[4],N=b[5],F=b[6],z=b[7],I=0;I<64;I++){if(I<16)g[I]=A[_+I]|0;else{var K=g[I-15],W=(K<<25|K>>>7)^(K<<14|K>>>18)^K>>>3,U=g[I-2],X=(U<<15|U>>>17)^(U<<13|U>>>19)^U>>>10;g[I]=W+g[I-7]+X+g[I-16]}var $=D&N^~D&F,ee=w&C^w&T^C&T,le=(w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22),Z=(D<<26|D>>>6)^(D<<21|D>>>11)^(D<<7|D>>>25),ie=z+Z+$+p[I]+g[I],V=le+ee;z=F,F=N,N=D,D=E+ie|0,E=T,T=C,C=w,w=ie+V|0}b[0]=b[0]+w|0,b[1]=b[1]+C|0,b[2]=b[2]+T|0,b[3]=b[3]+E|0,b[4]=b[4]+D|0,b[5]=b[5]+N|0,b[6]=b[6]+F|0,b[7]=b[7]+z|0},_doFinalize:function(){var A=this._data,_=A.words,b=this._nDataBytes*8,w=A.sigBytes*8;return _[w>>>5]|=128<<24-w%32,_[(w+64>>>9<<4)+14]=r.floor(b/4294967296),_[(w+64>>>9<<4)+15]=b,A.sigBytes=_.length*4,this._process(),this._hash},clone:function(){var A=a.clone.call(this);return A._hash=this._hash.clone(),A}});i.SHA256=a._createHelper(x),i.HmacSHA256=a._createHmacHelper(x)})(Math),t.SHA256})})(A0)),A0.exports}var b0={exports:{}},O9=b0.exports,gO;function k9(){return gO||(gO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Gh())})(O9,function(t){return(function(){var r=t,i=r.lib,s=i.WordArray,o=r.algo,a=o.SHA256,u=o.SHA224=a.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var f=a._doFinalize.call(this);return f.sigBytes-=4,f}});r.SHA224=a._createHelper(u),r.HmacSHA224=a._createHmacHelper(u)})(),t.SHA224})})(b0)),b0.exports}var w0={exports:{}},S9=w0.exports,xO;function EE(){return xO||(xO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),dm())})(S9,function(t){return(function(){var r=t,i=r.lib,s=i.Hasher,o=r.x64,a=o.Word,u=o.WordArray,f=r.algo;function p(){return a.create.apply(a,arguments)}var g=[p(1116352408,3609767458),p(1899447441,602891725),p(3049323471,3964484399),p(3921009573,2173295548),p(961987163,4081628472),p(1508970993,3053834265),p(2453635748,2937671579),p(2870763221,3664609560),p(3624381080,2734883394),p(310598401,1164996542),p(607225278,1323610764),p(1426881987,3590304994),p(1925078388,4068182383),p(2162078206,991336113),p(2614888103,633803317),p(3248222580,3479774868),p(3835390401,2666613458),p(4022224774,944711139),p(264347078,2341262773),p(604807628,2007800933),p(770255983,1495990901),p(1249150122,1856431235),p(1555081692,3175218132),p(1996064986,2198950837),p(2554220882,3999719339),p(2821834349,766784016),p(2952996808,2566594879),p(3210313671,3203337956),p(3336571891,1034457026),p(3584528711,2466948901),p(113926993,3758326383),p(338241895,168717936),p(666307205,1188179964),p(773529912,1546045734),p(1294757372,1522805485),p(1396182291,2643833823),p(1695183700,2343527390),p(1986661051,1014477480),p(2177026350,1206759142),p(2456956037,344077627),p(2730485921,1290863460),p(2820302411,3158454273),p(3259730800,3505952657),p(3345764771,106217008),p(3516065817,3606008344),p(3600352804,1432725776),p(4094571909,1467031594),p(275423344,851169720),p(430227734,3100823752),p(506948616,1363258195),p(659060556,3750685593),p(883997877,3785050280),p(958139571,3318307427),p(1322822218,3812723403),p(1537002063,2003034995),p(1747873779,3602036899),p(1955562222,1575990012),p(2024104815,1125592928),p(2227730452,2716904306),p(2361852424,442776044),p(2428436474,593698344),p(2756734187,3733110249),p(3204031479,2999351573),p(3329325298,3815920427),p(3391569614,3928383900),p(3515267271,566280711),p(3940187606,3454069534),p(4118630271,4000239992),p(116418474,1914138554),p(174292421,2731055270),p(289380356,3203993006),p(460393269,320620315),p(685471733,587496836),p(852142971,1086792851),p(1017036298,365543100),p(1126000580,2618297676),p(1288033470,3409855158),p(1501505948,4234509866),p(1607167915,987167468),p(1816402316,1246189591)],x=[];(function(){for(var _=0;_<80;_++)x[_]=p()})();var A=f.SHA512=s.extend({_doReset:function(){this._hash=new u.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(_,b){for(var w=this._hash.words,C=w[0],T=w[1],E=w[2],D=w[3],N=w[4],F=w[5],z=w[6],I=w[7],K=C.high,W=C.low,U=T.high,X=T.low,$=E.high,ee=E.low,le=D.high,Z=D.low,ie=N.high,V=N.low,ne=F.high,q=F.low,B=z.high,Q=z.low,G=I.high,Y=I.low,ue=K,pe=W,ve=U,xe=X,ye=$,Pe=ee,Ke=le,nt=Z,Ce=ie,Ge=V,pt=ne,bt=q,ot=B,mt=Q,et=G,tt=Y,at=0;at<80;at++){var qe,Dt,Jt=x[at];if(at<16)Dt=Jt.high=_[b+at*2]|0,qe=Jt.low=_[b+at*2+1]|0;else{var dr=x[at-15],en=dr.high,vn=dr.low,En=(en>>>1|vn<<31)^(en>>>8|vn<<24)^en>>>7,Zn=(vn>>>1|en<<31)^(vn>>>8|en<<24)^(vn>>>7|en<<25),rn=x[at-2],Qt=rn.high,sn=rn.low,pr=(Qt>>>19|sn<<13)^(Qt<<3|sn>>>29)^Qt>>>6,zn=(sn>>>19|Qt<<13)^(sn<<3|Qt>>>29)^(sn>>>6|Qt<<26),Ae=x[at-7],Te=Ae.high,Ie=Ae.low,xt=x[at-16],se=xt.high,be=xt.low;qe=Zn+Ie,Dt=En+Te+(qe>>>0<Zn>>>0?1:0),qe=qe+zn,Dt=Dt+pr+(qe>>>0<zn>>>0?1:0),qe=qe+be,Dt=Dt+se+(qe>>>0<be>>>0?1:0),Jt.high=Dt,Jt.low=qe}var Oe=Ce&pt^~Ce&ot,Le=Ge&bt^~Ge&mt,lt=ue&ve^ue&ye^ve&ye,ae=pe&xe^pe&Pe^xe&Pe,De=(ue>>>28|pe<<4)^(ue<<30|pe>>>2)^(ue<<25|pe>>>7),wt=(pe>>>28|ue<<4)^(pe<<30|ue>>>2)^(pe<<25|ue>>>7),Gt=(Ce>>>14|Ge<<18)^(Ce>>>18|Ge<<14)^(Ce<<23|Ge>>>9),On=(Ge>>>14|Ce<<18)^(Ge>>>18|Ce<<14)^(Ge<<23|Ce>>>9),At=g[at],Ht=At.high,Qr=At.low,Mt=tt+On,on=et+Gt+(Mt>>>0<tt>>>0?1:0),Mt=Mt+Le,on=on+Oe+(Mt>>>0<Le>>>0?1:0),Mt=Mt+Qr,on=on+Ht+(Mt>>>0<Qr>>>0?1:0),Mt=Mt+qe,on=on+Dt+(Mt>>>0<qe>>>0?1:0),pn=wt+ae,ze=De+lt+(pn>>>0<wt>>>0?1:0);et=ot,tt=mt,ot=pt,mt=bt,pt=Ce,bt=Ge,Ge=nt+Mt|0,Ce=Ke+on+(Ge>>>0<nt>>>0?1:0)|0,Ke=ye,nt=Pe,ye=ve,Pe=xe,ve=ue,xe=pe,pe=Mt+pn|0,ue=on+ze+(pe>>>0<Mt>>>0?1:0)|0}W=C.low=W+pe,C.high=K+ue+(W>>>0<pe>>>0?1:0),X=T.low=X+xe,T.high=U+ve+(X>>>0<xe>>>0?1:0),ee=E.low=ee+Pe,E.high=$+ye+(ee>>>0<Pe>>>0?1:0),Z=D.low=Z+nt,D.high=le+Ke+(Z>>>0<nt>>>0?1:0),V=N.low=V+Ge,N.high=ie+Ce+(V>>>0<Ge>>>0?1:0),q=F.low=q+bt,F.high=ne+pt+(q>>>0<bt>>>0?1:0),Q=z.low=Q+mt,z.high=B+ot+(Q>>>0<mt>>>0?1:0),Y=I.low=Y+tt,I.high=G+et+(Y>>>0<tt>>>0?1:0)},_doFinalize:function(){var _=this._data,b=_.words,w=this._nDataBytes*8,C=_.sigBytes*8;b[C>>>5]|=128<<24-C%32,b[(C+128>>>10<<5)+30]=Math.floor(w/4294967296),b[(C+128>>>10<<5)+31]=w,_.sigBytes=b.length*4,this._process();var T=this._hash.toX32();return T},clone:function(){var _=s.clone.call(this);return _._hash=this._hash.clone(),_},blockSize:1024/32});r.SHA512=s._createHelper(A),r.HmacSHA512=s._createHmacHelper(A)})(),t.SHA512})})(w0)),w0.exports}var _0={exports:{}},C9=_0.exports,yO;function T9(){return yO||(yO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),dm(),EE())})(C9,function(t){return(function(){var r=t,i=r.x64,s=i.Word,o=i.WordArray,a=r.algo,u=a.SHA512,f=a.SHA384=u.extend({_doReset:function(){this._hash=new o.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var p=u._doFinalize.call(this);return p.sigBytes-=16,p}});r.SHA384=u._createHelper(f),r.HmacSHA384=u._createHmacHelper(f)})(),t.SHA384})})(_0)),_0.exports}var O0={exports:{}},E9=O0.exports,vO;function P9(){return vO||(vO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),dm())})(E9,function(t){return(function(r){var i=t,s=i.lib,o=s.WordArray,a=s.Hasher,u=i.x64,f=u.Word,p=i.algo,g=[],x=[],A=[];(function(){for(var w=1,C=0,T=0;T<24;T++){g[w+5*C]=(T+1)*(T+2)/2%64;var E=C%5,D=(2*w+3*C)%5;w=E,C=D}for(var w=0;w<5;w++)for(var C=0;C<5;C++)x[w+5*C]=C+(2*w+3*C)%5*5;for(var N=1,F=0;F<24;F++){for(var z=0,I=0,K=0;K<7;K++){if(N&1){var W=(1<<K)-1;W<32?I^=1<<W:z^=1<<W-32}N&128?N=N<<1^113:N<<=1}A[F]=f.create(z,I)}})();var _=[];(function(){for(var w=0;w<25;w++)_[w]=f.create()})();var b=p.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var w=this._state=[],C=0;C<25;C++)w[C]=new f.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(w,C){for(var T=this._state,E=this.blockSize/2,D=0;D<E;D++){var N=w[C+2*D],F=w[C+2*D+1];N=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,F=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360;var z=T[D];z.high^=F,z.low^=N}for(var I=0;I<24;I++){for(var K=0;K<5;K++){for(var W=0,U=0,X=0;X<5;X++){var z=T[K+5*X];W^=z.high,U^=z.low}var $=_[K];$.high=W,$.low=U}for(var K=0;K<5;K++)for(var ee=_[(K+4)%5],le=_[(K+1)%5],Z=le.high,ie=le.low,W=ee.high^(Z<<1|ie>>>31),U=ee.low^(ie<<1|Z>>>31),X=0;X<5;X++){var z=T[K+5*X];z.high^=W,z.low^=U}for(var V=1;V<25;V++){var W,U,z=T[V],ne=z.high,q=z.low,B=g[V];B<32?(W=ne<<B|q>>>32-B,U=q<<B|ne>>>32-B):(W=q<<B-32|ne>>>64-B,U=ne<<B-32|q>>>64-B);var Q=_[x[V]];Q.high=W,Q.low=U}var G=_[0],Y=T[0];G.high=Y.high,G.low=Y.low;for(var K=0;K<5;K++)for(var X=0;X<5;X++){var V=K+5*X,z=T[V],ue=_[V],pe=_[(K+1)%5+5*X],ve=_[(K+2)%5+5*X];z.high=ue.high^~pe.high&ve.high,z.low=ue.low^~pe.low&ve.low}var z=T[0],xe=A[I];z.high^=xe.high,z.low^=xe.low}},_doFinalize:function(){var w=this._data,C=w.words;this._nDataBytes*8;var T=w.sigBytes*8,E=this.blockSize*32;C[T>>>5]|=1<<24-T%32,C[(r.ceil((T+1)/E)*E>>>5)-1]|=128,w.sigBytes=C.length*4,this._process();for(var D=this._state,N=this.cfg.outputLength/8,F=N/8,z=[],I=0;I<F;I++){var K=D[I],W=K.high,U=K.low;W=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360,U=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360,z.push(U),z.push(W)}return new o.init(z,N)},clone:function(){for(var w=a.clone.call(this),C=w._state=this._state.slice(0),T=0;T<25;T++)C[T]=C[T].clone();return w}});i.SHA3=a._createHelper(b),i.HmacSHA3=a._createHmacHelper(b)})(Math),t.SHA3})})(O0)),O0.exports}var k0={exports:{}},B9=k0.exports,AO;function R9(){return AO||(AO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(B9,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return(function(r){var i=t,s=i.lib,o=s.WordArray,a=s.Hasher,u=i.algo,f=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),p=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),g=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),x=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),A=o.create([0,1518500249,1859775393,2400959708,2840853838]),_=o.create([1352829926,1548603684,1836072691,2053994217,0]),b=u.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(F,z){for(var I=0;I<16;I++){var K=z+I,W=F[K];F[K]=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360}var U=this._hash.words,X=A.words,$=_.words,ee=f.words,le=p.words,Z=g.words,ie=x.words,V,ne,q,B,Q,G,Y,ue,pe,ve;G=V=U[0],Y=ne=U[1],ue=q=U[2],pe=B=U[3],ve=Q=U[4];for(var xe,I=0;I<80;I+=1)xe=V+F[z+ee[I]]|0,I<16?xe+=w(ne,q,B)+X[0]:I<32?xe+=C(ne,q,B)+X[1]:I<48?xe+=T(ne,q,B)+X[2]:I<64?xe+=E(ne,q,B)+X[3]:xe+=D(ne,q,B)+X[4],xe=xe|0,xe=N(xe,Z[I]),xe=xe+Q|0,V=Q,Q=B,B=N(q,10),q=ne,ne=xe,xe=G+F[z+le[I]]|0,I<16?xe+=D(Y,ue,pe)+$[0]:I<32?xe+=E(Y,ue,pe)+$[1]:I<48?xe+=T(Y,ue,pe)+$[2]:I<64?xe+=C(Y,ue,pe)+$[3]:xe+=w(Y,ue,pe)+$[4],xe=xe|0,xe=N(xe,ie[I]),xe=xe+ve|0,G=ve,ve=pe,pe=N(ue,10),ue=Y,Y=xe;xe=U[1]+q+pe|0,U[1]=U[2]+B+ve|0,U[2]=U[3]+Q+G|0,U[3]=U[4]+V+Y|0,U[4]=U[0]+ne+ue|0,U[0]=xe},_doFinalize:function(){var F=this._data,z=F.words,I=this._nDataBytes*8,K=F.sigBytes*8;z[K>>>5]|=128<<24-K%32,z[(K+64>>>9<<4)+14]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,F.sigBytes=(z.length+1)*4,this._process();for(var W=this._hash,U=W.words,X=0;X<5;X++){var $=U[X];U[X]=($<<8|$>>>24)&16711935|($<<24|$>>>8)&4278255360}return W},clone:function(){var F=a.clone.call(this);return F._hash=this._hash.clone(),F}});function w(F,z,I){return F^z^I}function C(F,z,I){return F&z|~F&I}function T(F,z,I){return(F|~z)^I}function E(F,z,I){return F&I|z&~I}function D(F,z,I){return F^(z|~I)}function N(F,z){return F<<z|F>>>32-z}i.RIPEMD160=a._createHelper(b),i.HmacRIPEMD160=a._createHmacHelper(b)})(),t.RIPEMD160})})(k0)),k0.exports}var S0={exports:{}},D9=S0.exports,bO;function pm(){return bO||(bO=1,(function(n,e){(function(t,r){n.exports=r(Et())})(D9,function(t){(function(){var r=t,i=r.lib,s=i.Base,o=r.enc,a=o.Utf8,u=r.algo;u.HMAC=s.extend({init:function(f,p){f=this._hasher=new f.init,typeof p=="string"&&(p=a.parse(p));var g=f.blockSize,x=g*4;p.sigBytes>x&&(p=f.finalize(p)),p.clamp();for(var A=this._oKey=p.clone(),_=this._iKey=p.clone(),b=A.words,w=_.words,C=0;C<g;C++)b[C]^=1549556828,w[C]^=909522486;A.sigBytes=_.sigBytes=x,this.reset()},reset:function(){var f=this._hasher;f.reset(),f.update(this._iKey)},update:function(f){return this._hasher.update(f),this},finalize:function(f){var p=this._hasher,g=p.finalize(f);p.reset();var x=p.finalize(this._oKey.clone().concat(g));return x}})})()})})(S0)),S0.exports}var C0={exports:{}},M9=C0.exports,wO;function N9(){return wO||(wO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Gh(),pm())})(M9,function(t){return(function(){var r=t,i=r.lib,s=i.Base,o=i.WordArray,a=r.algo,u=a.SHA256,f=a.HMAC,p=a.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:u,iterations:25e4}),init:function(g){this.cfg=this.cfg.extend(g)},compute:function(g,x){for(var A=this.cfg,_=f.create(A.hasher,g),b=o.create(),w=o.create([1]),C=b.words,T=w.words,E=A.keySize,D=A.iterations;C.length<E;){var N=_.update(x).finalize(w);_.reset();for(var F=N.words,z=F.length,I=N,K=1;K<D;K++){I=_.finalize(I),_.reset();for(var W=I.words,U=0;U<z;U++)F[U]^=W[U]}b.concat(N),T[0]++}return b.sigBytes=E*4,b}});r.PBKDF2=function(g,x,A){return p.create(A).compute(g,x)}})(),t.PBKDF2})})(C0)),C0.exports}var T0={exports:{}},L9=T0.exports,_O;function ua(){return _O||(_O=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),TE(),pm())})(L9,function(t){return(function(){var r=t,i=r.lib,s=i.Base,o=i.WordArray,a=r.algo,u=a.MD5,f=a.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:u,iterations:1}),init:function(p){this.cfg=this.cfg.extend(p)},compute:function(p,g){for(var x,A=this.cfg,_=A.hasher.create(),b=o.create(),w=b.words,C=A.keySize,T=A.iterations;w.length<C;){x&&_.update(x),x=_.update(p).finalize(g),_.reset();for(var E=1;E<T;E++)x=_.finalize(x),_.reset();b.concat(x)}return b.sigBytes=C*4,b}});r.EvpKDF=function(p,g,x){return f.create(x).compute(p,g)}})(),t.EvpKDF})})(T0)),T0.exports}var E0={exports:{}},F9=E0.exports,OO;function Un(){return OO||(OO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ua())})(F9,function(t){t.lib.Cipher||(function(r){var i=t,s=i.lib,o=s.Base,a=s.WordArray,u=s.BufferedBlockAlgorithm,f=i.enc;f.Utf8;var p=f.Base64,g=i.algo,x=g.EvpKDF,A=s.Cipher=u.extend({cfg:o.extend(),createEncryptor:function(W,U){return this.create(this._ENC_XFORM_MODE,W,U)},createDecryptor:function(W,U){return this.create(this._DEC_XFORM_MODE,W,U)},init:function(W,U,X){this.cfg=this.cfg.extend(X),this._xformMode=W,this._key=U,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(W){return this._append(W),this._process()},finalize:function(W){W&&this._append(W);var U=this._doFinalize();return U},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function W(U){return typeof U=="string"?K:F}return function(U){return{encrypt:function(X,$,ee){return W($).encrypt(U,X,$,ee)},decrypt:function(X,$,ee){return W($).decrypt(U,X,$,ee)}}}})()});s.StreamCipher=A.extend({_doFinalize:function(){var W=this._process(!0);return W},blockSize:1});var _=i.mode={},b=s.BlockCipherMode=o.extend({createEncryptor:function(W,U){return this.Encryptor.create(W,U)},createDecryptor:function(W,U){return this.Decryptor.create(W,U)},init:function(W,U){this._cipher=W,this._iv=U}}),w=_.CBC=(function(){var W=b.extend();W.Encryptor=W.extend({processBlock:function(X,$){var ee=this._cipher,le=ee.blockSize;U.call(this,X,$,le),ee.encryptBlock(X,$),this._prevBlock=X.slice($,$+le)}}),W.Decryptor=W.extend({processBlock:function(X,$){var ee=this._cipher,le=ee.blockSize,Z=X.slice($,$+le);ee.decryptBlock(X,$),U.call(this,X,$,le),this._prevBlock=Z}});function U(X,$,ee){var le,Z=this._iv;Z?(le=Z,this._iv=r):le=this._prevBlock;for(var ie=0;ie<ee;ie++)X[$+ie]^=le[ie]}return W})(),C=i.pad={},T=C.Pkcs7={pad:function(W,U){for(var X=U*4,$=X-W.sigBytes%X,ee=$<<24|$<<16|$<<8|$,le=[],Z=0;Z<$;Z+=4)le.push(ee);var ie=a.create(le,$);W.concat(ie)},unpad:function(W){var U=W.words[W.sigBytes-1>>>2]&255;W.sigBytes-=U}};s.BlockCipher=A.extend({cfg:A.cfg.extend({mode:w,padding:T}),reset:function(){var W;A.reset.call(this);var U=this.cfg,X=U.iv,$=U.mode;this._xformMode==this._ENC_XFORM_MODE?W=$.createEncryptor:(W=$.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==W?this._mode.init(this,X&&X.words):(this._mode=W.call($,this,X&&X.words),this._mode.__creator=W)},_doProcessBlock:function(W,U){this._mode.processBlock(W,U)},_doFinalize:function(){var W,U=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(U.pad(this._data,this.blockSize),W=this._process(!0)):(W=this._process(!0),U.unpad(W)),W},blockSize:128/32});var E=s.CipherParams=o.extend({init:function(W){this.mixIn(W)},toString:function(W){return(W||this.formatter).stringify(this)}}),D=i.format={},N=D.OpenSSL={stringify:function(W){var U,X=W.ciphertext,$=W.salt;return $?U=a.create([1398893684,1701076831]).concat($).concat(X):U=X,U.toString(p)},parse:function(W){var U,X=p.parse(W),$=X.words;return $[0]==1398893684&&$[1]==1701076831&&(U=a.create($.slice(2,4)),$.splice(0,4),X.sigBytes-=16),E.create({ciphertext:X,salt:U})}},F=s.SerializableCipher=o.extend({cfg:o.extend({format:N}),encrypt:function(W,U,X,$){$=this.cfg.extend($);var ee=W.createEncryptor(X,$),le=ee.finalize(U),Z=ee.cfg;return E.create({ciphertext:le,key:X,iv:Z.iv,algorithm:W,mode:Z.mode,padding:Z.padding,blockSize:W.blockSize,formatter:$.format})},decrypt:function(W,U,X,$){$=this.cfg.extend($),U=this._parse(U,$.format);var ee=W.createDecryptor(X,$).finalize(U.ciphertext);return ee},_parse:function(W,U){return typeof W=="string"?U.parse(W,this):W}}),z=i.kdf={},I=z.OpenSSL={execute:function(W,U,X,$,ee){if($||($=a.random(64/8)),ee)var le=x.create({keySize:U+X,hasher:ee}).compute(W,$);else var le=x.create({keySize:U+X}).compute(W,$);var Z=a.create(le.words.slice(U),X*4);return le.sigBytes=U*4,E.create({key:le,iv:Z,salt:$})}},K=s.PasswordBasedCipher=F.extend({cfg:F.cfg.extend({kdf:I}),encrypt:function(W,U,X,$){$=this.cfg.extend($);var ee=$.kdf.execute(X,W.keySize,W.ivSize,$.salt,$.hasher);$.iv=ee.iv;var le=F.encrypt.call(this,W,U,ee.key,$);return le.mixIn(ee),le},decrypt:function(W,U,X,$){$=this.cfg.extend($),U=this._parse(U,$.format);var ee=$.kdf.execute(X,W.keySize,W.ivSize,U.salt,$.hasher);$.iv=ee.iv;var le=F.decrypt.call(this,W,U,ee.key,$);return le}})})()})})(E0)),E0.exports}var P0={exports:{}},I9=P0.exports,kO;function z9(){return kO||(kO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(I9,function(t){return t.mode.CFB=(function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(s,o){var a=this._cipher,u=a.blockSize;i.call(this,s,o,u,a),this._prevBlock=s.slice(o,o+u)}}),r.Decryptor=r.extend({processBlock:function(s,o){var a=this._cipher,u=a.blockSize,f=s.slice(o,o+u);i.call(this,s,o,u,a),this._prevBlock=f}});function i(s,o,a,u){var f,p=this._iv;p?(f=p.slice(0),this._iv=void 0):f=this._prevBlock,u.encryptBlock(f,0);for(var g=0;g<a;g++)s[o+g]^=f[g]}return r})(),t.mode.CFB})})(P0)),P0.exports}var B0={exports:{}},j9=B0.exports,SO;function Q9(){return SO||(SO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(j9,function(t){return t.mode.CTR=(function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,o){var a=this._cipher,u=a.blockSize,f=this._iv,p=this._counter;f&&(p=this._counter=f.slice(0),this._iv=void 0);var g=p.slice(0);a.encryptBlock(g,0),p[u-1]=p[u-1]+1|0;for(var x=0;x<u;x++)s[o+x]^=g[x]}});return r.Decryptor=i,r})(),t.mode.CTR})})(B0)),B0.exports}var R0={exports:{}},H9=R0.exports,CO;function W9(){return CO||(CO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(H9,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=(function(){var r=t.lib.BlockCipherMode.extend();function i(a){if((a>>24&255)===255){var u=a>>16&255,f=a>>8&255,p=a&255;u===255?(u=0,f===255?(f=0,p===255?p=0:++p):++f):++u,a=0,a+=u<<16,a+=f<<8,a+=p}else a+=1<<24;return a}function s(a){return(a[0]=i(a[0]))===0&&(a[1]=i(a[1])),a}var o=r.Encryptor=r.extend({processBlock:function(a,u){var f=this._cipher,p=f.blockSize,g=this._iv,x=this._counter;g&&(x=this._counter=g.slice(0),this._iv=void 0),s(x);var A=x.slice(0);f.encryptBlock(A,0);for(var _=0;_<p;_++)a[u+_]^=A[_]}});return r.Decryptor=o,r})(),t.mode.CTRGladman})})(R0)),R0.exports}var D0={exports:{}},q9=D0.exports,TO;function V9(){return TO||(TO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(q9,function(t){return t.mode.OFB=(function(){var r=t.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,o){var a=this._cipher,u=a.blockSize,f=this._iv,p=this._keystream;f&&(p=this._keystream=f.slice(0),this._iv=void 0),a.encryptBlock(p,0);for(var g=0;g<u;g++)s[o+g]^=p[g]}});return r.Decryptor=i,r})(),t.mode.OFB})})(D0)),D0.exports}var M0={exports:{}},$9=M0.exports,EO;function U9(){return EO||(EO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})($9,function(t){return t.mode.ECB=(function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,s){this._cipher.encryptBlock(i,s)}}),r.Decryptor=r.extend({processBlock:function(i,s){this._cipher.decryptBlock(i,s)}}),r})(),t.mode.ECB})})(M0)),M0.exports}var N0={exports:{}},Z9=N0.exports,PO;function G9(){return PO||(PO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(Z9,function(t){return t.pad.AnsiX923={pad:function(r,i){var s=r.sigBytes,o=i*4,a=o-s%o,u=s+a-1;r.clamp(),r.words[u>>>2]|=a<<24-u%4*8,r.sigBytes+=a},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Ansix923})})(N0)),N0.exports}var L0={exports:{}},X9=L0.exports,BO;function K9(){return BO||(BO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(X9,function(t){return t.pad.Iso10126={pad:function(r,i){var s=i*4,o=s-r.sigBytes%s;r.concat(t.lib.WordArray.random(o-1)).concat(t.lib.WordArray.create([o<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},t.pad.Iso10126})})(L0)),L0.exports}var F0={exports:{}},Y9=F0.exports,RO;function J9(){return RO||(RO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(Y9,function(t){return t.pad.Iso97971={pad:function(r,i){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,i)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})})(F0)),F0.exports}var I0={exports:{}},ej=I0.exports,DO;function tj(){return DO||(DO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(ej,function(t){return t.pad.ZeroPadding={pad:function(r,i){var s=i*4;r.clamp(),r.sigBytes+=s-(r.sigBytes%s||s)},unpad:function(r){for(var i=r.words,s=r.sigBytes-1,s=r.sigBytes-1;s>=0;s--)if(i[s>>>2]>>>24-s%4*8&255){r.sigBytes=s+1;break}}},t.pad.ZeroPadding})})(I0)),I0.exports}var z0={exports:{}},nj=z0.exports,MO;function rj(){return MO||(MO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(nj,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})})(z0)),z0.exports}var j0={exports:{}},ij=j0.exports,NO;function sj(){return NO||(NO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Un())})(ij,function(t){return(function(r){var i=t,s=i.lib,o=s.CipherParams,a=i.enc,u=a.Hex,f=i.format;f.Hex={stringify:function(p){return p.ciphertext.toString(u)},parse:function(p){var g=u.parse(p);return o.create({ciphertext:g})}}})(),t.format.Hex})})(j0)),j0.exports}var Q0={exports:{}},oj=Q0.exports,LO;function aj(){return LO||(LO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ul(),hl(),ua(),Un())})(oj,function(t){return(function(){var r=t,i=r.lib,s=i.BlockCipher,o=r.algo,a=[],u=[],f=[],p=[],g=[],x=[],A=[],_=[],b=[],w=[];(function(){for(var E=[],D=0;D<256;D++)D<128?E[D]=D<<1:E[D]=D<<1^283;for(var N=0,F=0,D=0;D<256;D++){var z=F^F<<1^F<<2^F<<3^F<<4;z=z>>>8^z&255^99,a[N]=z,u[z]=N;var I=E[N],K=E[I],W=E[K],U=E[z]*257^z*16843008;f[N]=U<<24|U>>>8,p[N]=U<<16|U>>>16,g[N]=U<<8|U>>>24,x[N]=U;var U=W*16843009^K*65537^I*257^N*16843008;A[z]=U<<24|U>>>8,_[z]=U<<16|U>>>16,b[z]=U<<8|U>>>24,w[z]=U,N?(N=I^E[E[E[W^I]]],F^=E[E[F]]):N=F=1}})();var C=[0,1,2,4,8,16,32,64,128,27,54],T=o.AES=s.extend({_doReset:function(){var E;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var D=this._keyPriorReset=this._key,N=D.words,F=D.sigBytes/4,z=this._nRounds=F+6,I=(z+1)*4,K=this._keySchedule=[],W=0;W<I;W++)W<F?K[W]=N[W]:(E=K[W-1],W%F?F>6&&W%F==4&&(E=a[E>>>24]<<24|a[E>>>16&255]<<16|a[E>>>8&255]<<8|a[E&255]):(E=E<<8|E>>>24,E=a[E>>>24]<<24|a[E>>>16&255]<<16|a[E>>>8&255]<<8|a[E&255],E^=C[W/F|0]<<24),K[W]=K[W-F]^E);for(var U=this._invKeySchedule=[],X=0;X<I;X++){var W=I-X;if(X%4)var E=K[W];else var E=K[W-4];X<4||W<=4?U[X]=E:U[X]=A[a[E>>>24]]^_[a[E>>>16&255]]^b[a[E>>>8&255]]^w[a[E&255]]}}},encryptBlock:function(E,D){this._doCryptBlock(E,D,this._keySchedule,f,p,g,x,a)},decryptBlock:function(E,D){var N=E[D+1];E[D+1]=E[D+3],E[D+3]=N,this._doCryptBlock(E,D,this._invKeySchedule,A,_,b,w,u);var N=E[D+1];E[D+1]=E[D+3],E[D+3]=N},_doCryptBlock:function(E,D,N,F,z,I,K,W){for(var U=this._nRounds,X=E[D]^N[0],$=E[D+1]^N[1],ee=E[D+2]^N[2],le=E[D+3]^N[3],Z=4,ie=1;ie<U;ie++){var V=F[X>>>24]^z[$>>>16&255]^I[ee>>>8&255]^K[le&255]^N[Z++],ne=F[$>>>24]^z[ee>>>16&255]^I[le>>>8&255]^K[X&255]^N[Z++],q=F[ee>>>24]^z[le>>>16&255]^I[X>>>8&255]^K[$&255]^N[Z++],B=F[le>>>24]^z[X>>>16&255]^I[$>>>8&255]^K[ee&255]^N[Z++];X=V,$=ne,ee=q,le=B}var V=(W[X>>>24]<<24|W[$>>>16&255]<<16|W[ee>>>8&255]<<8|W[le&255])^N[Z++],ne=(W[$>>>24]<<24|W[ee>>>16&255]<<16|W[le>>>8&255]<<8|W[X&255])^N[Z++],q=(W[ee>>>24]<<24|W[le>>>16&255]<<16|W[X>>>8&255]<<8|W[$&255])^N[Z++],B=(W[le>>>24]<<24|W[X>>>16&255]<<16|W[$>>>8&255]<<8|W[ee&255])^N[Z++];E[D]=V,E[D+1]=ne,E[D+2]=q,E[D+3]=B},keySize:256/32});r.AES=s._createHelper(T)})(),t.AES})})(Q0)),Q0.exports}var H0={exports:{}},lj=H0.exports,FO;function cj(){return FO||(FO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ul(),hl(),ua(),Un())})(lj,function(t){return(function(){var r=t,i=r.lib,s=i.WordArray,o=i.BlockCipher,a=r.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],f=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],p=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],g=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],x=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],A=a.DES=o.extend({_doReset:function(){for(var C=this._key,T=C.words,E=[],D=0;D<56;D++){var N=u[D]-1;E[D]=T[N>>>5]>>>31-N%32&1}for(var F=this._subKeys=[],z=0;z<16;z++){for(var I=F[z]=[],K=p[z],D=0;D<24;D++)I[D/6|0]|=E[(f[D]-1+K)%28]<<31-D%6,I[4+(D/6|0)]|=E[28+(f[D+24]-1+K)%28]<<31-D%6;I[0]=I[0]<<1|I[0]>>>31;for(var D=1;D<7;D++)I[D]=I[D]>>>(D-1)*4+3;I[7]=I[7]<<5|I[7]>>>27}for(var W=this._invSubKeys=[],D=0;D<16;D++)W[D]=F[15-D]},encryptBlock:function(C,T){this._doCryptBlock(C,T,this._subKeys)},decryptBlock:function(C,T){this._doCryptBlock(C,T,this._invSubKeys)},_doCryptBlock:function(C,T,E){this._lBlock=C[T],this._rBlock=C[T+1],_.call(this,4,252645135),_.call(this,16,65535),b.call(this,2,858993459),b.call(this,8,16711935),_.call(this,1,1431655765);for(var D=0;D<16;D++){for(var N=E[D],F=this._lBlock,z=this._rBlock,I=0,K=0;K<8;K++)I|=g[K][((z^N[K])&x[K])>>>0];this._lBlock=z,this._rBlock=F^I}var W=this._lBlock;this._lBlock=this._rBlock,this._rBlock=W,_.call(this,1,1431655765),b.call(this,8,16711935),b.call(this,2,858993459),_.call(this,16,65535),_.call(this,4,252645135),C[T]=this._lBlock,C[T+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function _(C,T){var E=(this._lBlock>>>C^this._rBlock)&T;this._rBlock^=E,this._lBlock^=E<<C}function b(C,T){var E=(this._rBlock>>>C^this._lBlock)&T;this._lBlock^=E,this._rBlock^=E<<C}r.DES=o._createHelper(A);var w=a.TripleDES=o.extend({_doReset:function(){var C=this._key,T=C.words;if(T.length!==2&&T.length!==4&&T.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var E=T.slice(0,2),D=T.length<4?T.slice(0,2):T.slice(2,4),N=T.length<6?T.slice(0,2):T.slice(4,6);this._des1=A.createEncryptor(s.create(E)),this._des2=A.createEncryptor(s.create(D)),this._des3=A.createEncryptor(s.create(N))},encryptBlock:function(C,T){this._des1.encryptBlock(C,T),this._des2.decryptBlock(C,T),this._des3.encryptBlock(C,T)},decryptBlock:function(C,T){this._des3.decryptBlock(C,T),this._des2.encryptBlock(C,T),this._des1.decryptBlock(C,T)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(w)})(),t.TripleDES})})(H0)),H0.exports}var W0={exports:{}},uj=W0.exports,IO;function hj(){return IO||(IO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ul(),hl(),ua(),Un())})(uj,function(t){return(function(){var r=t,i=r.lib,s=i.StreamCipher,o=r.algo,a=o.RC4=s.extend({_doReset:function(){for(var p=this._key,g=p.words,x=p.sigBytes,A=this._S=[],_=0;_<256;_++)A[_]=_;for(var _=0,b=0;_<256;_++){var w=_%x,C=g[w>>>2]>>>24-w%4*8&255;b=(b+A[_]+C)%256;var T=A[_];A[_]=A[b],A[b]=T}this._i=this._j=0},_doProcessBlock:function(p,g){p[g]^=u.call(this)},keySize:256/32,ivSize:0});function u(){for(var p=this._S,g=this._i,x=this._j,A=0,_=0;_<4;_++){g=(g+1)%256,x=(x+p[g])%256;var b=p[g];p[g]=p[x],p[x]=b,A|=p[(p[g]+p[x])%256]<<24-_*8}return this._i=g,this._j=x,A}r.RC4=s._createHelper(a);var f=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var p=this.cfg.drop;p>0;p--)u.call(this)}});r.RC4Drop=s._createHelper(f)})(),t.RC4})})(W0)),W0.exports}var q0={exports:{}},fj=q0.exports,zO;function dj(){return zO||(zO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ul(),hl(),ua(),Un())})(fj,function(t){return(function(){var r=t,i=r.lib,s=i.StreamCipher,o=r.algo,a=[],u=[],f=[],p=o.Rabbit=s.extend({_doReset:function(){for(var x=this._key.words,A=this.cfg.iv,_=0;_<4;_++)x[_]=(x[_]<<8|x[_]>>>24)&16711935|(x[_]<<24|x[_]>>>8)&4278255360;var b=this._X=[x[0],x[3]<<16|x[2]>>>16,x[1],x[0]<<16|x[3]>>>16,x[2],x[1]<<16|x[0]>>>16,x[3],x[2]<<16|x[1]>>>16],w=this._C=[x[2]<<16|x[2]>>>16,x[0]&4294901760|x[1]&65535,x[3]<<16|x[3]>>>16,x[1]&4294901760|x[2]&65535,x[0]<<16|x[0]>>>16,x[2]&4294901760|x[3]&65535,x[1]<<16|x[1]>>>16,x[3]&4294901760|x[0]&65535];this._b=0;for(var _=0;_<4;_++)g.call(this);for(var _=0;_<8;_++)w[_]^=b[_+4&7];if(A){var C=A.words,T=C[0],E=C[1],D=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,N=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,F=D>>>16|N&4294901760,z=N<<16|D&65535;w[0]^=D,w[1]^=F,w[2]^=N,w[3]^=z,w[4]^=D,w[5]^=F,w[6]^=N,w[7]^=z;for(var _=0;_<4;_++)g.call(this)}},_doProcessBlock:function(x,A){var _=this._X;g.call(this),a[0]=_[0]^_[5]>>>16^_[3]<<16,a[1]=_[2]^_[7]>>>16^_[5]<<16,a[2]=_[4]^_[1]>>>16^_[7]<<16,a[3]=_[6]^_[3]>>>16^_[1]<<16;for(var b=0;b<4;b++)a[b]=(a[b]<<8|a[b]>>>24)&16711935|(a[b]<<24|a[b]>>>8)&4278255360,x[A+b]^=a[b]},blockSize:128/32,ivSize:64/32});function g(){for(var x=this._X,A=this._C,_=0;_<8;_++)u[_]=A[_];A[0]=A[0]+1295307597+this._b|0,A[1]=A[1]+3545052371+(A[0]>>>0<u[0]>>>0?1:0)|0,A[2]=A[2]+886263092+(A[1]>>>0<u[1]>>>0?1:0)|0,A[3]=A[3]+1295307597+(A[2]>>>0<u[2]>>>0?1:0)|0,A[4]=A[4]+3545052371+(A[3]>>>0<u[3]>>>0?1:0)|0,A[5]=A[5]+886263092+(A[4]>>>0<u[4]>>>0?1:0)|0,A[6]=A[6]+1295307597+(A[5]>>>0<u[5]>>>0?1:0)|0,A[7]=A[7]+3545052371+(A[6]>>>0<u[6]>>>0?1:0)|0,this._b=A[7]>>>0<u[7]>>>0?1:0;for(var _=0;_<8;_++){var b=x[_]+A[_],w=b&65535,C=b>>>16,T=((w*w>>>17)+w*C>>>15)+C*C,E=((b&4294901760)*b|0)+((b&65535)*b|0);f[_]=T^E}x[0]=f[0]+(f[7]<<16|f[7]>>>16)+(f[6]<<16|f[6]>>>16)|0,x[1]=f[1]+(f[0]<<8|f[0]>>>24)+f[7]|0,x[2]=f[2]+(f[1]<<16|f[1]>>>16)+(f[0]<<16|f[0]>>>16)|0,x[3]=f[3]+(f[2]<<8|f[2]>>>24)+f[1]|0,x[4]=f[4]+(f[3]<<16|f[3]>>>16)+(f[2]<<16|f[2]>>>16)|0,x[5]=f[5]+(f[4]<<8|f[4]>>>24)+f[3]|0,x[6]=f[6]+(f[5]<<16|f[5]>>>16)+(f[4]<<16|f[4]>>>16)|0,x[7]=f[7]+(f[6]<<8|f[6]>>>24)+f[5]|0}r.Rabbit=s._createHelper(p)})(),t.Rabbit})})(q0)),q0.exports}var V0={exports:{}},pj=V0.exports,jO;function mj(){return jO||(jO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ul(),hl(),ua(),Un())})(pj,function(t){return(function(){var r=t,i=r.lib,s=i.StreamCipher,o=r.algo,a=[],u=[],f=[],p=o.RabbitLegacy=s.extend({_doReset:function(){var x=this._key.words,A=this.cfg.iv,_=this._X=[x[0],x[3]<<16|x[2]>>>16,x[1],x[0]<<16|x[3]>>>16,x[2],x[1]<<16|x[0]>>>16,x[3],x[2]<<16|x[1]>>>16],b=this._C=[x[2]<<16|x[2]>>>16,x[0]&4294901760|x[1]&65535,x[3]<<16|x[3]>>>16,x[1]&4294901760|x[2]&65535,x[0]<<16|x[0]>>>16,x[2]&4294901760|x[3]&65535,x[1]<<16|x[1]>>>16,x[3]&4294901760|x[0]&65535];this._b=0;for(var w=0;w<4;w++)g.call(this);for(var w=0;w<8;w++)b[w]^=_[w+4&7];if(A){var C=A.words,T=C[0],E=C[1],D=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,N=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,F=D>>>16|N&4294901760,z=N<<16|D&65535;b[0]^=D,b[1]^=F,b[2]^=N,b[3]^=z,b[4]^=D,b[5]^=F,b[6]^=N,b[7]^=z;for(var w=0;w<4;w++)g.call(this)}},_doProcessBlock:function(x,A){var _=this._X;g.call(this),a[0]=_[0]^_[5]>>>16^_[3]<<16,a[1]=_[2]^_[7]>>>16^_[5]<<16,a[2]=_[4]^_[1]>>>16^_[7]<<16,a[3]=_[6]^_[3]>>>16^_[1]<<16;for(var b=0;b<4;b++)a[b]=(a[b]<<8|a[b]>>>24)&16711935|(a[b]<<24|a[b]>>>8)&4278255360,x[A+b]^=a[b]},blockSize:128/32,ivSize:64/32});function g(){for(var x=this._X,A=this._C,_=0;_<8;_++)u[_]=A[_];A[0]=A[0]+1295307597+this._b|0,A[1]=A[1]+3545052371+(A[0]>>>0<u[0]>>>0?1:0)|0,A[2]=A[2]+886263092+(A[1]>>>0<u[1]>>>0?1:0)|0,A[3]=A[3]+1295307597+(A[2]>>>0<u[2]>>>0?1:0)|0,A[4]=A[4]+3545052371+(A[3]>>>0<u[3]>>>0?1:0)|0,A[5]=A[5]+886263092+(A[4]>>>0<u[4]>>>0?1:0)|0,A[6]=A[6]+1295307597+(A[5]>>>0<u[5]>>>0?1:0)|0,A[7]=A[7]+3545052371+(A[6]>>>0<u[6]>>>0?1:0)|0,this._b=A[7]>>>0<u[7]>>>0?1:0;for(var _=0;_<8;_++){var b=x[_]+A[_],w=b&65535,C=b>>>16,T=((w*w>>>17)+w*C>>>15)+C*C,E=((b&4294901760)*b|0)+((b&65535)*b|0);f[_]=T^E}x[0]=f[0]+(f[7]<<16|f[7]>>>16)+(f[6]<<16|f[6]>>>16)|0,x[1]=f[1]+(f[0]<<8|f[0]>>>24)+f[7]|0,x[2]=f[2]+(f[1]<<16|f[1]>>>16)+(f[0]<<16|f[0]>>>16)|0,x[3]=f[3]+(f[2]<<8|f[2]>>>24)+f[1]|0,x[4]=f[4]+(f[3]<<16|f[3]>>>16)+(f[2]<<16|f[2]>>>16)|0,x[5]=f[5]+(f[4]<<8|f[4]>>>24)+f[3]|0,x[6]=f[6]+(f[5]<<16|f[5]>>>16)+(f[4]<<16|f[4]>>>16)|0,x[7]=f[7]+(f[6]<<8|f[6]>>>24)+f[5]|0}r.RabbitLegacy=s._createHelper(p)})(),t.RabbitLegacy})})(V0)),V0.exports}var $0={exports:{}},gj=$0.exports,QO;function xj(){return QO||(QO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),ul(),hl(),ua(),Un())})(gj,function(t){return(function(){var r=t,i=r.lib,s=i.BlockCipher,o=r.algo;const a=16,u=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],f=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var p={pbox:[],sbox:[]};function g(w,C){let T=C>>24&255,E=C>>16&255,D=C>>8&255,N=C&255,F=w.sbox[0][T]+w.sbox[1][E];return F=F^w.sbox[2][D],F=F+w.sbox[3][N],F}function x(w,C,T){let E=C,D=T,N;for(let F=0;F<a;++F)E=E^w.pbox[F],D=g(w,E)^D,N=E,E=D,D=N;return N=E,E=D,D=N,D=D^w.pbox[a],E=E^w.pbox[a+1],{left:E,right:D}}function A(w,C,T){let E=C,D=T,N;for(let F=a+1;F>1;--F)E=E^w.pbox[F],D=g(w,E)^D,N=E,E=D,D=N;return N=E,E=D,D=N,D=D^w.pbox[1],E=E^w.pbox[0],{left:E,right:D}}function _(w,C,T){for(let z=0;z<4;z++){w.sbox[z]=[];for(let I=0;I<256;I++)w.sbox[z][I]=f[z][I]}let E=0;for(let z=0;z<a+2;z++)w.pbox[z]=u[z]^C[E],E++,E>=T&&(E=0);let D=0,N=0,F=0;for(let z=0;z<a+2;z+=2)F=x(w,D,N),D=F.left,N=F.right,w.pbox[z]=D,w.pbox[z+1]=N;for(let z=0;z<4;z++)for(let I=0;I<256;I+=2)F=x(w,D,N),D=F.left,N=F.right,w.sbox[z][I]=D,w.sbox[z][I+1]=N;return!0}var b=o.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var w=this._keyPriorReset=this._key,C=w.words,T=w.sigBytes/4;_(p,C,T)}},encryptBlock:function(w,C){var T=x(p,w[C],w[C+1]);w[C]=T.left,w[C+1]=T.right},decryptBlock:function(w,C){var T=A(p,w[C],w[C+1]);w[C]=T.left,w[C+1]=T.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=s._createHelper(b)})(),t.Blowfish})})($0)),$0.exports}var yj=h0.exports,HO;function PE(){return HO||(HO=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),dm(),m9(),x9(),ul(),A9(),hl(),TE(),Gh(),k9(),EE(),T9(),P9(),R9(),pm(),N9(),ua(),Un(),z9(),Q9(),W9(),V9(),U9(),G9(),K9(),J9(),tj(),rj(),sj(),aj(),cj(),hj(),dj(),mj(),xj())})(yj,function(t){return t})})(h0)),h0.exports}var WO;function mA(){if(WO)return Iu;WO=1,Object.defineProperty(Iu,"__esModule",{value:!0}),Iu.ChannelCrypto=void 0;const n=PE(),e=nr();class t{static decryptGroupTextMessage(i,s,o){try{const a=(0,e.hexToBytes)(o),u=(0,e.hexToBytes)(s),f=new Uint8Array(32);f.set(a,0);const p=(0,n.HmacSHA256)(n.enc.Hex.parse(i),n.enc.Hex.parse((0,e.bytesToHex)(f))),x=(0,e.hexToBytes)(p.toString(n.enc.Hex)).slice(0,2);if(x[0]!==u[0]||x[1]!==u[1])return{success:!1,error:"MAC verification failed"};const A=n.enc.Hex.parse(o),_=n.enc.Hex.parse(i),b=n.AES.decrypt(n.lib.CipherParams.create({ciphertext:_}),A,{mode:n.mode.ECB,padding:n.pad.NoPadding}),w=(0,e.hexToBytes)(b.toString(n.enc.Hex));if(!w||w.length<5)return{success:!1,error:"Decrypted content too short"};const C=w[0]|w[1]<<8|w[2]<<16|w[3]<<24,T=w[4],E=w.slice(5);let N=new TextDecoder("utf-8").decode(E);const F=N.indexOf("\0");F>=0&&(N=N.substring(0,F));const z=N.indexOf(": ");let I,K;if(z>0&&z<50){const W=N.substring(0,z);/[:\[\]]/.test(W)?K=N:(I=W,K=N.substring(z+2))}else K=N;return{success:!0,data:{timestamp:C,flags:T,sender:I,message:K}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Decryption failed"}}}static calculateChannelHash(i){const s=(0,n.SHA256)(n.enc.Hex.parse(i));return(0,e.hexToBytes)(s.toString(n.enc.Hex))[0].toString(16).padStart(2,"0")}}return Iu.ChannelCrypto=t,Iu}var qO;function BE(){if(qO)return Fu;qO=1,Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.MeshCoreKeyStore=void 0;const n=mA();class e{constructor(r){this.nodeKeys=new Map,this.channelHashToKeys=new Map,r!=null&&r.channelSecrets&&this.addChannelSecrets(r.channelSecrets),r!=null&&r.nodeKeys&&Object.entries(r.nodeKeys).forEach(([i,s])=>{this.addNodeKey(i,s)})}addNodeKey(r,i){const s=r.toUpperCase();this.nodeKeys.set(s,i)}hasChannelKey(r){const i=r.toLowerCase();return this.channelHashToKeys.has(i)}hasNodeKey(r){const i=r.toUpperCase();return this.nodeKeys.has(i)}getChannelKeys(r){const i=r.toLowerCase();return this.channelHashToKeys.get(i)||[]}getNodeKey(r){const i=r.toUpperCase();return this.nodeKeys.get(i)}addChannelSecrets(r){for(const i of r){const s=n.ChannelCrypto.calculateChannelHash(i).toLowerCase();this.channelHashToKeys.has(s)||this.channelHashToKeys.set(s,[]),this.channelHashToKeys.get(s).push(i)}}}return Fu.MeshCoreKeyStore=e,Fu}var zu={},Fi={};/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const RE={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:ur,n:U0,Gx:VO,Gy:$O,a:$x,d:Ux}=RE,vj=8n,ws=32,Rh=64,si=(n="")=>{throw new Error(n)},Aj=n=>typeof n=="bigint",DE=n=>typeof n=="string",bj=n=>n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array",ll=(n,e)=>!bj(n)||typeof e=="number"&&e>0&&n.length!==e?si("Uint8Array expected"):n,mm=n=>new Uint8Array(n),gA=n=>Uint8Array.from(n),ME=(n,e)=>n.toString(16).padStart(e,"0"),xA=n=>Array.from(ll(n)).map(e=>ME(e,2)).join(""),Gs={_0:48,_9:57,A:65,F:70,a:97,f:102},UO=n=>{if(n>=Gs._0&&n<=Gs._9)return n-Gs._0;if(n>=Gs.A&&n<=Gs.F)return n-(Gs.A-10);if(n>=Gs.a&&n<=Gs.f)return n-(Gs.a-10)},yA=n=>{const e="hex invalid";if(!DE(n))return si(e);const t=n.length,r=t/2;if(t%2)return si(e);const i=mm(r);for(let s=0,o=0;s<r;s++,o+=2){const a=UO(n.charCodeAt(o)),u=UO(n.charCodeAt(o+1));if(a===void 0||u===void 0)return si(e);i[s]=a*16+u}return i},ta=(n,e)=>ll(DE(n)?yA(n):gA(ll(n)),e),NE=()=>globalThis==null?void 0:globalThis.crypto,wj=()=>{var n;return((n=NE())==null?void 0:n.subtle)??si("crypto.subtle must be defined")},Dh=(...n)=>{const e=mm(n.reduce((r,i)=>r+ll(i).length,0));let t=0;return n.forEach(r=>{e.set(r,t),t+=r.length}),e},LE=(n=ws)=>NE().getRandomValues(mm(n)),Bp=BigInt,Va=(n,e,t,r="bad number: out of range")=>Aj(n)&&e<=n&&n<t?n:si(r),Ze=(n,e=ur)=>{const t=n%e;return t>=0n?t:e+t},FE=n=>Ze(n,U0),IE=(n,e)=>{(n===0n||e<=0n)&&si("no inverse n="+n+" mod="+e);let t=Ze(n,e),r=e,i=0n,s=1n;for(;t!==0n;){const o=r/t,a=r%t,u=i-s*o;r=t,t=a,i=s,s=u}return r===1n?Ze(i,e):si("no inverse")},_j=n=>{const e=kA[n];return typeof e!="function"&&si("hashes."+n+" not set"),e},ZO=n=>n instanceof qi?n:si("Point expected"),ev=2n**256n,ds=class ds{constructor(e,t,r,i){La(this,"ex");La(this,"ey");La(this,"ez");La(this,"et");const s=ev;this.ex=Va(e,0n,s),this.ey=Va(t,0n,s),this.ez=Va(r,1n,s),this.et=Va(i,0n,s),Object.freeze(this)}static fromAffine(e){return new ds(e.x,e.y,1n,Ze(e.x*e.y))}static fromBytes(e,t=!1){const r=Ux,i=gA(ll(e,ws)),s=e[31];i[31]=s&-129;const o=vA(i);Va(o,0n,t?ev:ur);const u=Ze(o*o),f=Ze(u-1n),p=Ze(r*u+1n);let{isValid:g,value:x}=kj(f,p);g||si("bad point: y not sqrt");const A=(x&1n)===1n,_=(s&128)!==0;return!t&&x===0n&&_&&si("bad point: x==0, isLastByteOdd"),_!==A&&(x=Ze(-x)),new ds(x,o,1n,Ze(x*o))}assertValidity(){const e=$x,t=Ux,r=this;if(r.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=r,u=Ze(i*i),f=Ze(s*s),p=Ze(o*o),g=Ze(p*p),x=Ze(u*e),A=Ze(p*Ze(x+f)),_=Ze(g+Ze(t*Ze(u*f)));if(A!==_)throw new Error("bad point: equation left != right (1)");const b=Ze(i*s),w=Ze(o*a);if(b!==w)throw new Error("bad point: equation left != right (2)");return this}equals(e){const{ex:t,ey:r,ez:i}=this,{ex:s,ey:o,ez:a}=ZO(e),u=Ze(t*a),f=Ze(s*i),p=Ze(r*a),g=Ze(o*i);return u===f&&p===g}is0(){return this.equals(cc)}negate(){return new ds(Ze(-this.ex),this.ey,this.ez,Ze(-this.et))}double(){const{ex:e,ey:t,ez:r}=this,i=$x,s=Ze(e*e),o=Ze(t*t),a=Ze(2n*Ze(r*r)),u=Ze(i*s),f=e+t,p=Ze(Ze(f*f)-s-o),g=u+o,x=g-a,A=u-o,_=Ze(p*x),b=Ze(g*A),w=Ze(p*A),C=Ze(x*g);return new ds(_,b,C,w)}add(e){const{ex:t,ey:r,ez:i,et:s}=this,{ex:o,ey:a,ez:u,et:f}=ZO(e),p=$x,g=Ux,x=Ze(t*o),A=Ze(r*a),_=Ze(s*g*f),b=Ze(i*u),w=Ze((t+r)*(o+a)-x-A),C=Ze(b-_),T=Ze(b+_),E=Ze(A-p*x),D=Ze(w*C),N=Ze(T*E),F=Ze(w*E),z=Ze(C*T);return new ds(D,N,z,F)}multiply(e,t=!0){if(!t&&(e===0n||this.is0()))return cc;if(Va(e,1n,U0),e===1n)return this;if(this.equals(lo))return Nj(e).p;let r=cc,i=lo;for(let s=this;e>0n;s=s.double(),e>>=1n)e&1n?r=r.add(s):t&&(i=i.add(s));return r}toAffine(){const{ex:e,ey:t,ez:r}=this;if(this.equals(cc))return{x:0n,y:1n};const i=IE(r,ur);return Ze(r*i)!==1n&&si("invalid inverse"),{x:Ze(e*i),y:Ze(t*i)}}toBytes(){const{x:e,y:t}=this.assertValidity().toAffine(),r=zE(t);return r[31]|=e&1n?128:0,r}toHex(){return xA(this.toBytes())}clearCofactor(){return this.multiply(Bp(vj),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(U0/2n,!1).double();return U0%2n&&(e=e.add(this)),e.is0()}static fromHex(e,t){return ds.fromBytes(ta(e),t)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}toRawBytes(){return this.toBytes()}};La(ds,"BASE"),La(ds,"ZERO");let qi=ds;const lo=new qi(VO,$O,1n,Ze(VO*$O)),cc=new qi(0n,1n,1n,0n);qi.BASE=lo;qi.ZERO=cc;const zE=n=>yA(ME(Va(n,0n,ev),Rh)).reverse(),vA=n=>Bp("0x"+xA(gA(ll(n)).reverse())),hs=(n,e)=>{let t=n;for(;e-- >0n;)t*=t,t%=ur;return t},Oj=n=>{const t=n*n%ur*n%ur,r=hs(t,2n)*t%ur,i=hs(r,1n)*n%ur,s=hs(i,5n)*i%ur,o=hs(s,10n)*s%ur,a=hs(o,20n)*o%ur,u=hs(a,40n)*a%ur,f=hs(u,80n)*u%ur,p=hs(f,80n)*u%ur,g=hs(p,10n)*s%ur;return{pow_p_5_8:hs(g,2n)*n%ur,b2:t}},GO=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,kj=(n,e)=>{const t=Ze(e*e*e),r=Ze(t*t*e),i=Oj(n*r).pow_p_5_8;let s=Ze(n*t*i);const o=Ze(e*s*s),a=s,u=Ze(s*GO),f=o===n,p=o===Ze(-n),g=o===Ze(-n*GO);return f&&(s=a),(p||g)&&(s=u),(Ze(s)&1n)===1n&&(s=Ze(-s)),{isValid:f||p,value:s}},Rp=n=>FE(vA(n)),AA=(...n)=>kA.sha512Async(...n),bA=(...n)=>_j("sha512Sync")(...n),jE=n=>{const e=n.slice(0,ws);e[0]&=248,e[31]&=127,e[31]|=64;const t=n.slice(ws,Rh),r=Rp(e),i=lo.multiply(r),s=i.toBytes();return{head:e,prefix:t,scalar:r,point:i,pointBytes:s}},wA=n=>AA(ta(n,ws)).then(jE),_A=n=>jE(bA(ta(n,ws))),Sj=n=>wA(n).then(e=>e.pointBytes),Cj=n=>_A(n).pointBytes,QE=n=>AA(n.hashable).then(n.finish),HE=n=>n.finish(bA(n.hashable)),WE=(n,e,t)=>{const{pointBytes:r,scalar:i}=n,s=Rp(e),o=lo.multiply(s).toBytes();return{hashable:Dh(o,r,t),finish:f=>{const p=FE(s+Rp(f)*i);return ll(Dh(o,zE(p)),Rh)}}},Tj=async(n,e)=>{const t=ta(n),r=await wA(e),i=await AA(r.prefix,t);return QE(WE(r,i,t))},Ej=(n,e)=>{const t=ta(n),r=_A(e),i=bA(r.prefix,t);return HE(WE(r,i,t))},OA={zip215:!0},qE=(n,e,t,r=OA)=>{n=ta(n,Rh),e=ta(e),t=ta(t,ws);const{zip215:i}=r;let s,o,a,u,f=Uint8Array.of();try{s=qi.fromHex(t,i),o=qi.fromHex(n.slice(0,ws),i),a=vA(n.slice(ws,Rh)),u=lo.multiply(a,!1),f=Dh(o.toBytes(),s.toBytes(),e)}catch{}return{hashable:f,finish:g=>{if(u==null||!i&&s.isSmallOrder())return!1;const x=Rp(g);return o.add(s.multiply(x,!1)).add(u.negate()).clearCofactor().is0()}}},Pj=async(n,e,t,r=OA)=>QE(qE(n,e,t,r)),Bj=(n,e,t,r=OA)=>HE(qE(n,e,t,r)),kA={sha512Async:async(...n)=>{const e=wj(),t=Dh(...n);return mm(await e.digest("SHA-512",t.buffer))},sha512Sync:void 0,bytesToHex:xA,hexToBytes:yA,concatBytes:Dh,mod:Ze,invert:IE,randomBytes:LE},Rj={getExtendedPublicKeyAsync:wA,getExtendedPublicKey:_A,randomPrivateKey:()=>LE(ws),precompute:(n=8,e=lo)=>(e.multiply(3n),e)},Dp=8,Dj=256,VE=Math.ceil(Dj/Dp)+1,tv=2**(Dp-1),Mj=()=>{const n=[];let e=lo,t=e;for(let r=0;r<VE;r++){t=e,n.push(t);for(let i=1;i<tv;i++)t=t.add(e),n.push(t);e=t.double()}return n};let XO;const KO=(n,e)=>{const t=e.negate();return n?t:e},Nj=n=>{const e=XO||(XO=Mj());let t=cc,r=lo;const i=2**Dp,s=i,o=Bp(i-1),a=Bp(Dp);for(let u=0;u<VE;u++){let f=Number(n&o);n>>=a,f>tv&&(f-=s,n+=1n);const p=u*tv,g=p,x=p+Math.abs(f)-1,A=u%2!==0,_=f<0;f===0?r=r.add(KO(A,e[g])):t=t.add(KO(_,e[x]))}return{p:t,f:r}},Lj=Object.freeze(Object.defineProperty({__proto__:null,CURVE:RE,ExtendedPoint:qi,Point:qi,etc:kA,getPublicKey:Cj,getPublicKeyAsync:Sj,sign:Ej,signAsync:Tj,utils:Rj,verify:Bj,verifyAsync:Pj},Symbol.toStringTag,{value:"Module"})),Fj=Lk(Lj);var Qa={},Zx={exports:{}},YO;function Ij(){return YO||(YO=1,(function(n,e){var t=(()=>{var i;var r=typeof document<"u"?(i=document.currentScript)==null?void 0:i.src:void 0;return(async function(s={}){var zn;var o,a=s,u=typeof window=="object",f=typeof WorkerGlobalScope<"u",p=typeof process=="object"&&((zn=process.versions)==null?void 0:zn.node)&&process.type!="renderer";typeof __filename<"u"?r=__filename:f&&(r=self.location.href);var g="";function x(Ae){return a.locateFile?a.locateFile(Ae,g):g+Ae}var A,_;if(p){var b=Pp;g=__dirname+"/",_=Ae=>{Ae=E(Ae)?new URL(Ae):Ae;var Te=b.readFileSync(Ae);return Te},A=async(Ae,Te=!0)=>{Ae=E(Ae)?new URL(Ae):Ae;var Ie=b.readFileSync(Ae,Te?void 0:"utf8");return Ie},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2)}else if(u||f){try{g=new URL(".",r).href}catch{}f&&(_=Ae=>{var Te=new XMLHttpRequest;return Te.open("GET",Ae,!1),Te.responseType="arraybuffer",Te.send(null),new Uint8Array(Te.response)}),A=async Ae=>{if(E(Ae))return new Promise((Ie,xt)=>{var se=new XMLHttpRequest;se.open("GET",Ae,!0),se.responseType="arraybuffer",se.onload=()=>{if(se.status==200||se.status==0&&se.response){Ie(se.response);return}xt(se.status)},se.onerror=xt,se.send(null)});var Te=await fetch(Ae,{credentials:"same-origin"});if(Te.ok)return Te.arrayBuffer();throw new Error(Te.status+" : "+Te.url)}}console.log.bind(console);var w=console.error.bind(console),C,T=!1,E=Ae=>Ae.startsWith("file://"),D,N,F,z,I,K=!1;function W(){var Ae=F.buffer;a.HEAP8=z=new Int8Array(Ae),a.HEAPU8=I=new Uint8Array(Ae),a.HEAP32=new Int32Array(Ae),a.HEAPU32=new Uint32Array(Ae),new BigInt64Array(Ae),new BigUint64Array(Ae)}function U(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)Ke(a.preRun.shift());ve(Pe)}function X(){K=!0,Qt.b()}function $(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)ye(a.postRun.shift());ve(xe)}var ee=0,le=null;function Z(Ae){var Te;ee++,(Te=a.monitorRunDependencies)==null||Te.call(a,ee)}function ie(Ae){var Ie;if(ee--,(Ie=a.monitorRunDependencies)==null||Ie.call(a,ee),ee==0&&le){var Te=le;le=null,Te()}}function V(Ae){var Ie;(Ie=a.onAbort)==null||Ie.call(a,Ae),Ae="Aborted("+Ae+")",w(Ae),T=!0,Ae+=". Build with -sASSERTIONS for more info.";var Te=new WebAssembly.RuntimeError(Ae);throw N==null||N(Te),Te}var ne;function q(){return x("orlp-ed25519.wasm")}function B(Ae){if(Ae==ne&&C)return new Uint8Array(C);if(_)return _(Ae);throw"both async and sync fetching of the wasm failed"}async function Q(Ae){if(!C)try{var Te=await A(Ae);return new Uint8Array(Te)}catch{}return B(Ae)}async function G(Ae,Te){try{var Ie=await Q(Ae),xt=await WebAssembly.instantiate(Ie,Te);return xt}catch(se){w(`failed to asynchronously prepare wasm: ${se}`),V(se)}}async function Y(Ae,Te,Ie){if(!Ae&&typeof WebAssembly.instantiateStreaming=="function"&&!E(Te)&&!p)try{var xt=fetch(Te,{credentials:"same-origin"}),se=await WebAssembly.instantiateStreaming(xt,Ie);return se}catch(be){w(`wasm streaming compile failed: ${be}`),w("falling back to ArrayBuffer instantiation")}return G(Te,Ie)}function ue(){return{a:rn}}async function pe(){function Ae(be,Oe){return Qt=be.exports,F=Qt.a,W(),Zn(Qt),ie(),Qt}Z();function Te(be){return Ae(be.instance)}var Ie=ue();if(a.instantiateWasm)return new Promise((be,Oe)=>{a.instantiateWasm(Ie,(Le,lt)=>{be(Ae(Le))})});ne??(ne=q());var xt=await Y(C,ne,Ie),se=Te(xt);return se}var ve=Ae=>{for(;Ae.length>0;)Ae.shift()(a)},xe=[],ye=Ae=>xe.push(Ae),Pe=[],Ke=Ae=>Pe.push(Ae),nt=Ae=>en(Ae),Ce=()=>En(),Ge=Ae=>{var Te=a["_"+Ae];return Te},pt=(Ae,Te)=>{z.set(Ae,Te)},bt=Ae=>{for(var Te=0,Ie=0;Ie<Ae.length;++Ie){var xt=Ae.charCodeAt(Ie);xt<=127?Te++:xt<=2047?Te+=2:xt>=55296&&xt<=57343?(Te+=4,++Ie):Te+=3}return Te},ot=(Ae,Te,Ie,xt)=>{if(!(xt>0))return 0;for(var se=Ie,be=Ie+xt-1,Oe=0;Oe<Ae.length;++Oe){var Le=Ae.codePointAt(Oe);if(Le<=127){if(Ie>=be)break;Te[Ie++]=Le}else if(Le<=2047){if(Ie+1>=be)break;Te[Ie++]=192|Le>>6,Te[Ie++]=128|Le&63}else if(Le<=65535){if(Ie+2>=be)break;Te[Ie++]=224|Le>>12,Te[Ie++]=128|Le>>6&63,Te[Ie++]=128|Le&63}else{if(Ie+3>=be)break;Te[Ie++]=240|Le>>18,Te[Ie++]=128|Le>>12&63,Te[Ie++]=128|Le>>6&63,Te[Ie++]=128|Le&63,Oe++}}return Te[Ie]=0,Ie-se},mt=(Ae,Te,Ie)=>ot(Ae,I,Te,Ie),et=Ae=>vn(Ae),tt=Ae=>{var Te=bt(Ae)+1,Ie=et(Te);return mt(Ae,Ie,Te),Ie},at=typeof TextDecoder<"u"?new TextDecoder:void 0,qe=(Ae,Te=0,Ie=NaN)=>{for(var xt=Te+Ie,se=Te;Ae[se]&&!(se>=xt);)++se;if(se-Te>16&&Ae.buffer&&at)return at.decode(Ae.subarray(Te,se));for(var be="";Te<se;){var Oe=Ae[Te++];if(!(Oe&128)){be+=String.fromCharCode(Oe);continue}var Le=Ae[Te++]&63;if((Oe&224)==192){be+=String.fromCharCode((Oe&31)<<6|Le);continue}var lt=Ae[Te++]&63;if((Oe&240)==224?Oe=(Oe&15)<<12|Le<<6|lt:Oe=(Oe&7)<<18|Le<<12|lt<<6|Ae[Te++]&63,Oe<65536)be+=String.fromCharCode(Oe);else{var ae=Oe-65536;be+=String.fromCharCode(55296|ae>>10,56320|ae&1023)}}return be},Dt=(Ae,Te)=>Ae?qe(I,Ae,Te):"",Jt=(Ae,Te,Ie,xt,se)=>{var be={string:At=>{var Ht=0;return At!=null&&At!==0&&(Ht=tt(At)),Ht},array:At=>{var Ht=et(At.length);return pt(At,Ht),Ht}};function Oe(At){return Te==="string"?Dt(At):Te==="boolean"?!!At:At}var Le=Ge(Ae),lt=[],ae=0;if(xt)for(var De=0;De<xt.length;De++){var wt=be[Ie[De]];wt?(ae===0&&(ae=Ce()),lt[De]=wt(xt[De])):lt[De]=xt[De]}var Gt=Le(...lt);function On(At){return ae!==0&&nt(ae),Oe(At)}return Gt=On(Gt),Gt},dr=(Ae,Te,Ie,xt)=>{var se=!Ie||Ie.every(Oe=>Oe==="number"||Oe==="boolean"),be=Te!=="string";return be&&se&&!xt?Ge(Ae):(...Oe)=>Jt(Ae,Te,Ie,Oe)};a.noExitRuntime&&a.noExitRuntime,a.print&&a.print,a.printErr&&(w=a.printErr),a.wasmBinary&&(C=a.wasmBinary),a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.ccall=Jt,a.cwrap=dr;var en,vn,En;function Zn(Ae){a._orlp_derive_public_key=Ae.c,a._orlp_validate_keypair=Ae.d,a._orlp_sign=Ae.e,a._orlp_verify=Ae.f,en=Ae.g,vn=Ae.h,En=Ae.i}var rn={},Qt=await pe();function sn(){if(ee>0){le=sn;return}if(U(),ee>0){le=sn;return}function Ae(){var Te;a.calledRun=!0,!T&&(X(),D==null||D(a),(Te=a.onRuntimeInitialized)==null||Te.call(a),$())}a.setStatus?(a.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>a.setStatus(""),1),Ae()},1)):Ae()}function pr(){if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.shift()()}return pr(),sn(),K?o=a:o=new Promise((Ae,Te)=>{D=Ae,N=Te}),o})})();n.exports=t,n.exports.default=t})(Zx)),Zx.exports}var JO;function SA(){if(JO)return Qa;JO=1,Object.defineProperty(Qa,"__esModule",{value:!0}),Qa.derivePublicKey=r,Qa.validateKeyPair=i,Qa.sign=s,Qa.verify=o;const n=nr(),e=Ij();async function t(){return await e()}async function r(a){const u=await t(),f=(0,n.hexToBytes)(a);if(f.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${f.length}`);const p=1024,g=1088;if(u.HEAPU8.set(f,p),u.ccall("orlp_derive_public_key","number",["number","number"],[g,p])!==0)throw new Error("orlp key derivation failed: invalid private key");const A=new Uint8Array(32);return A.set(u.HEAPU8.subarray(g,g+32)),(0,n.bytesToHex)(A)}async function i(a,u){try{const f=await t(),p=(0,n.hexToBytes)(a),g=(0,n.hexToBytes)(u);if(p.length!==64||g.length!==32)return!1;const x=2048,A=2112;return f.HEAPU8.set(p,x),f.HEAPU8.set(g,A),f.ccall("orlp_validate_keypair","number",["number","number"],[A,x])===1}catch{return!1}}async function s(a,u,f){const p=await t(),g=(0,n.hexToBytes)(a),x=(0,n.hexToBytes)(u),A=(0,n.hexToBytes)(f);if(x.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${x.length}`);if(A.length!==32)throw new Error(`Invalid public key length: expected 32 bytes, got ${A.length}`);const _=1e5,b=2e5,w=3e5,C=4e5;p.HEAPU8.set(g,_),p.HEAPU8.set(x,b),p.HEAPU8.set(A,w),p.ccall("orlp_sign","void",["number","number","number","number","number"],[C,_,g.length,w,b]);const T=new Uint8Array(64);return T.set(p.HEAPU8.subarray(C,C+64)),(0,n.bytesToHex)(T)}async function o(a,u,f){try{const p=await t(),g=(0,n.hexToBytes)(a),x=(0,n.hexToBytes)(u),A=(0,n.hexToBytes)(f);if(g.length!==64||A.length!==32)return!1;const _=5e5,b=6e5,w=7e5;return p.HEAPU8.set(g,b),p.HEAPU8.set(x,_),p.HEAPU8.set(A,w),p.ccall("orlp_verify","number",["number","number","number","number"],[b,_,x.length,w])===1}catch{return!1}}return Qa}var ek;function $E(){if(ek)return Fi;ek=1;var n=Fi&&Fi.__createBinding||(Object.create?(function(f,p,g,x){x===void 0&&(x=g);var A=Object.getOwnPropertyDescriptor(p,g);(!A||("get"in A?!p.__esModule:A.writable||A.configurable))&&(A={enumerable:!0,get:function(){return p[g]}}),Object.defineProperty(f,x,A)}):(function(f,p,g,x){x===void 0&&(x=g),f[x]=p[g]})),e=Fi&&Fi.__setModuleDefault||(Object.create?(function(f,p){Object.defineProperty(f,"default",{enumerable:!0,value:p})}):function(f,p){f.default=p}),t=Fi&&Fi.__importStar||(function(){var f=function(p){return f=Object.getOwnPropertyNames||function(g){var x=[];for(var A in g)Object.prototype.hasOwnProperty.call(g,A)&&(x[x.length]=A);return x},f(p)};return function(p){if(p&&p.__esModule)return p;var g={};if(p!=null)for(var x=f(p),A=0;A<x.length;A++)x[A]!=="default"&&n(g,p,x[A]);return e(g,p),g}})();Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.Ed25519SignatureVerifier=void 0;const r=t(Fj),i=nr(),s=SA();async function o(f){if(typeof globalThis<"u"&&globalThis.crypto&&globalThis.crypto.subtle){const p=await globalThis.crypto.subtle.digest("SHA-512",f);return new Uint8Array(p)}if(typeof Jy<"u")try{const{createHash:p}=Pp;return p("sha512").update(f).digest()}catch{}throw new Error("No SHA-512 implementation available")}function a(f){if(typeof Jy<"u")try{const{createHash:p}=Pp;return p("sha512").update(f).digest()}catch{}try{const p=PE(),g=p.lib.WordArray.create(f),x=p.SHA512(g),A=new Uint8Array(64);for(let _=0;_<16;_++){const b=x.words[_]||0;A[_*4]=b>>>24&255,A[_*4+1]=b>>>16&255,A[_*4+2]=b>>>8&255,A[_*4+3]=b&255}return A}catch{throw new Error("No SHA-512 implementation available for synchronous operation")}}r.etc.sha512Async=o;try{r.etc.sha512Sync=a}catch(f){console.debug("Could not set up synchronous SHA-512:",f)}class u{static async verifyAdvertisementSignature(p,g,x,A){try{const _=(0,i.hexToBytes)(p),b=(0,i.hexToBytes)(g),w=(0,i.hexToBytes)(A),C=this.constructAdvertSignedMessage(p,x,w);return await r.verify(b,C,_)}catch(_){return console.error("Ed25519 signature verification failed:",_),!1}}static constructAdvertSignedMessage(p,g,x){const A=(0,i.hexToBytes)(p),_=new Uint8Array(4);_[0]=g&255,_[1]=g>>8&255,_[2]=g>>16&255,_[3]=g>>24&255;const b=new Uint8Array(36+x.length);return b.set(A,0),b.set(_,32),b.set(x,36),b}static getSignedMessageDescription(p,g,x){return`Public Key: ${p} + Timestamp: ${g} (${new Date(g*1e3).toISOString()}) + App Data: ${x}`}static getSignedMessageHex(p,g,x){const A=(0,i.hexToBytes)(x),_=this.constructAdvertSignedMessage(p,g,A);return(0,i.bytesToHex)(_)}static async derivePublicKey(p){try{const g=(0,i.hexToBytes)(p);if(g.length!==64)throw new Error(`Invalid private key length: expected 64 bytes, got ${g.length}`);return await(0,s.derivePublicKey)(p)}catch(g){throw new Error(`Failed to derive public key: ${g instanceof Error?g.message:"Unknown error"}`)}}static derivePublicKeySync(p){try{const g=(0,i.hexToBytes)(p);throw g.length!==64?new Error(`Invalid private key length: expected 64 bytes, got ${g.length}`):new Error("Synchronous key derivation not supported with WASM. Use derivePublicKey() instead.")}catch(g){throw new Error(`Failed to derive public key: ${g instanceof Error?g.message:"Unknown error"}`)}}static async validateKeyPair(p,g){try{return await(0,s.validateKeyPair)(p,g)}catch{return!1}}}return Fi.Ed25519SignatureVerifier=u,Fi}var tk;function zj(){if(tk)return zu;tk=1,Object.defineProperty(zu,"__esModule",{value:!0}),zu.AdvertPayloadDecoder=void 0;const n=oi(),e=nr(),t=Bh(),r=$E();class i{static decode(o,a){try{if(o.length<101){const C={type:n.PayloadType.Advert,version:n.PayloadVersion.Version1,isValid:!1,errors:["Advertisement payload too short"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:n.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}};return a!=null&&a.includeSegments&&(C.segments=[{name:"Invalid Advert Data",description:"Advert payload too short (minimum 101 bytes required)",startByte:a.segmentOffset||0,endByte:(a.segmentOffset||0)+o.length-1,value:(0,e.bytesToHex)(o)}]),C}const u=[],f=(a==null?void 0:a.segmentOffset)||0;let p=0;const g=(0,e.bytesToHex)(o.subarray(p,p+32));a!=null&&a.includeSegments&&u.push({name:"Public Key",description:"Ed25519 public key",startByte:f+p,endByte:f+p+31,value:g}),p+=32;const x=this.readUint32LE(o,p);if(a!=null&&a.includeSegments){const C=new Date(x*1e3);u.push({name:"Timestamp",description:`${x} (${C.toISOString().slice(0,19)}Z)`,startByte:f+p,endByte:f+p+3,value:(0,e.bytesToHex)(o.subarray(p,p+4))})}p+=4;const A=(0,e.bytesToHex)(o.subarray(p,p+64));a!=null&&a.includeSegments&&u.push({name:"Signature",description:"Ed25519 signature",startByte:f+p,endByte:f+p+63,value:A}),p+=64;const _=o[p];if(a!=null&&a.includeSegments){const C=_.toString(2).padStart(8,"0"),T=this.parseDeviceRole(_),D=` | Bits 0-3 (Role): ${(0,t.getDeviceRoleName)(T)} | Bit 4 (Location): ${_&n.AdvertFlags.HasLocation?"Yes":"No"} | Bit 7 (Name): ${_&n.AdvertFlags.HasName?"Yes":"No"}`;u.push({name:"App Flags",description:`Binary: ${C}${D}`,startByte:f+p,endByte:f+p,value:_.toString(16).padStart(2,"0").toUpperCase()})}p+=1;const b={type:n.PayloadType.Advert,version:n.PayloadVersion.Version1,isValid:!0,publicKey:g,timestamp:x,signature:A,appData:{flags:_,deviceRole:this.parseDeviceRole(_),hasLocation:!!(_&n.AdvertFlags.HasLocation),hasName:!!(_&n.AdvertFlags.HasName)}};let w=p;if(_&n.AdvertFlags.HasLocation&&o.length>=w+8){const C=this.readInt32LE(o,w)/1e6,T=this.readInt32LE(o,w+4)/1e6;b.appData.location={latitude:Math.round(C*1e6)/1e6,longitude:Math.round(T*1e6)/1e6},a!=null&&a.includeSegments&&(u.push({name:"Latitude",description:`${C} (${C})`,startByte:f+w,endByte:f+w+3,value:(0,e.bytesToHex)(o.subarray(w,w+4))}),u.push({name:"Longitude",description:`${T} (${T})`,startByte:f+w+4,endByte:f+w+7,value:(0,e.bytesToHex)(o.subarray(w+4,w+8))})),w+=8}if(_&n.AdvertFlags.HasFeature1&&(w+=2),_&n.AdvertFlags.HasFeature2&&(w+=2),_&n.AdvertFlags.HasName&&o.length>w){const C=o.subarray(w),T=new TextDecoder("utf-8").decode(C).replace(/\0.*$/,"");b.appData.name=this.sanitizeControlCharacters(T)||T,a!=null&&a.includeSegments&&u.push({name:"Node Name",description:`Node name: "${b.appData.name}"`,startByte:f+w,endByte:f+o.length-1,value:(0,e.bytesToHex)(C)})}return a!=null&&a.includeSegments&&(b.segments=u),b}catch(u){return{type:n.PayloadType.Advert,version:n.PayloadVersion.Version1,isValid:!1,errors:[u instanceof Error?u.message:"Failed to decode advertisement payload"],publicKey:"",timestamp:0,signature:"",appData:{flags:0,deviceRole:n.DeviceRole.ChatNode,hasLocation:!1,hasName:!1}}}}static async decodeWithVerification(o,a){const u=this.decode(o,a);if(!u||!u.isValid)return u;try{const p=o.subarray(100),g=(0,e.bytesToHex)(p),x=await r.Ed25519SignatureVerifier.verifyAdvertisementSignature(u.publicKey,u.signature,u.timestamp,g);u.signatureValid=x,x||(u.signatureError="Ed25519 signature verification failed",u.isValid=!1,u.errors||(u.errors=[]),u.errors.push("Invalid Ed25519 signature"))}catch(f){u.signatureValid=!1,u.signatureError=f instanceof Error?f.message:"Signature verification error",u.isValid=!1,u.errors||(u.errors=[]),u.errors.push("Signature verification failed: "+(f instanceof Error?f.message:"Unknown error"))}return u}static parseDeviceRole(o){switch(o&15){case 1:return n.DeviceRole.ChatNode;case 2:return n.DeviceRole.Repeater;case 3:return n.DeviceRole.RoomServer;case 4:return n.DeviceRole.Sensor;default:return n.DeviceRole.ChatNode}}static readUint32LE(o,a){return o[a]|o[a+1]<<8|o[a+2]<<16|o[a+3]<<24}static readInt32LE(o,a){const u=this.readUint32LE(o,a);return u>2147483647?u-4294967296:u}static sanitizeControlCharacters(o){return o&&o.trim().replace(/[\x00-\x1F\x7F]/g,"")||null}}return zu.AdvertPayloadDecoder=i,zu}var ju={},nk;function jj(){if(nk)return ju;nk=1,Object.defineProperty(ju,"__esModule",{value:!0}),ju.TracePayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i,s,o){try{if(i.length<9){const T={type:n.PayloadType.Trace,version:n.PayloadVersion.Version1,isValid:!1,errors:["Trace payload too short (need at least tag(4) + auth(4) + flags(1))"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]};return o!=null&&o.includeSegments&&(T.segments=[{name:"Invalid Trace Data",description:"Trace payload too short (minimum 9 bytes required)",startByte:o.segmentOffset||0,endByte:(o.segmentOffset||0)+i.length-1,value:(0,e.bytesToHex)(i)}]),T}let a=0;const u=[],f=(o==null?void 0:o.segmentOffset)||0,p=this.readUint32LE(i,a),g=(0,e.numberToHex)(p,8);o!=null&&o.includeSegments&&u.push({name:"Trace Tag",description:`Unique identifier for this trace: 0x${p.toString(16).padStart(8,"0")}`,startByte:f+a,endByte:f+a+3,value:(0,e.bytesToHex)(i.slice(a,a+4))}),a+=4;const x=this.readUint32LE(i,a);o!=null&&o.includeSegments&&u.push({name:"Auth Code",description:`Authentication/verification code: ${x}`,startByte:f+a,endByte:f+a+3,value:(0,e.bytesToHex)(i.slice(a,a+4))}),a+=4;const A=i[a];o!=null&&o.includeSegments&&u.push({name:"Flags",description:`Application-defined control flags: 0x${A.toString(16).padStart(2,"0")} (${A.toString(2).padStart(8,"0")}b)`,startByte:f+a,endByte:f+a,value:A.toString(16).padStart(2,"0").toUpperCase()}),a+=1;const _=[],b=a;for(;a<i.length;)_.push((0,e.byteToHex)(i[a])),a++;if(o!=null&&o.includeSegments&&_.length>0){const T=_.join(" ");u.push({name:"Path Hashes",description:`Node hashes in trace path: ${T}`,startByte:f+b,endByte:f+i.length-1,value:(0,e.bytesToHex)(i.slice(b))})}let w;s&&s.length>0&&(w=s.map(T=>{const E=parseInt(T,16);return(E>127?E-256:E)/4}));const C={type:n.PayloadType.Trace,version:n.PayloadVersion.Version1,isValid:!0,traceTag:g,authCode:x,flags:A,pathHashes:_,snrValues:w};return o!=null&&o.includeSegments&&(C.segments=u),C}catch(a){return{type:n.PayloadType.Trace,version:n.PayloadVersion.Version1,isValid:!1,errors:[a instanceof Error?a.message:"Failed to decode trace payload"],traceTag:"00000000",authCode:0,flags:0,pathHashes:[]}}}static readUint32LE(i,s){return i[s]|i[s+1]<<8|i[s+2]<<16|i[s+3]<<24}}return ju.TracePayloadDecoder=t,ju}var Qu={},rk;function Qj(){if(rk)return Qu;rk=1,Object.defineProperty(Qu,"__esModule",{value:!0}),Qu.GroupTextPayloadDecoder=void 0;const n=oi(),e=mA(),t=nr();class r{static decode(s,o){try{if(s.length<3){const _={type:n.PayloadType.GroupText,version:n.PayloadVersion.Version1,isValid:!1,errors:["GroupText payload too short (need at least channel_hash(1) + MAC(2))"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return o!=null&&o.includeSegments&&(_.segments=[{name:"Invalid GroupText Data",description:"GroupText payload too short (minimum 3 bytes required)",startByte:o.segmentOffset||0,endByte:(o.segmentOffset||0)+s.length-1,value:(0,t.bytesToHex)(s)}]),_}const a=[],u=(o==null?void 0:o.segmentOffset)||0;let f=0;const p=(0,t.byteToHex)(s[f]);o!=null&&o.includeSegments&&a.push({name:"Channel Hash",description:"First byte of SHA256 of channel's shared key",startByte:u+f,endByte:u+f,value:p}),f+=1;const g=(0,t.bytesToHex)(s.subarray(f,f+2));o!=null&&o.includeSegments&&a.push({name:"Cipher MAC",description:"MAC for encrypted data",startByte:u+f,endByte:u+f+1,value:g}),f+=2;const x=(0,t.bytesToHex)(s.subarray(f));o!=null&&o.includeSegments&&s.length>f&&a.push({name:"Ciphertext",description:"Encrypted message content (timestamp + flags + message)",startByte:u+f,endByte:u+s.length-1,value:x});const A={type:n.PayloadType.GroupText,version:n.PayloadVersion.Version1,isValid:!0,channelHash:p,cipherMac:g,ciphertext:x,ciphertextLength:s.length-3};if(o!=null&&o.keyStore&&o.keyStore.hasChannelKey(p)){const _=o.keyStore.getChannelKeys(p);for(const b of _){const w=e.ChannelCrypto.decryptGroupTextMessage(x,g,b);if(w.success&&w.data){A.decrypted={timestamp:w.data.timestamp,flags:w.data.flags,sender:w.data.sender,message:w.data.message};break}}}return o!=null&&o.includeSegments&&(A.segments=a),A}catch(a){return{type:n.PayloadType.GroupText,version:n.PayloadVersion.Version1,isValid:!1,errors:[a instanceof Error?a.message:"Failed to decode GroupText payload"],channelHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}}return Qu.GroupTextPayloadDecoder=r,Qu}var Hu={},ik;function Hj(){if(ik)return Hu;ik=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.RequestPayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i,s){try{if(i.length<4){const _={type:n.PayloadType.Request,version:n.PayloadVersion.Version1,isValid:!1,errors:["Request payload too short (minimum 4 bytes: dest hash + source hash + MAC)"],timestamp:0,requestType:n.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""};return s!=null&&s.includeSegments&&(_.segments=[{name:"Invalid Request Data",description:"Request payload too short (minimum 4 bytes required: 1 for dest hash + 1 for source hash + 2 for MAC)",startByte:s.segmentOffset||0,endByte:(s.segmentOffset||0)+i.length-1,value:(0,e.bytesToHex)(i)}]),_}const o=[],a=(s==null?void 0:s.segmentOffset)||0;let u=0;const f=(0,e.bytesToHex)(i.subarray(u,u+1));s!=null&&s.includeSegments&&o.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${f}`,startByte:a+u,endByte:a+u,value:f}),u+=1;const p=(0,e.bytesToHex)(i.subarray(u,u+1));s!=null&&s.includeSegments&&o.push({name:"Source Hash",description:`First byte of source node public key: 0x${p}`,startByte:a+u,endByte:a+u,value:p}),u+=1;const g=(0,e.bytesToHex)(i.subarray(u,u+2));s!=null&&s.includeSegments&&o.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:a+u,endByte:a+u+1,value:g}),u+=2;const x=(0,e.bytesToHex)(i.subarray(u));s!=null&&s.includeSegments&&i.length>u&&o.push({name:"Ciphertext",description:`Encrypted message data (${i.length-u} bytes). Contains encrypted plaintext with this structure:
 Timestamp (4 bytes) - send time as unix timestamp
 Request Type (1 byte) - type of request (GetStats, GetTelemetryData, etc.)
 Request Data (remaining bytes) - additional request-specific data`,startByte:a+u,endByte:a+i.length-1,value:x});const A={type:n.PayloadType.Request,version:n.PayloadVersion.Version1,isValid:!0,timestamp:0,requestType:n.RequestType.GetStats,requestData:"",destinationHash:f,sourceHash:p,cipherMac:g,ciphertext:x};return s!=null&&s.includeSegments&&(A.segments=o),A}catch(o){return{type:n.PayloadType.Request,version:n.PayloadVersion.Version1,isValid:!1,errors:[o instanceof Error?o.message:"Failed to decode request payload"],timestamp:0,requestType:n.RequestType.GetStats,requestData:"",destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:""}}}}return Hu.RequestPayloadDecoder=t,Hu}var Wu={},sk;function Wj(){if(sk)return Wu;sk=1,Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.ResponsePayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i,s){try{if(i.length<4){const _={type:n.PayloadType.Response,version:n.PayloadVersion.Version1,isValid:!1,errors:["Response payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return s!=null&&s.includeSegments&&(_.segments=[{name:"Invalid Response Data",description:"Response payload too short (minimum 4 bytes required)",startByte:s.segmentOffset||0,endByte:(s.segmentOffset||0)+i.length-1,value:(0,e.bytesToHex)(i)}]),_}const o=[],a=(s==null?void 0:s.segmentOffset)||0;let u=0;const f=(0,e.byteToHex)(i[u]);s!=null&&s.includeSegments&&o.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:a+u,endByte:a+u,value:f}),u+=1;const p=(0,e.byteToHex)(i[u]);s!=null&&s.includeSegments&&o.push({name:"Source Hash",description:"First byte of source node public key",startByte:a+u,endByte:a+u,value:p}),u+=1;const g=(0,e.bytesToHex)(i.subarray(u,u+2));s!=null&&s.includeSegments&&o.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:a+u,endByte:a+u+1,value:g}),u+=2;const x=(0,e.bytesToHex)(i.subarray(u));s!=null&&s.includeSegments&&i.length>u&&o.push({name:"Ciphertext",description:"Encrypted response data (tag + content)",startByte:a+u,endByte:a+i.length-1,value:x});const A={type:n.PayloadType.Response,version:n.PayloadVersion.Version1,isValid:!0,destinationHash:f,sourceHash:p,cipherMac:g,ciphertext:x,ciphertextLength:i.length-4};return s!=null&&s.includeSegments&&(A.segments=o),A}catch(o){return{type:n.PayloadType.Response,version:n.PayloadVersion.Version1,isValid:!1,errors:[o instanceof Error?o.message:"Failed to decode response payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}}return Wu.ResponsePayloadDecoder=t,Wu}var qu={},ok;function qj(){if(ok)return qu;ok=1,Object.defineProperty(qu,"__esModule",{value:!0}),qu.AnonRequestPayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i,s){try{if(i.length<35){const _={type:n.PayloadType.AnonRequest,version:n.PayloadVersion.Version1,isValid:!1,errors:["AnonRequest payload too short (minimum 35 bytes: dest + public key + MAC)"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return s!=null&&s.includeSegments&&(_.segments=[{name:"Invalid AnonRequest Data",description:"AnonRequest payload too short (minimum 35 bytes required: 1 for dest hash + 32 for public key + 2 for MAC)",startByte:s.segmentOffset||0,endByte:(s.segmentOffset||0)+i.length-1,value:(0,e.bytesToHex)(i)}]),_}const o=[],a=(s==null?void 0:s.segmentOffset)||0;let u=0;const f=(0,e.byteToHex)(i[0]);s!=null&&s.includeSegments&&o.push({name:"Destination Hash",description:`First byte of destination node public key: 0x${f}`,startByte:a+u,endByte:a+u,value:f}),u+=1;const p=(0,e.bytesToHex)(i.subarray(1,33));s!=null&&s.includeSegments&&o.push({name:"Sender Public Key",description:"Ed25519 public key of the sender (32 bytes)",startByte:a+u,endByte:a+u+31,value:p}),u+=32;const g=(0,e.bytesToHex)(i.subarray(33,35));s!=null&&s.includeSegments&&o.push({name:"Cipher MAC",description:"MAC for encrypted data verification (2 bytes)",startByte:a+u,endByte:a+u+1,value:g}),u+=2;const x=(0,e.bytesToHex)(i.subarray(35));s!=null&&s.includeSegments&&i.length>35&&o.push({name:"Ciphertext",description:`Encrypted message data (${i.length-35} bytes). Contains encrypted plaintext with this structure:
 Timestamp (4 bytes) - send time as unix timestamp
 Sync Timestamp (4 bytes) - room server only, sender's "sync messages SINCE x" timestamp  
 Password (remaining bytes) - password for repeater/room`,startByte:a+u,endByte:a+i.length-1,value:x});const A={type:n.PayloadType.AnonRequest,version:n.PayloadVersion.Version1,isValid:!0,destinationHash:f,senderPublicKey:p,cipherMac:g,ciphertext:x,ciphertextLength:i.length-35};return s!=null&&s.includeSegments&&(A.segments=o),A}catch(o){return{type:n.PayloadType.AnonRequest,version:n.PayloadVersion.Version1,isValid:!1,errors:[o instanceof Error?o.message:"Failed to decode AnonRequest payload"],destinationHash:"",senderPublicKey:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}}return qu.AnonRequestPayloadDecoder=t,qu}var Vu={},ak;function Vj(){if(ak)return Vu;ak=1,Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.AckPayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i,s){try{if(i.length<4){const p={type:n.PayloadType.Ack,version:n.PayloadVersion.Version1,isValid:!1,errors:["Ack payload too short (minimum 4 bytes for checksum)"],checksum:""};return s!=null&&s.includeSegments&&(p.segments=[{name:"Invalid Ack Data",description:"Ack payload too short (minimum 4 bytes required for checksum)",startByte:s.segmentOffset||0,endByte:(s.segmentOffset||0)+i.length-1,value:(0,e.bytesToHex)(i)}]),p}const o=[],a=(s==null?void 0:s.segmentOffset)||0,u=(0,e.bytesToHex)(i.subarray(0,4));s!=null&&s.includeSegments&&o.push({name:"Checksum",description:`CRC checksum of message timestamp, text, and sender pubkey: 0x${u}`,startByte:a,endByte:a+3,value:u}),s!=null&&s.includeSegments&&i.length>4&&o.push({name:"Additional Data",description:"Extra data in Ack payload",startByte:a+4,endByte:a+i.length-1,value:(0,e.bytesToHex)(i.subarray(4))});const f={type:n.PayloadType.Ack,version:n.PayloadVersion.Version1,isValid:!0,checksum:u};return s!=null&&s.includeSegments&&(f.segments=o),f}catch(o){return{type:n.PayloadType.Ack,version:n.PayloadVersion.Version1,isValid:!1,errors:[o instanceof Error?o.message:"Failed to decode Ack payload"],checksum:""}}}}return Vu.AckPayloadDecoder=t,Vu}var $u={},lk;function $j(){if(lk)return $u;lk=1,Object.defineProperty($u,"__esModule",{value:!0}),$u.PathPayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i){try{if(i.length<2)return{type:n.PayloadType.Path,version:n.PayloadVersion.Version1,isValid:!1,errors:["Path payload too short (minimum 2 bytes: path length + extra type)"],pathLength:0,pathHashes:[],extraType:0,extraData:""};const s=i[0];if(i.length<1+s+1)return{type:n.PayloadType.Path,version:n.PayloadVersion.Version1,isValid:!1,errors:[`Path payload too short (need ${1+s+1} bytes for path length + path + extra type)`],pathLength:s,pathHashes:[],extraType:0,extraData:""};const o=[];for(let f=0;f<s;f++)o.push((0,e.byteToHex)(i[1+f]));const a=i[1+s];let u="";return i.length>1+s+1&&(u=(0,e.bytesToHex)(i.subarray(1+s+1))),{type:n.PayloadType.Path,version:n.PayloadVersion.Version1,isValid:!0,pathLength:s,pathHashes:o,extraType:a,extraData:u}}catch(s){return{type:n.PayloadType.Path,version:n.PayloadVersion.Version1,isValid:!1,errors:[s instanceof Error?s.message:"Failed to decode Path payload"],pathLength:0,pathHashes:[],extraType:0,extraData:""}}}}return $u.PathPayloadDecoder=t,$u}var Uu={},ck;function Uj(){if(ck)return Uu;ck=1,Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.TextMessagePayloadDecoder=void 0;const n=oi(),e=nr();class t{static decode(i,s){try{if(i.length<4){const _={type:n.PayloadType.TextMessage,version:n.PayloadVersion.Version1,isValid:!1,errors:["TextMessage payload too short (minimum 4 bytes: dest + source + MAC)"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0};return s!=null&&s.includeSegments&&(_.segments=[{name:"Invalid TextMessage Data",description:"TextMessage payload too short (minimum 4 bytes required)",startByte:s.segmentOffset||0,endByte:(s.segmentOffset||0)+i.length-1,value:(0,e.bytesToHex)(i)}]),_}const o=[],a=(s==null?void 0:s.segmentOffset)||0;let u=0;const f=(0,e.byteToHex)(i[u]);s!=null&&s.includeSegments&&o.push({name:"Destination Hash",description:"First byte of destination node public key",startByte:a+u,endByte:a+u,value:f}),u+=1;const p=(0,e.byteToHex)(i[u]);s!=null&&s.includeSegments&&o.push({name:"Source Hash",description:"First byte of source node public key",startByte:a+u,endByte:a+u,value:p}),u+=1;const g=(0,e.bytesToHex)(i.subarray(u,u+2));s!=null&&s.includeSegments&&o.push({name:"Cipher MAC",description:"MAC for encrypted data in next field",startByte:a+u,endByte:a+u+1,value:g}),u+=2;const x=(0,e.bytesToHex)(i.subarray(u));s!=null&&s.includeSegments&&i.length>u&&o.push({name:"Ciphertext",description:"Encrypted message data (timestamp + message text)",startByte:a+u,endByte:a+i.length-1,value:x});const A={type:n.PayloadType.TextMessage,version:n.PayloadVersion.Version1,isValid:!0,destinationHash:f,sourceHash:p,cipherMac:g,ciphertext:x,ciphertextLength:i.length-4};return s!=null&&s.includeSegments&&(A.segments=o),A}catch(o){return{type:n.PayloadType.TextMessage,version:n.PayloadVersion.Version1,isValid:!1,errors:[o instanceof Error?o.message:"Failed to decode TextMessage payload"],destinationHash:"",sourceHash:"",cipherMac:"",ciphertext:"",ciphertextLength:0}}}}return Uu.TextMessagePayloadDecoder=t,Uu}var Zu={},uk;function Zj(){if(uk)return Zu;uk=1,Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.ControlPayloadDecoder=void 0;const n=oi(),e=nr(),t=Bh();class r{static decode(s,o){try{if(s.length<1)return this.createErrorPayload("Control payload too short (minimum 1 byte required)",s,o);const u=s[0]&240;switch(u){case n.ControlSubType.NodeDiscoverReq:return this.decodeDiscoverReq(s,o);case n.ControlSubType.NodeDiscoverResp:return this.decodeDiscoverResp(s,o);default:return this.createErrorPayload(`Unknown control sub-type: 0x${u.toString(16).padStart(2,"0")}`,s,o)}}catch(a){return this.createErrorPayload(a instanceof Error?a.message:"Failed to decode control payload",s,o)}}static decodeDiscoverReq(s,o){const a=[],u=(o==null?void 0:o.segmentOffset)??0;if(s.length<6){const C={type:n.PayloadType.Control,version:n.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_REQ payload too short (minimum 6 bytes required)"],subType:n.ControlSubType.NodeDiscoverReq,rawFlags:s[0],prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return o!=null&&o.includeSegments&&(C.segments=[{name:"Invalid DISCOVER_REQ Data",description:"DISCOVER_REQ payload too short (minimum 6 bytes required)",startByte:u,endByte:u+s.length-1,value:(0,e.bytesToHex)(s)}]),C}let f=0;const p=s[f],g=(p&1)!==0;o!=null&&o.includeSegments&&a.push({name:"Flags",description:`Sub-type: DISCOVER_REQ (0x8) | Prefix Only: ${g}`,startByte:u+f,endByte:u+f,value:p.toString(16).padStart(2,"0").toUpperCase()}),f+=1;const x=s[f],A=this.parseTypeFilter(x);o!=null&&o.includeSegments&&a.push({name:"Type Filter",description:`Filter mask: 0b${x.toString(2).padStart(8,"0")} | Types: ${A.length>0?A.join(", "):"None"}`,startByte:u+f,endByte:u+f,value:x.toString(16).padStart(2,"0").toUpperCase()}),f+=1;const _=this.readUint32LE(s,f);o!=null&&o.includeSegments&&a.push({name:"Tag",description:`Random tag for response matching: 0x${_.toString(16).padStart(8,"0")}`,startByte:u+f,endByte:u+f+3,value:(0,e.bytesToHex)(s.slice(f,f+4))}),f+=4;let b=0;if(s.length>=f+4&&(b=this.readUint32LE(s,f),o!=null&&o.includeSegments)){const C=b>0?new Date(b*1e3).toISOString().slice(0,19)+"Z":"N/A";a.push({name:"Since",description:`Filter timestamp: ${b} (${C})`,startByte:u+f,endByte:u+f+3,value:(0,e.bytesToHex)(s.slice(f,f+4))})}const w={type:n.PayloadType.Control,version:n.PayloadVersion.Version1,isValid:!0,subType:n.ControlSubType.NodeDiscoverReq,rawFlags:p,prefixOnly:g,typeFilter:x,typeFilterNames:A,tag:_,since:b};return o!=null&&o.includeSegments&&(w.segments=a),w}static decodeDiscoverResp(s,o){const a=[],u=(o==null?void 0:o.segmentOffset)??0;if(s.length<14){const F={type:n.PayloadType.Control,version:n.PayloadVersion.Version1,isValid:!1,errors:["DISCOVER_RESP payload too short (minimum 14 bytes required)"],subType:n.ControlSubType.NodeDiscoverResp,rawFlags:s.length>0?s[0]:0,nodeType:n.DeviceRole.Unknown,nodeTypeName:"Unknown",snr:0,tag:0,publicKey:"",publicKeyLength:0};return o!=null&&o.includeSegments&&(F.segments=[{name:"Invalid DISCOVER_RESP Data",description:"DISCOVER_RESP payload too short (minimum 14 bytes required)",startByte:u,endByte:u+s.length-1,value:(0,e.bytesToHex)(s)}]),F}let f=0;const p=s[f],g=p&15,x=(0,t.getDeviceRoleName)(g);o!=null&&o.includeSegments&&a.push({name:"Flags",description:`Sub-type: DISCOVER_RESP (0x9) | Node Type: ${x}`,startByte:u+f,endByte:u+f,value:p.toString(16).padStart(2,"0").toUpperCase()}),f+=1;const A=s[f],_=A>127?A-256:A,b=_/4;o!=null&&o.includeSegments&&a.push({name:"SNR",description:`Inbound SNR: ${b.toFixed(2)} dB (raw: ${A}, signed: ${_})`,startByte:u+f,endByte:u+f,value:A.toString(16).padStart(2,"0").toUpperCase()}),f+=1;const w=this.readUint32LE(s,f);o!=null&&o.includeSegments&&a.push({name:"Tag",description:`Reflected tag from request: 0x${w.toString(16).padStart(8,"0")}`,startByte:u+f,endByte:u+f+3,value:(0,e.bytesToHex)(s.slice(f,f+4))}),f+=4;const T=s.length-f,E=s.slice(f,f+T),D=(0,e.bytesToHex)(E);if(o!=null&&o.includeSegments){const F=T===32?"Full Public Key":"Public Key Prefix";a.push({name:F,description:`${F} (${T} bytes)`,startByte:u+f,endByte:u+f+T-1,value:D})}const N={type:n.PayloadType.Control,version:n.PayloadVersion.Version1,isValid:!0,subType:n.ControlSubType.NodeDiscoverResp,rawFlags:p,nodeType:g,nodeTypeName:x,snr:b,tag:w,publicKey:D,publicKeyLength:T};return o!=null&&o.includeSegments&&(N.segments=a),N}static parseTypeFilter(s){const o=[];return s&1<<n.DeviceRole.ChatNode&&o.push("Chat"),s&1<<n.DeviceRole.Repeater&&o.push("Repeater"),s&1<<n.DeviceRole.RoomServer&&o.push("Room"),s&1<<n.DeviceRole.Sensor&&o.push("Sensor"),o}static createErrorPayload(s,o,a){const u={type:n.PayloadType.Control,version:n.PayloadVersion.Version1,isValid:!1,errors:[s],subType:n.ControlSubType.NodeDiscoverReq,rawFlags:o.length>0?o[0]:0,prefixOnly:!1,typeFilter:0,typeFilterNames:[],tag:0,since:0};return a!=null&&a.includeSegments&&(u.segments=[{name:"Invalid Control Data",description:s,startByte:a.segmentOffset??0,endByte:(a.segmentOffset??0)+o.length-1,value:(0,e.bytesToHex)(o)}]),u}static readUint32LE(s,o){return(s[o]|s[o+1]<<8|s[o+2]<<16|s[o+3]<<24)>>>0}}return Zu.ControlPayloadDecoder=r,Zu}var hk;function fk(){if(hk)return Lu;hk=1,Object.defineProperty(Lu,"__esModule",{value:!0}),Lu.MeshCorePacketDecoder=void 0;const n=oi(),e=nr(),t=Bh(),r=BE(),i=zj(),s=jj(),o=Qj(),a=Hj(),u=Wj(),f=qj(),p=Vj(),g=$j(),x=Uj(),A=Zj();class _{static decode(w,C){return this.parseInternal(w,!1,C).packet}static async decodeWithVerification(w,C){return(await this.parseInternalAsync(w,!1,C)).packet}static analyzeStructure(w,C){return this.parseInternal(w,!0,C).structure}static async analyzeStructureWithVerification(w,C){return(await this.parseInternalAsync(w,!0,C)).structure}static parseInternal(w,C,T){const E=(0,e.hexToBytes)(w),D=[];if(E.length<2){const N={messageHash:"",routeType:n.RouteType.Flood,payloadType:n.PayloadType.RawCustom,payloadVersion:n.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:E.length,isValid:!1,errors:["Packet too short (minimum 2 bytes required)"]},F={segments:[],totalBytes:E.length,rawHex:w.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:N,structure:F}}try{let N=0;const F=E[0],z=F&3,I=F>>2&15,K=F>>6&3;C&&D.push({name:"Header",description:"Header byte breakdown",startByte:0,endByte:0,value:`0x${F.toString(16).padStart(2,"0")}`,headerBreakdown:{fullBinary:F.toString(2).padStart(8,"0"),fields:[{bits:"0-1",field:"Route Type",value:(0,t.getRouteTypeName)(z),binary:(F&3).toString(2).padStart(2,"0")},{bits:"2-5",field:"Payload Type",value:(0,t.getPayloadTypeName)(I),binary:(F>>2&15).toString(2).padStart(4,"0")},{bits:"6-7",field:"Version",value:K.toString(),binary:(F>>6&3).toString(2).padStart(2,"0")}]}}),N=1;let W;if(z===n.RouteType.TransportFlood||z===n.RouteType.TransportDirect){if(E.length<N+4)throw new Error("Packet too short for transport codes");const B=E[N]|E[N+1]<<8,Q=E[N+2]|E[N+3]<<8;if(W=[B,Q],C){const G=E[N]|E[N+1]<<8|E[N+2]<<16|E[N+3]<<24;D.push({name:"Transport Code",description:"Used for Direct/Response routing",startByte:N,endByte:N+3,value:`0x${G.toString(16).padStart(8,"0")}`})}N+=4}if(E.length<N+1)throw new Error("Packet too short for path length");const U=E[N];if(C){let B=`Path contains ${U} bytes`;z===n.RouteType.Direct||z===n.RouteType.TransportDirect?B=`For "Direct" packets, this contains routing instructions. ${U} bytes of routing instructions (decreases as packet travels)`:(z===n.RouteType.Flood||z===n.RouteType.TransportFlood)&&(B=`${U} bytes showing route taken (increases as packet floods)`),D.push({name:"Path Length",description:B,startByte:N,endByte:N,value:`0x${U.toString(16).padStart(2,"0")}`})}if(N+=1,E.length<N+U)throw new Error("Packet too short for path data");const X=E.subarray(N,N+U),$=U>0?Array.from(X).map(e.byteToHex):null;if(C&&U>0)if(I===n.PayloadType.Trace){const B=[];for(let Q=0;Q<U;Q++){const G=E[N+Q],ue=(G>127?G-256:G)/4;B.push(`${ue.toFixed(2)}dB (0x${G.toString(16).padStart(2,"0")})`)}D.push({name:"Path SNR Data",description:`SNR values collected during trace: ${B.join(", ")}`,startByte:N,endByte:N+U-1,value:(0,e.bytesToHex)(E.slice(N,N+U))})}else{let B="Routing path information";z===n.RouteType.Direct||z===n.RouteType.TransportDirect?B="Routing instructions (bytes are stripped at each hop as packet travels to destination)":(z===n.RouteType.Flood||z===n.RouteType.TransportFlood)&&(B="Historical route taken (bytes are added as packet floods through network)"),D.push({name:"Path Data",description:B,startByte:N,endByte:N+U-1,value:(0,e.bytesToHex)(E.slice(N,N+U))})}N+=U;const ee=E.subarray(N),le=(0,e.bytesToHex)(ee);C&&E.length>N&&D.push({name:"Payload",description:`${(0,t.getPayloadTypeName)(I)} payload data`,startByte:N,endByte:E.length-1,value:(0,e.bytesToHex)(E.slice(N))});let Z=null;const ie=[];if(I===n.PayloadType.Advert){const B=i.AdvertPayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.Trace){const B=s.TracePayloadDecoder.decode(ee,$,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.GroupText){const B=o.GroupTextPayloadDecoder.decode(ee,{...T,includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.Request){const B=a.RequestPayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.Response){const B=u.ResponsePayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.AnonRequest){const B=f.AnonRequestPayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.Ack){const B=p.AckPayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.Path)Z=g.PathPayloadDecoder.decode(ee);else if(I===n.PayloadType.TextMessage){const B=x.TextMessagePayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}else if(I===n.PayloadType.Control){const B=A.ControlPayloadDecoder.decode(ee,{includeSegments:C,segmentOffset:0});Z=B,B!=null&&B.segments&&(ie.push(...B.segments),delete B.segments)}C&&ie.length===0&&E.length>N&&ie.push({name:`${(0,t.getPayloadTypeName)(I)} Payload`,description:`Raw ${(0,t.getPayloadTypeName)(I)} payload data (${ee.length} bytes)`,startByte:0,endByte:ee.length-1,value:(0,e.bytesToHex)(ee)});const V=this.calculateMessageHash(E,z,I,K),ne={messageHash:V,routeType:z,payloadType:I,payloadVersion:K,transportCodes:W,pathLength:U,path:$,payload:{raw:le,decoded:Z},totalBytes:E.length,isValid:!0},q={segments:D,totalBytes:E.length,rawHex:w.toUpperCase(),messageHash:V,payload:{segments:ie,hex:le,startByte:N,type:(0,t.getPayloadTypeName)(I)}};return{packet:ne,structure:q}}catch(N){const F={messageHash:"",routeType:n.RouteType.Flood,payloadType:n.PayloadType.RawCustom,payloadVersion:n.PayloadVersion.Version1,pathLength:0,path:null,payload:{raw:"",decoded:null},totalBytes:E.length,isValid:!1,errors:[N instanceof Error?N.message:"Unknown decoding error"]},z={segments:[],totalBytes:E.length,rawHex:w.toUpperCase(),messageHash:"",payload:{segments:[],hex:"",startByte:0,type:"Unknown"}};return{packet:F,structure:z}}}static async parseInternalAsync(w,C,T){const E=this.parseInternal(w,C,T);if(E.packet.payloadType===n.PayloadType.Advert&&E.packet.payload.decoded)try{const D=E.packet.payload.decoded,N=await i.AdvertPayloadDecoder.decodeWithVerification((0,e.hexToBytes)(E.packet.payload.raw),{includeSegments:C,segmentOffset:0});N&&(E.packet.payload.decoded=N,N.isValid||(E.packet.isValid=!1,E.packet.errors=N.errors||["Invalid advertisement signature"]),C&&N.segments&&(E.structure.payload.segments=N.segments,delete N.segments))}catch(D){console.error("Signature verification failed:",D)}return E}static validate(w){const C=(0,e.hexToBytes)(w),T=[];if(C.length<2)return T.push("Packet too short (minimum 2 bytes required)"),{isValid:!1,errors:T};try{let E=1;const N=C[0]&3;if((N===n.RouteType.TransportFlood||N===n.RouteType.TransportDirect)&&(C.length<E+4&&T.push("Packet too short for transport codes"),E+=4),C.length<E+1)T.push("Packet too short for path length");else{const F=C[E];E+=1,C.length<E+F&&T.push("Packet too short for path data"),E+=F}E>=C.length&&T.push("No payload data found")}catch(E){T.push(E instanceof Error?E.message:"Validation error")}return{isValid:T.length===0,errors:T.length>0?T:void 0}}static calculateMessageHash(w,C,T,E){if(T===n.PayloadType.Trace&&w.length>=13){let K=1;if((C===n.RouteType.TransportFlood||C===n.RouteType.TransportDirect)&&(K+=4),w.length>K){const W=w[K];K+=1+W}if(w.length>=K+4){const W=w[K]|w[K+1]<<8|w[K+2]<<16|w[K+3]<<24;return(0,e.numberToHex)(W,8)}}const D=T<<2|E<<6;let N=1;if((C===n.RouteType.TransportFlood||C===n.RouteType.TransportDirect)&&(N+=4),w.length>N){const K=w[N];N+=1+K}const F=w.slice(N),z=[D,...Array.from(F)];let I=0;for(let K=0;K<z.length;K++)I=(I<<5)-I+z[K]&4294967295;return(0,e.numberToHex)(I,8)}static createKeyStore(w){return new r.MeshCoreKeyStore(w)}}return Lu.MeshCorePacketDecoder=_,Lu}var Ha={},dk;function pk(){if(dk)return Ha;dk=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.createAuthToken=i,Ha.verifyAuthToken=s,Ha.parseAuthToken=o,Ha.decodeAuthTokenPayload=a;const n=SA(),e=nr();function t(u){let f="";if(typeof Buffer<"u")f=Buffer.from(u).toString("base64");else{const p=String.fromCharCode(...Array.from(u));f=btoa(p)}return f.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function r(u){let f=u.replace(/-/g,"+").replace(/_/g,"/");for(;f.length%4;)f+="=";if(typeof Buffer<"u")return new Uint8Array(Buffer.from(f,"base64"));{const p=atob(f),g=new Uint8Array(p.length);for(let x=0;x<p.length;x++)g[x]=p.charCodeAt(x);return g}}async function i(u,f,p){const g={alg:"Ed25519",typ:"JWT"};u.publicKey?u.publicKey=u.publicKey.toUpperCase():u.publicKey=p.toUpperCase(),u.iat||(u.iat=Math.floor(Date.now()/1e3));const x=JSON.stringify(g),A=JSON.stringify(u),_=new TextEncoder().encode(x),b=new TextEncoder().encode(A),w=t(_),C=t(b),T=`${w}.${C}`,E=new TextEncoder().encode(T),D=(0,e.bytesToHex)(E),N=await(0,n.sign)(D,f,u.publicKey);return`${w}.${C}.${N}`}async function s(u,f){try{const p=u.split(".");if(p.length!==3)return null;const[g,x,A]=p,_=r(g),b=r(x),w=new TextDecoder().decode(_),C=new TextDecoder().decode(b),T=JSON.parse(w),E=JSON.parse(C);if(T.alg!=="Ed25519"||T.typ!=="JWT"||!E.publicKey||!E.iat||f&&E.publicKey.toUpperCase()!==f.toUpperCase()||E.exp&&Math.floor(Date.now()/1e3)>E.exp)return null;const D=`${g}.${x}`,N=new TextEncoder().encode(D),F=(0,e.bytesToHex)(N);return await(0,n.verify)(A,F,E.publicKey)?E:null}catch{return null}}function o(u){try{const f=u.split(".");return f.length!==3?null:{header:f[0],payload:f[1],signature:f[2]}}catch{return null}}function a(u){try{const f=u.split(".");if(f.length!==3)return null;const p=r(f[1]),g=new TextDecoder().decode(p);return JSON.parse(g)}catch{return null}}return Ha}var mk;function Gj(){return mk||(mk=1,(function(n){var e=Us&&Us.__createBinding||(Object.create?(function(C,T,E,D){D===void 0&&(D=E);var N=Object.getOwnPropertyDescriptor(T,E);(!N||("get"in N?!T.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return T[E]}}),Object.defineProperty(C,D,N)}):(function(C,T,E,D){D===void 0&&(D=E),C[D]=T[E]})),t=Us&&Us.__setModuleDefault||(Object.create?(function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}):function(C,T){C.default=T}),r=Us&&Us.__importStar||(function(){var C=function(T){return C=Object.getOwnPropertyNames||function(E){var D=[];for(var N in E)Object.prototype.hasOwnProperty.call(E,N)&&(D[D.length]=N);return D},C(T)};return function(T){if(T&&T.__esModule)return T;var E={};if(T!=null)for(var D=C(T),N=0;N<D.length;N++)D[N]!=="default"&&e(E,T,D[N]);return t(E,T),E}})();Object.defineProperty(n,"__esModule",{value:!0}),n.Utils=n.decodeAuthTokenPayload=n.parseAuthToken=n.verifyAuthToken=n.createAuthToken=n.getControlSubTypeName=n.getRequestTypeName=n.getDeviceRoleName=n.getPayloadVersionName=n.getPayloadTypeName=n.getRouteTypeName=n.numberToHex=n.byteToHex=n.bytesToHex=n.hexToBytes=n.Ed25519SignatureVerifier=n.ChannelCrypto=n.MeshCoreKeyStore=n.ControlSubType=n.RequestType=n.AdvertFlags=n.DeviceRole=n.PayloadVersion=n.PayloadType=n.RouteType=n.MeshCoreDecoder=n.MeshCorePacketDecoder=void 0;var i=fk();Object.defineProperty(n,"MeshCorePacketDecoder",{enumerable:!0,get:function(){return i.MeshCorePacketDecoder}});var s=fk();Object.defineProperty(n,"MeshCoreDecoder",{enumerable:!0,get:function(){return s.MeshCorePacketDecoder}});var o=oi();Object.defineProperty(n,"RouteType",{enumerable:!0,get:function(){return o.RouteType}}),Object.defineProperty(n,"PayloadType",{enumerable:!0,get:function(){return o.PayloadType}}),Object.defineProperty(n,"PayloadVersion",{enumerable:!0,get:function(){return o.PayloadVersion}}),Object.defineProperty(n,"DeviceRole",{enumerable:!0,get:function(){return o.DeviceRole}}),Object.defineProperty(n,"AdvertFlags",{enumerable:!0,get:function(){return o.AdvertFlags}}),Object.defineProperty(n,"RequestType",{enumerable:!0,get:function(){return o.RequestType}}),Object.defineProperty(n,"ControlSubType",{enumerable:!0,get:function(){return o.ControlSubType}});var a=BE();Object.defineProperty(n,"MeshCoreKeyStore",{enumerable:!0,get:function(){return a.MeshCoreKeyStore}});var u=mA();Object.defineProperty(n,"ChannelCrypto",{enumerable:!0,get:function(){return u.ChannelCrypto}});var f=$E();Object.defineProperty(n,"Ed25519SignatureVerifier",{enumerable:!0,get:function(){return f.Ed25519SignatureVerifier}});var p=nr();Object.defineProperty(n,"hexToBytes",{enumerable:!0,get:function(){return p.hexToBytes}}),Object.defineProperty(n,"bytesToHex",{enumerable:!0,get:function(){return p.bytesToHex}}),Object.defineProperty(n,"byteToHex",{enumerable:!0,get:function(){return p.byteToHex}}),Object.defineProperty(n,"numberToHex",{enumerable:!0,get:function(){return p.numberToHex}});var g=Bh();Object.defineProperty(n,"getRouteTypeName",{enumerable:!0,get:function(){return g.getRouteTypeName}}),Object.defineProperty(n,"getPayloadTypeName",{enumerable:!0,get:function(){return g.getPayloadTypeName}}),Object.defineProperty(n,"getPayloadVersionName",{enumerable:!0,get:function(){return g.getPayloadVersionName}}),Object.defineProperty(n,"getDeviceRoleName",{enumerable:!0,get:function(){return g.getDeviceRoleName}}),Object.defineProperty(n,"getRequestTypeName",{enumerable:!0,get:function(){return g.getRequestTypeName}}),Object.defineProperty(n,"getControlSubTypeName",{enumerable:!0,get:function(){return g.getControlSubTypeName}});var x=pk();Object.defineProperty(n,"createAuthToken",{enumerable:!0,get:function(){return x.createAuthToken}}),Object.defineProperty(n,"verifyAuthToken",{enumerable:!0,get:function(){return x.verifyAuthToken}}),Object.defineProperty(n,"parseAuthToken",{enumerable:!0,get:function(){return x.parseAuthToken}}),Object.defineProperty(n,"decodeAuthTokenPayload",{enumerable:!0,get:function(){return x.decodeAuthTokenPayload}});const A=r(Bh()),_=r(nr()),b=r(pk()),w=SA();n.Utils={...A,..._,...b,derivePublicKey:w.derivePublicKey,validateKeyPair:w.validateKeyPair,sign:w.sign,verify:w.verify}})(Us)),Us}var Pt=Gj();function Xj(n){return new Date(n*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function Kj(n){const e=[];return n.snr!==null&&n.snr!==void 0&&e.push(`SNR: ${n.snr.toFixed(1)} dB`),n.rssi!==null&&n.rssi!==void 0&&e.push(`RSSI: ${n.rssi} dBm`),e.join(" | ")}function Yj(n,e){var t;try{const r=Pt.MeshCoreDecoder.decode(n);if(!r.isValid)return{summary:"Invalid packet",routeType:"Unknown"};const i=Pt.Utils.getRouteTypeName(r.routeType),s=Pt.Utils.getPayloadTypeName(r.payloadType),o=r.path&&r.path.length>0?` via ${r.path.join("-")}`:"";let a=s,u;switch(r.payloadType){case Pt.PayloadType.TextMessage:{const f=r.payload.decoded;f!=null&&f.sourceHash&&(f!=null&&f.destinationHash)?a=`DM from ${f.sourceHash} to ${f.destinationHash}${o}`:a=`DM${o}`;break}case Pt.PayloadType.GroupText:{const f=r.payload.decoded;e!=null&&e.channel_name?e.sender?a=`GT from ${e.sender} in ${e.channel_name}${o}`:a=`GT in ${e.channel_name}${o}`:f!=null&&f.channelHash?a=`GT ch:${f.channelHash}${o}`:a=`GroupText${o}`;break}case Pt.PayloadType.Advert:{const f=r.payload.decoded;if((t=f==null?void 0:f.appData)!=null&&t.name){const p=f.appData.deviceRole!==void 0?Pt.Utils.getDeviceRoleName(f.appData.deviceRole):"";a=`Advert: ${f.appData.name}${p?` (${p})`:""}${o}`}else f!=null&&f.publicKey?a=`Advert: ${f.publicKey.slice(0,8)}...${o}`:a=`Advert${o}`;break}case Pt.PayloadType.Ack:{a=`ACK${o}`;break}case Pt.PayloadType.Request:{a=`Request${o}`;break}case Pt.PayloadType.Response:{a=`Response${o}`;break}case Pt.PayloadType.Trace:{a=`Trace${o}`;break}case Pt.PayloadType.Path:{a=`Path${o}`;break}default:a=`${s}${o}`}return{summary:a,routeType:i,details:u}}catch{return{summary:"Decode error",routeType:"Unknown"}}}function Jj(n){switch(n){case"Flood":return"bg-blue-500/20 text-blue-400";case"Direct":return"bg-green-500/20 text-green-400";case"Transport Flood":return"bg-purple-500/20 text-purple-400";case"Transport Direct":return"bg-orange-500/20 text-orange-400";default:return"bg-gray-500/20 text-gray-400"}}function eQ(n){switch(n){case"Flood":return"F";case"Direct":return"D";case"Transport Flood":return"TF";case"Transport Direct":return"TD";default:return"?"}}function nv({packets:n}){const e=R.useRef(null),t=R.useMemo(()=>n.map(i=>({packet:i,decoded:Yj(i.data,i.decrypted_info)})),[n]);if(R.useEffect(()=>{e.current&&(e.current.scrollTop=e.current.scrollHeight)},[n]),n.length===0)return S.jsx("div",{className:"h-full overflow-y-auto p-5 text-center text-muted-foreground",children:"No packets received yet. Packets will appear here in real-time."});const r=[...t].sort((i,s)=>i.packet.timestamp-s.packet.timestamp);return S.jsx("div",{className:"h-full overflow-y-auto p-4 flex flex-col gap-3",ref:e,children:r.map(({packet:i,decoded:s})=>S.jsxs("div",{className:"py-2 px-3 bg-muted rounded",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:`text-[10px] font-mono px-1.5 py-0.5 rounded ${Jj(s.routeType)}`,title:s.routeType,children:eQ(s.routeType)}),!i.decrypted&&S.jsx("span",{title:"Encrypted",children:""}),S.jsx("span",{className:i.decrypted?"text-primary":"text-foreground",children:s.summary}),S.jsx("span",{className:"text-muted-foreground ml-auto text-sm",children:Xj(i.timestamp)})]}),(i.snr!==null||i.rssi!==null)&&S.jsx("div",{className:"text-[11px] text-muted-foreground mt-0.5",children:Kj(i)}),S.jsx("div",{className:"font-mono text-[10px] break-all text-muted-foreground/70 mt-1 p-1 bg-background/50 rounded",children:i.data.toUpperCase()})]},i.id))})}function UE(n,e){const t=R.useRef(e);R.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}function tQ(n,e,t){e.center!==t.center&&n.setLatLng(e.center),e.radius!=null&&e.radius!==t.radius&&n.setRadius(e.radius)}const nQ=1;function rQ(n){return Object.freeze({__version:nQ,map:n})}function iQ(n,e){return Object.freeze({...n,...e})}const ZE=R.createContext(null),GE=ZE.Provider;function gm(){const n=R.useContext(ZE);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function sQ(n){function e(t,r){const{instance:i,context:s}=n(t).current;return R.useImperativeHandle(r,()=>i),t.children==null?null:Be.createElement(GE,{value:s},t.children)}return R.forwardRef(e)}function oQ(n){function e(t,r){const[i,s]=R.useState(!1),{instance:o}=n(t,s).current;R.useImperativeHandle(r,()=>o),R.useEffect(function(){i&&o.update()},[o,i,t.children]);const a=o._contentNode;return a?dv.createPortal(t.children,a):null}return R.forwardRef(e)}function aQ(n){function e(t,r){const{instance:i}=n(t).current;return R.useImperativeHandle(r,()=>i),null}return R.forwardRef(e)}function CA(n,e){const t=R.useRef();R.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function xm(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function lQ(n,e){return function(r,i){const s=gm(),o=n(xm(r,s),s);return UE(s.map,r.attribution),CA(o.current,r.eventHandlers),e(o.current,s,r,i),o}}var eh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var cQ=eh.exports,gk;function uQ(){return gk||(gk=1,(function(n,e){(function(t,r){r(e)})(cQ,(function(t){var r="1.9.4";function i(c){var d,y,O,M;for(y=1,O=arguments.length;y<O;y++){M=arguments[y];for(d in M)c[d]=M[d]}return c}var s=Object.create||(function(){function c(){}return function(d){return c.prototype=d,new c}})();function o(c,d){var y=Array.prototype.slice;if(c.bind)return c.bind.apply(c,y.call(arguments,1));var O=y.call(arguments,2);return function(){return c.apply(d,O.length?O.concat(y.call(arguments)):arguments)}}var a=0;function u(c){return"_leaflet_id"in c||(c._leaflet_id=++a),c._leaflet_id}function f(c,d,y){var O,M,H,te;return te=function(){O=!1,M&&(H.apply(y,M),M=!1)},H=function(){O?M=arguments:(c.apply(y,arguments),setTimeout(te,d),O=!0)},H}function p(c,d,y){var O=d[1],M=d[0],H=O-M;return c===O&&y?c:((c-M)%H+H)%H+M}function g(){return!1}function x(c,d){if(d===!1)return c;var y=Math.pow(10,d===void 0?6:d);return Math.round(c*y)/y}function A(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function _(c){return A(c).split(/\s+/)}function b(c,d){Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?s(c.options):{});for(var y in d)c.options[y]=d[y];return c.options}function w(c,d,y){var O=[];for(var M in c)O.push(encodeURIComponent(y?M.toUpperCase():M)+"="+encodeURIComponent(c[M]));return(!d||d.indexOf("?")===-1?"?":"&")+O.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function T(c,d){return c.replace(C,function(y,O){var M=d[O];if(M===void 0)throw new Error("No value provided for variable "+y);return typeof M=="function"&&(M=M(d)),M})}var E=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function D(c,d){for(var y=0;y<c.length;y++)if(c[y]===d)return y;return-1}var N="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function F(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var z=0;function I(c){var d=+new Date,y=Math.max(0,16-(d-z));return z=d+y,window.setTimeout(c,y)}var K=window.requestAnimationFrame||F("RequestAnimationFrame")||I,W=window.cancelAnimationFrame||F("CancelAnimationFrame")||F("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function U(c,d,y){if(y&&K===I)c.call(d);else return K.call(window,o(c,d))}function X(c){c&&W.call(window,c)}var $={__proto__:null,extend:i,create:s,bind:o,get lastId(){return a},stamp:u,throttle:f,wrapNum:p,falseFn:g,formatNum:x,trim:A,splitWords:_,setOptions:b,getParamString:w,template:T,isArray:E,indexOf:D,emptyImageUrl:N,requestFn:K,cancelFn:W,requestAnimFrame:U,cancelAnimFrame:X};function ee(){}ee.extend=function(c){var d=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},y=d.__super__=this.prototype,O=s(y);O.constructor=d,d.prototype=O;for(var M in this)Object.prototype.hasOwnProperty.call(this,M)&&M!=="prototype"&&M!=="__super__"&&(d[M]=this[M]);return c.statics&&i(d,c.statics),c.includes&&(le(c.includes),i.apply(null,[O].concat(c.includes))),i(O,c),delete O.statics,delete O.includes,O.options&&(O.options=y.options?s(y.options):{},i(O.options,c.options)),O._initHooks=[],O.callInitHooks=function(){if(!this._initHooksCalled){y.callInitHooks&&y.callInitHooks.call(this),this._initHooksCalled=!0;for(var H=0,te=O._initHooks.length;H<te;H++)O._initHooks[H].call(this)}},d},ee.include=function(c){var d=this.prototype.options;return i(this.prototype,c),c.options&&(this.prototype.options=d,this.mergeOptions(c.options)),this},ee.mergeOptions=function(c){return i(this.prototype.options,c),this},ee.addInitHook=function(c){var d=Array.prototype.slice.call(arguments,1),y=typeof c=="function"?c:function(){this[c].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(y),this};function le(c){if(!(typeof L>"u"||!L||!L.Mixin)){c=E(c)?c:[c];for(var d=0;d<c.length;d++)c[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(c,d,y){if(typeof c=="object")for(var O in c)this._on(O,c[O],d);else{c=_(c);for(var M=0,H=c.length;M<H;M++)this._on(c[M],d,y)}return this},off:function(c,d,y){if(!arguments.length)delete this._events;else if(typeof c=="object")for(var O in c)this._off(O,c[O],d);else{c=_(c);for(var M=arguments.length===1,H=0,te=c.length;H<te;H++)M?this._off(c[H]):this._off(c[H],d,y)}return this},_on:function(c,d,y,O){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(c,d,y)===!1){y===this&&(y=void 0);var M={fn:d,ctx:y};O&&(M.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(M)}},_off:function(c,d,y){var O,M,H;if(this._events&&(O=this._events[c],!!O)){if(arguments.length===1){if(this._firingCount)for(M=0,H=O.length;M<H;M++)O[M].fn=g;delete this._events[c];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var te=this._listens(c,d,y);if(te!==!1){var ce=O[te];this._firingCount&&(ce.fn=g,this._events[c]=O=O.slice()),O.splice(te,1)}}},fire:function(c,d,y){if(!this.listens(c,y))return this;var O=i({},d,{type:c,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var M=this._events[c];if(M){this._firingCount=this._firingCount+1||1;for(var H=0,te=M.length;H<te;H++){var ce=M[H],me=ce.fn;ce.once&&this.off(c,me,ce.ctx),me.call(ce.ctx||this,O)}this._firingCount--}}return y&&this._propagateEvent(O),this},listens:function(c,d,y,O){typeof c!="string"&&console.warn('"string" type argument expected');var M=d;typeof d!="function"&&(O=!!d,M=void 0,y=void 0);var H=this._events&&this._events[c];if(H&&H.length&&this._listens(c,M,y)!==!1)return!0;if(O){for(var te in this._eventParents)if(this._eventParents[te].listens(c,d,y,O))return!0}return!1},_listens:function(c,d,y){if(!this._events)return!1;var O=this._events[c]||[];if(!d)return!!O.length;y===this&&(y=void 0);for(var M=0,H=O.length;M<H;M++)if(O[M].fn===d&&O[M].ctx===y)return M;return!1},once:function(c,d,y){if(typeof c=="object")for(var O in c)this._on(O,c[O],d,!0);else{c=_(c);for(var M=0,H=c.length;M<H;M++)this._on(c[M],d,y,!0)}return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[u(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[u(c)],this},_propagateEvent:function(c){for(var d in this._eventParents)this._eventParents[d].fire(c.type,i({layer:c.target,propagatedFrom:c.target},c),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var ie=ee.extend(Z);function V(c,d,y){this.x=y?Math.round(c):c,this.y=y?Math.round(d):d}var ne=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};V.prototype={clone:function(){return new V(this.x,this.y)},add:function(c){return this.clone()._add(q(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(q(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new V(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new V(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ne(this.x),this.y=ne(this.y),this},distanceTo:function(c){c=q(c);var d=c.x-this.x,y=c.y-this.y;return Math.sqrt(d*d+y*y)},equals:function(c){return c=q(c),c.x===this.x&&c.y===this.y},contains:function(c){return c=q(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function q(c,d,y){return c instanceof V?c:E(c)?new V(c[0],c[1]):c==null?c:typeof c=="object"&&"x"in c&&"y"in c?new V(c.x,c.y):new V(c,d,y)}function B(c,d){if(c)for(var y=d?[c,d]:c,O=0,M=y.length;O<M;O++)this.extend(y[O])}B.prototype={extend:function(c){var d,y;if(!c)return this;if(c instanceof V||typeof c[0]=="number"||"x"in c)d=y=q(c);else if(c=Q(c),d=c.min,y=c.max,!d||!y)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=y.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(y.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(y.y,this.max.y)),this},getCenter:function(c){return q((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return q(this.min.x,this.max.y)},getTopRight:function(){return q(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var d,y;return typeof c[0]=="number"||c instanceof V?c=q(c):c=Q(c),c instanceof B?(d=c.min,y=c.max):d=y=c,d.x>=this.min.x&&y.x<=this.max.x&&d.y>=this.min.y&&y.y<=this.max.y},intersects:function(c){c=Q(c);var d=this.min,y=this.max,O=c.min,M=c.max,H=M.x>=d.x&&O.x<=y.x,te=M.y>=d.y&&O.y<=y.y;return H&&te},overlaps:function(c){c=Q(c);var d=this.min,y=this.max,O=c.min,M=c.max,H=M.x>d.x&&O.x<y.x,te=M.y>d.y&&O.y<y.y;return H&&te},isValid:function(){return!!(this.min&&this.max)},pad:function(c){var d=this.min,y=this.max,O=Math.abs(d.x-y.x)*c,M=Math.abs(d.y-y.y)*c;return Q(q(d.x-O,d.y-M),q(y.x+O,y.y+M))},equals:function(c){return c?(c=Q(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight())):!1}};function Q(c,d){return!c||c instanceof B?c:new B(c,d)}function G(c,d){if(c)for(var y=d?[c,d]:c,O=0,M=y.length;O<M;O++)this.extend(y[O])}G.prototype={extend:function(c){var d=this._southWest,y=this._northEast,O,M;if(c instanceof ue)O=c,M=c;else if(c instanceof G){if(O=c._southWest,M=c._northEast,!O||!M)return this}else return c?this.extend(pe(c)||Y(c)):this;return!d&&!y?(this._southWest=new ue(O.lat,O.lng),this._northEast=new ue(M.lat,M.lng)):(d.lat=Math.min(O.lat,d.lat),d.lng=Math.min(O.lng,d.lng),y.lat=Math.max(M.lat,y.lat),y.lng=Math.max(M.lng,y.lng)),this},pad:function(c){var d=this._southWest,y=this._northEast,O=Math.abs(d.lat-y.lat)*c,M=Math.abs(d.lng-y.lng)*c;return new G(new ue(d.lat-O,d.lng-M),new ue(y.lat+O,y.lng+M))},getCenter:function(){return new ue((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ue(this.getNorth(),this.getWest())},getSouthEast:function(){return new ue(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){typeof c[0]=="number"||c instanceof ue||"lat"in c?c=pe(c):c=Y(c);var d=this._southWest,y=this._northEast,O,M;return c instanceof G?(O=c.getSouthWest(),M=c.getNorthEast()):O=M=c,O.lat>=d.lat&&M.lat<=y.lat&&O.lng>=d.lng&&M.lng<=y.lng},intersects:function(c){c=Y(c);var d=this._southWest,y=this._northEast,O=c.getSouthWest(),M=c.getNorthEast(),H=M.lat>=d.lat&&O.lat<=y.lat,te=M.lng>=d.lng&&O.lng<=y.lng;return H&&te},overlaps:function(c){c=Y(c);var d=this._southWest,y=this._northEast,O=c.getSouthWest(),M=c.getNorthEast(),H=M.lat>d.lat&&O.lat<y.lat,te=M.lng>d.lng&&O.lng<y.lng;return H&&te},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,d){return c?(c=Y(c),this._southWest.equals(c.getSouthWest(),d)&&this._northEast.equals(c.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Y(c,d){return c instanceof G?c:new G(c,d)}function ue(c,d,y){if(isNaN(c)||isNaN(d))throw new Error("Invalid LatLng object: ("+c+", "+d+")");this.lat=+c,this.lng=+d,y!==void 0&&(this.alt=+y)}ue.prototype={equals:function(c,d){if(!c)return!1;c=pe(c);var y=Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng));return y<=(d===void 0?1e-9:d)},toString:function(c){return"LatLng("+x(this.lat,c)+", "+x(this.lng,c)+")"},distanceTo:function(c){return xe.distance(this,pe(c))},wrap:function(){return xe.wrapLatLng(this)},toBounds:function(c){var d=180*c/40075017,y=d/Math.cos(Math.PI/180*this.lat);return Y([this.lat-d,this.lng-y],[this.lat+d,this.lng+y])},clone:function(){return new ue(this.lat,this.lng,this.alt)}};function pe(c,d,y){return c instanceof ue?c:E(c)&&typeof c[0]!="object"?c.length===3?new ue(c[0],c[1],c[2]):c.length===2?new ue(c[0],c[1]):null:c==null?c:typeof c=="object"&&"lat"in c?new ue(c.lat,"lng"in c?c.lng:c.lon,c.alt):d===void 0?null:new ue(c,d,y)}var ve={latLngToPoint:function(c,d){var y=this.projection.project(c),O=this.scale(d);return this.transformation._transform(y,O)},pointToLatLng:function(c,d){var y=this.scale(d),O=this.transformation.untransform(c,y);return this.projection.unproject(O)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var d=this.projection.bounds,y=this.scale(c),O=this.transformation.transform(d.min,y),M=this.transformation.transform(d.max,y);return new B(O,M)},infinite:!1,wrapLatLng:function(c){var d=this.wrapLng?p(c.lng,this.wrapLng,!0):c.lng,y=this.wrapLat?p(c.lat,this.wrapLat,!0):c.lat,O=c.alt;return new ue(y,d,O)},wrapLatLngBounds:function(c){var d=c.getCenter(),y=this.wrapLatLng(d),O=d.lat-y.lat,M=d.lng-y.lng;if(O===0&&M===0)return c;var H=c.getSouthWest(),te=c.getNorthEast(),ce=new ue(H.lat-O,H.lng-M),me=new ue(te.lat-O,te.lng-M);return new G(ce,me)}},xe=i({},ve,{wrapLng:[-180,180],R:6371e3,distance:function(c,d){var y=Math.PI/180,O=c.lat*y,M=d.lat*y,H=Math.sin((d.lat-c.lat)*y/2),te=Math.sin((d.lng-c.lng)*y/2),ce=H*H+Math.cos(O)*Math.cos(M)*te*te,me=2*Math.atan2(Math.sqrt(ce),Math.sqrt(1-ce));return this.R*me}}),ye=6378137,Pe={R:ye,MAX_LATITUDE:85.0511287798,project:function(c){var d=Math.PI/180,y=this.MAX_LATITUDE,O=Math.max(Math.min(y,c.lat),-y),M=Math.sin(O*d);return new V(this.R*c.lng*d,this.R*Math.log((1+M)/(1-M))/2)},unproject:function(c){var d=180/Math.PI;return new ue((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*d,c.x*d/this.R)},bounds:(function(){var c=ye*Math.PI;return new B([-c,-c],[c,c])})()};function Ke(c,d,y,O){if(E(c)){this._a=c[0],this._b=c[1],this._c=c[2],this._d=c[3];return}this._a=c,this._b=d,this._c=y,this._d=O}Ke.prototype={transform:function(c,d){return this._transform(c.clone(),d)},_transform:function(c,d){return d=d||1,c.x=d*(this._a*c.x+this._b),c.y=d*(this._c*c.y+this._d),c},untransform:function(c,d){return d=d||1,new V((c.x/d-this._b)/this._a,(c.y/d-this._d)/this._c)}};function nt(c,d,y,O){return new Ke(c,d,y,O)}var Ce=i({},xe,{code:"EPSG:3857",projection:Pe,transformation:(function(){var c=.5/(Math.PI*Pe.R);return nt(c,.5,-c,.5)})()}),Ge=i({},Ce,{code:"EPSG:900913"});function pt(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function bt(c,d){var y="",O,M,H,te,ce,me;for(O=0,H=c.length;O<H;O++){for(ce=c[O],M=0,te=ce.length;M<te;M++)me=ce[M],y+=(M?"L":"M")+me.x+" "+me.y;y+=d?ze.svg?"z":"x":""}return y||"M0 0"}var ot=document.documentElement.style,mt="ActiveXObject"in window,et=mt&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),at=pn("webkit"),qe=pn("android"),Dt=pn("android 2")||pn("android 3"),Jt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),dr=qe&&pn("Google")&&Jt<537&&!("AudioNode"in window),en=!!window.opera,vn=!tt&&pn("chrome"),En=pn("gecko")&&!at&&!en&&!mt,Zn=!vn&&pn("safari"),rn=pn("phantom"),Qt="OTransition"in ot,sn=navigator.platform.indexOf("Win")===0,pr=mt&&"transition"in ot,zn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Dt,Ae="MozPerspective"in ot,Te=!window.L_DISABLE_3D&&(pr||zn||Ae)&&!Qt&&!rn,Ie=typeof orientation<"u"||pn("mobile"),xt=Ie&&at,se=Ie&&zn,be=!window.PointerEvent&&window.MSPointerEvent,Oe=!!(window.PointerEvent||be),Le="ontouchstart"in window||!!window.TouchEvent,lt=!window.L_NO_TOUCH&&(Le||Oe),ae=Ie&&en,De=Ie&&En,wt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Gt=(function(){var c=!1;try{var d=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",g,d),window.removeEventListener("testPassiveEventSupport",g,d)}catch{}return c})(),On=(function(){return!!document.createElement("canvas").getContext})(),At=!!(document.createElementNS&&pt("svg").createSVGRect),Ht=!!At&&(function(){var c=document.createElement("div");return c.innerHTML="<svg/>",(c.firstChild&&c.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Qr=!At&&(function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var d=c.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),Mt=navigator.platform.indexOf("Mac")===0,on=navigator.platform.indexOf("Linux")===0;function pn(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var ze={ie:mt,ielt9:et,edge:tt,webkit:at,android:qe,android23:Dt,androidStock:dr,opera:en,chrome:vn,gecko:En,safari:Zn,phantom:rn,opera12:Qt,win:sn,ie3d:pr,webkit3d:zn,gecko3d:Ae,any3d:Te,mobile:Ie,mobileWebkit:xt,mobileWebkit3d:se,msPointer:be,pointer:Oe,touch:lt,touchNative:Le,mobileOpera:ae,mobileGecko:De,retina:wt,passiveEvents:Gt,canvas:On,svg:At,vml:Qr,inlineSvg:Ht,mac:Mt,linux:on},co=ze.msPointer?"MSPointerDown":"pointerdown",fl=ze.msPointer?"MSPointerMove":"pointermove",Xh=ze.msPointer?"MSPointerUp":"pointerup",Kh=ze.msPointer?"MSPointerCancel":"pointercancel",jc={touchstart:co,touchmove:fl,touchend:Xh,touchcancel:Kh},Gi={touchstart:cn,touchmove:dl,touchend:dl,touchcancel:dl},ks={},Qc=!1;function bm(c,d,y){return d==="touchstart"&&wm(),Gi[d]?(y=Gi[d].bind(this,y),c.addEventListener(jc[d],y,!1),y):(console.warn("wrong event specified:",d),g)}function Yh(c,d,y){if(!jc[d]){console.warn("wrong event specified:",d);return}c.removeEventListener(jc[d],y,!1)}function Jh(c){ks[c.pointerId]=c}function ef(c){ks[c.pointerId]&&(ks[c.pointerId]=c)}function Hc(c){delete ks[c.pointerId]}function wm(){Qc||(document.addEventListener(co,Jh,!0),document.addEventListener(fl,ef,!0),document.addEventListener(Xh,Hc,!0),document.addEventListener(Kh,Hc,!0),Qc=!0)}function dl(c,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var y in ks)d.touches.push(ks[y]);d.changedTouches=[d],c(d)}}function cn(c,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&un(d),dl(c,d)}function _m(c){var d={},y,O;for(O in c)y=c[O],d[O]=y&&y.bind?y.bind(c):y;return c=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Wc=200;function tf(c,d){c.addEventListener("dblclick",d);var y=0,O;function M(H){if(H.detail!==1){O=H.detail;return}if(!(H.pointerType==="mouse"||H.sourceCapabilities&&!H.sourceCapabilities.firesTouchEvents)){var te=Ts(H);if(!(te.some(function(me){return me instanceof HTMLLabelElement&&me.attributes.for})&&!te.some(function(me){return me instanceof HTMLInputElement||me instanceof HTMLSelectElement}))){var ce=Date.now();ce-y<=Wc?(O++,O===2&&d(_m(H))):O=1,y=ce}}}return c.addEventListener("click",M),{dblclick:d,simDblclick:M}}function pl(c,d){c.removeEventListener("dblclick",d.dblclick),c.removeEventListener("click",d.simDblclick)}var qc=po(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),uo=po(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ha=uo==="webkitTransition"||uo==="OTransition"?uo+"End":"transitionend";function Hr(c){return typeof c=="string"?document.getElementById(c):c}function fa(c,d){var y=c.style[d]||c.currentStyle&&c.currentStyle[d];if((!y||y==="auto")&&document.defaultView){var O=document.defaultView.getComputedStyle(c,null);y=O?O[d]:null}return y==="auto"?null:y}function gt(c,d,y){var O=document.createElement(c);return O.className=d||"",y&&y.appendChild(O),O}function tn(c){var d=c.parentNode;d&&d.removeChild(c)}function ml(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function ho(c){var d=c.parentNode;d&&d.lastChild!==c&&d.appendChild(c)}function Si(c){var d=c.parentNode;d&&d.firstChild!==c&&d.insertBefore(c,d.firstChild)}function fo(c,d){if(c.classList!==void 0)return c.classList.contains(d);var y=gl(c);return y.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(y)}function ht(c,d){if(c.classList!==void 0)for(var y=_(d),O=0,M=y.length;O<M;O++)c.classList.add(y[O]);else if(!fo(c,d)){var H=gl(c);Vc(c,(H?H+" ":"")+d)}}function Xt(c,d){c.classList!==void 0?c.classList.remove(d):Vc(c,A((" "+gl(c)+" ").replace(" "+d+" "," ")))}function Vc(c,d){c.className.baseVal===void 0?c.className=d:c.className.baseVal=d}function gl(c){return c.correspondingElement&&(c=c.correspondingElement),c.className.baseVal===void 0?c.className:c.className.baseVal}function rr(c,d){"opacity"in c.style?c.style.opacity=d:"filter"in c.style&&nf(c,d)}function nf(c,d){var y=!1,O="DXImageTransform.Microsoft.Alpha";try{y=c.filters.item(O)}catch{if(d===1)return}d=Math.round(d*100),y?(y.Enabled=d!==100,y.Opacity=d):c.style.filter+=" progid:"+O+"(opacity="+d+")"}function po(c){for(var d=document.documentElement.style,y=0;y<c.length;y++)if(c[y]in d)return c[y];return!1}function Wr(c,d,y){var O=d||new V(0,0);c.style[qc]=(ze.ie3d?"translate("+O.x+"px,"+O.y+"px)":"translate3d("+O.x+"px,"+O.y+"px,0)")+(y?" scale("+y+")":"")}function mn(c,d){c._leaflet_pos=d,ze.any3d?Wr(c,d):(c.style.left=d.x+"px",c.style.top=d.y+"px")}function Ci(c){return c._leaflet_pos||new V(0,0)}var Bt,mo,xl;if("onselectstart"in document)Bt=function(){ct(window,"selectstart",un)},mo=function(){Wt(window,"selectstart",un)};else{var Ss=po(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Bt=function(){if(Ss){var c=document.documentElement.style;xl=c[Ss],c[Ss]="none"}},mo=function(){Ss&&(document.documentElement.style[Ss]=xl,xl=void 0)}}function yl(){ct(window,"dragstart",un)}function vl(){Wt(window,"dragstart",un)}var da,pa;function go(c){for(;c.tabIndex===-1;)c=c.parentNode;c.style&&(qr(),da=c,pa=c.style.outlineStyle,c.style.outlineStyle="none",ct(window,"keydown",qr))}function qr(){da&&(da.style.outlineStyle=pa,da=void 0,pa=void 0,Wt(window,"keydown",qr))}function Ti(c){do c=c.parentNode;while((!c.offsetWidth||!c.offsetHeight)&&c!==document.body);return c}function ai(c){var d=c.getBoundingClientRect();return{x:d.width/c.offsetWidth||1,y:d.height/c.offsetHeight||1,boundingClientRect:d}}var ma={__proto__:null,TRANSFORM:qc,TRANSITION:uo,TRANSITION_END:ha,get:Hr,getStyle:fa,create:gt,remove:tn,empty:ml,toFront:ho,toBack:Si,hasClass:fo,addClass:ht,removeClass:Xt,setClass:Vc,getClass:gl,setOpacity:rr,testProp:po,setTransform:Wr,setPosition:mn,getPosition:Ci,get disableTextSelection(){return Bt},get enableTextSelection(){return mo},disableImageDrag:yl,enableImageDrag:vl,preventOutline:go,restoreOutline:qr,getSizedParentNode:Ti,getScale:ai};function ct(c,d,y,O){if(d&&typeof d=="object")for(var M in d)Uc(c,M,d[M],y);else{d=_(d);for(var H=0,te=d.length;H<te;H++)Uc(c,d[H],y,O)}return this}var Pn="_leaflet_events";function Wt(c,d,y,O){if(arguments.length===1)$c(c),delete c[Pn];else if(d&&typeof d=="object")for(var M in d)Al(c,M,d[M],y);else if(d=_(d),arguments.length===2)$c(c,function(ce){return D(d,ce)!==-1});else for(var H=0,te=d.length;H<te;H++)Al(c,d[H],y,O);return this}function $c(c,d){for(var y in c[Pn]){var O=y.split(/\d/)[0];(!d||d(O))&&Al(c,O,null,null,y)}}var Cs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Uc(c,d,y,O){var M=d+u(y)+(O?"_"+u(O):"");if(c[Pn]&&c[Pn][M])return this;var H=function(ce){return y.call(O||c,ce||window.event)},te=H;!ze.touchNative&&ze.pointer&&d.indexOf("touch")===0?H=bm(c,d,H):ze.touch&&d==="dblclick"?H=tf(c,H):"addEventListener"in c?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?c.addEventListener(Cs[d]||d,H,ze.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(H=function(ce){ce=ce||window.event,ya(c,ce)&&te(ce)},c.addEventListener(Cs[d],H,!1)):c.addEventListener(d,te,!1):c.attachEvent("on"+d,H),c[Pn]=c[Pn]||{},c[Pn][M]=H}function Al(c,d,y,O,M){M=M||d+u(y)+(O?"_"+u(O):"");var H=c[Pn]&&c[Pn][M];if(!H)return this;!ze.touchNative&&ze.pointer&&d.indexOf("touch")===0?Yh(c,d,H):ze.touch&&d==="dblclick"?pl(c,H):"removeEventListener"in c?c.removeEventListener(Cs[d]||d,H,!1):c.detachEvent("on"+d,H),c[Pn][M]=null}function li(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function bl(c){return Uc(c,"wheel",li),this}function ga(c){return ct(c,"mousedown touchstart dblclick contextmenu",li),c._leaflet_disable_click=!0,this}function un(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function Vr(c){return un(c),li(c),this}function Ts(c){if(c.composedPath)return c.composedPath();for(var d=[],y=c.target;y;)d.push(y),y=y.parentNode;return d}function xa(c,d){if(!d)return new V(c.clientX,c.clientY);var y=ai(d),O=y.boundingClientRect;return new V((c.clientX-O.left)/y.x-d.clientLeft,(c.clientY-O.top)/y.y-d.clientTop)}var Om=ze.linux&&ze.chrome?window.devicePixelRatio:ze.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function rf(c){return ze.edge?c.wheelDeltaY/2:c.deltaY&&c.deltaMode===0?-c.deltaY/Om:c.deltaY&&c.deltaMode===1?-c.deltaY*20:c.deltaY&&c.deltaMode===2?-c.deltaY*60:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?-c.detail*20:c.detail?c.detail/-32765*60:0}function ya(c,d){var y=d.relatedTarget;if(!y)return!0;try{for(;y&&y!==c;)y=y.parentNode}catch{return!1}return y!==c}var wl={__proto__:null,on:ct,off:Wt,stopPropagation:li,disableScrollPropagation:bl,disableClickPropagation:ga,preventDefault:un,stop:Vr,getPropagationPath:Ts,getMousePosition:xa,getWheelDelta:rf,isExternalTarget:ya,addListener:ct,removeListener:Wt},_l=ie.extend({run:function(c,d,y,O){this.stop(),this._el=c,this._inProgress=!0,this._duration=y||.25,this._easeOutPower=1/Math.max(O||.5,.2),this._startPos=Ci(c),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=U(this._animate,this),this._step()},_step:function(c){var d=+new Date-this._startTime,y=this._duration*1e3;d<y?this._runFrame(this._easeOut(d/y),c):(this._runFrame(1),this._complete())},_runFrame:function(c,d){var y=this._startPos.add(this._offset.multiplyBy(c));d&&y._round(),mn(this._el,y),this.fire("step")},_complete:function(){X(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),Ct=ie.extend({options:{crs:Ce,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,d){d=b(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(pe(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=uo&&ze.any3d&&!ze.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ct(this._proxy,ha,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,d,y){if(d=d===void 0?this._zoom:this._limitZoom(d),c=this._limitCenter(pe(c),d,this.options.maxBounds),y=y||{},this._stop(),this._loaded&&!y.reset&&y!==!0){y.animate!==void 0&&(y.zoom=i({animate:y.animate},y.zoom),y.pan=i({animate:y.animate,duration:y.duration},y.pan));var O=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,d,y.zoom):this._tryAnimatedPan(c,y.pan);if(O)return clearTimeout(this._sizeTimer),this}return this._resetView(c,d,y.pan&&y.pan.noMoveStart),this},setZoom:function(c,d){return this._loaded?this.setView(this.getCenter(),c,{zoom:d}):(this._zoom=c,this)},zoomIn:function(c,d){return c=c||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+c,d)},zoomOut:function(c,d){return c=c||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-c,d)},setZoomAround:function(c,d,y){var O=this.getZoomScale(d),M=this.getSize().divideBy(2),H=c instanceof V?c:this.latLngToContainerPoint(c),te=H.subtract(M).multiplyBy(1-1/O),ce=this.containerPointToLatLng(M.add(te));return this.setView(ce,d,{zoom:y})},_getBoundsCenterZoom:function(c,d){d=d||{},c=c.getBounds?c.getBounds():Y(c);var y=q(d.paddingTopLeft||d.padding||[0,0]),O=q(d.paddingBottomRight||d.padding||[0,0]),M=this.getBoundsZoom(c,!1,y.add(O));if(M=typeof d.maxZoom=="number"?Math.min(d.maxZoom,M):M,M===1/0)return{center:c.getCenter(),zoom:M};var H=O.subtract(y).divideBy(2),te=this.project(c.getSouthWest(),M),ce=this.project(c.getNorthEast(),M),me=this.unproject(te.add(ce).divideBy(2).add(H),M);return{center:me,zoom:M}},fitBounds:function(c,d){if(c=Y(c),!c.isValid())throw new Error("Bounds are not valid.");var y=this._getBoundsCenterZoom(c,d);return this.setView(y.center,y.zoom,d)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,d){return this.setView(c,this._zoom,{pan:d})},panBy:function(c,d){if(c=q(c).round(),d=d||{},!c.x&&!c.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new _l,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){ht(this._mapPane,"leaflet-pan-anim");var y=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,y,d.duration||.25,d.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,d,y){if(y=y||{},y.animate===!1||!ze.any3d)return this.setView(c,d,y);this._stop();var O=this.project(this.getCenter()),M=this.project(c),H=this.getSize(),te=this._zoom;c=pe(c),d=d===void 0?te:d;var ce=Math.max(H.x,H.y),me=ce*this.getZoomScale(te,d),_e=M.distanceTo(O)||1,Fe=1.42,rt=Fe*Fe;function yt(It){var Bo=It?-1:1,Im=It?me:ce,zm=me*me-ce*ce+Bo*rt*rt*_e*_e,Ns=2*Im*rt*_e,Ls=zm/Ns,Fs=Math.sqrt(Ls*Ls+1)-Ls,Fl=Fs<1e-9?-18:Math.log(Fs);return Fl}function Bn(It){return(Math.exp(It)-Math.exp(-It))/2}function kn(It){return(Math.exp(It)+Math.exp(-It))/2}function xr(It){return Bn(It)/kn(It)}var sr=yt(0);function Eo(It){return ce*(kn(sr)/kn(sr+Fe*It))}function pu(It){return ce*(kn(sr)*xr(sr+Fe*It)-Bn(sr))/rt}function rs(It){return 1-Math.pow(1-It,1.5)}var kf=Date.now(),Ms=(yt(1)-sr)/Fe,fi=y.duration?1e3*y.duration:1e3*Ms*.8;function Po(){var It=(Date.now()-kf)/fi,Bo=rs(It)*Ms;It<=1?(this._flyToFrame=U(Po,this),this._move(this.unproject(O.add(M.subtract(O).multiplyBy(pu(Bo)/_e)),te),this.getScaleZoom(ce/Eo(Bo),te),{flyTo:!0})):this._move(c,d)._moveEnd(!0)}return this._moveStart(!0,y.noMoveStart),Po.call(this),this},flyToBounds:function(c,d){var y=this._getBoundsCenterZoom(c,d);return this.flyTo(y.center,y.zoom,d)},setMaxBounds:function(c){return c=Y(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var d=this.options.minZoom;return this.options.minZoom=c,this._loaded&&d!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var d=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&d!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,d){this._enforcingBounds=!0;var y=this.getCenter(),O=this._limitCenter(y,this._zoom,Y(c));return y.equals(O)||this.panTo(O,d),this._enforcingBounds=!1,this},panInside:function(c,d){d=d||{};var y=q(d.paddingTopLeft||d.padding||[0,0]),O=q(d.paddingBottomRight||d.padding||[0,0]),M=this.project(this.getCenter()),H=this.project(c),te=this.getPixelBounds(),ce=Q([te.min.add(y),te.max.subtract(O)]),me=ce.getSize();if(!ce.contains(H)){this._enforcingBounds=!0;var _e=H.subtract(ce.getCenter()),Fe=ce.extend(H).getSize().subtract(me);M.x+=_e.x<0?-Fe.x:Fe.x,M.y+=_e.y<0?-Fe.y:Fe.y,this.panTo(this.unproject(M),d),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=i({animate:!1,pan:!0},c===!0?{animate:!0}:c);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var y=this.getSize(),O=d.divideBy(2).round(),M=y.divideBy(2).round(),H=O.subtract(M);return!H.x&&!H.y?this:(c.animate&&c.pan?this.panBy(H):(c.pan&&this._rawPanBy(H),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:y}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=i({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=o(this._handleGeolocationResponse,this),y=o(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,y,c):navigator.geolocation.getCurrentPosition(d,y,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var d=c.code,y=c.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+y+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var d=c.coords.latitude,y=c.coords.longitude,O=new ue(d,y),M=O.toBounds(c.coords.accuracy*2),H=this._locateOptions;if(H.setView){var te=this.getBoundsZoom(M);this.setView(O,H.maxZoom?Math.min(te,H.maxZoom):te)}var ce={latlng:O,bounds:M,timestamp:c.timestamp};for(var me in c.coords)typeof c.coords[me]=="number"&&(ce[me]=c.coords[me]);this.fire("locationfound",ce)}},addHandler:function(c,d){if(!d)return this;var y=this[c]=new d(this);return this._handlers.push(y),this.options[c]&&y.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),tn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(X(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var c;for(c in this._layers)this._layers[c].remove();for(c in this._panes)tn(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,d){var y="leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),O=gt("div",y,d||this._mapPane);return c&&(this._panes[c]=O),O},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds(),d=this.unproject(c.getBottomLeft()),y=this.unproject(c.getTopRight());return new G(d,y)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,d,y){c=Y(c),y=q(y||[0,0]);var O=this.getZoom()||0,M=this.getMinZoom(),H=this.getMaxZoom(),te=c.getNorthWest(),ce=c.getSouthEast(),me=this.getSize().subtract(y),_e=Q(this.project(ce,O),this.project(te,O)).getSize(),Fe=ze.any3d?this.options.zoomSnap:1,rt=me.x/_e.x,yt=me.y/_e.y,Bn=d?Math.max(rt,yt):Math.min(rt,yt);return O=this.getScaleZoom(Bn,O),Fe&&(O=Math.round(O/(Fe/100))*(Fe/100),O=d?Math.ceil(O/Fe)*Fe:Math.floor(O/Fe)*Fe),Math.max(M,Math.min(H,O))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new V(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,d){var y=this._getTopLeftPoint(c,d);return new B(y,y.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(c===void 0?this.getZoom():c)},getPane:function(c){return typeof c=="string"?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,d){var y=this.options.crs;return d=d===void 0?this._zoom:d,y.scale(c)/y.scale(d)},getScaleZoom:function(c,d){var y=this.options.crs;d=d===void 0?this._zoom:d;var O=y.zoom(c*y.scale(d));return isNaN(O)?1/0:O},project:function(c,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(pe(c),d)},unproject:function(c,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(q(c),d)},layerPointToLatLng:function(c){var d=q(c).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(c){var d=this.project(pe(c))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(pe(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(Y(c))},distance:function(c,d){return this.options.crs.distance(pe(c),pe(d))},containerPointToLayerPoint:function(c){return q(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return q(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var d=this.containerPointToLayerPoint(q(c));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pe(c)))},mouseEventToContainerPoint:function(c){return xa(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var d=this._container=Hr(c);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ct(d,"scroll",this._onScroll,this),this._containerId=u(d)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&ze.any3d,ht(c,"leaflet-container"+(ze.touch?" leaflet-touch":"")+(ze.retina?" leaflet-retina":"")+(ze.ielt9?" leaflet-oldie":"")+(ze.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=fa(c,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),mn(this._mapPane,new V(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ht(c.markerPane,"leaflet-zoom-hide"),ht(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,d,y){mn(this._mapPane,new V(0,0));var O=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var M=this._zoom!==d;this._moveStart(M,y)._move(c,d)._moveEnd(M),this.fire("viewreset"),O&&this.fire("load")},_moveStart:function(c,d){return c&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(c,d,y,O){d===void 0&&(d=this._zoom);var M=this._zoom!==d;return this._zoom=d,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),O?y&&y.pinch&&this.fire("zoom",y):((M||y&&y.pinch)&&this.fire("zoom",y),this.fire("move",y)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return X(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){mn(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[u(this._container)]=this;var d=c?Wt:ct;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),ze.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){X(this._resizeRequest),this._resizeRequest=U(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,d){for(var y=[],O,M=d==="mouseout"||d==="mouseover",H=c.target||c.srcElement,te=!1;H;){if(O=this._targets[u(H)],O&&(d==="click"||d==="preclick")&&this._draggableMoved(O)){te=!0;break}if(O&&O.listens(d,!0)&&(M&&!ya(H,c)||(y.push(O),M))||H===this._container)break;H=H.parentNode}return!y.length&&!te&&!M&&this.listens(d,!0)&&(y=[this]),y},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var d=c.target||c.srcElement;if(!(!this._loaded||d._leaflet_disable_events||c.type==="click"&&this._isClickDisabled(d))){var y=c.type;y==="mousedown"&&go(d),this._fireDOMEvent(c,y)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,d,y){if(c.type==="click"){var O=i({},c);O.type="preclick",this._fireDOMEvent(O,O.type,y)}var M=this._findEventTargets(c,d);if(y){for(var H=[],te=0;te<y.length;te++)y[te].listens(d,!0)&&H.push(y[te]);M=H.concat(M)}if(M.length){d==="contextmenu"&&un(c);var ce=M[0],me={originalEvent:c};if(c.type!=="keypress"&&c.type!=="keydown"&&c.type!=="keyup"){var _e=ce.getLatLng&&(!ce._radius||ce._radius<=10);me.containerPoint=_e?this.latLngToContainerPoint(ce.getLatLng()):this.mouseEventToContainerPoint(c),me.layerPoint=this.containerPointToLayerPoint(me.containerPoint),me.latlng=_e?ce.getLatLng():this.layerPointToLatLng(me.layerPoint)}for(te=0;te<M.length;te++)if(M[te].fire(d,me,!0),me.originalEvent._stopped||M[te].options.bubblingMouseEvents===!1&&D(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(c){return c=c.dragging&&c.dragging.enabled()?c:this,c.dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,d=this._handlers.length;c<d;c++)this._handlers[c].disable()},whenReady:function(c,d){return this._loaded?c.call(d||this,{target:this}):this.on("load",c,d),this},_getMapPanePos:function(){return Ci(this._mapPane)||new V(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,d){var y=c&&d!==void 0?this._getNewPixelOrigin(c,d):this.getPixelOrigin();return y.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,d){var y=this.getSize()._divideBy(2);return this.project(c,d)._subtract(y)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,d,y){var O=this._getNewPixelOrigin(y,d);return this.project(c,d)._subtract(O)},_latLngBoundsToNewLayerBounds:function(c,d,y){var O=this._getNewPixelOrigin(y,d);return Q([this.project(c.getSouthWest(),d)._subtract(O),this.project(c.getNorthWest(),d)._subtract(O),this.project(c.getSouthEast(),d)._subtract(O),this.project(c.getNorthEast(),d)._subtract(O)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,d,y){if(!y)return c;var O=this.project(c,d),M=this.getSize().divideBy(2),H=new B(O.subtract(M),O.add(M)),te=this._getBoundsOffset(H,y,d);return Math.abs(te.x)<=1&&Math.abs(te.y)<=1?c:this.unproject(O.add(te),d)},_limitOffset:function(c,d){if(!d)return c;var y=this.getPixelBounds(),O=new B(y.min.add(c),y.max.add(c));return c.add(this._getBoundsOffset(O,d))},_getBoundsOffset:function(c,d,y){var O=Q(this.project(d.getNorthEast(),y),this.project(d.getSouthWest(),y)),M=O.min.subtract(c.min),H=O.max.subtract(c.max),te=this._rebound(M.x,-H.x),ce=this._rebound(M.y,-H.y);return new V(te,ce)},_rebound:function(c,d){return c+d>0?Math.round(c-d)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(d))},_limitZoom:function(c){var d=this.getMinZoom(),y=this.getMaxZoom(),O=ze.any3d?this.options.zoomSnap:1;return O&&(c=Math.round(c/O)*O),Math.max(d,Math.min(y,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Xt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,d){var y=this._getCenterOffset(c)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(y)?!1:(this.panBy(y,d),!0)},_createAnimProxy:function(){var c=this._proxy=gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(d){var y=qc,O=this._proxy.style[y];Wr(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),O===this._proxy.style[y]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){tn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),d=this.getZoom();Wr(this._proxy,this.project(c,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,d,y){if(this._animatingZoom)return!0;if(y=y||{},!this._zoomAnimated||y.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var O=this.getZoomScale(d),M=this._getCenterOffset(c)._divideBy(1-1/O);return y.animate!==!0&&!this.getSize().contains(M)?!1:(U(function(){this._moveStart(!0,y.noMoveStart||!1)._animateZoom(c,d,!0)},this),!0)},_animateZoom:function(c,d,y,O){this._mapPane&&(y&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=d,ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:d,noUpdate:O}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Xt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Xi(c,d){return new Ct(c,d)}var mr=ee.extend({options:{position:"topright"},initialize:function(c){b(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var d=this._map;return d&&d.removeControl(this),this.options.position=c,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var d=this._container=this.onAdd(c),y=this.getPosition(),O=c._controlCorners[y];return ht(d,"leaflet-control"),y.indexOf("bottom")!==-1?O.insertBefore(d,O.firstChild):O.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(tn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),Ki=function(c){return new mr(c)};Ct.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},d="leaflet-",y=this._controlContainer=gt("div",d+"control-container",this._container);function O(M,H){var te=d+M+" "+d+H;c[M+H]=gt("div",te,y)}O("top","left"),O("top","right"),O("bottom","left"),O("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)tn(this._controlCorners[c]);tn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Zc=mr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,d,y,O){return y<O?-1:O<y?1:0}},initialize:function(c,d,y){b(this,y),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var O in c)this._addLayer(c[O],O);for(O in d)this._addLayer(d[O],O,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return mr.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,d){return this._addLayer(c,d),this._map?this._update():this},addOverlay:function(c,d){return this._addLayer(c,d,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var d=this._getLayer(u(c));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):Xt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Xt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",d=this._container=gt("div",c),y=this.options.collapsed;d.setAttribute("aria-haspopup",!0),ga(d),bl(d);var O=this._section=gt("section",c+"-list");y&&(this._map.on("click",this.collapse,this),ct(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var M=this._layersLink=gt("a",c+"-toggle",d);M.href="#",M.title="Layers",M.setAttribute("role","button"),ct(M,{keydown:function(H){H.keyCode===13&&this._expandSafely()},click:function(H){un(H),this._expandSafely()}},this),y||this.expand(),this._baseLayersList=gt("div",c+"-base",O),this._separator=gt("div",c+"-separator",O),this._overlaysList=gt("div",c+"-overlays",O),d.appendChild(O)},_getLayer:function(c){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&u(this._layers[d].layer)===c)return this._layers[d]},_addLayer:function(c,d,y){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:d,overlay:y}),this.options.sortLayers&&this._layers.sort(o(function(O,M){return this.options.sortFunction(O.layer,M.layer,O.name,M.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ml(this._baseLayersList),ml(this._overlaysList),this._layerControlInputs=[];var c,d,y,O,M=0;for(y=0;y<this._layers.length;y++)O=this._layers[y],this._addItem(O),d=d||O.overlay,c=c||!O.overlay,M+=O.overlay?0:1;return this.options.hideSingleBase&&(c=c&&M>1,this._baseLayersList.style.display=c?"":"none"),this._separator.style.display=d&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var d=this._getLayer(u(c.target)),y=d.overlay?c.type==="add"?"overlayadd":"overlayremove":c.type==="add"?"baselayerchange":null;y&&this._map.fire(y,d)},_createRadioElement:function(c,d){var y='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(d?' checked="checked"':"")+"/>",O=document.createElement("div");return O.innerHTML=y,O.firstChild},_addItem:function(c){var d=document.createElement("label"),y=this._map.hasLayer(c.layer),O;c.overlay?(O=document.createElement("input"),O.type="checkbox",O.className="leaflet-control-layers-selector",O.defaultChecked=y):O=this._createRadioElement("leaflet-base-layers_"+u(this),y),this._layerControlInputs.push(O),O.layerId=u(c.layer),ct(O,"click",this._onInputClick,this);var M=document.createElement("span");M.innerHTML=" "+c.name;var H=document.createElement("span");d.appendChild(H),H.appendChild(O),H.appendChild(M);var te=c.overlay?this._overlaysList:this._baseLayersList;return te.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var c=this._layerControlInputs,d,y,O=[],M=[];this._handlingClick=!0;for(var H=c.length-1;H>=0;H--)d=c[H],y=this._getLayer(d.layerId).layer,d.checked?O.push(y):d.checked||M.push(y);for(H=0;H<M.length;H++)this._map.hasLayer(M[H])&&this._map.removeLayer(M[H]);for(H=0;H<O.length;H++)this._map.hasLayer(O[H])||this._map.addLayer(O[H]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var c=this._layerControlInputs,d,y,O=this._map.getZoom(),M=c.length-1;M>=0;M--)d=c[M],y=this._getLayer(d.layerId).layer,d.disabled=y.options.minZoom!==void 0&&O<y.options.minZoom||y.options.maxZoom!==void 0&&O>y.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var c=this._section;this._preventClick=!0,ct(c,"click",un),this.expand();var d=this;setTimeout(function(){Wt(c,"click",un),d._preventClick=!1})}}),Ol=function(c,d,y){return new Zc(c,d,y)},xo=mr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var d="leaflet-control-zoom",y=gt("div",d+" leaflet-bar"),O=this.options;return this._zoomInButton=this._createButton(O.zoomInText,O.zoomInTitle,d+"-in",y,this._zoomIn),this._zoomOutButton=this._createButton(O.zoomOutText,O.zoomOutTitle,d+"-out",y,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),y},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,d,y,O,M){var H=gt("a",y,O);return H.innerHTML=c,H.href="#",H.title=d,H.setAttribute("role","button"),H.setAttribute("aria-label",d),ga(H),ct(H,"click",Vr),ct(H,"click",M,this),ct(H,"click",this._refocusOnMap,this),H},_updateDisabled:function(){var c=this._map,d="leaflet-disabled";Xt(this._zoomInButton,d),Xt(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(ht(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(ht(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ct.mergeOptions({zoomControl:!0}),Ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xo,this.addControl(this.zoomControl))});var sf=function(c){return new xo(c)},ir=mr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var d="leaflet-control-scale",y=gt("div",d),O=this.options;return this._addScales(O,d+"-line",y),c.on(O.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),y},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,d,y){c.metric&&(this._mScale=gt("div",d,y)),c.imperial&&(this._iScale=gt("div",d,y))},_update:function(){var c=this._map,d=c.getSize().y/2,y=c.distance(c.containerPointToLatLng([0,d]),c.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(y)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var d=this._getRoundNum(c),y=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,y,d/c)},_updateImperial:function(c){var d=c*3.2808399,y,O,M;d>5280?(y=d/5280,O=this._getRoundNum(y),this._updateScale(this._iScale,O+" mi",O/y)):(M=this._getRoundNum(d),this._updateScale(this._iScale,M+" ft",M/d))},_updateScale:function(c,d,y){c.style.width=Math.round(this.options.maxWidth*y)+"px",c.innerHTML=d},_getRoundNum:function(c){var d=Math.pow(10,(Math.floor(c)+"").length-1),y=c/d;return y=y>=10?10:y>=5?5:y>=3?3:y>=2?2:1,d*y}}),yo=function(c){return new ir(c)},Gc='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Es=mr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ze.inlineSvg?Gc+" ":"")+"Leaflet</a>"},initialize:function(c){b(this,c),this._attributions={}},onAdd:function(c){c.attributionControl=this,this._container=gt("div","leaflet-control-attribution"),ga(this._container);for(var d in c._layers)c._layers[d].getAttribution&&this.addAttribution(c._layers[d].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var d in this._attributions)this._attributions[d]&&c.push(d);var y=[];this.options.prefix&&y.push(this.options.prefix),c.length&&y.push(c.join(", ")),this._container.innerHTML=y.join(' <span aria-hidden="true">|</span> ')}}});Ct.mergeOptions({attributionControl:!0}),Ct.addInitHook(function(){this.options.attributionControl&&new Es().addTo(this)});var km=function(c){return new Es(c)};mr.Layers=Zc,mr.Zoom=xo,mr.Scale=ir,mr.Attribution=Es,Ki.layers=Ol,Ki.zoom=sf,Ki.scale=yo,Ki.attribution=km;var kr=ee.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});kr.addTo=function(c,d){return c.addHandler(d,this),this};var Xc={Events:Z},vo=ze.touch?"touchstart mousedown":"mousedown",$r=ie.extend({options:{clickTolerance:3},initialize:function(c,d,y,O){b(this,O),this._element=c,this._dragStartTarget=d||c,this._preventOutline=y},enable:function(){this._enabled||(ct(this._dragStartTarget,vo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&($r._dragging===this&&this.finishDrag(!0),Wt(this._dragStartTarget,vo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!fo(this._element,"leaflet-zoom-anim"))){if(c.touches&&c.touches.length!==1){$r._dragging===this&&this.finishDrag();return}if(!($r._dragging||c.shiftKey||c.which!==1&&c.button!==1&&!c.touches)&&($r._dragging=this,this._preventOutline&&go(this._element),yl(),Bt(),!this._moving)){this.fire("down");var d=c.touches?c.touches[0]:c,y=Ti(this._element);this._startPoint=new V(d.clientX,d.clientY),this._startPos=Ci(this._element),this._parentScale=ai(y);var O=c.type==="mousedown";ct(document,O?"mousemove":"touchmove",this._onMove,this),ct(document,O?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1){this._moved=!0;return}var d=c.touches&&c.touches.length===1?c.touches[0]:c,y=new V(d.clientX,d.clientY)._subtract(this._startPoint);!y.x&&!y.y||Math.abs(y.x)+Math.abs(y.y)<this.options.clickTolerance||(y.x/=this._parentScale.x,y.y/=this._parentScale.y,un(c),this._moved||(this.fire("dragstart"),this._moved=!0,ht(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(y),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),mn(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(c){Xt(document.body,"leaflet-dragging"),this._lastTarget&&(Xt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Wt(document,"mousemove touchmove",this._onMove,this),Wt(document,"mouseup touchend touchcancel",this._onUp,this),vl(),mo();var d=this._moved&&this._moving;this._moving=!1,$r._dragging=!1,d&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)})}});function Kc(c,d,y){var O,M=[1,4,2,8],H,te,ce,me,_e,Fe,rt,yt;for(H=0,Fe=c.length;H<Fe;H++)c[H]._code=Ps(c[H],d);for(ce=0;ce<4;ce++){for(rt=M[ce],O=[],H=0,Fe=c.length,te=Fe-1;H<Fe;te=H++)me=c[H],_e=c[te],me._code&rt?_e._code&rt||(yt=Sl(_e,me,rt,d,y),yt._code=Ps(yt,d),O.push(yt)):(_e._code&rt&&(yt=Sl(_e,me,rt,d,y),yt._code=Ps(yt,d),O.push(yt)),O.push(me));c=O}return c}function of(c,d){var y,O,M,H,te,ce,me,_e,Fe;if(!c||c.length===0)throw new Error("latlngs not passed");Sr(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var rt=pe([0,0]),yt=Y(c),Bn=yt.getNorthWest().distanceTo(yt.getSouthWest())*yt.getNorthEast().distanceTo(yt.getNorthWest());Bn<1700&&(rt=Yc(c));var kn=c.length,xr=[];for(y=0;y<kn;y++){var sr=pe(c[y]);xr.push(d.project(pe([sr.lat-rt.lat,sr.lng-rt.lng])))}for(ce=me=_e=0,y=0,O=kn-1;y<kn;O=y++)M=xr[y],H=xr[O],te=M.y*H.x-H.y*M.x,me+=(M.x+H.x)*te,_e+=(M.y+H.y)*te,ce+=te*3;ce===0?Fe=xr[0]:Fe=[me/ce,_e/ce];var Eo=d.unproject(q(Fe));return pe([Eo.lat+rt.lat,Eo.lng+rt.lng])}function Yc(c){for(var d=0,y=0,O=0,M=0;M<c.length;M++){var H=pe(c[M]);d+=H.lat,y+=H.lng,O++}return pe([d/O,y/O])}var Sm={__proto__:null,clipPolygon:Kc,polygonCenter:of,centroid:Yc};function kl(c,d){if(!d||!c.length)return c.slice();var y=d*d;return c=Em(c,y),c=Tm(c,y),c}function af(c,d,y){return Math.sqrt(Bs(c,d,y,!0))}function Cm(c,d,y){return Bs(c,d,y)}function Tm(c,d){var y=c.length,O=typeof Uint8Array<"u"?Uint8Array:Array,M=new O(y);M[0]=M[y-1]=1,Jc(c,M,d,0,y-1);var H,te=[];for(H=0;H<y;H++)M[H]&&te.push(c[H]);return te}function Jc(c,d,y,O,M){var H=0,te,ce,me;for(ce=O+1;ce<=M-1;ce++)me=Bs(c[ce],c[O],c[M],!0),me>H&&(te=ce,H=me);H>y&&(d[te]=1,Jc(c,d,y,O,te),Jc(c,d,y,te,M))}function Em(c,d){for(var y=[c[0]],O=1,M=0,H=c.length;O<H;O++)Pm(c[O],c[M])>d&&(y.push(c[O]),M=O);return M<H-1&&y.push(c[H-1]),y}var eu;function lf(c,d,y,O,M){var H=O?eu:Ps(c,y),te=Ps(d,y),ce,me,_e;for(eu=te;;){if(!(H|te))return[c,d];if(H&te)return!1;ce=H||te,me=Sl(c,d,ce,y,M),_e=Ps(me,y),ce===H?(c=me,H=_e):(d=me,te=_e)}}function Sl(c,d,y,O,M){var H=d.x-c.x,te=d.y-c.y,ce=O.min,me=O.max,_e,Fe;return y&8?(_e=c.x+H*(me.y-c.y)/te,Fe=me.y):y&4?(_e=c.x+H*(ce.y-c.y)/te,Fe=ce.y):y&2?(_e=me.x,Fe=c.y+te*(me.x-c.x)/H):y&1&&(_e=ce.x,Fe=c.y+te*(ce.x-c.x)/H),new V(_e,Fe,M)}function Ps(c,d){var y=0;return c.x<d.min.x?y|=1:c.x>d.max.x&&(y|=2),c.y<d.min.y?y|=4:c.y>d.max.y&&(y|=8),y}function Pm(c,d){var y=d.x-c.x,O=d.y-c.y;return y*y+O*O}function Bs(c,d,y,O){var M=d.x,H=d.y,te=y.x-M,ce=y.y-H,me=te*te+ce*ce,_e;return me>0&&(_e=((c.x-M)*te+(c.y-H)*ce)/me,_e>1?(M=y.x,H=y.y):_e>0&&(M+=te*_e,H+=ce*_e)),te=c.x-M,ce=c.y-H,O?te*te+ce*ce:new V(M,H)}function Sr(c){return!E(c[0])||typeof c[0][0]!="object"&&typeof c[0][0]<"u"}function cf(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Sr(c)}function uf(c,d){var y,O,M,H,te,ce,me,_e;if(!c||c.length===0)throw new Error("latlngs not passed");Sr(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var Fe=pe([0,0]),rt=Y(c),yt=rt.getNorthWest().distanceTo(rt.getSouthWest())*rt.getNorthEast().distanceTo(rt.getNorthWest());yt<1700&&(Fe=Yc(c));var Bn=c.length,kn=[];for(y=0;y<Bn;y++){var xr=pe(c[y]);kn.push(d.project(pe([xr.lat-Fe.lat,xr.lng-Fe.lng])))}for(y=0,O=0;y<Bn-1;y++)O+=kn[y].distanceTo(kn[y+1])/2;if(O===0)_e=kn[0];else for(y=0,H=0;y<Bn-1;y++)if(te=kn[y],ce=kn[y+1],M=te.distanceTo(ce),H+=M,H>O){me=(H-O)/M,_e=[ce.x-me*(ce.x-te.x),ce.y-me*(ce.y-te.y)];break}var sr=d.unproject(q(_e));return pe([sr.lat+Fe.lat,sr.lng+Fe.lng])}var hf={__proto__:null,simplify:kl,pointToSegmentDistance:af,closestPointOnSegment:Cm,clipSegment:lf,_getEdgeIntersection:Sl,_getBitCode:Ps,_sqClosestPointOnSegment:Bs,isFlat:Sr,_flat:cf,polylineCenter:uf},tu={project:function(c){return new V(c.lng,c.lat)},unproject:function(c){return new ue(c.y,c.x)},bounds:new B([-180,-90],[180,90])},nu={R:6378137,R_MINOR:6356752314245179e-9,bounds:new B([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(c){var d=Math.PI/180,y=this.R,O=c.lat*d,M=this.R_MINOR/y,H=Math.sqrt(1-M*M),te=H*Math.sin(O),ce=Math.tan(Math.PI/4-O/2)/Math.pow((1-te)/(1+te),H/2);return O=-y*Math.log(Math.max(ce,1e-10)),new V(c.lng*d*y,O)},unproject:function(c){for(var d=180/Math.PI,y=this.R,O=this.R_MINOR/y,M=Math.sqrt(1-O*O),H=Math.exp(-c.y/y),te=Math.PI/2-2*Math.atan(H),ce=0,me=.1,_e;ce<15&&Math.abs(me)>1e-7;ce++)_e=M*Math.sin(te),_e=Math.pow((1-_e)/(1+_e),M/2),me=Math.PI/2-2*Math.atan(H*_e)-te,te+=me;return new ue(te*d,c.x*d/y)}},Bm={__proto__:null,LonLat:tu,Mercator:nu,SphericalMercator:Pe},Rm=i({},xe,{code:"EPSG:3395",projection:nu,transformation:(function(){var c=.5/(Math.PI*nu.R);return nt(c,.5,-c,.5)})()}),ff=i({},xe,{code:"EPSG:4326",projection:tu,transformation:nt(1/180,1,-1/180,.5)}),Dm=i({},ve,{projection:tu,transformation:nt(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,d){var y=d.lng-c.lng,O=d.lat-c.lat;return Math.sqrt(y*y+O*O)},infinite:!0});ve.Earth=xe,ve.EPSG3395=Rm,ve.EPSG3857=Ce,ve.EPSG900913=Ge,ve.EPSG4326=ff,ve.Simple=Dm;var Ur=ie.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[u(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[u(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var d=c.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var y=this.getEvents();d.on(y,this),this.once("remove",function(){d.off(y,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});Ct.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var d=u(c);return this._layers[d]?this:(this._layers[d]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c),this)},removeLayer:function(c){var d=u(c);return this._layers[d]?(this._loaded&&c.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return u(c)in this._layers},eachLayer:function(c,d){for(var y in this._layers)c.call(d,this._layers[y]);return this},_addLayers:function(c){c=c?E(c)?c:[c]:[];for(var d=0,y=c.length;d<y;d++)this.addLayer(c[d])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[u(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var d=u(c);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,d=-1/0,y=this._getZoomSpan();for(var O in this._zoomBoundLayers){var M=this._zoomBoundLayers[O].options;c=M.minZoom===void 0?c:Math.min(c,M.minZoom),d=M.maxZoom===void 0?d:Math.max(d,M.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=c===1/0?void 0:c,y!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yi=Ur.extend({initialize:function(c,d){b(this,d),this._layers={};var y,O;if(c)for(y=0,O=c.length;y<O;y++)this.addLayer(c[y])},addLayer:function(c){var d=this.getLayerId(c);return this._layers[d]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var d=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(c){var d=typeof c=="number"?c:this.getLayerId(c);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var d=Array.prototype.slice.call(arguments,1),y,O;for(y in this._layers)O=this._layers[y],O[c]&&O[c].apply(O,d);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,d){for(var y in this._layers)c.call(d,this._layers[y]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return u(c)}}),va=function(c,d){return new Yi(c,d)},Ei=Yi.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),Yi.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),Yi.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new G;for(var d in this._layers){var y=this._layers[d];c.extend(y.getBounds?y.getBounds():y.getLatLng())}return c}}),df=function(c,d){return new Ei(c,d)},Rs=ee.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){b(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,d){var y=this._getIconUrl(c);if(!y){if(c==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var O=this._createImg(y,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(O,c),(this.options.crossOrigin||this.options.crossOrigin==="")&&(O.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),O},_setIconStyles:function(c,d){var y=this.options,O=y[d+"Size"];typeof O=="number"&&(O=[O,O]);var M=q(O),H=q(d==="shadow"&&y.shadowAnchor||y.iconAnchor||M&&M.divideBy(2,!0));c.className="leaflet-marker-"+d+" "+(y.className||""),H&&(c.style.marginLeft=-H.x+"px",c.style.marginTop=-H.y+"px"),M&&(c.style.width=M.x+"px",c.style.height=M.y+"px")},_createImg:function(c,d){return d=d||document.createElement("img"),d.src=c,d},_getIconUrl:function(c){return ze.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});function pf(c){return new Rs(c)}var Ao=Rs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return typeof Ao.imagePath!="string"&&(Ao.imagePath=this._detectIconPath()),(this.options.imagePath||Ao.imagePath)+Rs.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var d=function(y,O,M){var H=O.exec(y);return H&&H[M]};return c=d(c,/^url\((['"])?(.+)\1\)$/,2),c&&d(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=gt("div","leaflet-default-icon-path",document.body),d=fa(c,"background-image")||fa(c,"backgroundImage");if(document.body.removeChild(c),d=this._stripUrl(d),d)return d;var y=document.querySelector('link[href$="leaflet.css"]');return y?y.href.substring(0,y.href.length-11-1):""}}),ru=kr.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new $r(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ht(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Xt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var d=this._marker,y=d._map,O=this._marker.options.autoPanSpeed,M=this._marker.options.autoPanPadding,H=Ci(d._icon),te=y.getPixelBounds(),ce=y.getPixelOrigin(),me=Q(te.min._subtract(ce).add(M),te.max._subtract(ce).subtract(M));if(!me.contains(H)){var _e=q((Math.max(me.max.x,H.x)-me.max.x)/(te.max.x-me.max.x)-(Math.min(me.min.x,H.x)-me.min.x)/(te.min.x-me.min.x),(Math.max(me.max.y,H.y)-me.max.y)/(te.max.y-me.max.y)-(Math.min(me.min.y,H.y)-me.min.y)/(te.min.y-me.min.y)).multiplyBy(O);y.panBy(_e,{animate:!1}),this._draggable._newPos._add(_e),this._draggable._startPos._add(_e),mn(d._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=U(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(X(this._panRequest),this._panRequest=U(this._adjustPan.bind(this,c)))},_onDrag:function(c){var d=this._marker,y=d._shadow,O=Ci(d._icon),M=d._map.layerPointToLatLng(O);y&&mn(y,O),d._latlng=M,c.latlng=M,c.oldLatLng=this._oldLatLng,d.fire("move",c).fire("drag",c)},_onDragEnd:function(c){X(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Pi=Ur.extend({options:{icon:new Ao,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,d){b(this,d),this._latlng=pe(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var d=this._latlng;return this._latlng=pe(c),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),y=c.icon.createIcon(this._icon),O=!1;y!==this._icon&&(this._icon&&this._removeIcon(),O=!0,c.title&&(y.title=c.title),y.tagName==="IMG"&&(y.alt=c.alt||"")),ht(y,d),c.keyboard&&(y.tabIndex="0",y.setAttribute("role","button")),this._icon=y,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ct(y,"focus",this._panOnFocus,this);var M=c.icon.createShadow(this._shadow),H=!1;M!==this._shadow&&(this._removeShadow(),H=!0),M&&(ht(M,d),M.alt=""),this._shadow=M,c.opacity<1&&this._updateOpacity(),O&&this.getPane().appendChild(this._icon),this._initInteraction(),M&&H&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Wt(this._icon,"focus",this._panOnFocus,this),tn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&tn(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&mn(this._icon,c),this._shadow&&mn(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var d=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ru)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ru(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&rr(this._icon,c),this._shadow&&rr(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var d=this.options.icon.options,y=d.iconSize?q(d.iconSize):q(0,0),O=d.iconAnchor?q(d.iconAnchor):q(0,0);c.panInside(this._latlng,{paddingTopLeft:O,paddingBottomRight:y.subtract(O)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Mm(c,d){return new Pi(c,d)}var Ji=Ur.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return b(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Cl=Ji.extend({options:{fill:!0,radius:10},initialize:function(c,d){b(this,d),this._latlng=pe(c),this._radius=this.options.radius},setLatLng:function(c){var d=this._latlng;return this._latlng=pe(c),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var d=c&&c.radius||this._radius;return Ji.prototype.setStyle.call(this,c),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,d=this._radiusY||c,y=this._clickTolerance(),O=[c+y,d+y];this._pxBounds=new B(this._point.subtract(O),this._point.add(O))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function mf(c,d){return new Cl(c,d)}var Tl=Cl.extend({initialize:function(c,d,y){if(typeof d=="number"&&(d=i({},y,{radius:d})),b(this,d),this._latlng=pe(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new G(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:Ji.prototype.setStyle,_project:function(){var c=this._latlng.lng,d=this._latlng.lat,y=this._map,O=y.options.crs;if(O.distance===xe.distance){var M=Math.PI/180,H=this._mRadius/xe.R/M,te=y.project([d+H,c]),ce=y.project([d-H,c]),me=te.add(ce).divideBy(2),_e=y.unproject(me).lat,Fe=Math.acos((Math.cos(H*M)-Math.sin(d*M)*Math.sin(_e*M))/(Math.cos(d*M)*Math.cos(_e*M)))/M;(isNaN(Fe)||Fe===0)&&(Fe=H/Math.cos(Math.PI/180*d)),this._point=me.subtract(y.getPixelOrigin()),this._radius=isNaN(Fe)?0:me.x-y.project([_e,c-Fe]).x,this._radiusY=me.y-te.y}else{var rt=O.unproject(O.project(this._latlng).subtract([this._mRadius,0]));this._point=y.latLngToLayerPoint(this._latlng),this._radius=this._point.x-y.latLngToLayerPoint(rt).x}this._updateBounds()}});function Aa(c,d,y){return new Tl(c,d,y)}var gr=Ji.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,d){b(this,d),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var d=1/0,y=null,O=Bs,M,H,te=0,ce=this._parts.length;te<ce;te++)for(var me=this._parts[te],_e=1,Fe=me.length;_e<Fe;_e++){M=me[_e-1],H=me[_e];var rt=O(c,M,H,!0);rt<d&&(d=rt,y=O(c,M,H))}return y&&(y.distance=Math.sqrt(d)),y},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return uf(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,d){return d=d||this._defaultShape(),c=pe(c),d.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new G,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return Sr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var d=[],y=Sr(c),O=0,M=c.length;O<M;O++)y?(d[O]=pe(c[O]),this._bounds.extend(d[O])):d[O]=this._convertLatLngs(c[O]);return d},_project:function(){var c=new B;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),d=new V(c,c);this._rawPxBounds&&(this._pxBounds=new B([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(c,d,y){var O=c[0]instanceof ue,M=c.length,H,te;if(O){for(te=[],H=0;H<M;H++)te[H]=this._map.latLngToLayerPoint(c[H]),y.extend(te[H]);d.push(te)}else for(H=0;H<M;H++)this._projectLatlngs(c[H],d,y)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,y,O,M,H,te,ce,me;for(y=0,M=0,H=this._rings.length;y<H;y++)for(me=this._rings[y],O=0,te=me.length;O<te-1;O++)ce=lf(me[O],me[O+1],c,O,!0),ce&&(d[M]=d[M]||[],d[M].push(ce[0]),(ce[1]!==me[O+1]||O===te-2)&&(d[M].push(ce[1]),M++))}},_simplifyPoints:function(){for(var c=this._parts,d=this.options.smoothFactor,y=0,O=c.length;y<O;y++)c[y]=kl(c[y],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,d){var y,O,M,H,te,ce,me=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(y=0,H=this._parts.length;y<H;y++)for(ce=this._parts[y],O=0,te=ce.length,M=te-1;O<te;M=O++)if(!(!d&&O===0)&&af(c,ce[M],ce[O])<=me)return!0;return!1}});function Nm(c,d){return new gr(c,d)}gr._flat=cf;var Bi=gr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return of(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var d=gr.prototype._convertLatLngs.call(this,c),y=d.length;return y>=2&&d[0]instanceof ue&&d[0].equals(d[y-1])&&d.pop(),d},_setLatLngs:function(c){gr.prototype._setLatLngs.call(this,c),Sr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Sr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,d=this.options.weight,y=new V(d,d);if(c=new B(c.min.subtract(y),c.max.add(y)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}for(var O=0,M=this._rings.length,H;O<M;O++)H=Kc(this._rings[O],c,!0),H.length&&this._parts.push(H)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var d=!1,y,O,M,H,te,ce,me,_e;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(H=0,me=this._parts.length;H<me;H++)for(y=this._parts[H],te=0,_e=y.length,ce=_e-1;te<_e;ce=te++)O=y[te],M=y[ce],O.y>c.y!=M.y>c.y&&c.x<(M.x-O.x)*(c.y-O.y)/(M.y-O.y)+O.x&&(d=!d);return d||gr.prototype._containsPoint.call(this,c,!0)}});function Lm(c,d){return new Bi(c,d)}var ci=Ei.extend({initialize:function(c,d){b(this,d),this._layers={},c&&this.addData(c)},addData:function(c){var d=E(c)?c:c.features,y,O,M;if(d){for(y=0,O=d.length;y<O;y++)M=d[y],(M.geometries||M.geometry||M.features||M.coordinates)&&this.addData(M);return this}var H=this.options;if(H.filter&&!H.filter(c))return this;var te=bo(c,H);return te?(te.feature=Dl(c),te.defaultOptions=te.options,this.resetStyle(te),H.onEachFeature&&H.onEachFeature(c,te),this.addLayer(te)):this},resetStyle:function(c){return c===void 0?this.eachLayer(this.resetStyle,this):(c.options=i({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(d){this._setLayerStyle(d,c)},this)},_setLayerStyle:function(c,d){c.setStyle&&(typeof d=="function"&&(d=d(c.feature)),c.setStyle(d))}});function bo(c,d){var y=c.type==="Feature"?c.geometry:c,O=y?y.coordinates:null,M=[],H=d&&d.pointToLayer,te=d&&d.coordsToLatLng||Pl,ce,me,_e,Fe;if(!O&&!y)return null;switch(y.type){case"Point":return ce=te(O),El(H,c,ce,d);case"MultiPoint":for(_e=0,Fe=O.length;_e<Fe;_e++)ce=te(O[_e]),M.push(El(H,c,ce,d));return new Ei(M);case"LineString":case"MultiLineString":return me=ba(O,y.type==="LineString"?0:1,te),new gr(me,d);case"Polygon":case"MultiPolygon":return me=ba(O,y.type==="Polygon"?1:2,te),new Bi(me,d);case"GeometryCollection":for(_e=0,Fe=y.geometries.length;_e<Fe;_e++){var rt=bo({geometry:y.geometries[_e],type:"Feature",properties:c.properties},d);rt&&M.push(rt)}return new Ei(M);case"FeatureCollection":for(_e=0,Fe=y.features.length;_e<Fe;_e++){var yt=bo(y.features[_e],d);yt&&M.push(yt)}return new Ei(M);default:throw new Error("Invalid GeoJSON object.")}}function El(c,d,y,O){return c?c(d,y):new Pi(y,O&&O.markersInheritOptions&&O)}function Pl(c){return new ue(c[1],c[0],c[2])}function ba(c,d,y){for(var O=[],M=0,H=c.length,te;M<H;M++)te=d?ba(c[M],d-1,y):(y||Pl)(c[M]),O.push(te);return O}function Bl(c,d){return c=pe(c),c.alt!==void 0?[x(c.lng,d),x(c.lat,d),x(c.alt,d)]:[x(c.lng,d),x(c.lat,d)]}function Rl(c,d,y,O){for(var M=[],H=0,te=c.length;H<te;H++)M.push(d?Rl(c[H],Sr(c[H])?0:d-1,y,O):Bl(c[H],O));return!d&&y&&M.length>0&&M.push(M[0].slice()),M}function wo(c,d){return c.feature?i({},c.feature,{geometry:d}):Dl(d)}function Dl(c){return c.type==="Feature"||c.type==="FeatureCollection"?c:{type:"Feature",properties:{},geometry:c}}var iu={toGeoJSON:function(c){return wo(this,{type:"Point",coordinates:Bl(this.getLatLng(),c)})}};Pi.include(iu),Tl.include(iu),Cl.include(iu),gr.include({toGeoJSON:function(c){var d=!Sr(this._latlngs),y=Rl(this._latlngs,d?1:0,!1,c);return wo(this,{type:(d?"Multi":"")+"LineString",coordinates:y})}}),Bi.include({toGeoJSON:function(c){var d=!Sr(this._latlngs),y=d&&!Sr(this._latlngs[0]),O=Rl(this._latlngs,y?2:d?1:0,!0,c);return d||(O=[O]),wo(this,{type:(y?"Multi":"")+"Polygon",coordinates:O})}}),Yi.include({toMultiPoint:function(c){var d=[];return this.eachLayer(function(y){d.push(y.toGeoJSON(c).geometry.coordinates)}),wo(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(c){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(c);var y=d==="GeometryCollection",O=[];return this.eachLayer(function(M){if(M.toGeoJSON){var H=M.toGeoJSON(c);if(y)O.push(H.geometry);else{var te=Dl(H);te.type==="FeatureCollection"?O.push.apply(O,te.features):O.push(te)}}}),y?wo(this,{geometries:O,type:"GeometryCollection"}):{type:"FeatureCollection",features:O}}});function gf(c,d){return new ci(c,d)}var Zr=gf,es=Ur.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,d,y){this._url=c,this._bounds=Y(d),b(this,y)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){tn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&ho(this._image),this},bringToBack:function(){return this._map&&Si(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=Y(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c=this._url.tagName==="IMG",d=this._image=c?this._url:gt("img");if(ht(d,"leaflet-image-layer"),this._zoomAnimated&&ht(d,"leaflet-zoom-animated"),this.options.className&&ht(d,this.options.className),d.onselectstart=g,d.onmousemove=g,d.onload=o(this.fire,this,"load"),d.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(c){var d=this._map.getZoomScale(c.zoom),y=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;Wr(this._image,y,d)},_reset:function(){var c=this._image,d=new B(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),y=d.getSize();mn(c,d.min),c.style.width=y.x+"px",c.style.height=y.y+"px"},_updateOpacity:function(){rr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),xf=function(c,d,y){return new es(c,d,y)},su=es.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c=this._url.tagName==="VIDEO",d=this._image=c?this._url:gt("video");if(ht(d,"leaflet-image-layer"),this._zoomAnimated&&ht(d,"leaflet-zoom-animated"),this.options.className&&ht(d,this.options.className),d.onselectstart=g,d.onmousemove=g,d.onloadeddata=o(this.fire,this,"load"),c){for(var y=d.getElementsByTagName("source"),O=[],M=0;M<y.length;M++)O.push(y[M].src);this._url=y.length>0?O:[d.src];return}E(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var H=0;H<this._url.length;H++){var te=gt("source");te.src=this._url[H],d.appendChild(te)}}});function yf(c,d,y){return new su(c,d,y)}var ou=es.extend({_initImage:function(){var c=this._image=this._url;ht(c,"leaflet-image-layer"),this._zoomAnimated&&ht(c,"leaflet-zoom-animated"),this.options.className&&ht(c,this.options.className),c.onselectstart=g,c.onmousemove=g}});function au(c,d,y){return new ou(c,d,y)}var ui=Ur.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,d){c&&(c instanceof ue||E(c))?(this._latlng=pe(c),b(this,d)):(b(this,c),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(c){return c=arguments.length?c:this._source._map,c.hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&rr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&rr(this._container,1),this.bringToFront(),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(rr(this._container,0),this._removeTimeout=setTimeout(o(tn,void 0,this._container),200)):tn(this._container),this.options.interactive&&(Xt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=pe(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ho(this._container),this},bringToBack:function(){return this._map&&Si(this._container),this},_prepareOpen:function(c){var d=this._source;if(!d._map)return!1;if(d instanceof Ei){d=null;var y=this._source._layers;for(var O in y)if(y[O]._map){d=y[O];break}if(!d)return!1;this._source=d}if(!c)if(d.getCenter)c=d.getCenter();else if(d.getLatLng)c=d.getLatLng();else if(d.getBounds)c=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")c.innerHTML=d;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),d=q(this.options.offset),y=this._getAnchor();this._zoomAnimated?mn(this._container,c.add(y)):d=d.add(c).add(y);var O=this._containerBottom=-d.y,M=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=O+"px",this._container.style.left=M+"px"}},_getAnchor:function(){return[0,0]}});Ct.include({_initOverlay:function(c,d,y,O){var M=d;return M instanceof c||(M=new c(O).setContent(d)),y&&M.setLatLng(y),M}}),Ur.include({_initOverlay:function(c,d,y,O){var M=y;return M instanceof c?(b(M,O),M._source=this):(M=d&&!O?d:new c(O,this),M.setContent(y)),M}});var Ml=ui.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return c=arguments.length?c:this._source._map,!c.hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,ui.prototype.openOn.call(this,c)},onAdd:function(c){ui.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ji||this._source.on("preclick",li))},onRemove:function(c){ui.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ji||this._source.off("preclick",li))},getEvents:function(){var c=ui.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",d=this._container=gt("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),y=this._wrapper=gt("div",c+"-content-wrapper",d);if(this._contentNode=gt("div",c+"-content",y),ga(d),bl(this._contentNode),ct(d,"contextmenu",li),this._tipContainer=gt("div",c+"-tip-container",d),this._tip=gt("div",c+"-tip",this._tipContainer),this.options.closeButton){var O=this._closeButton=gt("a",c+"-close-button",d);O.setAttribute("role","button"),O.setAttribute("aria-label","Close popup"),O.href="#close",O.innerHTML='<span aria-hidden="true">&#215;</span>',ct(O,"click",function(M){un(M),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,d=c.style;d.width="",d.whiteSpace="nowrap";var y=c.offsetWidth;y=Math.min(y,this.options.maxWidth),y=Math.max(y,this.options.minWidth),d.width=y+1+"px",d.whiteSpace="",d.height="";var O=c.offsetHeight,M=this.options.maxHeight,H="leaflet-popup-scrolled";M&&O>M?(d.height=M+"px",ht(c,H)):Xt(c,H),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var d=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),y=this._getAnchor();mn(this._container,d.add(y))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var c=this._map,d=parseInt(fa(this._container,"marginBottom"),10)||0,y=this._container.offsetHeight+d,O=this._containerWidth,M=new V(this._containerLeft,-y-this._containerBottom);M._add(Ci(this._container));var H=c.layerPointToContainerPoint(M),te=q(this.options.autoPanPadding),ce=q(this.options.autoPanPaddingTopLeft||te),me=q(this.options.autoPanPaddingBottomRight||te),_e=c.getSize(),Fe=0,rt=0;H.x+O+me.x>_e.x&&(Fe=H.x+O-_e.x+me.x),H.x-Fe-ce.x<0&&(Fe=H.x-ce.x),H.y+y+me.y>_e.y&&(rt=H.y+y-_e.y+me.y),H.y-rt-ce.y<0&&(rt=H.y-ce.y),(Fe||rt)&&(this.options.keepInView&&(this._autopanning=!0),c.fire("autopanstart").panBy([Fe,rt]))}},_getAnchor:function(){return q(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),_o=function(c,d){return new Ml(c,d)};Ct.mergeOptions({closePopupOnClick:!0}),Ct.include({openPopup:function(c,d,y){return this._initOverlay(Ml,c,d,y).openOn(this),this},closePopup:function(c){return c=arguments.length?c:this._popup,c&&c.close(),this}}),Ur.include({bindPopup:function(c,d){return this._popup=this._initOverlay(Ml,this._popup,c,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&(this instanceof Ei||(this._popup._source=this),this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(!(!this._popup||!this._map)){Vr(c);var d=c.layer||c.target;if(this._popup._source===d&&!(d instanceof Ji)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng);return}this._popup._source=d,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){c.originalEvent.keyCode===13&&this._openPopup(c)}});var Oo=ui.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){ui.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){ui.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=ui.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){var c="leaflet-tooltip",d=c+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=gt("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var d,y,O=this._map,M=this._container,H=O.latLngToContainerPoint(O.getCenter()),te=O.layerPointToContainerPoint(c),ce=this.options.direction,me=M.offsetWidth,_e=M.offsetHeight,Fe=q(this.options.offset),rt=this._getAnchor();ce==="top"?(d=me/2,y=_e):ce==="bottom"?(d=me/2,y=0):ce==="center"?(d=me/2,y=_e/2):ce==="right"?(d=0,y=_e/2):ce==="left"?(d=me,y=_e/2):te.x<H.x?(ce="right",d=0,y=_e/2):(ce="left",d=me+(Fe.x+rt.x)*2,y=_e/2),c=c.subtract(q(d,y,!0)).add(Fe).add(rt),Xt(M,"leaflet-tooltip-right"),Xt(M,"leaflet-tooltip-left"),Xt(M,"leaflet-tooltip-top"),Xt(M,"leaflet-tooltip-bottom"),ht(M,"leaflet-tooltip-"+ce),mn(M,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&rr(this._container,c)},_animateZoom:function(c){var d=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(d)},_getAnchor:function(){return q(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),wa=function(c,d){return new Oo(c,d)};Ct.include({openTooltip:function(c,d,y){return this._initOverlay(Oo,c,d,y).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),Ur.include({bindTooltip:function(c,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Oo,this._tooltip,c,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(!(!c&&this._tooltipHandlersAdded)){var d=c?"off":"on",y={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?y.add=this._openTooltip:(y.mouseover=this._openTooltip,y.mouseout=this.closeTooltip,y.click=this._openTooltip,this._map?this._addFocusListeners():y.add=this._addFocusListeners),this._tooltip.options.sticky&&(y.mousemove=this._moveTooltip),this[d](y),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&(this instanceof Ei||(this._tooltip._source=this),this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var d=typeof c.getElement=="function"&&c.getElement();d&&(ct(d,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),ct(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var d=typeof c.getElement=="function"&&c.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(c)});return}this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0)}},_moveTooltip:function(c){var d=c.latlng,y,O;this._tooltip.options.sticky&&c.originalEvent&&(y=this._map.mouseEventToContainerPoint(c.originalEvent),O=this._map.containerPointToLayerPoint(y),d=this._map.layerPointToLatLng(O)),this._tooltip.setLatLng(d)}});var Nl=Rs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var d=c&&c.tagName==="DIV"?c:document.createElement("div"),y=this.options;if(y.html instanceof Element?(ml(d),d.appendChild(y.html)):d.innerHTML=y.html!==!1?y.html:"",y.bgPos){var O=q(y.bgPos);d.style.backgroundPosition=-O.x+"px "+-O.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function vf(c){return new Nl(c)}Rs.Default=Ao;var ts=Ur.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ze.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){b(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),tn(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ho(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Si(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof V?c:new V(c,c)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var d=this.getPane().children,y=-c(-1/0,1/0),O=0,M=d.length,H;O<M;O++)H=d[O].style.zIndex,d[O]!==this._container&&H&&(y=c(y,+H));isFinite(y)&&(this.options.zIndex=y+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ze.ielt9){rr(this._container,this.options.opacity);var c=+new Date,d=!1,y=!1;for(var O in this._tiles){var M=this._tiles[O];if(!(!M.current||!M.loaded)){var H=Math.min(1,(c-M.loaded)/200);rr(M.el,H),H<1?d=!0:(M.active?y=!0:this._onOpaqueTile(M),M.active=!0)}}y&&!this._noPrune&&this._pruneTiles(),d&&(X(this._fadeFrame),this._fadeFrame=U(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,d=this.options.maxZoom;if(c!==void 0){for(var y in this._levels)y=Number(y),this._levels[y].el.children.length||y===c?(this._levels[y].el.style.zIndex=d-Math.abs(c-y),this._onUpdateLevel(y)):(tn(this._levels[y].el),this._removeTilesAtZoom(y),this._onRemoveLevel(y),delete this._levels[y]);var O=this._levels[c],M=this._map;return O||(O=this._levels[c]={},O.el=gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),O.el.style.zIndex=d,O.origin=M.project(M.unproject(M.getPixelOrigin()),c).round(),O.zoom=c,this._setZoomTransform(O,M.getCenter(),M.getZoom()),g(O.el.offsetWidth),this._onCreateLevel(O)),this._level=O,O}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var c,d,y=this._map.getZoom();if(y>this.options.maxZoom||y<this.options.minZoom){this._removeAllTiles();return}for(c in this._tiles)d=this._tiles[c],d.retain=d.current;for(c in this._tiles)if(d=this._tiles[c],d.current&&!d.active){var O=d.coords;this._retainParent(O.x,O.y,O.z,O.z-5)||this._retainChildren(O.x,O.y,O.z,O.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var d in this._tiles)this._tiles[d].coords.z===c&&this._removeTile(d)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)tn(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,d,y,O){var M=Math.floor(c/2),H=Math.floor(d/2),te=y-1,ce=new V(+M,+H);ce.z=+te;var me=this._tileCoordsToKey(ce),_e=this._tiles[me];return _e&&_e.active?(_e.retain=!0,!0):(_e&&_e.loaded&&(_e.retain=!0),te>O?this._retainParent(M,H,te,O):!1)},_retainChildren:function(c,d,y,O){for(var M=2*c;M<2*c+2;M++)for(var H=2*d;H<2*d+2;H++){var te=new V(M,H);te.z=y+1;var ce=this._tileCoordsToKey(te),me=this._tiles[ce];if(me&&me.active){me.retain=!0;continue}else me&&me.loaded&&(me.retain=!0);y+1<O&&this._retainChildren(M,H,y+1,O)}},_resetView:function(c){var d=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var d=this.options;return d.minNativeZoom!==void 0&&c<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<c?d.maxNativeZoom:c},_setView:function(c,d,y,O){var M=Math.round(d);this.options.maxZoom!==void 0&&M>this.options.maxZoom||this.options.minZoom!==void 0&&M<this.options.minZoom?M=void 0:M=this._clampZoom(M);var H=this.options.updateWhenZooming&&M!==this._tileZoom;(!O||H)&&(this._tileZoom=M,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),M!==void 0&&this._update(c),y||this._pruneTiles(),this._noPrune=!!y),this._setZoomTransforms(c,d)},_setZoomTransforms:function(c,d){for(var y in this._levels)this._setZoomTransform(this._levels[y],c,d)},_setZoomTransform:function(c,d,y){var O=this._map.getZoomScale(y,c.zoom),M=c.origin.multiplyBy(O).subtract(this._map._getNewPixelOrigin(d,y)).round();ze.any3d?Wr(c.el,M,O):mn(c.el,M)},_resetGrid:function(){var c=this._map,d=c.options.crs,y=this._tileSize=this.getTileSize(),O=this._tileZoom,M=this._map.getPixelWorldBounds(this._tileZoom);M&&(this._globalTileRange=this._pxBoundsToTileRange(M)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,d.wrapLng[0]],O).x/y.x),Math.ceil(c.project([0,d.wrapLng[1]],O).x/y.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([d.wrapLat[0],0],O).y/y.x),Math.ceil(c.project([d.wrapLat[1],0],O).y/y.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var d=this._map,y=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),O=d.getZoomScale(y,this._tileZoom),M=d.project(c,this._tileZoom).floor(),H=d.getSize().divideBy(O*2);return new B(M.subtract(H),M.add(H))},_update:function(c){var d=this._map;if(d){var y=this._clampZoom(d.getZoom());if(c===void 0&&(c=d.getCenter()),this._tileZoom!==void 0){var O=this._getTiledPixelBounds(c),M=this._pxBoundsToTileRange(O),H=M.getCenter(),te=[],ce=this.options.keepBuffer,me=new B(M.getBottomLeft().subtract([ce,-ce]),M.getTopRight().add([ce,-ce]));if(!(isFinite(M.min.x)&&isFinite(M.min.y)&&isFinite(M.max.x)&&isFinite(M.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var _e in this._tiles){var Fe=this._tiles[_e].coords;(Fe.z!==this._tileZoom||!me.contains(new V(Fe.x,Fe.y)))&&(this._tiles[_e].current=!1)}if(Math.abs(y-this._tileZoom)>1){this._setView(c,y);return}for(var rt=M.min.y;rt<=M.max.y;rt++)for(var yt=M.min.x;yt<=M.max.x;yt++){var Bn=new V(yt,rt);if(Bn.z=this._tileZoom,!!this._isValidTile(Bn)){var kn=this._tiles[this._tileCoordsToKey(Bn)];kn?kn.current=!0:te.push(Bn)}}if(te.sort(function(sr,Eo){return sr.distanceTo(H)-Eo.distanceTo(H)}),te.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xr=document.createDocumentFragment();for(yt=0;yt<te.length;yt++)this._addTile(te[yt],xr);this._level.el.appendChild(xr)}}}},_isValidTile:function(c){var d=this._map.options.crs;if(!d.infinite){var y=this._globalTileRange;if(!d.wrapLng&&(c.x<y.min.x||c.x>y.max.x)||!d.wrapLat&&(c.y<y.min.y||c.y>y.max.y))return!1}if(!this.options.bounds)return!0;var O=this._tileCoordsToBounds(c);return Y(this.options.bounds).overlaps(O)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var d=this._map,y=this.getTileSize(),O=c.scaleBy(y),M=O.add(y),H=d.unproject(O,c.z),te=d.unproject(M,c.z);return[H,te]},_tileCoordsToBounds:function(c){var d=this._tileCoordsToNwSe(c),y=new G(d[0],d[1]);return this.options.noWrap||(y=this._map.wrapLatLngBounds(y)),y},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var d=c.split(":"),y=new V(+d[0],+d[1]);return y.z=+d[2],y},_removeTile:function(c){var d=this._tiles[c];d&&(tn(d.el),delete this._tiles[c],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){ht(c,"leaflet-tile");var d=this.getTileSize();c.style.width=d.x+"px",c.style.height=d.y+"px",c.onselectstart=g,c.onmousemove=g,ze.ielt9&&this.options.opacity<1&&rr(c,this.options.opacity)},_addTile:function(c,d){var y=this._getTilePos(c),O=this._tileCoordsToKey(c),M=this.createTile(this._wrapCoords(c),o(this._tileReady,this,c));this._initTile(M),this.createTile.length<2&&U(o(this._tileReady,this,c,null,M)),mn(M,y),this._tiles[O]={el:M,coords:c,current:!0},d.appendChild(M),this.fire("tileloadstart",{tile:M,coords:c})},_tileReady:function(c,d,y){d&&this.fire("tileerror",{error:d,tile:y,coords:c});var O=this._tileCoordsToKey(c);y=this._tiles[O],y&&(y.loaded=+new Date,this._map._fadeAnimated?(rr(y.el,0),X(this._fadeFrame),this._fadeFrame=U(this._updateOpacity,this)):(y.active=!0,this._pruneTiles()),d||(ht(y.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:y.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ze.ielt9||!this._map._fadeAnimated?U(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var d=new V(this._wrapX?p(c.x,this._wrapX):c.x,this._wrapY?p(c.y,this._wrapY):c.y);return d.z=c.z,d},_pxBoundsToTileRange:function(c){var d=this.getTileSize();return new B(c.min.unscaleBy(d).floor(),c.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});function ko(c){return new ts(c)}var ns=ts.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,d){this._url=c,d=b(this,d),d.detectRetina&&ze.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,d){return this._url===c&&d===void 0&&(d=!0),this._url=c,d||this.redraw(),this},createTile:function(c,d){var y=document.createElement("img");return ct(y,"load",o(this._tileOnLoad,this,d,y)),ct(y,"error",o(this._tileOnError,this,d,y)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(y.referrerPolicy=this.options.referrerPolicy),y.alt="",y.src=this.getTileUrl(c),y},getTileUrl:function(c){var d={r:ze.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var y=this._globalTileRange.max.y-c.y;this.options.tms&&(d.y=y),d["-y"]=y}return T(this._url,i(d,this.options))},_tileOnLoad:function(c,d){ze.ielt9?setTimeout(o(c,this,null,d),0):c(null,d)},_tileOnError:function(c,d,y){var O=this.options.errorTileUrl;O&&d.getAttribute("src")!==O&&(d.src=O),c(y,d)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom,d=this.options.maxZoom,y=this.options.zoomReverse,O=this.options.zoomOffset;return y&&(c=d-c),c+O},_getSubdomain:function(c){var d=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var c,d;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&(d=this._tiles[c].el,d.onload=g,d.onerror=g,!d.complete)){d.src=N;var y=this._tiles[c].coords;tn(d),delete this._tiles[c],this.fire("tileabort",{tile:d,coords:y})}},_removeTile:function(c){var d=this._tiles[c];if(d)return d.el.setAttribute("src",N),ts.prototype._removeTile.call(this,c)},_tileReady:function(c,d,y){if(!(!this._map||y&&y.getAttribute("src")===N))return ts.prototype._tileReady.call(this,c,d,y)}});function lu(c,d){return new ns(c,d)}var _a=ns.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,d){this._url=c;var y=i({},this.defaultWmsParams);for(var O in d)O in this.options||(y[O]=d[O]);d=b(this,d);var M=d.detectRetina&&ze.retina?2:1,H=this.getTileSize();y.width=H.x*M,y.height=H.y*M,this.wmsParams=y},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,ns.prototype.onAdd.call(this,c)},getTileUrl:function(c){var d=this._tileCoordsToNwSe(c),y=this._crs,O=Q(y.project(d[0]),y.project(d[1])),M=O.min,H=O.max,te=(this._wmsVersion>=1.3&&this._crs===ff?[M.y,M.x,H.y,H.x]:[M.x,M.y,H.x,H.y]).join(","),ce=ns.prototype.getTileUrl.call(this,c);return ce+w(this.wmsParams,ce,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+te},setParams:function(c,d){return i(this.wmsParams,c),d||this.redraw(),this}});function Af(c,d){return new _a(c,d)}ns.WMS=_a,lu.wms=Af;var hi=Ur.extend({options:{padding:.1},initialize:function(c){b(this,c),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,d){var y=this._map.getZoomScale(d,this._zoom),O=this._map.getSize().multiplyBy(.5+this.options.padding),M=this._map.project(this._center,d),H=O.multiplyBy(-y).add(M).subtract(this._map._getNewPixelOrigin(c,d));ze.any3d?Wr(this._container,H,y):mn(this._container,H)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var c in this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,d=this._map.getSize(),y=this._map.containerPointToLayerPoint(d.multiplyBy(-c)).round();this._bounds=new B(y,y.add(d.multiplyBy(1+c*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),cu=hi.extend({options:{tolerance:0},getEvents:function(){var c=hi.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){hi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");ct(c,"mousemove",this._onMouseMove,this),ct(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ct(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){X(this._redrawRequest),delete this._ctx,tn(this._container),Wt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var c;this._redrawBounds=null;for(var d in this._layers)c=this._layers[d],c._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){hi.prototype._update.call(this);var c=this._bounds,d=this._container,y=c.getSize(),O=ze.retina?2:1;mn(d,c.min),d.width=O*y.x,d.height=O*y.y,d.style.width=y.x+"px",d.style.height=y.y+"px",ze.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){hi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[u(c)]=c;var d=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var d=c._order,y=d.next,O=d.prev;y?y.prev=O:this._drawLast=O,O?O.next=y:this._drawFirst=y,delete c._order,delete this._layers[u(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if(typeof c.options.dashArray=="string"){var d=c.options.dashArray.split(/[, ]+/),y=[],O,M;for(M=0;M<d.length;M++){if(O=Number(d[M]),isNaN(O))return;y.push(O)}c.options._dashArray=y}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){this._map&&(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||U(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var d=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new B,this._redrawBounds.extend(c._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(c._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var d=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,d=this._redrawBounds;if(this._ctx.save(),d){var y=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,y.x,y.y),this._ctx.clip()}this._drawing=!0;for(var O=this._drawFirst;O;O=O.next)c=O.layer,(!d||c._pxBounds&&c._pxBounds.intersects(d))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,d){if(this._drawing){var y,O,M,H,te=c._parts,ce=te.length,me=this._ctx;if(ce){for(me.beginPath(),y=0;y<ce;y++){for(O=0,M=te[y].length;O<M;O++)H=te[y][O],me[O?"lineTo":"moveTo"](H.x,H.y);d&&me.closePath()}this._fillStroke(me,c)}}},_updateCircle:function(c){if(!(!this._drawing||c._empty())){var d=c._point,y=this._ctx,O=Math.max(Math.round(c._radius),1),M=(Math.max(Math.round(c._radiusY),1)||O)/O;M!==1&&(y.save(),y.scale(1,M)),y.beginPath(),y.arc(d.x,d.y/M,O,0,Math.PI*2,!1),M!==1&&y.restore(),this._fillStroke(y,c)}},_fillStroke:function(c,d){var y=d.options;y.fill&&(c.globalAlpha=y.fillOpacity,c.fillStyle=y.fillColor||y.color,c.fill(y.fillRule||"evenodd")),y.stroke&&y.weight!==0&&(c.setLineDash&&c.setLineDash(d.options&&d.options._dashArray||[]),c.globalAlpha=y.opacity,c.lineWidth=y.weight,c.strokeStyle=y.color,c.lineCap=y.lineCap,c.lineJoin=y.lineJoin,c.stroke())},_onClick:function(c){for(var d=this._map.mouseEventToLayerPoint(c),y,O,M=this._drawFirst;M;M=M.next)y=M.layer,y.options.interactive&&y._containsPoint(d)&&(!(c.type==="click"||c.type==="preclick")||!this._map._draggableMoved(y))&&(O=y);this._fireEvent(O?[O]:!1,c)},_onMouseMove:function(c){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,d)}},_handleMouseOut:function(c){var d=this._hoveredLayer;d&&(Xt(this._container,"leaflet-interactive"),this._fireEvent([d],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,d){if(!this._mouseHoverThrottled){for(var y,O,M=this._drawFirst;M;M=M.next)y=M.layer,y.options.interactive&&y._containsPoint(d)&&(O=y);O!==this._hoveredLayer&&(this._handleMouseOut(c),O&&(ht(this._container,"leaflet-interactive"),this._fireEvent([O],c,"mouseover"),this._hoveredLayer=O)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,c),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,d,y){this._map._fireDOMEvent(d,y||d.type,c)},_bringToFront:function(c){var d=c._order;if(d){var y=d.next,O=d.prev;if(y)y.prev=O;else return;O?O.next=y:y&&(this._drawFirst=y),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(c)}},_bringToBack:function(c){var d=c._order;if(d){var y=d.next,O=d.prev;if(O)O.next=y;else return;y?y.prev=O:O&&(this._drawLast=O),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(c)}}});function uu(c){return ze.canvas?new cu(c):null}var So=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch{}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),bf={_initContainer:function(){this._container=gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(hi.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var d=c._container=So("shape");ht(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",c._path=So("path"),d.appendChild(c._path),this._updateStyle(c),this._layers[u(c)]=c},_addPath:function(c){var d=c._container;this._container.appendChild(d),c.options.interactive&&c.addInteractiveTarget(d)},_removePath:function(c){var d=c._container;tn(d),c.removeInteractiveTarget(d),delete this._layers[u(c)]},_updateStyle:function(c){var d=c._stroke,y=c._fill,O=c.options,M=c._container;M.stroked=!!O.stroke,M.filled=!!O.fill,O.stroke?(d||(d=c._stroke=So("stroke")),M.appendChild(d),d.weight=O.weight+"px",d.color=O.color,d.opacity=O.opacity,O.dashArray?d.dashStyle=E(O.dashArray)?O.dashArray.join(" "):O.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=O.lineCap.replace("butt","flat"),d.joinstyle=O.lineJoin):d&&(M.removeChild(d),c._stroke=null),O.fill?(y||(y=c._fill=So("fill")),M.appendChild(y),y.color=O.fillColor||O.color,y.opacity=O.fillOpacity):y&&(M.removeChild(y),c._fill=null)},_updateCircle:function(c){var d=c._point.round(),y=Math.round(c._radius),O=Math.round(c._radiusY||y);this._setPath(c,c._empty()?"M0 0":"AL "+d.x+","+d.y+" "+y+","+O+" 0,"+65535*360)},_setPath:function(c,d){c._path.v=d},_bringToFront:function(c){ho(c._container)},_bringToBack:function(c){Si(c._container)}},Gr=ze.vml?So:pt,Ds=hi.extend({_initContainer:function(){this._container=Gr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Gr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){tn(this._container),Wt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){hi.prototype._update.call(this);var c=this._bounds,d=c.getSize(),y=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,y.setAttribute("width",d.x),y.setAttribute("height",d.y)),mn(y,c.min),y.setAttribute("viewBox",[c.min.x,c.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(c){var d=c._path=Gr("path");c.options.className&&ht(d,c.options.className),c.options.interactive&&ht(d,"leaflet-interactive"),this._updateStyle(c),this._layers[u(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){tn(c._path),c.removeInteractiveTarget(c._path),delete this._layers[u(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var d=c._path,y=c.options;d&&(y.stroke?(d.setAttribute("stroke",y.color),d.setAttribute("stroke-opacity",y.opacity),d.setAttribute("stroke-width",y.weight),d.setAttribute("stroke-linecap",y.lineCap),d.setAttribute("stroke-linejoin",y.lineJoin),y.dashArray?d.setAttribute("stroke-dasharray",y.dashArray):d.removeAttribute("stroke-dasharray"),y.dashOffset?d.setAttribute("stroke-dashoffset",y.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),y.fill?(d.setAttribute("fill",y.fillColor||y.color),d.setAttribute("fill-opacity",y.fillOpacity),d.setAttribute("fill-rule",y.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(c,d){this._setPath(c,bt(c._parts,d))},_updateCircle:function(c){var d=c._point,y=Math.max(Math.round(c._radius),1),O=Math.max(Math.round(c._radiusY),1)||y,M="a"+y+","+O+" 0 1,0 ",H=c._empty()?"M0 0":"M"+(d.x-y)+","+d.y+M+y*2+",0 "+M+-y*2+",0 ";this._setPath(c,H)},_setPath:function(c,d){c._path.setAttribute("d",d)},_bringToFront:function(c){ho(c._path)},_bringToBack:function(c){Si(c._path)}});ze.vml&&Ds.include(bf);function Ll(c){return ze.svg||ze.vml?new Ds(c):null}Ct.include({getRenderer:function(c){var d=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(c){if(c==="overlayPane"||c===void 0)return!1;var d=this._paneRenderers[c];return d===void 0&&(d=this._createRenderer({pane:c}),this._paneRenderers[c]=d),d},_createRenderer:function(c){return this.options.preferCanvas&&uu(c)||Ll(c)}});var wf=Bi.extend({initialize:function(c,d){Bi.prototype.initialize.call(this,this._boundsToLatLngs(c),d)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return c=Y(c),[c.getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});function Fm(c,d){return new wf(c,d)}Ds.create=Gr,Ds.pointsToPath=bt,ci.geometryToLayer=bo,ci.coordsToLatLng=Pl,ci.coordsToLatLngs=ba,ci.latLngToCoords=Bl,ci.latLngsToCoords=Rl,ci.getFeature=wo,ci.asFeature=Dl,Ct.mergeOptions({boxZoom:!0});var Co=kr.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){ct(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Wt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){tn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||c.which!==1&&c.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Bt(),yl(),this._startPoint=this._map.mouseEventToContainerPoint(c),ct(document,{contextmenu:Vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=gt("div","leaflet-zoom-box",this._container),ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var d=new B(this._point,this._startPoint),y=d.getSize();mn(this._box,d.min),this._box.style.width=y.x+"px",this._box.style.height=y.y+"px"},_finish:function(){this._moved&&(tn(this._box),Xt(this._container,"leaflet-crosshair")),mo(),vl(),Wt(document,{contextmenu:Vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if(!(c.which!==1&&c.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var d=new G(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(c){c.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ct.addInitHook("addHandler","boxZoom",Co),Ct.mergeOptions({doubleClickZoom:!0});var _f=kr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var d=this._map,y=d.getZoom(),O=d.options.zoomDelta,M=c.originalEvent.shiftKey?y-O:y+O;d.options.doubleClickZoom==="center"?d.setZoom(M):d.setZoomAround(c.containerPoint,M)}});Ct.addInitHook("addHandler","doubleClickZoom",_f),Ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var hu=kr.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new $r(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Xt(this._map._container,"leaflet-grab"),Xt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=Y(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var d=this._lastTime=+new Date,y=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(y),this._times.push(d),this._prunePositions(d)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,d){return c-(c-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var c=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;c.x<d.min.x&&(c.x=this._viscousLimit(c.x,d.min.x)),c.y<d.min.y&&(c.y=this._viscousLimit(c.y,d.min.y)),c.x>d.max.x&&(c.x=this._viscousLimit(c.x,d.max.x)),c.y>d.max.y&&(c.y=this._viscousLimit(c.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,d=Math.round(c/2),y=this._initialWorldOffset,O=this._draggable._newPos.x,M=(O-d+y)%c+d-y,H=(O+d+y)%c-d-y,te=Math.abs(M+y)<Math.abs(H+y)?M:H;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=te},_onDragEnd:function(c){var d=this._map,y=d.options,O=!y.inertia||c.noInertia||this._times.length<2;if(d.fire("dragend",c),O)d.fire("moveend");else{this._prunePositions(+new Date);var M=this._lastPos.subtract(this._positions[0]),H=(this._lastTime-this._times[0])/1e3,te=y.easeLinearity,ce=M.multiplyBy(te/H),me=ce.distanceTo([0,0]),_e=Math.min(y.inertiaMaxSpeed,me),Fe=ce.multiplyBy(_e/me),rt=_e/(y.inertiaDeceleration*te),yt=Fe.multiplyBy(-rt/2).round();!yt.x&&!yt.y?d.fire("moveend"):(yt=d._limitOffset(yt,d.options.maxBounds),U(function(){d.panBy(yt,{duration:rt,easeLinearity:te,noMoveStart:!0,animate:!0})}))}}});Ct.addInitHook("addHandler","dragging",hu),Ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var fu=kr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),ct(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Wt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,d=document.documentElement,y=c.scrollTop||d.scrollTop,O=c.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(O,y)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var d=this._panKeys={},y=this.keyCodes,O,M;for(O=0,M=y.left.length;O<M;O++)d[y.left[O]]=[-1*c,0];for(O=0,M=y.right.length;O<M;O++)d[y.right[O]]=[c,0];for(O=0,M=y.down.length;O<M;O++)d[y.down[O]]=[0,c];for(O=0,M=y.up.length;O<M;O++)d[y.up[O]]=[0,-1*c]},_setZoomDelta:function(c){var d=this._zoomKeys={},y=this.keyCodes,O,M;for(O=0,M=y.zoomIn.length;O<M;O++)d[y.zoomIn[O]]=c;for(O=0,M=y.zoomOut.length;O<M;O++)d[y.zoomOut[O]]=-c},_addHooks:function(){ct(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Wt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var d=c.keyCode,y=this._map,O;if(d in this._panKeys){if(!y._panAnim||!y._panAnim._inProgress)if(O=this._panKeys[d],c.shiftKey&&(O=q(O).multiplyBy(3)),y.options.maxBounds&&(O=y._limitOffset(q(O),y.options.maxBounds)),y.options.worldCopyJump){var M=y.wrapLatLng(y.unproject(y.project(y.getCenter()).add(O)));y.panTo(M)}else y.panBy(O)}else if(d in this._zoomKeys)y.setZoom(y.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&y._popup&&y._popup.options.closeOnEscapeKey)y.closePopup();else return;Vr(c)}}});Ct.addInitHook("addHandler","keyboard",fu),Ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var qt=kr.extend({addHooks:function(){ct(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Wt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var d=rf(c),y=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var O=Math.max(y-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),O),Vr(c)},_performZoom:function(){var c=this._map,d=c.getZoom(),y=this._map.options.zoomSnap||0;c._stop();var O=this._delta/(this._map.options.wheelPxPerZoomLevel*4),M=4*Math.log(2/(1+Math.exp(-Math.abs(O))))/Math.LN2,H=y?Math.ceil(M/y)*y:M,te=c._limitZoom(d+(this._delta>0?H:-H))-d;this._delta=0,this._startTime=null,te&&(c.options.scrollWheelZoom==="center"?c.setZoom(d+te):c.setZoomAround(this._lastMousePos,d+te))}});Ct.addInitHook("addHandler","scrollWheelZoom",qt);var du=600;Ct.mergeOptions({tapHold:ze.touchNative&&ze.safari&&ze.mobile,tapTolerance:15});var Oa=kr.extend({addHooks:function(){ct(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Wt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),c.touches.length===1){var d=c.touches[0];this._startPos=this._newPos=new V(d.clientX,d.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(ct(document,"touchend",un),ct(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),du),ct(document,"touchend touchcancel contextmenu",this._cancel,this),ct(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){Wt(document,"touchend",un),Wt(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),Wt(document,"touchend touchcancel contextmenu",this._cancel,this),Wt(document,"touchmove",this._onMove,this)},_onMove:function(c){var d=c.touches[0];this._newPos=new V(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,d){var y=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});y._simulated=!0,d.target.dispatchEvent(y)}});Ct.addInitHook("addHandler","tapHold",Oa),Ct.mergeOptions({touchZoom:ze.touch,bounceAtZoomLimits:!0});var To=kr.extend({addHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),ct(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Xt(this._map._container,"leaflet-touch-zoom"),Wt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var d=this._map;if(!(!c.touches||c.touches.length!==2||d._animatingZoom||this._zooming)){var y=d.mouseEventToContainerPoint(c.touches[0]),O=d.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(y.add(O)._divideBy(2))),this._startDist=y.distanceTo(O),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),ct(document,"touchmove",this._onTouchMove,this),ct(document,"touchend touchcancel",this._onTouchEnd,this),un(c)}},_onTouchMove:function(c){if(!(!c.touches||c.touches.length!==2||!this._zooming)){var d=this._map,y=d.mouseEventToContainerPoint(c.touches[0]),O=d.mouseEventToContainerPoint(c.touches[1]),M=y.distanceTo(O)/this._startDist;if(this._zoom=d.getScaleZoom(M,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&M<1||this._zoom>d.getMaxZoom()&&M>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,M===1)return}else{var H=y._add(O)._divideBy(2)._subtract(this._centerPoint);if(M===1&&H.x===0&&H.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(H),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),X(this._animRequest);var te=o(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=U(te,this,!0),un(c)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,X(this._animRequest),Wt(document,"touchmove",this._onTouchMove,this),Wt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ct.addInitHook("addHandler","touchZoom",To),Ct.BoxZoom=Co,Ct.DoubleClickZoom=_f,Ct.Drag=hu,Ct.Keyboard=fu,Ct.ScrollWheelZoom=qt,Ct.TapHold=Oa,Ct.TouchZoom=To,t.Bounds=B,t.Browser=ze,t.CRS=ve,t.Canvas=cu,t.Circle=Tl,t.CircleMarker=Cl,t.Class=ee,t.Control=mr,t.DivIcon=Nl,t.DivOverlay=ui,t.DomEvent=wl,t.DomUtil=ma,t.Draggable=$r,t.Evented=ie,t.FeatureGroup=Ei,t.GeoJSON=ci,t.GridLayer=ts,t.Handler=kr,t.Icon=Rs,t.ImageOverlay=es,t.LatLng=ue,t.LatLngBounds=G,t.Layer=Ur,t.LayerGroup=Yi,t.LineUtil=hf,t.Map=Ct,t.Marker=Pi,t.Mixin=Xc,t.Path=Ji,t.Point=V,t.PolyUtil=Sm,t.Polygon=Bi,t.Polyline=gr,t.Popup=Ml,t.PosAnimation=_l,t.Projection=Bm,t.Rectangle=wf,t.Renderer=hi,t.SVG=Ds,t.SVGOverlay=ou,t.TileLayer=ns,t.Tooltip=Oo,t.Transformation=Ke,t.Util=$,t.VideoOverlay=su,t.bind=o,t.bounds=Q,t.canvas=uu,t.circle=Aa,t.circleMarker=mf,t.control=Ki,t.divIcon=vf,t.extend=i,t.featureGroup=df,t.geoJSON=gf,t.geoJson=Zr,t.gridLayer=ko,t.icon=pf,t.imageOverlay=xf,t.latLng=pe,t.latLngBounds=Y,t.layerGroup=va,t.map=Xi,t.marker=Mm,t.point=q,t.polygon=Lm,t.polyline=Nm,t.popup=_o,t.rectangle=Fm,t.setOptions=b,t.stamp=u,t.svg=Ll,t.svgOverlay=au,t.tileLayer=lu,t.tooltip=wa,t.transformation=nt,t.version=r,t.videoOverlay=yf;var Of=window.L;t.noConflict=function(){return window.L=Of,this},window.L=t}))})(eh,eh.exports)),eh.exports}var ym=uQ();function TA(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function EA(n,e){return e==null?function(r,i){const s=R.useRef();return s.current||(s.current=n(r,i)),s}:function(r,i){const s=R.useRef();s.current||(s.current=n(r,i));const o=R.useRef(r),{instance:a}=s.current;return R.useEffect(function(){o.current!==r&&(e(a,r,o.current),o.current=r)},[a,r,i]),s}}function XE(n,e){R.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var s;(s=e.layerContainer)==null||s.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function hQ(n){return function(t){const r=gm(),i=n(xm(t,r),r);return UE(r.map,t.attribution),CA(i.current,t.eventHandlers),XE(i.current,r),i}}function fQ(n,e){const t=R.useRef();R.useEffect(function(){if(e.pathOptions!==t.current){const i=e.pathOptions??{};n.instance.setStyle(i),t.current=i}},[n,e])}function dQ(n){return function(t){const r=gm(),i=n(xm(t,r),r);return CA(i.current,t.eventHandlers),XE(i.current,r),fQ(i.current,t),i}}function pQ(n,e){const t=EA(n),r=lQ(t,e);return oQ(r)}function mQ(n,e){const t=EA(n,e),r=dQ(t);return sQ(r)}function gQ(n,e){const t=EA(n,e),r=hQ(t);return aQ(r)}function xQ(n,e,t){const{opacity:r,zIndex:i}=e;r!=null&&r!==t.opacity&&n.setOpacity(r),i!=null&&i!==t.zIndex&&n.setZIndex(i)}function yQ(){return gm().map}const vQ=mQ(function({center:e,children:t,...r},i){const s=new ym.CircleMarker(e,r);return TA(s,iQ(i,{overlayContainer:s}))},tQ);function rv(){return rv=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},rv.apply(this,arguments)}function AQ({bounds:n,boundsOptions:e,center:t,children:r,className:i,id:s,placeholder:o,style:a,whenReady:u,zoom:f,...p},g){const[x]=R.useState({className:i,id:s,style:a}),[A,_]=R.useState(null);R.useImperativeHandle(g,()=>(A==null?void 0:A.map)??null,[A]);const b=R.useCallback(C=>{if(C!==null&&A===null){const T=new ym.Map(C,p);t!=null&&f!=null?T.setView(t,f):n!=null&&T.fitBounds(n,e),u!=null&&T.whenReady(u),_(rQ(T))}},[]);R.useEffect(()=>()=>{A==null||A.map.remove()},[A]);const w=A?Be.createElement(GE,{value:A},r):o??null;return Be.createElement("div",rv({},x,{ref:b}),w)}const bQ=R.forwardRef(AQ),wQ=pQ(function(e,t){const r=new ym.Popup(e,t.overlayContainer);return TA(r,t)},function(e,t,{position:r},i){R.useEffect(function(){const{instance:o}=e;function a(f){f.popup===o&&(o.update(),i(!0))}function u(f){f.popup===o&&i(!1)}return t.map.on({popupopen:a,popupclose:u}),t.overlayContainer==null?(r!=null&&o.setLatLng(r),o.openOn(t.map)):t.overlayContainer.bindPopup(o),function(){var p;t.map.off({popupopen:a,popupclose:u}),(p=t.overlayContainer)==null||p.unbindPopup(),t.map.removeLayer(o)}},[e,t,i,r])}),_Q=gQ(function({url:e,...t},r){const i=new ym.TileLayer(e,xm(t,r));return TA(i,r)},function(e,t,r){xQ(e,t,r);const{url:i}=t;i!=null&&i!==r.url&&e.setUrl(i)});function OQ(n){const t=Date.now()/1e3-n,r=3600,i=86400;return t<r?"#22c55e":t<i?"#4ade80":t<3*i?"#a3e635":"#9ca3af"}function kQ({contacts:n,focusedContact:e}){const t=yQ(),[r,i]=R.useState(!1);return R.useEffect(()=>{if(e&&e.lat!=null&&e.lon!=null){t.setView([e.lat,e.lon],12),i(!0);return}if(r)return;const s=()=>{if(n.length===0){t.setView([20,0],2),i(!0);return}if(n.length===1){t.setView([n[0].lat,n[0].lon],10),i(!0);return}const o=n.map(a=>[a.lat,a.lon]);t.fitBounds(o,{padding:[50,50],maxZoom:12}),i(!0)};"geolocation"in navigator?navigator.geolocation.getCurrentPosition(o=>{t.setView([o.coords.latitude,o.coords.longitude],8),i(!0)},()=>{s()},{timeout:5e3,maximumAge:3e5}):s()},[t,n,r,e]),null}function SQ({contacts:n,focusedKey:e}){const t=R.useMemo(()=>{const o=Date.now()/1e3-604800;return n.filter(a=>a.lat!=null&&a.lon!=null&&a.last_seen!=null&&a.last_seen>o)},[n]),r=R.useMemo(()=>e&&t.find(o=>o.public_key===e)||null,[e,t]),i=R.useRef({}),s=R.useCallback((o,a)=>{i.current[o]=a},[]);return R.useEffect(()=>{if(r&&i.current[r.public_key]){const o=setTimeout(()=>{var a;(a=i.current[r.public_key])==null||a.openPopup()},100);return()=>clearTimeout(o)}},[r]),S.jsxs("div",{className:"flex flex-col h-full",children:[S.jsxs("div",{className:"px-4 py-2 bg-muted/50 text-xs text-muted-foreground flex items-center justify-between",children:[S.jsxs("span",{children:["Showing ",t.length," contact",t.length!==1?"s":""," heard in the last 7 days"]}),S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsxs("span",{className:"flex items-center gap-1",children:[S.jsx("span",{className:"w-3 h-3 rounded-full bg-[#22c55e]"})," <1h"]}),S.jsxs("span",{className:"flex items-center gap-1",children:[S.jsx("span",{className:"w-3 h-3 rounded-full bg-[#4ade80]"})," <1d"]}),S.jsxs("span",{className:"flex items-center gap-1",children:[S.jsx("span",{className:"w-3 h-3 rounded-full bg-[#a3e635]"})," <3d"]}),S.jsxs("span",{className:"flex items-center gap-1",children:[S.jsx("span",{className:"w-3 h-3 rounded-full bg-[#9ca3af]"})," older"]})]})]}),S.jsx("div",{className:"flex-1 relative",style:{zIndex:0},children:S.jsxs(bQ,{center:[20,0],zoom:2,className:"h-full w-full",style:{background:"#1a1a2e"},children:[S.jsx(_Q,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),S.jsx(kQ,{contacts:t,focusedContact:r}),t.map(o=>{const a=o.type===Lp,u=OQ(o.last_seen),f=o.name||o.public_key.slice(0,12);return S.jsx(vQ,{ref:p=>s(o.public_key,p),center:[o.lat,o.lon],radius:a?10:7,pathOptions:{color:a?u:"#000",fillColor:u,fillOpacity:.8,weight:a?0:1},children:S.jsx(wQ,{children:S.jsxs("div",{className:"text-sm",children:[S.jsxs("div",{className:"font-medium flex items-center gap-1",children:[a&&S.jsx("span",{title:"Repeater",children:""}),f]}),S.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Last heard: ",Ac(o.last_seen)]}),S.jsxs("div",{className:"text-xs text-gray-400 mt-1 font-mono",children:[o.lat.toFixed(5),", ",o.lon.toFixed(5)]})]})})},o.public_key)})]})})]})}function xk(n,e){var t,r=1;n==null&&(n=0),e==null&&(e=0);function i(){var s,o=t.length,a,u=0,f=0;for(s=0;s<o;++s)a=t[s],u+=a.x,f+=a.y;for(u=(u/o-n)*r,f=(f/o-e)*r,s=0;s<o;++s)a=t[s],a.x-=u,a.y-=f}return i.initialize=function(s){t=s},i.x=function(s){return arguments.length?(n=+s,i):n},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function CQ(n){const e=+this._x.call(null,n),t=+this._y.call(null,n);return KE(this.cover(e,t),e,t,n)}function KE(n,e,t,r){if(isNaN(e)||isNaN(t))return n;var i,s=n._root,o={data:r},a=n._x0,u=n._y0,f=n._x1,p=n._y1,g,x,A,_,b,w,C,T;if(!s)return n._root=o,n;for(;s.length;)if((b=e>=(g=(a+f)/2))?a=g:f=g,(w=t>=(x=(u+p)/2))?u=x:p=x,i=s,!(s=s[C=w<<1|b]))return i[C]=o,n;if(A=+n._x.call(null,s.data),_=+n._y.call(null,s.data),e===A&&t===_)return o.next=s,i?i[C]=o:n._root=o,n;do i=i?i[C]=new Array(4):n._root=new Array(4),(b=e>=(g=(a+f)/2))?a=g:f=g,(w=t>=(x=(u+p)/2))?u=x:p=x;while((C=w<<1|b)===(T=(_>=x)<<1|A>=g));return i[T]=s,i[C]=o,n}function TQ(n){var e,t,r=n.length,i,s,o=new Array(r),a=new Array(r),u=1/0,f=1/0,p=-1/0,g=-1/0;for(t=0;t<r;++t)isNaN(i=+this._x.call(null,e=n[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=i,a[t]=s,i<u&&(u=i),i>p&&(p=i),s<f&&(f=s),s>g&&(g=s));if(u>p||f>g)return this;for(this.cover(u,f).cover(p,g),t=0;t<r;++t)KE(this,o[t],a[t],n[t]);return this}function EQ(n,e){if(isNaN(n=+n)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(t))i=(t=Math.floor(n))+1,s=(r=Math.floor(e))+1;else{for(var o=i-t||1,a=this._root,u,f;t>n||n>=i||r>e||e>=s;)switch(f=(e<r)<<1|n<t,u=new Array(4),u[f]=a,a=u,o*=2,f){case 0:i=t+o,s=r+o;break;case 1:t=i-o,s=r+o;break;case 2:i=t+o,r=s-o;break;case 3:t=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=r,this._x1=i,this._y1=s,this}function PQ(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function BQ(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function br(n,e,t,r,i){this.node=n,this.x0=e,this.y0=t,this.x1=r,this.y1=i}function RQ(n,e,t){var r,i=this._x0,s=this._y0,o,a,u,f,p=this._x1,g=this._y1,x=[],A=this._root,_,b;for(A&&x.push(new br(A,i,s,p,g)),t==null?t=1/0:(i=n-t,s=e-t,p=n+t,g=e+t,t*=t);_=x.pop();)if(!(!(A=_.node)||(o=_.x0)>p||(a=_.y0)>g||(u=_.x1)<i||(f=_.y1)<s))if(A.length){var w=(o+u)/2,C=(a+f)/2;x.push(new br(A[3],w,C,u,f),new br(A[2],o,C,w,f),new br(A[1],w,a,u,C),new br(A[0],o,a,w,C)),(b=(e>=C)<<1|n>=w)&&(_=x[x.length-1],x[x.length-1]=x[x.length-1-b],x[x.length-1-b]=_)}else{var T=n-+this._x.call(null,A.data),E=e-+this._y.call(null,A.data),D=T*T+E*E;if(D<t){var N=Math.sqrt(t=D);i=n-N,s=e-N,p=n+N,g=e+N,r=A.data}}return r}function DQ(n){if(isNaN(p=+this._x.call(null,n))||isNaN(g=+this._y.call(null,n)))return this;var e,t=this._root,r,i,s,o=this._x0,a=this._y0,u=this._x1,f=this._y1,p,g,x,A,_,b,w,C;if(!t)return this;if(t.length)for(;;){if((_=p>=(x=(o+u)/2))?o=x:u=x,(b=g>=(A=(a+f)/2))?a=A:f=A,e=t,!(t=t[w=b<<1|_]))return this;if(!t.length)break;(e[w+1&3]||e[w+2&3]||e[w+3&3])&&(r=e,C=w)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[w]=s:delete e[w],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[C]=t:this._root=t),this):(this._root=s,this)}function MQ(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function NQ(){return this._root}function LQ(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function FQ(n){var e=[],t,r=this._root,i,s,o,a,u;for(r&&e.push(new br(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!n(r=t.node,s=t.x0,o=t.y0,a=t.x1,u=t.y1)&&r.length){var f=(s+a)/2,p=(o+u)/2;(i=r[3])&&e.push(new br(i,f,p,a,u)),(i=r[2])&&e.push(new br(i,s,p,f,u)),(i=r[1])&&e.push(new br(i,f,o,a,p)),(i=r[0])&&e.push(new br(i,s,o,f,p))}return this}function IQ(n){var e=[],t=[],r;for(this._root&&e.push(new br(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,u=r.x1,f=r.y1,p=(o+u)/2,g=(a+f)/2;(s=i[0])&&e.push(new br(s,o,a,p,g)),(s=i[1])&&e.push(new br(s,p,a,u,g)),(s=i[2])&&e.push(new br(s,o,g,p,f)),(s=i[3])&&e.push(new br(s,p,g,u,f))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.x1,r.y1);return this}function zQ(n){return n[0]}function jQ(n){return arguments.length?(this._x=n,this):this._x}function QQ(n){return n[1]}function HQ(n){return arguments.length?(this._y=n,this):this._y}function PA(n,e,t){var r=new BA(e??zQ,t??QQ,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function BA(n,e,t,r,i,s){this._x=n,this._y=e,this._x0=t,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function yk(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Or=PA.prototype=BA.prototype;Or.copy=function(){var n=new BA(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=yk(e),n;for(t=[{source:e,target:n._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=yk(r));return n};Or.add=CQ;Or.addAll=TQ;Or.cover=EQ;Or.data=PQ;Or.extent=BQ;Or.find=RQ;Or.remove=DQ;Or.removeAll=MQ;Or.root=NQ;Or.size=LQ;Or.visit=FQ;Or.visitAfter=IQ;Or.x=jQ;Or.y=HQ;function wr(n){return function(){return n}}function Ko(n){return(n()-.5)*1e-6}function WQ(n){return n.x+n.vx}function qQ(n){return n.y+n.vy}function VQ(n){var e,t,r,i=1,s=1;typeof n!="function"&&(n=wr(n==null?1:+n));function o(){for(var f,p=e.length,g,x,A,_,b,w,C=0;C<s;++C)for(g=PA(e,WQ,qQ).visitAfter(a),f=0;f<p;++f)x=e[f],b=t[x.index],w=b*b,A=x.x+x.vx,_=x.y+x.vy,g.visit(T);function T(E,D,N,F,z){var I=E.data,K=E.r,W=b+K;if(I){if(I.index>x.index){var U=A-I.x-I.vx,X=_-I.y-I.vy,$=U*U+X*X;$<W*W&&(U===0&&(U=Ko(r),$+=U*U),X===0&&(X=Ko(r),$+=X*X),$=(W-($=Math.sqrt($)))/$*i,x.vx+=(U*=$)*(W=(K*=K)/(w+K)),x.vy+=(X*=$)*W,I.vx-=U*(W=1-W),I.vy-=X*W)}return}return D>A+W||F<A-W||N>_+W||z<_-W}}function a(f){if(f.data)return f.r=t[f.data.index];for(var p=f.r=0;p<4;++p)f[p]&&f[p].r>f.r&&(f.r=f[p].r)}function u(){if(e){var f,p=e.length,g;for(t=new Array(p),f=0;f<p;++f)g=e[f],t[g.index]=+n(g,f,e)}}return o.initialize=function(f,p){e=f,r=p,u()},o.iterations=function(f){return arguments.length?(s=+f,o):s},o.strength=function(f){return arguments.length?(i=+f,o):i},o.radius=function(f){return arguments.length?(n=typeof f=="function"?f:wr(+f),u(),o):n},o}function $Q(n){return n.index}function vk(n,e){var t=n.get(e);if(!t)throw new Error("node not found: "+e);return t}function Ud(n){var e=$Q,t=g,r,i=wr(30),s,o,a,u,f,p=1;n==null&&(n=[]);function g(w){return 1/Math.min(a[w.source.index],a[w.target.index])}function x(w){for(var C=0,T=n.length;C<p;++C)for(var E=0,D,N,F,z,I,K,W;E<T;++E)D=n[E],N=D.source,F=D.target,z=F.x+F.vx-N.x-N.vx||Ko(f),I=F.y+F.vy-N.y-N.vy||Ko(f),K=Math.sqrt(z*z+I*I),K=(K-s[E])/K*w*r[E],z*=K,I*=K,F.vx-=z*(W=u[E]),F.vy-=I*W,N.vx+=z*(W=1-W),N.vy+=I*W}function A(){if(o){var w,C=o.length,T=n.length,E=new Map(o.map((N,F)=>[e(N,F,o),N])),D;for(w=0,a=new Array(C);w<T;++w)D=n[w],D.index=w,typeof D.source!="object"&&(D.source=vk(E,D.source)),typeof D.target!="object"&&(D.target=vk(E,D.target)),a[D.source.index]=(a[D.source.index]||0)+1,a[D.target.index]=(a[D.target.index]||0)+1;for(w=0,u=new Array(T);w<T;++w)D=n[w],u[w]=a[D.source.index]/(a[D.source.index]+a[D.target.index]);r=new Array(T),_(),s=new Array(T),b()}}function _(){if(o)for(var w=0,C=n.length;w<C;++w)r[w]=+t(n[w],w,n)}function b(){if(o)for(var w=0,C=n.length;w<C;++w)s[w]=+i(n[w],w,n)}return x.initialize=function(w,C){o=w,f=C,A()},x.links=function(w){return arguments.length?(n=w,A(),x):n},x.id=function(w){return arguments.length?(e=w,x):e},x.iterations=function(w){return arguments.length?(p=+w,x):p},x.strength=function(w){return arguments.length?(t=typeof w=="function"?w:wr(+w),_(),x):t},x.distance=function(w){return arguments.length?(i=typeof w=="function"?w:wr(+w),b(),x):i},x}var UQ={value:()=>{}};function YE(){for(var n=0,e=arguments.length,t={},r;n<e;++n){if(!(r=arguments[n]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new Z0(t)}function Z0(n){this._=n}function ZQ(n,e){return n.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");if(i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}Z0.prototype=YE.prototype={constructor:Z0,on:function(n,e){var t=this._,r=ZQ(n+"",t),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(n=r[s]).type)&&(i=GQ(t[i],n.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(n=r[s]).type)t[i]=Ak(t[i],n.name,e);else if(e==null)for(i in t)t[i]=Ak(t[i],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new Z0(n)},call:function(n,e){if((i=arguments.length-2)>0)for(var t=new Array(i),r=0,i,s;r<i;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(s=this._[n],r=0,i=s.length;r<i;++r)s[r].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,s=r.length;i<s;++i)r[i].value.apply(e,t)}};function GQ(n,e){for(var t=0,r=n.length,i;t<r;++t)if((i=n[t]).name===e)return i.value}function Ak(n,e,t){for(var r=0,i=n.length;r<i;++r)if(n[r].name===e){n[r]=UQ,n=n.slice(0,r).concat(n.slice(r+1));break}return t!=null&&n.push({name:e,value:t}),n}var Bc=0,th=0,Gu=0,JE=1e3,Mp,nh,Np=0,cl=0,vm=0,Mh=typeof performance=="object"&&performance.now?performance:Date,eP=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function tP(){return cl||(eP(XQ),cl=Mh.now()+vm)}function XQ(){cl=0}function iv(){this._call=this._time=this._next=null}iv.prototype=nP.prototype={constructor:iv,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?tP():+t)+(e==null?0:+e),!this._next&&nh!==this&&(nh?nh._next=this:Mp=this,nh=this),this._call=n,this._time=t,sv()},stop:function(){this._call&&(this._call=null,this._time=1/0,sv())}};function nP(n,e,t){var r=new iv;return r.restart(n,e,t),r}function KQ(){tP(),++Bc;for(var n=Mp,e;n;)(e=cl-n._time)>=0&&n._call.call(void 0,e),n=n._next;--Bc}function bk(){cl=(Np=Mh.now())+vm,Bc=th=0;try{KQ()}finally{Bc=0,JQ(),cl=0}}function YQ(){var n=Mh.now(),e=n-Np;e>JE&&(vm-=e,Np=n)}function JQ(){for(var n,e=Mp,t,r=1/0;e;)e._call?(r>e._time&&(r=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:Mp=t);nh=n,sv(r)}function sv(n){if(!Bc){th&&(th=clearTimeout(th));var e=n-cl;e>24?(n<1/0&&(th=setTimeout(bk,n-Mh.now()-vm)),Gu&&(Gu=clearInterval(Gu))):(Gu||(Np=Mh.now(),Gu=setInterval(YQ,JE)),Bc=1,eP(bk))}}const e7=1664525,t7=1013904223,wk=4294967296;function n7(){let n=1;return()=>(n=(e7*n+t7)%wk)/wk}function r7(n){return n.x}function i7(n){return n.y}var s7=10,o7=Math.PI*(3-Math.sqrt(5));function a7(n){var e,t=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,a=new Map,u=nP(g),f=YE("tick","end"),p=n7();n==null&&(n=[]);function g(){x(),f.call("tick",e),t<r&&(u.stop(),f.call("end",e))}function x(b){var w,C=n.length,T;b===void 0&&(b=1);for(var E=0;E<b;++E)for(t+=(s-t)*i,a.forEach(function(D){D(t)}),w=0;w<C;++w)T=n[w],T.fx==null?T.x+=T.vx*=o:(T.x=T.fx,T.vx=0),T.fy==null?T.y+=T.vy*=o:(T.y=T.fy,T.vy=0);return e}function A(){for(var b=0,w=n.length,C;b<w;++b){if(C=n[b],C.index=b,C.fx!=null&&(C.x=C.fx),C.fy!=null&&(C.y=C.fy),isNaN(C.x)||isNaN(C.y)){var T=s7*Math.sqrt(.5+b),E=b*o7;C.x=T*Math.cos(E),C.y=T*Math.sin(E)}(isNaN(C.vx)||isNaN(C.vy))&&(C.vx=C.vy=0)}}function _(b){return b.initialize&&b.initialize(n,p),b}return A(),e={tick:x,restart:function(){return u.restart(g),e},stop:function(){return u.stop(),e},nodes:function(b){return arguments.length?(n=b,A(),a.forEach(_),e):n},alpha:function(b){return arguments.length?(t=+b,e):t},alphaMin:function(b){return arguments.length?(r=+b,e):r},alphaDecay:function(b){return arguments.length?(i=+b,e):+i},alphaTarget:function(b){return arguments.length?(s=+b,e):s},velocityDecay:function(b){return arguments.length?(o=1-b,e):1-o},randomSource:function(b){return arguments.length?(p=b,a.forEach(_),e):p},force:function(b,w){return arguments.length>1?(w==null?a.delete(b):a.set(b,_(w)),e):a.get(b)},find:function(b,w,C){var T=0,E=n.length,D,N,F,z,I;for(C==null?C=1/0:C*=C,T=0;T<E;++T)z=n[T],D=b-z.x,N=w-z.y,F=D*D+N*N,F<C&&(I=z,C=F);return I},on:function(b,w){return arguments.length>1?(f.on(b,w),e):f.on(b)}}}function Zd(){var n,e,t,r,i=wr(-30),s,o=1,a=1/0,u=.81;function f(A){var _,b=n.length,w=PA(n,r7,i7).visitAfter(g);for(r=A,_=0;_<b;++_)e=n[_],w.visit(x)}function p(){if(n){var A,_=n.length,b;for(s=new Array(_),A=0;A<_;++A)b=n[A],s[b.index]=+i(b,A,n)}}function g(A){var _=0,b,w,C=0,T,E,D;if(A.length){for(T=E=D=0;D<4;++D)(b=A[D])&&(w=Math.abs(b.value))&&(_+=b.value,C+=w,T+=w*b.x,E+=w*b.y);A.x=T/C,A.y=E/C}else{b=A,b.x=b.data.x,b.y=b.data.y;do _+=s[b.data.index];while(b=b.next)}A.value=_}function x(A,_,b,w){if(!A.value)return!0;var C=A.x-e.x,T=A.y-e.y,E=w-_,D=C*C+T*T;if(E*E/u<D)return D<a&&(C===0&&(C=Ko(t),D+=C*C),T===0&&(T=Ko(t),D+=T*T),D<o&&(D=Math.sqrt(o*D)),e.vx+=C*A.value*r/D,e.vy+=T*A.value*r/D),!0;if(A.length||D>=a)return;(A.data!==e||A.next)&&(C===0&&(C=Ko(t),D+=C*C),T===0&&(T=Ko(t),D+=T*T),D<o&&(D=Math.sqrt(o*D)));do A.data!==e&&(E=s[A.data.index]*r/D,e.vx+=C*E,e.vy+=T*E);while(A=A.next)}return f.initialize=function(A,_){n=A,t=_,p()},f.strength=function(A){return arguments.length?(i=typeof A=="function"?A:wr(+A),p(),f):i},f.distanceMin=function(A){return arguments.length?(o=A*A,f):Math.sqrt(o)},f.distanceMax=function(A){return arguments.length?(a=A*A,f):Math.sqrt(a)},f.theta=function(A){return arguments.length?(u=A*A,f):Math.sqrt(u)},f}function _k(n){var e=wr(.1),t,r,i;typeof n!="function"&&(n=wr(n==null?0:+n));function s(a){for(var u=0,f=t.length,p;u<f;++u)p=t[u],p.vx+=(i[u]-p.x)*r[u]*a}function o(){if(t){var a,u=t.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+n(t[a],a,t))?0:+e(t[a],a,t)}}return s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:wr(+a),o(),s):e},s.x=function(a){return arguments.length?(n=typeof a=="function"?a:wr(+a),o(),s):n},s}function Ok(n){var e=wr(.1),t,r,i;typeof n!="function"&&(n=wr(n==null?0:+n));function s(a){for(var u=0,f=t.length,p;u<f;++u)p=t[u],p.vy+=(i[u]-p.y)*r[u]*a}function o(){if(t){var a,u=t.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+n(t[a],a,t))?0:+e(t[a],a,t)}}return s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:wr(+a),o(),s):e},s.y=function(a){return arguments.length?(n=typeof a=="function"?a:wr(+a),o(),s):n},s}const Nn={background:"#0a0a0a",link:"#4b5563",ambiguous:"#9ca3af",particleAD:"#f59e0b",particleGT:"#06b6d4",particleDM:"#8b5cf6",particleACK:"#22c55e",particleTR:"#f97316",particleRQ:"#ec4899",particleRS:"#14b8a6",particleUnknown:"#6b7280"},l7={AD:Nn.particleAD,GT:Nn.particleGT,DM:Nn.particleDM,ACK:Nn.particleACK,TR:Nn.particleTR,RQ:Nn.particleRQ,RS:Nn.particleRS,"?":Nn.particleUnknown},c7=.008,u7=15,h7=2880*60*1e3,f7=20,kk=200,rP=1800*1e3,d7=[{emoji:"",label:"You",size:"text-xl"},{emoji:"",label:"Repeater",size:"text-base"},{emoji:"",label:"Node",size:"text-base"},{emoji:"",label:"Unknown",size:"text-base"}],p7=[{label:"AD",color:Nn.particleAD,description:"Advertisement"},{label:"GT",color:Nn.particleGT,description:"Group Text"},{label:"DM",color:Nn.particleDM,description:"Direct Message"},{label:"ACK",color:Nn.particleACK,description:"Acknowledgment"},{label:"TR",color:Nn.particleTR,description:"Trace"},{label:"RQ",color:Nn.particleRQ,description:"Request"},{label:"RS",color:Nn.particleRS,description:"Response"},{label:"?",color:Nn.particleUnknown,description:"Other"}];function m7(n){let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t),e=e&e;return Math.abs(e).toString(16).padStart(8,"0")}function g7(n){var e;try{const t=Pt.MeshCoreDecoder.decode(n);if(!t.isValid)return null;const r={payloadType:t.payloadType,pathBytes:t.path||[],srcHash:null,dstHash:null,advertPubkey:null,groupTextSender:null,anonRequestPubkey:null};if(t.payloadType===Pt.PayloadType.TextMessage&&t.payload.decoded){const i=t.payload.decoded;r.srcHash=i.sourceHash||null,r.dstHash=i.destinationHash||null}else if(t.payloadType===Pt.PayloadType.Advert&&t.payload.decoded)r.advertPubkey=t.payload.decoded.publicKey||null;else if(t.payloadType===Pt.PayloadType.GroupText&&t.payload.decoded){const i=t.payload.decoded;r.groupTextSender=((e=i.decrypted)==null?void 0:e.sender)||null}else if(t.payloadType===Pt.PayloadType.AnonRequest&&t.payload.decoded){const i=t.payload.decoded;r.anonRequestPubkey=i.senderPublicKey||null}return r}catch{return null}}function x7(n){switch(n){case Pt.PayloadType.Advert:return"AD";case Pt.PayloadType.GroupText:return"GT";case Pt.PayloadType.TextMessage:return"DM";case Pt.PayloadType.Ack:return"ACK";case Pt.PayloadType.Trace:return"TR";case Pt.PayloadType.Request:case Pt.PayloadType.AnonRequest:return"RQ";case Pt.PayloadType.Response:return"RS";default:return"?"}}function y7(n,e){var r,i;const t=m7(e.data).slice(0,8);if(n.payloadType===Pt.PayloadType.Advert&&n.advertPubkey)return`ad:${n.advertPubkey.slice(0,12)}`;if(n.payloadType===Pt.PayloadType.GroupText){const s=n.groupTextSender||((r=e.decrypted_info)==null?void 0:r.sender)||"?";return`gt:${((i=e.decrypted_info)==null?void 0:i.channel_name)||"?"}:${s}:${t}`}return n.payloadType===Pt.PayloadType.TextMessage?`dm:${n.srcHash||"?"}:${n.dstHash||"?"}:${t}`:n.payloadType===Pt.PayloadType.AnonRequest&&n.anonRequestPubkey?`rq:${n.anonRequestPubkey.slice(0,12)}:${t}`:`other:${t}`}function iP(n){return{sourceId:typeof n.source=="string"?n.source:n.source.id,targetId:typeof n.target=="string"?n.target:n.target.id}}function v7(n,e){const t=n.toLowerCase(),r=e.filter(i=>i.public_key.toLowerCase().startsWith(t));return r.length===1?r[0]:null}function A7(n,e){const t=n.toLowerCase();return e.filter(r=>r.public_key.toLowerCase().startsWith(t))}function b7(n,e){return e.find(t=>t.name===n)||null}function Gd(n){return(n==null?void 0:n.type)===vc?"repeater":"client"}function Sk(n){return n.filter((e,t)=>t===0||e!==n[t-1])}function w7(n){const e=Date.now(),t=n.observations.filter(s=>e-s.timestamp<rP),r=new Map;for(const s of t){const o=s.nextHop??"self";r.has(o)||r.set(o,new Set),r.get(o).add(s.source)}if(r.size<=1)return{shouldSplit:!1,disjointGroups:null};const i=new Map;for(const[s,o]of r)for(const a of o)i.has(a)||i.set(a,[]),i.get(a).push(s);for(const[,s]of i)if(s.length>1)return{shouldSplit:!1,disjointGroups:null};for(const[,s]of r)if(s.size<f7)return{shouldSplit:!1,disjointGroups:null};return{shouldSplit:!0,disjointGroups:r}}function _7(n,e,t,r){const i=e.toLowerCase(),s=Date.now();n.has(i)||n.set(i,{prefix:i,observations:[]});const o=n.get(i);o.observations.push({source:t,nextHop:r,timestamp:s}),o.observations=o.observations.filter(a=>s-a.timestamp<rP),o.observations.length>kk&&(o.observations=o.observations.slice(-kk))}function O7({packets:n,contacts:e,config:t,showAmbiguousPaths:r,showAmbiguousNodes:i,splitAmbiguousByTraffic:s,chargeStrength:o,letEmDrift:a,particleSpeedMultiplier:u,observationWindowSec:f,dimensions:p}){const g=R.useRef(new Map),x=R.useRef(new Map),A=R.useRef([]),_=R.useRef(null),b=R.useRef(new Set),w=R.useRef(new Map),C=R.useRef(new Map),T=R.useRef(new Map),E=R.useRef(u),D=R.useRef(f*1e3),[N,F]=R.useState({processed:0,animated:0,nodes:0,links:0});R.useEffect(()=>{E.current=u},[u]),R.useEffect(()=>{D.current=f*1e3},[f]),R.useEffect(()=>{const Z=a7([]).force("link",Ud([]).id(ie=>ie.id).distance(80).strength(.3)).force("charge",Zd().strength(ie=>ie.id==="self"?-1200:-200).distanceMax(500)).force("center",xk(p.width/2,p.height/2)).force("collide",VQ(40)).force("selfX",_k(p.width/2).strength(ie=>ie.id==="self"?.1:0)).force("selfY",Ok(p.height/2).strength(ie=>ie.id==="self"?.1:0)).alphaDecay(.02).velocityDecay(.5).alphaTarget(.03);return _.current=Z,()=>{Z.stop()}},[]),R.useEffect(()=>{const Z=_.current;Z&&(Z.force("center",xk(p.width/2,p.height/2)),Z.force("selfX",_k(p.width/2).strength(ie=>ie.id==="self"?.1:0)),Z.force("selfY",Ok(p.height/2).strength(ie=>ie.id==="self"?.1:0)),Z.force("charge",Zd().strength(ie=>ie.id==="self"?o*6:o).distanceMax(500)),Z.alpha(.3).restart())},[p,o]),R.useEffect(()=>{const Z=_.current;Z&&Z.alphaTarget(a?.05:0)},[a]),R.useEffect(()=>{g.current.has("self")||(g.current.set("self",{id:"self",name:(t==null?void 0:t.name)||"Me",type:"self",isAmbiguous:!1,lastActivity:Date.now(),x:p.width/2,y:p.height/2}),z())},[t,p]),R.useEffect(()=>{b.current.clear();const Z=g.current.get("self");g.current.clear(),Z&&g.current.set("self",Z),x.current.clear(),A.current=[],w.current.clear(),C.current.forEach(ie=>clearTimeout(ie)),C.current.clear(),T.current.clear(),F({processed:0,animated:0,nodes:Z?1:0,links:0})},[r,i,s]);const z=R.useCallback(()=>{const Z=_.current;if(!Z)return;const ie=Array.from(g.current.values()),V=Array.from(x.current.values());Z.nodes(ie);const ne=Z.force("link");ne==null||ne.links(V),Z.alpha(.15).restart(),F(q=>({...q,nodes:ie.length,links:V.length}))},[]),I=R.useCallback((Z,ie,V,ne,q,B)=>{const Q=g.current.get(Z);if(Q)Q.lastActivity=Date.now(),ie&&!Q.name&&(Q.name=ie),q&&(Q.ambiguousNames=q),B!==void 0&&(Q.lastSeen=B);else{const G=g.current.get("self");g.current.set(Z,{id:Z,name:ie,type:V,isAmbiguous:ne,lastActivity:Date.now(),lastSeen:B,ambiguousNames:q,x:((G==null?void 0:G.x)??400)+(Math.random()-.5)*100,y:((G==null?void 0:G.y)??300)+(Math.random()-.5)*100})}},[]),K=R.useCallback((Z,ie)=>{const V=[Z,ie].sort().join("->"),ne=x.current.get(V);ne?ne.lastActivity=Date.now():x.current.set(V,{source:Z,target:ie,lastActivity:Date.now()})},[]),W=R.useCallback(Z=>{const ie=w.current.get(Z);if(ie){w.current.delete(Z),C.current.delete(Z);for(const V of ie.paths){const ne=Sk(V.nodes);if(!(ne.length<2))for(let q=0;q<ne.length-1;q++)A.current.push({linkKey:[ne[q],ne[q+1]].sort().join("->"),progress:-q,speed:c7*E.current,color:l7[ie.label],label:ie.label,fromNodeId:ne[q],toNodeId:ne[q+1]})}}},[]),U=R.useCallback((Z,ie,V,ne,q)=>{if(Z.type==="pubkey"){if(Z.value.length<12)return null;const Q=Z.value.slice(0,12).toLowerCase();if(ne&&Q===ne)return"self";const G=e.find(Y=>Y.public_key.toLowerCase().startsWith(Q));return I(Q,(G==null?void 0:G.name)||null,Gd(G),!1,void 0,G==null?void 0:G.last_seen),Q}if(Z.type==="name"){const Q=b7(Z.value,e);if(Q){const Y=Q.public_key.slice(0,12).toLowerCase();return ne&&Y===ne?"self":(I(Y,Q.name,Gd(Q),!1,void 0,Q.last_seen),Y)}const G=`name:${Z.value}`;return I(G,Z.value,"client",!1),G}const B=v7(Z.value,e);if(B){const Q=B.public_key.slice(0,12).toLowerCase();return ne&&Q===ne?"self":(I(Q,B.name,Gd(B),!1,void 0,B.last_seen),Q)}if(V){const Q=A7(Z.value,e),G=ie?Q.filter(Y=>Y.type===vc):Q.filter(Y=>Y.type!==vc);if(G.length===1){const Y=G[0],ue=Y.public_key.slice(0,12).toLowerCase();return I(ue,Y.name,Gd(Y),!1,void 0,Y.last_seen),ue}if(G.length>1||G.length===0&&ie){const Y=G.map(xe=>xe.name||xe.public_key.slice(0,8)),ue=G.reduce((xe,ye)=>ye.last_seen&&(!xe||ye.last_seen>xe)?ye.last_seen:xe,null);let pe=`?${Z.value.toLowerCase()}`,ve=Z.value.toUpperCase();if(s&&ie&&q){const xe=Z.value.toLowerCase();q.packetSource&&_7(T.current,xe,q.packetSource,q.nextPrefix);const ye=T.current.get(xe);if(ye&&w7(ye).shouldSplit&&q.nextPrefix){const Ke=q.nextPrefix.slice(0,2).toLowerCase();pe=`?${xe}:>${Ke}`,ve=`${Z.value.toUpperCase()}:>${Ke}`}}return I(pe,ve,ie?"repeater":"client",!0,Y.length>0?Y:void 0,ue),pe}}return null},[e,I,s]),X=R.useCallback((Z,ie,V)=>{var B;const ne=[];let q=null;if(Z.payloadType===Pt.PayloadType.Advert&&Z.advertPubkey){const Q=U({type:"pubkey",value:Z.advertPubkey},!1,!1,V);Q&&(ne.push(Q),q=Q)}else if(Z.payloadType===Pt.PayloadType.AnonRequest&&Z.anonRequestPubkey){const Q=U({type:"pubkey",value:Z.anonRequestPubkey},!1,!1,V);Q&&(ne.push(Q),q=Q)}else if(Z.payloadType===Pt.PayloadType.TextMessage&&Z.srcHash)if(V&&Z.srcHash.toLowerCase()===V)ne.push("self"),q="self";else{const Q=U({type:"prefix",value:Z.srcHash},!1,i,V);Q&&(ne.push(Q),q=Q)}else if(Z.payloadType===Pt.PayloadType.GroupText){const Q=Z.groupTextSender||((B=ie.decrypted_info)==null?void 0:B.sender);if(Q){const G=U({type:"name",value:Q},!1,!1,V);G&&(ne.push(G),q=G)}}for(let Q=0;Q<Z.pathBytes.length;Q++){const G=Z.pathBytes[Q],Y=Z.pathBytes[Q+1]||null,ue=U({type:"prefix",value:G},!0,r,V,{packetSource:q,nextPrefix:Y});ue&&ne.push(ue)}if(Z.payloadType===Pt.PayloadType.TextMessage&&Z.dstHash)if(V&&Z.dstHash.toLowerCase()===V)ne.push("self");else{const Q=U({type:"prefix",value:Z.dstHash},!1,i,V);Q?ne.push(Q):ne.push("self")}else ne.length>0&&ne.push("self");return ne.length>0&&ne[ne.length-1]!=="self"&&ne.push("self"),Sk(ne)},[U,r,i]);R.useEffect(()=>{var q;let Z=0,ie=0,V=!1;const ne=((q=t==null?void 0:t.public_key)==null?void 0:q.slice(0,12).toLowerCase())||null;for(const B of n){if(b.current.has(B.id))continue;b.current.add(B.id),Z++,b.current.size>1e3&&(b.current=new Set(Array.from(b.current).slice(-500)));const Q=g7(B.data);if(!Q)continue;const G=X(Q,B,ne);if(G.length<2)continue;for(let ve=0;ve<G.length-1;ve++)G[ve]!==G[ve+1]&&(K(G[ve],G[ve+1]),V=!0);const Y=y7(Q,B),ue=Date.now(),pe=w.current.get(Y);if(pe&&ue<pe.expiresAt)pe.paths.push({nodes:G,snr:B.snr??null,timestamp:ue});else{C.current.has(Y)&&clearTimeout(C.current.get(Y));const ve=D.current;w.current.set(Y,{key:Y,label:x7(Q.payloadType),paths:[{nodes:G,snr:B.snr??null,timestamp:ue}],firstSeen:ue,expiresAt:ue+ve}),C.current.set(Y,setTimeout(()=>W(Y),ve))}if(w.current.size>100){const ve=Array.from(w.current.entries()).sort((xe,ye)=>xe[1].firstSeen-ye[1].firstSeen).slice(0,50);for(const[xe]of ve)clearTimeout(C.current.get(xe)),C.current.delete(xe),w.current.delete(xe)}ie++}V&&z(),Z>0&&F(B=>({...B,processed:B.processed+Z,animated:B.animated+ie}))},[n,t,X,K,z,W]);const $=R.useCallback(()=>{const Z=_.current;if(!Z)return;const ie=p.width/2,V=p.height/2,ne=Math.min(p.width,p.height)*.4;for(const q of g.current.values()){if(q.id==="self")q.x=ie,q.y=V;else{const B=Math.random()*2*Math.PI,Q=Math.random()*ne;q.x=ie+Q*Math.cos(B),q.y=V+Q*Math.sin(B)}q.vx=0,q.vy=0}Z.alpha(1).restart()},[p]),ee=R.useCallback(()=>{const Z=_.current;if(!Z)return;const ie=o,V=-5e3,ne=.3,q=.02,B=1e3,Q=2e3,G=1e3,Y=performance.now(),ue=pe=>{const ve=pe-Y;let xe,ye;if(ve<B){const Pe=ve/B;xe=ie+(V-ie)*Pe,ye=ne+(q-ne)*Pe}else if(ve<B+Q)xe=V,ye=q;else if(ve<B+Q+G){const Pe=(ve-B-Q)/G;xe=V+(ie-V)*Pe,ye=q+(ne-q)*Pe}else{Z.force("charge",Zd().strength(Pe=>Pe.id==="self"?ie*6:ie).distanceMax(500)),Z.force("link",Ud(Array.from(x.current.values())).id(Pe=>Pe.id).distance(80).strength(ne)),Z.alpha(.3).restart();return}Z.force("charge",Zd().strength(Pe=>Pe.id==="self"?xe*6:xe).distanceMax(500)),Z.force("link",Ud(Array.from(x.current.values())).id(Pe=>Pe.id).distance(80).strength(ye)),Z.alpha(.5).restart(),requestAnimationFrame(ue)};requestAnimationFrame(ue)},[o]),le=R.useCallback(()=>{for(const V of C.current.values())clearTimeout(V);C.current.clear(),w.current.clear(),b.current.clear(),T.current.clear(),A.current.length=0,x.current.clear();const Z=g.current.get("self");g.current.clear(),Z&&(Z.x=p.width/2,Z.y=p.height/2,Z.vx=0,Z.vy=0,Z.lastActivity=Date.now(),g.current.set("self",Z));const ie=_.current;ie&&(ie.nodes(Array.from(g.current.values())),ie.force("link",Ud([]).id(V=>V.id).distance(80).strength(.3)),ie.alpha(.3).restart()),F({processed:0,animated:0,nodes:1,links:0})},[p]);return{nodes:g.current,links:x.current,particles:A.current,simulation:_.current,stats:N,randomizePositions:$,expandContract:ee,clearAndReset:le}}function k7(n,e,t){n.strokeStyle=Nn.link,n.lineWidth=2;for(const r of e){const{sourceId:i,targetId:s}=iP(r),o=t.get(i),a=t.get(s);(o==null?void 0:o.x)!=null&&(o==null?void 0:o.y)!=null&&(a==null?void 0:a.x)!=null&&(a==null?void 0:a.y)!=null&&(n.beginPath(),n.moveTo(o.x,o.y),n.lineTo(a.x,a.y),n.stroke())}}function S7(n,e,t,r){const i=[];for(const s of e){const o=t.get(s.fromNodeId),a=t.get(s.toNodeId),u=r.has(s.fromNodeId)&&r.has(s.toNodeId);if(s.progress+=s.speed,s.progress>1||(i.push(s),!u||!(o!=null&&o.x)||!(a!=null&&a.x)||o.y==null||a.y==null)||s.progress<0)continue;const f=s.progress,p=o.x+(a.x-o.x)*f,g=o.y+(a.y-o.y)*f;n.fillStyle=s.color+"40",n.beginPath(),n.arc(p,g,14,0,Math.PI*2),n.fill(),n.fillStyle=s.color,n.beginPath(),n.arc(p,g,10,0,Math.PI*2),n.fill(),n.fillStyle="#ffffff",n.font="bold 8px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillText(s.label,p,g)}return i}function C7(n,e,t){var r;for(const i of e){if(i.x==null||i.y==null)continue;const s=i.type==="self"?"":i.type==="repeater"?"":i.isAmbiguous?"":"",o=i.type==="self"?36:18;n.font=`${o}px sans-serif`,n.textAlign="center",n.textBaseline="middle",n.fillText(s,i.x,i.y);const a=i.isAmbiguous?i.id:i.name||(i.type==="self"?"Me":i.id.slice(0,8));if(n.font="11px sans-serif",n.textBaseline="top",n.fillStyle=i.isAmbiguous?Nn.ambiguous:"#e5e7eb",n.fillText(a,i.x,i.y+o/2+4),i.isAmbiguous&&((r=i.ambiguousNames)!=null&&r.length)){n.font="9px sans-serif",n.fillStyle="#6b7280";let u=i.y+o/2+18;if(t===i.id)for(const f of i.ambiguousNames)n.fillText(f,i.x,u),u+=11;else i.ambiguousNames.length===1?n.fillText(i.ambiguousNames[0],i.x,u):n.fillText(`${i.ambiguousNames[0]} +${i.ambiguousNames.length-1} more`,i.x,u)}}}function Ck({packets:n,contacts:e,config:t,fullScreen:r,onFullScreenChange:i,onClearPackets:s}){const o=R.useRef(null),a=R.useRef(null),[u,f]=R.useState({width:800,height:600}),[p,g]=R.useState(!0),[x,A]=R.useState(!1),[_,b]=R.useState(!1),[w,C]=R.useState(-200),[T,E]=R.useState(!1),[D,N]=R.useState(u7),[F,z]=R.useState(!0),[I,K]=R.useState(2),[W,U]=R.useState(!1),[X,$]=R.useState({x:0,y:0,scale:1}),ee=R.useRef(!1),le=R.useRef({x:0,y:0}),Z=R.useRef(null),[ie,V]=R.useState(null),ne=O7({packets:n,contacts:e,config:t,showAmbiguousPaths:p,showAmbiguousNodes:x,splitAmbiguousByTraffic:_,chargeStrength:w,letEmDrift:F,particleSpeedMultiplier:I,observationWindowSec:D,dimensions:u});R.useEffect(()=>{const ye=()=>{if(a.current){const Ke=a.current.getBoundingClientRect();f({width:Ke.width,height:Ke.height})}};ye();const Pe=new ResizeObserver(ye);return a.current&&Pe.observe(a.current),()=>Pe.disconnect()},[]);const q=R.useCallback(()=>{const ye=o.current,Pe=ye==null?void 0:ye.getContext("2d");if(!ye||!Pe)return;const{width:Ke,height:nt}=u,Ce=window.devicePixelRatio||1;ye.width=Ke*Ce,ye.height=nt*Ce,ye.style.width=`${Ke}px`,ye.style.height=`${nt}px`,Pe.scale(Ce,Ce),Pe.fillStyle=Nn.background,Pe.fillRect(0,0,Ke,nt),Pe.save(),Pe.translate(Ke/2,nt/2),Pe.scale(X.scale,X.scale),Pe.translate(X.x-Ke/2,X.y-nt/2);const Ge=Date.now(),pt=Array.from(ne.nodes.values()),bt=new Set,ot=pt.filter(tt=>{if(tt.type==="self"||tt.type==="client")return bt.add(tt.id),!0;if(T&&tt.type==="repeater"){const at=tt.lastSeen?tt.lastSeen*1e3:tt.lastActivity;if(Ge-at>h7)return!1}return bt.add(tt.id),!0}),et=Array.from(ne.links.values()).filter(tt=>{const{sourceId:at,targetId:qe}=iP(tt);return bt.has(at)&&bt.has(qe)});k7(Pe,et,ne.nodes),ne.particles.splice(0,ne.particles.length,...S7(Pe,ne.particles,ne.nodes,bt)),C7(Pe,ot,ie),Pe.restore()},[u,X,ne,ie,T]);R.useEffect(()=>{let ye=!0;const Pe=()=>{ye&&(q(),requestAnimationFrame(Pe))};return Pe(),()=>{ye=!1}},[q]);const B=R.useCallback((ye,Pe)=>{const{width:Ke,height:nt}=u,Ce=(ye-Ke/2)/X.scale-X.x+Ke/2,Ge=(Pe-nt/2)/X.scale-X.y+nt/2;return{x:Ce,y:Ge}},[u,X]),Q=R.useCallback((ye,Pe)=>{for(const Ke of ne.nodes.values())if(!(Ke.x==null||Ke.y==null)&&Math.hypot(ye-Ke.x,Pe-Ke.y)<20)return Ke;return null},[ne.nodes]),G=R.useCallback(ye=>{var Ge;const Pe=o.current;if(!Pe)return;const Ke=Pe.getBoundingClientRect(),nt=B(ye.clientX-Ke.left,ye.clientY-Ke.top),Ce=Q(nt.x,nt.y);Ce?(Z.current=Ce,Ce.fx=Ce.x,Ce.fy=Ce.y,(Ge=ne.simulation)==null||Ge.alpha(.3).restart()):ee.current=!0,le.current={x:ye.clientX,y:ye.clientY}},[B,Q,ne.simulation]),Y=R.useCallback(ye=>{var pt;const Pe=o.current;if(!Pe)return;const Ke=Pe.getBoundingClientRect(),nt=B(ye.clientX-Ke.left,ye.clientY-Ke.top);if(V(((pt=Q(nt.x,nt.y))==null?void 0:pt.id)||null),Z.current){Z.current.fx=nt.x,Z.current.fy=nt.y;return}if(!ee.current)return;const Ce=ye.clientX-le.current.x,Ge=ye.clientY-le.current.y;le.current={x:ye.clientX,y:ye.clientY},$(bt=>({...bt,x:bt.x+Ce/bt.scale,y:bt.y+Ge/bt.scale}))},[B,Q]),ue=R.useCallback(()=>{Z.current&&(Z.current.fx=null,Z.current.fy=null,Z.current=null),ee.current=!1},[]),pe=R.useCallback(()=>{Z.current&&(Z.current.fx=null,Z.current.fy=null,Z.current=null),ee.current=!1,V(null)},[]),ve=R.useCallback(ye=>{ye.preventDefault();const Pe=ye.deltaY>0?1/1.1:1.1;$(Ke=>({...Ke,scale:Math.min(Math.max(Ke.scale*Pe,.1),5)}))},[]);R.useEffect(()=>{const ye=o.current;if(ye)return ye.addEventListener("wheel",ve,{passive:!1}),()=>ye.removeEventListener("wheel",ve)},[ve]);const xe=()=>Z.current?"grabbing":ie?"pointer":"grab";return S.jsxs("div",{ref:a,className:"w-full h-full bg-background relative overflow-hidden",children:[S.jsx("canvas",{ref:o,className:"w-full h-full",style:{display:"block",cursor:xe()},onMouseDown:G,onMouseMove:Y,onMouseUp:ue,onMouseLeave:pe}),!W&&S.jsx("div",{className:"absolute bottom-4 left-4 bg-background/80 backdrop-blur-sm rounded-lg p-3 text-xs border border-border",children:S.jsxs("div",{className:"flex gap-6",children:[S.jsxs("div",{className:"flex flex-col gap-1.5",children:[S.jsx("div",{className:"text-muted-foreground font-medium mb-1",children:"Nodes"}),d7.map(ye=>S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:ye.size,children:ye.emoji}),S.jsx("span",{children:ye.label})]},ye.label))]}),S.jsxs("div",{className:"flex flex-col gap-1.5",children:[S.jsx("div",{className:"text-muted-foreground font-medium mb-1",children:"Packets"}),p7.map(ye=>S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-[8px] font-bold text-white",style:{backgroundColor:ye.color},children:ye.label}),S.jsx("span",{children:ye.description})]},ye.label))]})]})}),S.jsx("div",{className:"absolute top-4 right-4 bg-background/80 backdrop-blur-sm rounded-lg p-3 text-xs border border-border",children:S.jsxs("div",{className:"flex flex-col gap-2",children:[!W&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{children:["Nodes: ",ne.stats.nodes]}),S.jsxs("div",{children:["Links: ",ne.stats.links]}),S.jsxs("div",{className:"border-t border-border pt-2 mt-1 flex flex-col gap-2",children:[S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:p,onCheckedChange:ye=>g(ye===!0)}),S.jsx("span",{title:"Show placeholder nodes for repeaters when the 1-byte prefix matches multiple contacts",children:"Ambiguous repeaters"})]}),S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:x,onCheckedChange:ye=>A(ye===!0)}),S.jsx("span",{title:"Show placeholder nodes for senders/recipients when only a 1-byte prefix is known",children:"Ambiguous sender/recipient"})]}),S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:_,onCheckedChange:ye=>b(ye===!0),disabled:!p}),S.jsx("span",{title:"Split ambiguous repeaters into separate nodes based on traffic patterns (prevnext). Helps identify colliding prefixes representing different physical nodes.",className:p?"":"text-muted-foreground",children:"Hueristically group repeaters by traffic pattern"})]}),S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:T,onCheckedChange:ye=>E(ye===!0)}),S.jsx("span",{title:"Hide repeaters not heard within the last 48 hours",children:"Hide repeaters >48hrs heard"})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("label",{className:"text-muted-foreground",title:"How long to wait for duplicate packets via different paths before animating",children:"Observation window:"}),S.jsx("input",{type:"number",min:"1",max:"60",value:D,onChange:ye=>N(Math.max(1,Math.min(60,parseInt(ye.target.value)||1))),className:"w-12 px-1 py-0.5 bg-background border border-border rounded text-xs text-center"}),S.jsx("span",{className:"text-muted-foreground",children:"sec"})]}),S.jsxs("div",{className:"border-t border-border pt-2 mt-1 flex flex-col gap-2",children:[S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:F,onCheckedChange:ye=>z(ye===!0)}),S.jsx("span",{title:"When enabled, the graph continuously reorganizes itself into a better layout",children:"Let 'em drift"})]}),S.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[S.jsxs("label",{className:"text-muted-foreground",title:"How strongly nodes repel each other. Higher values spread nodes out more.",children:["Repulsion: ",Math.abs(w)]}),S.jsx("input",{type:"range",min:"50",max:"2500",value:Math.abs(w),onChange:ye=>C(-parseInt(ye.target.value)),className:"w-full h-2 bg-border rounded-lg appearance-none cursor-pointer accent-primary"})]}),S.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[S.jsxs("label",{className:"text-muted-foreground",title:"How fast particles travel along links. Higher values make packets move faster.",children:["Packet speed: ",I,"x"]}),S.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:I,onChange:ye=>K(parseFloat(ye.target.value)),className:"w-full h-2 bg-border rounded-lg appearance-none cursor-pointer accent-primary"})]})]}),S.jsx("button",{onClick:ne.randomizePositions,className:"mt-2 px-3 py-1.5 bg-primary/20 hover:bg-primary/30 text-primary rounded text-xs transition-colors",title:"Randomize node positions and let the simulation settle into a new layout",children:"Shuffle layout"}),S.jsx("button",{onClick:ne.expandContract,className:"mt-1 px-3 py-1.5 bg-primary/20 hover:bg-primary/30 text-primary rounded text-xs transition-colors",title:"Expand nodes apart then contract back - can help untangle the graph",children:"Oooh Big Stretch!"}),S.jsx("button",{onClick:()=>{ne.clearAndReset(),s==null||s()},className:"mt-1 px-3 py-1.5 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-500 rounded text-xs transition-colors",title:"Clear all nodes, links, and packets - reset to initial state",children:"Clear & Reset"})]})]}),S.jsxs("div",{className:W?"":"border-t border-border pt-2 mt-1 flex flex-col gap-2",children:[S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:W,onCheckedChange:ye=>U(ye===!0)}),S.jsx("span",{title:"Hide legends and controls for a cleaner view",children:"Hide UI"})]}),i&&S.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[S.jsx(eo,{checked:r,onCheckedChange:ye=>i(ye===!0)}),S.jsx("span",{title:"Hide the packet feed panel",children:"Full screen"})]})]})]})})]})}function T7({packets:n,contacts:e,config:t,onClearPackets:r}){const[i,s]=R.useState(!1);return S.jsxs("div",{className:"flex flex-col h-full",children:[S.jsx("div",{className:"flex justify-between items-center px-4 py-3 border-b border-border font-medium text-lg",children:S.jsx("span",{children:"Mesh Visualizer"})}),S.jsx("div",{className:"flex-1 overflow-hidden md:hidden",children:S.jsxs(Ov,{defaultValue:"visualizer",className:"h-full flex flex-col",children:[S.jsxs(Gp,{className:"mx-4 mt-2 grid grid-cols-2",children:[S.jsx(ni,{value:"visualizer",children:"Visualizer"}),S.jsx(ni,{value:"packets",children:"Packet Feed"})]}),S.jsx(ri,{value:"visualizer",className:"flex-1 m-0 overflow-hidden",children:S.jsx(Ck,{packets:n,contacts:e,config:t,onClearPackets:r})}),S.jsx(ri,{value:"packets",className:"flex-1 m-0 overflow-hidden",children:S.jsx(nv,{packets:n})})]})}),S.jsxs("div",{className:"hidden md:flex flex-1 overflow-hidden",children:[S.jsx("div",{className:vt("overflow-hidden transition-all duration-200",i?"flex-1":"flex-1 border-r border-border"),children:S.jsx(Ck,{packets:n,contacts:e,config:t,fullScreen:i,onFullScreenChange:s,onClearPackets:r})}),S.jsx("div",{className:vt("overflow-hidden transition-all duration-200",i?"w-0":"w-[31rem] lg:w-[38rem]"),children:S.jsxs("div",{className:"h-full flex flex-col",children:[S.jsx("div",{className:"px-3 py-2 border-b border-border text-sm font-medium text-muted-foreground",children:"Packet Feed"}),S.jsx("div",{className:"flex-1 overflow-hidden",children:S.jsx(nv,{packets:n})})]})})]})]})}const E7="modulepreload",P7=function(n){return"/"+n},Tk={},B7=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let o=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=o(t.map(f=>{if(f=P7(f),f in Tk)return;Tk[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const x=document.createElement("link");if(x.rel=p?"stylesheet":E7,p||(x.as="script"),x.crossOrigin="",x.href=f,u&&x.setAttribute("nonce",u),document.head.appendChild(x),p)return new Promise((A,_)=>{x.addEventListener("load",A),x.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var R7=Gh();const sP=Rc(R7);var G0={exports:{}},D7=G0.exports,Ek;function M7(){return Ek||(Ek=1,(function(n,e){(function(t,r,i){n.exports=r(Et(),Gh(),pm())})(D7,function(t){return t.HmacSHA256})})(G0)),G0.exports}var N7=M7();const L7=Rc(N7);var X0={exports:{}},F7=X0.exports,Pk;function I7(){return Pk||(Pk=1,(function(n,e){(function(t,r){n.exports=r(Et())})(F7,function(t){return t.enc.Hex})})(X0)),X0.exports}var z7=I7();const yc=Rc(z7),oP="abcdefghijklmnopqrstuvwxyz0123456789",Wa=oP.length,aP=oP+"-",ov="[[public room]]",K0="8b3387e9c5cdea6ac9e5edbaa115cd72",av=720*60*60;function j7(n){if(!n||n.length===0)return null;const e=n.length;let t=0,r=1;for(let i=0;i<e;i++){const s=n[i],o=aP.indexOf(s);if(o===-1)return null;const a=i===0,u=i===e-1,f=a||u?36:37;if((a||u)&&o===36)return null;t+=o*r,r*=f}return{length:e,index:t}}function Za(n,e){if(n<=0)return null;let t="",r=e,i=!1;for(let s=0;s<n;s++){const o=s===0,a=s===n-1,u=o||a?36:37,f=r%u;r=Math.floor(r/u);const p=f===36;if(p&&i)return null;i=p,t+=aP[f]}return t}function lv(n){return n===ov?K0:sP(n).toString(yc).substring(0,32)}function cv(n){return sP(yc.parse(n)).toString(yc).substring(0,2)}function lP(n,e,t){const r=t.padEnd(64,"0");return L7(yc.parse(n),yc.parse(r)).toString(yc).substring(0,4).toLowerCase()===e.toLowerCase()}function rh(n){if(n===1)return Wa;if(n===2)return Wa*Wa;let e=Wa,t=1;for(let i=2;i<=n-2;i++){const s=(e+t)*Wa,o=e;e=s,t=o}const r=n>2?e+t:1;return Wa*r*Wa}function Q7(n,e=av,t){const r=Math.floor(Date.now()/1e3);return n<=r&&n>=r-e}function H7(n){return!n.includes("")}class Am{constructor(){this.device=null,this.pipeline=null,this.bindGroupLayout=null,this.paramsBuffer=null,this.matchCountBuffer=null,this.matchIndicesBuffer=null,this.ciphertextBuffer=null,this.ciphertextBufferSize=0,this.matchCountReadBuffers=[null,null],this.matchIndicesReadBuffers=[null,null],this.currentReadBufferIndex=0,this.bindGroup=null,this.bindGroupDirty=!0,this.shaderCode=`
// SHA256 round constants
const K: array<u32, 64> = array<u32, 64>(
  0x428a2f98u, 0x71374491u, 0xb5c0fbcfu, 0xe9b5dba5u, 0x3956c25bu, 0x59f111f1u, 0x923f82a4u, 0xab1c5ed5u,
  0xd807aa98u, 0x12835b01u, 0x243185beu, 0x550c7dc3u, 0x72be5d74u, 0x80deb1feu, 0x9bdc06a7u, 0xc19bf174u,
  0xe49b69c1u, 0xefbe4786u, 0x0fc19dc6u, 0x240ca1ccu, 0x2de92c6fu, 0x4a7484aau, 0x5cb0a9dcu, 0x76f988dau,
  0x983e5152u, 0xa831c66du, 0xb00327c8u, 0xbf597fc7u, 0xc6e00bf3u, 0xd5a79147u, 0x06ca6351u, 0x14292967u,
  0x27b70a85u, 0x2e1b2138u, 0x4d2c6dfcu, 0x53380d13u, 0x650a7354u, 0x766a0abbu, 0x81c2c92eu, 0x92722c85u,
  0xa2bfe8a1u, 0xa81a664bu, 0xc24b8b70u, 0xc76c51a3u, 0xd192e819u, 0xd6990624u, 0xf40e3585u, 0x106aa070u,
  0x19a4c116u, 0x1e376c08u, 0x2748774cu, 0x34b0bcb5u, 0x391c0cb3u, 0x4ed8aa4au, 0x5b9cca4fu, 0x682e6ff3u,
  0x748f82eeu, 0x78a5636fu, 0x84c87814u, 0x8cc70208u, 0x90befffau, 0xa4506cebu, 0xbef9a3f7u, 0xc67178f2u
);

// Character lookup table (a-z = 0-25, 0-9 = 26-35, dash = 36)
const CHARS: array<u32, 37> = array<u32, 37>(
  0x61u, 0x62u, 0x63u, 0x64u, 0x65u, 0x66u, 0x67u, 0x68u, 0x69u, 0x6au, // a-j
  0x6bu, 0x6cu, 0x6du, 0x6eu, 0x6fu, 0x70u, 0x71u, 0x72u, 0x73u, 0x74u, // k-t
  0x75u, 0x76u, 0x77u, 0x78u, 0x79u, 0x7au,                             // u-z
  0x30u, 0x31u, 0x32u, 0x33u, 0x34u, 0x35u, 0x36u, 0x37u, 0x38u, 0x39u, // 0-9
  0x2du                                                                  // dash
);

struct Params {
  target_channel_hash: u32,
  batch_offset: u32,
  name_length: u32,
  batch_size: u32,
  target_mac: u32,           // First 2 bytes of target MAC (in high 16 bits)
  ciphertext_words: u32,     // Number of 32-bit words in ciphertext
  ciphertext_len_bits: u32,  // Length of ciphertext in bits
  verify_mac: u32,           // 1 to verify MAC, 0 to skip
}

@group(0) @binding(0) var<uniform> params: Params;
@group(0) @binding(1) var<storage, read_write> match_count: atomic<u32>;
@group(0) @binding(2) var<storage, read_write> match_indices: array<u32>;
@group(0) @binding(3) var<storage, read> ciphertext: array<u32>; // Ciphertext data

fn rotr(x: u32, n: u32) -> u32 {
  return (x >> n) | (x << (32u - n));
}

fn ch(x: u32, y: u32, z: u32) -> u32 {
  return (x & y) ^ (~x & z);
}

fn maj(x: u32, y: u32, z: u32) -> u32 {
  return (x & y) ^ (x & z) ^ (y & z);
}

fn sigma0(x: u32) -> u32 {
  return rotr(x, 2u) ^ rotr(x, 13u) ^ rotr(x, 22u);
}

fn sigma1(x: u32) -> u32 {
  return rotr(x, 6u) ^ rotr(x, 11u) ^ rotr(x, 25u);
}

fn gamma0(x: u32) -> u32 {
  return rotr(x, 7u) ^ rotr(x, 18u) ^ (x >> 3u);
}

fn gamma1(x: u32) -> u32 {
  return rotr(x, 17u) ^ rotr(x, 19u) ^ (x >> 10u);
}

// Convert index to room name bytes, returns the hash as a u32 for the first byte check
fn index_to_room_name(idx: u32, length: u32, msg: ptr<function, array<u32, 16>>) -> bool {
  // Message starts with '#' (0x23)
  var byte_pos = 0u;
  var word_idx = 0u;
  var current_word = 0x23000000u; // '#' in big-endian position 0
  byte_pos = 1u;

  var remaining = idx;
  var prev_was_dash = false;

  // Generate room name from index
  for (var i = 0u; i < length; i++) {
    let char_count = select(37u, 36u, i == 0u || i == length - 1u); // no dash at start/end
    var char_idx = remaining % char_count;
    remaining = remaining / char_count;

    // Check for consecutive dashes (invalid)
    let is_dash = char_idx == 36u && i > 0u && i < length - 1u;
    if (is_dash && prev_was_dash) {
      return false; // Invalid: consecutive dashes
    }
    prev_was_dash = is_dash;

    // Map char index to actual character
    let c = CHARS[char_idx];

    // Pack byte into current word (big-endian)
    let shift = (3u - byte_pos % 4u) * 8u;
    if (byte_pos % 4u == 0u && byte_pos > 0u) {
      (*msg)[word_idx] = current_word;
      word_idx = word_idx + 1u;
      current_word = 0u;
    }
    current_word = current_word | (c << shift);
    byte_pos = byte_pos + 1u;
  }

  // Add padding: 0x80 followed by zeros, then length in bits
  let msg_len_bits = (length + 1u) * 8u; // +1 for '#'

  // Add 0x80 padding byte
  let shift = (3u - byte_pos % 4u) * 8u;
  if (byte_pos % 4u == 0u) {
    (*msg)[word_idx] = current_word;
    word_idx = word_idx + 1u;
    current_word = 0x80000000u;
  } else {
    current_word = current_word | (0x80u << shift);
  }
  byte_pos = byte_pos + 1u;

  // Store current word
  if (byte_pos % 4u == 0u || word_idx < 14u) {
    (*msg)[word_idx] = current_word;
    word_idx = word_idx + 1u;
  }

  // Zero-fill until word 14
  for (var i = word_idx; i < 14u; i++) {
    (*msg)[i] = 0u;
  }

  // Length in bits (64-bit, but we only use lower 32 bits for short messages)
  (*msg)[14u] = 0u;
  (*msg)[15u] = msg_len_bits;

  return true;
}

fn sha256_block(msg: ptr<function, array<u32, 16>>) -> array<u32, 8> {
  // Initialize hash values
  var h: array<u32, 8> = array<u32, 8>(
    0x6a09e667u, 0xbb67ae85u, 0x3c6ef372u, 0xa54ff53au,
    0x510e527fu, 0x9b05688cu, 0x1f83d9abu, 0x5be0cd19u
  );

  // Message schedule
  var w: array<u32, 64>;
  for (var i = 0u; i < 16u; i++) {
    w[i] = (*msg)[i];
  }
  for (var i = 16u; i < 64u; i++) {
    w[i] = gamma1(w[i-2u]) + w[i-7u] + gamma0(w[i-15u]) + w[i-16u];
  }

  // Compression
  var a = h[0]; var b = h[1]; var c = h[2]; var d = h[3];
  var e = h[4]; var f = h[5]; var g = h[6]; var hh = h[7];

  for (var i = 0u; i < 64u; i++) {
    let t1 = hh + sigma1(e) + ch(e, f, g) + K[i] + w[i];
    let t2 = sigma0(a) + maj(a, b, c);
    hh = g; g = f; f = e; e = d + t1;
    d = c; c = b; b = a; a = t1 + t2;
  }

  h[0] = h[0] + a; h[1] = h[1] + b; h[2] = h[2] + c; h[3] = h[3] + d;
  h[4] = h[4] + e; h[5] = h[5] + f; h[6] = h[6] + g; h[7] = h[7] + hh;

  return h;
}

// Compute SHA256 of the key (16 bytes) to get channel hash
fn sha256_key(key: array<u32, 4>) -> u32 {
  var msg: array<u32, 16>;

  // Key bytes (16 bytes = 4 words)
  msg[0] = key[0];
  msg[1] = key[1];
  msg[2] = key[2];
  msg[3] = key[3];

  // Padding: 0x80 followed by zeros
  msg[4] = 0x80000000u;
  for (var i = 5u; i < 14u; i++) {
    msg[i] = 0u;
  }

  // Length: 128 bits
  msg[14] = 0u;
  msg[15] = 128u;

  let hash = sha256_block(&msg);

  // Return first byte of hash (big-endian)
  return hash[0] >> 24u;
}

// HMAC-SHA256 for MAC verification
// Key is 16 bytes (4 words), padded to 32 bytes with zeros for MeshCore
// Returns first 2 bytes of HMAC (as u32 in high 16 bits)
fn hmac_sha256_mac(key: array<u32, 4>, ciphertext_len: u32) -> u32 {
  // HMAC: H((K' ^ opad) || H((K' ^ ipad) || message))
  // K' is 64 bytes (32 bytes key + 32 bytes zero padding for MeshCore, then padded to 64)
  // ipad = 0x36 repeated, opad = 0x5c repeated

  // Build padded key (64 bytes = 16 words)
  // MeshCore uses 32-byte secret: 16-byte key + 16 zero bytes
  var k_pad: array<u32, 16>;
  k_pad[0] = key[0];
  k_pad[1] = key[1];
  k_pad[2] = key[2];
  k_pad[3] = key[3];
  for (var i = 4u; i < 16u; i++) {
    k_pad[i] = 0u;
  }

  // Inner hash: SHA256((K' ^ ipad) || message)
  // First block: K' ^ ipad (64 bytes)
  var inner_block: array<u32, 16>;
  for (var i = 0u; i < 16u; i++) {
    inner_block[i] = k_pad[i] ^ 0x36363636u;
  }

  // Initialize hash state with first block
  var h: array<u32, 8> = sha256_block(&inner_block);

  // Process ciphertext blocks (continuing from h state)
  let ciphertext_words = params.ciphertext_words;
  var word_idx = 0u;

  // Process full 64-byte blocks of ciphertext
  while (word_idx + 16u <= ciphertext_words) {
    var block: array<u32, 16>;
    for (var i = 0u; i < 16u; i++) {
      block[i] = ciphertext[word_idx + i];
    }
    h = sha256_block_continue(&block, h);
    word_idx = word_idx + 16u;
  }

  // Final block with remaining ciphertext + padding
  var final_block: array<u32, 16>;
  var remaining = ciphertext_words - word_idx;
  for (var i = 0u; i < 16u; i++) {
    if (i < remaining) {
      final_block[i] = ciphertext[word_idx + i];
    } else if (i == remaining) {
      // Add 0x80 padding
      final_block[i] = 0x80000000u;
    } else {
      final_block[i] = 0u;
    }
  }

  // Add length (64 bytes of ipad + ciphertext length)
  let total_bits = 512u + params.ciphertext_len_bits;
  if (remaining < 14u) {
    final_block[14] = 0u;
    final_block[15] = total_bits;
    h = sha256_block_continue(&final_block, h);
  } else {
    // Need extra block for length
    h = sha256_block_continue(&final_block, h);
    var len_block: array<u32, 16>;
    for (var i = 0u; i < 14u; i++) {
      len_block[i] = 0u;
    }
    len_block[14] = 0u;
    len_block[15] = total_bits;
    h = sha256_block_continue(&len_block, h);
  }

  let inner_hash = h;

  // Outer hash: SHA256((K' ^ opad) || inner_hash)
  var outer_block: array<u32, 16>;
  for (var i = 0u; i < 16u; i++) {
    outer_block[i] = k_pad[i] ^ 0x5c5c5c5cu;
  }
  h = sha256_block(&outer_block);

  // Second block: inner_hash (32 bytes) + padding
  var hash_block: array<u32, 16>;
  for (var i = 0u; i < 8u; i++) {
    hash_block[i] = inner_hash[i];
  }
  hash_block[8] = 0x80000000u;
  for (var i = 9u; i < 14u; i++) {
    hash_block[i] = 0u;
  }
  hash_block[14] = 0u;
  hash_block[15] = 512u + 256u; // 64 bytes opad + 32 bytes inner hash

  h = sha256_block_continue(&hash_block, h);

  // Return first 2 bytes (high 16 bits of first word)
  return h[0] & 0xFFFF0000u;
}

// SHA256 block computation continuing from existing state
fn sha256_block_continue(msg: ptr<function, array<u32, 16>>, h_in: array<u32, 8>) -> array<u32, 8> {
  var h = h_in;

  // Message schedule
  var w: array<u32, 64>;
  for (var i = 0u; i < 16u; i++) {
    w[i] = (*msg)[i];
  }
  for (var i = 16u; i < 64u; i++) {
    w[i] = gamma1(w[i-2u]) + w[i-7u] + gamma0(w[i-15u]) + w[i-16u];
  }

  // Compression
  var a = h[0]; var b = h[1]; var c = h[2]; var d = h[3];
  var e = h[4]; var f = h[5]; var g = h[6]; var hh = h[7];

  for (var i = 0u; i < 64u; i++) {
    let t1 = hh + sigma1(e) + ch(e, f, g) + K[i] + w[i];
    let t2 = sigma0(a) + maj(a, b, c);
    hh = g; g = f; f = e; e = d + t1;
    d = c; c = b; b = a; a = t1 + t2;
  }

  h[0] = h[0] + a; h[1] = h[1] + b; h[2] = h[2] + c; h[3] = h[3] + d;
  h[4] = h[4] + e; h[5] = h[5] + f; h[6] = h[6] + g; h[7] = h[7] + hh;

  return h;
}

// Process a single candidate and record match if found
fn process_candidate(name_idx: u32) {
  // Generate message for this room name
  var msg: array<u32, 16>;
  let valid = index_to_room_name(name_idx, params.name_length, &msg);

  if (!valid) {
    return;
  }

  // Compute SHA256("#roomname") - this gives us the key
  let key_hash = sha256_block(&msg);

  // Take first 16 bytes (4 words) as the key
  var key: array<u32, 4>;
  key[0] = key_hash[0];
  key[1] = key_hash[1];
  key[2] = key_hash[2];
  key[3] = key_hash[3];

  // Compute SHA256(key) to get channel hash
  let channel_hash = sha256_key(key);

  // Check if channel hash matches target
  if (channel_hash != params.target_channel_hash) {
    return;
  }

  // Channel hash matches - verify MAC if enabled
  if (params.verify_mac == 1u) {
    let computed_mac = hmac_sha256_mac(key, params.ciphertext_len_bits);
    if (computed_mac != params.target_mac) {
      return;
    }
  }

  // Found a match - record the index
  let match_idx = atomicAdd(&match_count, 1u);
  if (match_idx < 1024u) { // Limit stored matches
    match_indices[match_idx] = name_idx;
  }
}

// Each thread processes 32 candidates to amortize thread overhead
const CANDIDATES_PER_THREAD: u32 = 32u;

@compute @workgroup_size(256)
fn main(@builtin(global_invocation_id) global_id: vec3<u32>) {
  let base_idx = global_id.x * CANDIDATES_PER_THREAD;

  for (var i = 0u; i < CANDIDATES_PER_THREAD; i++) {
    let idx = base_idx + i;
    if (idx >= params.batch_size) {
      return;
    }
    let name_idx = params.batch_offset + idx;
    process_candidate(name_idx);
  }
}
`}async init(){if(!navigator.gpu)return console.warn("WebGPU not supported"),!1;try{const e=await navigator.gpu.requestAdapter();if(!e)return console.warn("No GPU adapter found"),!1;this.device=await e.requestDevice(),this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}]}),this.paramsBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.matchCountBuffer=this.device.createBuffer({size:4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST}),this.matchIndicesBuffer=this.device.createBuffer({size:1024*4,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC});for(let i=0;i<2;i++)this.matchCountReadBuffers[i]=this.device.createBuffer({size:4,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.matchIndicesReadBuffers[i]=this.device.createBuffer({size:1024*4,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST});const t=this.device.createShaderModule({code:this.shaderCode}),r=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]});return this.pipeline=this.device.createComputePipeline({layout:r,compute:{module:t,entryPoint:"main"}}),!0}catch(e){return console.error("WebGPU initialization failed:",e),!1}}isAvailable(){return this.device!==null&&this.pipeline!==null}indexToRoomName(e,t){return Za(t,e)}countNamesForLength(e){return rh(e)}async runBatch(e,t,r,i,s,o){if(!this.device||!this.pipeline||!this.bindGroupLayout||!this.paramsBuffer||!this.matchCountBuffer||!this.matchIndicesBuffer||!this.matchCountReadBuffers[0]||!this.matchCountReadBuffers[1]||!this.matchIndicesReadBuffers[0]||!this.matchIndicesReadBuffers[1])throw new Error("GPU not initialized");const a=this.currentReadBufferIndex;this.currentReadBufferIndex=1-this.currentReadBufferIndex;const u=this.matchCountReadBuffers[a],f=this.matchIndicesReadBuffers[a],p=s&&o?1:0;let g,x=0,A=0;if(p){const N=new Uint8Array(s.length/2);for(let W=0;W<N.length;W++)N[W]=parseInt(s.substr(W*2,2),16);x=N.length*8;const F=Math.ceil(N.length/4)*4,z=new Uint8Array(F);z.set(N),g=new Uint32Array(F/4);for(let W=0;W<g.length;W++)g[W]=z[W*4]<<24|z[W*4+1]<<16|z[W*4+2]<<8|z[W*4+3];const I=parseInt(o.substr(0,2),16),K=parseInt(o.substr(2,2),16);A=I<<24|K<<16}else g=new Uint32Array([0]);const _=Math.max(g.length*4,4);(!this.ciphertextBuffer||this.ciphertextBufferSize<_)&&(this.ciphertextBuffer&&this.ciphertextBuffer.destroy(),this.ciphertextBuffer=this.device.createBuffer({size:_,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.ciphertextBufferSize=_,this.bindGroupDirty=!0);const b=new Uint32Array([e,r,t,i,A,g.length,x,p]);this.device.queue.writeBuffer(this.paramsBuffer,0,b),this.device.queue.writeBuffer(this.ciphertextBuffer,0,g),this.device.queue.writeBuffer(this.matchCountBuffer,0,Am.ZERO_DATA),(this.bindGroupDirty||!this.bindGroup)&&(this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:this.paramsBuffer}},{binding:1,resource:{buffer:this.matchCountBuffer}},{binding:2,resource:{buffer:this.matchIndicesBuffer}},{binding:3,resource:{buffer:this.ciphertextBuffer}}]}),this.bindGroupDirty=!1);const w=this.device.createCommandEncoder(),C=w.beginComputePass();C.setPipeline(this.pipeline),C.setBindGroup(0,this.bindGroup),C.dispatchWorkgroups(Math.ceil(i/(256*32))),C.end(),w.copyBufferToBuffer(this.matchCountBuffer,0,u,0,4),w.copyBufferToBuffer(this.matchIndicesBuffer,0,f,0,1024*4),this.device.queue.submit([w.finish()]),await u.mapAsync(GPUMapMode.READ);const E=new Uint32Array(u.getMappedRange())[0];u.unmap();const D=[];if(E>0){await f.mapAsync(GPUMapMode.READ);const N=new Uint32Array(f.getMappedRange());for(let F=0;F<Math.min(E,1024);F++)D.push(N[F]);f.unmap()}return D}destroy(){var e,t,r,i,s,o,a,u;(e=this.paramsBuffer)==null||e.destroy(),(t=this.matchCountBuffer)==null||t.destroy(),(r=this.matchIndicesBuffer)==null||r.destroy(),(i=this.ciphertextBuffer)==null||i.destroy(),(s=this.matchCountReadBuffers[0])==null||s.destroy(),(o=this.matchCountReadBuffers[1])==null||o.destroy(),(a=this.matchIndicesReadBuffers[0])==null||a.destroy(),(u=this.matchIndicesReadBuffers[1])==null||u.destroy(),this.paramsBuffer=null,this.matchCountBuffer=null,this.matchIndicesBuffer=null,this.ciphertextBuffer=null,this.ciphertextBufferSize=0,this.matchCountReadBuffers=[null,null],this.matchIndicesReadBuffers=[null,null],this.currentReadBufferIndex=0,this.bindGroup=null,this.bindGroupDirty=!0,this.device&&(this.device.destroy(),this.device=null),this.pipeline=null,this.bindGroupLayout=null}}Am.ZERO_DATA=new Uint32Array([0]);function W7(){return typeof navigator<"u"&&"gpu"in navigator}class Bk{runBatch(e,t,r,i,s,o){const a=[],u=e.toString(16).padStart(2,"0"),f=!!(s&&o);for(let p=0;p<i;p++){const g=r+p,x=Za(t,g);if(!x)continue;const A=lv("#"+x);cv(A)===u&&(f&&!lP(s,o,A)||a.push(g))}return a}destroy(){}}const q7=/^[a-z0-9-]+$/,V7=/^[a-z0-9].*[a-z0-9]$|^[a-z0-9]$/,$7=/--/;function Rk(n){return!(!n||n.length===0||!q7.test(n)||n.length>1&&!V7.test(n)||$7.test(n))}class U7{constructor(){this.gpuInstance=null,this.cpuInstance=null,this.wordlist=[],this.abortFlag=!1,this.useTimestampFilter=!0,this.useUtf8Filter=!0,this.useSenderFilter=!0,this.validSeconds=av,this.useCpu=!1}async loadWordlist(e){const t=await fetch(e);if(!t.ok)throw new Error(`Failed to load wordlist: ${t.status} ${t.statusText}`);const i=(await t.text()).split(`
`).map(s=>s.trim().toLowerCase()).filter(s=>s.length>0);this.wordlist=i.filter(Rk)}setWordlist(e){this.wordlist=e.map(t=>t.trim().toLowerCase()).filter(Rk)}abort(){this.abortFlag=!0}isGpuAvailable(){return W7()}async decodePacket(e){var r;const t=e.trim().replace(/\s+/g,"").replace(/^0x/i,"");if(!t||!/^[0-9a-fA-F]+$/.test(t))return null;try{const s=(r=(await Pt.MeshCorePacketDecoder.decodeWithVerification(t,{})).payload)==null?void 0:r.decoded;return!(s!=null&&s.channelHash)||!(s!=null&&s.ciphertext)||!(s!=null&&s.cipherMac)?null:{channelHash:s.channelHash,ciphertext:s.ciphertext,cipherMac:s.cipherMac,isGroupText:!0}}catch{return null}}async crack(e,t,r){this.abortFlag=!1,this.useTimestampFilter=(t==null?void 0:t.useTimestampFilter)??!0,this.useUtf8Filter=(t==null?void 0:t.useUtf8Filter)??!0,this.useSenderFilter=(t==null?void 0:t.useSenderFilter)??!0,this.validSeconds=(t==null?void 0:t.validSeconds)??av,this.useCpu=(t==null?void 0:t.forceCpu)??!1;const i=(t==null?void 0:t.maxLength)??8,s=(t==null?void 0:t.startingLength)??1,o=(t==null?void 0:t.useDictionary)??!0,a=(t==null?void 0:t.startFromType)??"bruteforce",u=e.toLowerCase(),f=await this.decodePacket(u);if(!f)return{found:!1,error:"Invalid packet or not a GroupText packet"};const{channelHash:p,ciphertext:g,cipherMac:x}=f,A=parseInt(p,16);this.useCpu?this.cpuInstance||(this.cpuInstance=new Bk):this.gpuInstance||(this.gpuInstance=new Am,await this.gpuInstance.init()||(this.useCpu=!0,this.cpuInstance=new Bk));const _=performance.now();let b=0,w=performance.now(),C=s,T=0,E=0,D=!1;if(t!=null&&t.startFrom){const $=t.startFrom.toLowerCase();if(a==="dictionary"){const ee=this.wordlist.indexOf($);ee>=0&&(E=ee+1)}else{D=!0;const ee=j7($);ee&&(C=Math.max(s,ee.length),T=ee.index+1,T>=rh(C)&&(C++,T=0))}}let N=0;o&&!D&&this.wordlist.length>0&&(N+=this.wordlist.length-E);for(let $=C;$<=i;$++)N+=rh($);N-=T;const F=($,ee,le)=>{if(!r)return;const ie=(performance.now()-_)/1e3,V=ie>0?Math.round(b/ie):0,ne=N-b,q=V>0?ne/V:0;r({checked:b,total:N,percent:N>0?Math.min(100,b/N*100):0,rateKeysPerSec:V,etaSeconds:q,elapsedSeconds:ie,currentLength:ee,currentPosition:le,phase:$})},z=$=>{if(!lP(g,x,$))return{valid:!1};const ee=Pt.ChannelCrypto.decryptGroupTextMessage(g,x,$);return!ee.success||!ee.data?{valid:!1}:this.useTimestampFilter&&!Q7(ee.data.timestamp,this.validSeconds)?{valid:!1}:this.useUtf8Filter&&!H7(ee.data.message)?{valid:!1}:this.useSenderFilter&&!ee.data.sender?{valid:!1}:{valid:!0,message:ee.data.sender?`${ee.data.sender}: ${ee.data.message}`:ee.data.message}};if(!D&&E===0&&C===s&&T===0){F("public-key",0,ov);const $=cv(K0);if(p===$){const ee=z(K0);if(ee.valid)return{found:!0,roomName:ov,key:K0,decryptedMessage:ee.message}}}if(o&&!D&&this.wordlist.length>0)for(let $=E;$<this.wordlist.length;$++){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:this.wordlist[$],resumeType:"dictionary"};const ee=this.wordlist[$],le=lv("#"+ee),Z=cv(le);if(parseInt(Z,16)===A){const V=z(le);if(V.valid)return{found:!0,roomName:ee,key:le,decryptedMessage:V.message,resumeFrom:ee,resumeType:"dictionary"}}b++;const ie=performance.now();ie-w>=200&&(F("wordlist",ee.length,ee),w=ie,await new Promise(V=>setTimeout(V,0)))}const I=this.useCpu?1024:32768,K=(t==null?void 0:t.gpuDispatchMs)??1e3;let W=I,U=!1;for(let $=C;$<=i;$++){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:Za($,0)||void 0,resumeType:"bruteforce"};const ee=rh($);let le=$===C?T:0;for(;le<ee;){if(this.abortFlag)return{found:!1,aborted:!0,resumeFrom:Za($,le)||void 0,resumeType:"bruteforce"};const Z=Math.min(W,ee-le),ie=performance.now();let V;this.useCpu?V=this.cpuInstance.runBatch(A,$,le,Z,g,x):V=await this.gpuInstance.runBatch(A,$,le,Z,g,x);const ne=performance.now()-ie;if(b+=Z,!this.useCpu&&!U&&Z>=I&&ne>0){const B=K/ne,Q=Math.round(Z*B),G=Math.pow(2,Math.round(Math.log2(Math.max(I,Q))));W=Math.max(I,G),U=!0}for(const B of V){const Q=Za($,B);if(!Q)continue;const G=lv("#"+Q),Y=z(G);if(Y.valid)return{found:!0,roomName:Q,key:G,decryptedMessage:Y.message,resumeFrom:Q,resumeType:"bruteforce"}}le+=Z;const q=performance.now();if(q-w>=200){const B=Za($,Math.min(le,ee-1))||"";F("bruteforce",$,B),w=q,await new Promise(Q=>setTimeout(Q,0))}}}return{found:!1,resumeFrom:Za(i,rh(i)-1)||void 0,resumeType:"bruteforce"}}destroy(){this.gpuInstance&&(this.gpuInstance.destroy(),this.gpuInstance=null),this.cpuInstance&&(this.cpuInstance.destroy(),this.cpuInstance=null)}}var Gx,Dk;function Z7(){return Dk||(Dk=1,Gx={webm:"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK",mp4:"data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"}),Gx}var Xx,Mk;function G7(){if(Mk)return Xx;Mk=1;const{webm:n,mp4:e}=Z7(),t=()=>typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,r=()=>"wakeLock"in navigator;class i{constructor(){if(this.enabled=!1,r()){this._wakeLock=null;const o=()=>{this._wakeLock!==null&&document.visibilityState==="visible"&&this.enable()};document.addEventListener("visibilitychange",o),document.addEventListener("fullscreenchange",o)}else t()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",n),this._addSourceToVideo(this.noSleepVideo,"mp4",e),this.noSleepVideo.addEventListener("loadedmetadata",()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})}))}_addSourceToVideo(o,a,u){var f=document.createElement("source");f.src=u,f.type=`video/${a}`,o.appendChild(f)}get isEnabled(){return this.enabled}enable(){return r()?navigator.wakeLock.request("screen").then(o=>{this._wakeLock=o,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",()=>{console.log("Wake Lock released.")})}).catch(o=>{throw this.enabled=!1,console.error(`${o.name}, ${o.message}`),o}):t()?(this.disable(),console.warn(`
        NoSleep enabled for older iOS devices. This can interrupt
        active or long-running network requests from completing successfully.
        See https://github.com/richtr/NoSleep.js/issues/15 for more details.
      `),this.noSleepTimer=window.setInterval(()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))},15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then(a=>(this.enabled=!0,a)).catch(a=>{throw this.enabled=!1,a})}disable(){r()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):t()?this.noSleepTimer&&(console.warn(`
          NoSleep now disabled for older iOS devices.
        `),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}}return Xx=i,Xx}var X7=G7();const K7=Rc(X7);function Y7(n){if(n.length<4)return null;try{const t=parseInt(n.slice(0,2),16)&3;let r=2;if(t===0||t===3){if(n.length<r+8)return null;r+=8}if(n.length<r+2)return null;const i=parseInt(n.slice(r,r+2),16);r+=2;const s=i*2;return n.length<r+s?null:(r+=s,n.slice(r))}catch{return null}}function J7({packets:n,channels:e,onChannelCreate:t,onRunningChange:r,visible:i=!1}){const[s,o]=R.useState(!1),[a,u]=R.useState(6),[f,p]=R.useState(!1),[g,x]=R.useState(!0),[A,_]=R.useState(!1),[b,w]=R.useState(null),[C,T]=R.useState(new Map),[E,D]=R.useState([]),[N,F]=R.useState(!1),[z,I]=R.useState(null),[K,W]=R.useState(null),[U,X]=R.useState(0),$=R.useRef(null),ee=R.useRef(null),le=R.useRef(!1),Z=R.useRef(!1),ie=R.useRef(!1),V=R.useRef(new Map),ne=R.useRef(!1),q=R.useRef(6),B=R.useRef(!0),Q=R.useRef(!1),G=R.useRef(new Set),Y=R.useRef(new Set);R.useEffect(()=>{const Ce=new U7;$.current=Ce,I(Ce.isGpuAvailable());const Ge=new K7;return ee.current=Ge,()=>{Ce.destroy(),$.current=null,Ge.disable(),ee.current=null}},[]),R.useEffect(()=>{!i||N||B7(async()=>{const{ENGLISH_WORDLIST:Ce}=await import("./wordlist-BtmChKSf.js");return{ENGLISH_WORDLIST:Ce}},[]).then(({ENGLISH_WORDLIST:Ce})=>{$.current&&($.current.setWordlist(Ce),F(!0))}).catch(Ce=>{console.error("Failed to load wordlist:",Ce),kt.error("Failed to load wordlist",{description:"Cracking will not be available"})})},[i,N]),R.useEffect(()=>{const Ce=()=>{dt.getUndecryptedPacketCount().then(({count:pt})=>W(pt)).catch(()=>W(null))};Ce();const Ge=setInterval(Ce,36e5);return()=>clearInterval(Ge)},[]);const ue=R.useMemo(()=>new Set(e.map(Ce=>Ce.key.toUpperCase())),[e]),pe=n.filter(Ce=>Ce.payload_type==="GROUP_TEXT"&&!Ce.decrypted);R.useEffect(()=>{let Ce=0;T(Ge=>{const pt=new Map(Ge);let bt=!1;for(const ot of pe)if(!pt.has(ot.id)){const mt=Y7(ot.data);if(mt&&Y.current.has(mt)){Ce++;continue}mt&&Y.current.add(mt),pt.set(ot.id,{packet:ot,attempts:0,lastAttemptLength:0,status:"pending"}),bt=!0}return bt?(V.current=pt,pt):Ge}),Ce>0&&X(Ge=>Ge+Ce)},[pe.length]),R.useEffect(()=>{V.current=C},[C]),R.useEffect(()=>{ne.current=f},[f]),R.useEffect(()=>{q.current=a},[a]),R.useEffect(()=>{B.current=g},[g]),R.useEffect(()=>{Q.current=A},[A]),R.useEffect(()=>{G.current=new Set(pe.map(Ce=>Ce.id))},[pe]),R.useEffect(()=>{r==null||r(s)},[s,r]);const ve=Array.from(C.values()).filter(Ce=>Ce.status==="pending").length,xe=Array.from(C.values()).filter(Ce=>Ce.status==="cracked").length,ye=Array.from(C.values()).filter(Ce=>Ce.status==="failed").length,Pe=R.useCallback(async()=>{if(ie.current||!$.current||!le.current)return;const Ce=V.current;let Ge=null,pt=null;for(const[et,tt]of Ce.entries())if(tt.status==="pending"){Ge=tt,pt=et;break}if(!Ge&&ne.current){const et=Array.from(Ce.entries()).filter(([,tt])=>tt.status==="failed"&&tt.lastAttemptLength<10);et.length>0&&(et.sort((tt,at)=>tt[1].lastAttemptLength-at[1].lastAttemptLength),[pt,Ge]=et[0])}if(!Ge||pt===null){le.current&&setTimeout(()=>Pe(),1e3);return}if(!G.current.has(pt)){T(et=>{const tt=new Map(et);return tt.delete(pt),tt}),le.current&&setTimeout(()=>Pe(),10);return}ie.current=!0;const bt=q.current,ot=Ge.lastAttemptLength>0,mt=ot?Ge.lastAttemptLength+1:bt;try{const et=await $.current.crack(Ge.packet.data,{maxLength:mt,useSenderFilter:!0,useTimestampFilter:!0,useUtf8Filter:!0,...Q.current&&{gpuDispatchMs:1e4},...ot&&{useDictionary:!1,startingLength:mt}},tt=>{w(tt)});if(Z.current){Z.current=!1,ie.current=!1,w(null);return}if(et.found&&et.roomName&&et.key){T(qe=>{const Dt=new Map(qe),Jt=Dt.get(pt);return Jt&&Dt.set(pt,{...Jt,status:"cracked",attempts:Jt.attempts+1,lastAttemptLength:mt}),Dt});const tt={roomName:et.roomName,key:et.key,packetId:pt,message:et.decryptedMessage||"",crackedAt:Date.now()};D(qe=>[...qe,tt]);const at=et.key.toUpperCase();if(!ue.has(at))try{const qe="#"+et.roomName;await t(qe,et.key),B.current&&await dt.decryptHistoricalPackets({key_type:"channel",channel_name:qe})}catch(qe){console.error("Failed to create channel or decrypt historical:",qe),kt.error("Failed to save cracked channel",{description:qe instanceof Error?qe.message:"Channel discovered but could not be saved"})}}else T(tt=>{const at=new Map(tt),qe=at.get(pt);return qe&&at.set(pt,{...qe,status:"failed",attempts:qe.attempts+1,lastAttemptLength:mt}),at})}catch(et){console.error("Cracking error:",et),T(tt=>{const at=new Map(tt),qe=at.get(pt);return qe&&at.set(pt,{...qe,status:"failed",attempts:qe.attempts+1,lastAttemptLength:mt}),at})}ie.current=!1,w(null),le.current&&setTimeout(()=>Pe(),100)},[ue,t]),Ke=()=>{var Ce;if(!z){kt.error("WebGPU not available",{description:"Cracking requires Chrome 113+ or Edge 113+ with WebGPU support."});return}o(!0),le.current=!0,Z.current=!1,(Ce=ee.current)==null||Ce.enable(),Pe()},nt=()=>{var Ce,Ge;o(!1),le.current=!1,Z.current=!0,(Ce=$.current)==null||Ce.abort(),(Ge=ee.current)==null||Ge.disable()};return S.jsxs("div",{className:"flex flex-col h-full p-3 gap-3 bg-background border-t border-border overflow-auto",children:[S.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("label",{className:"text-sm text-muted-foreground",children:"Max Length:"}),S.jsx("input",{type:"number",min:1,max:10,value:a,onChange:Ce=>u(Math.min(10,Math.max(1,parseInt(Ce.target.value)||6))),className:"w-14 px-2 py-1 text-sm bg-muted border border-border rounded"})]}),S.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted-foreground cursor-pointer",children:[S.jsx("input",{type:"checkbox",checked:f,onChange:Ce=>p(Ce.target.checked),className:"rounded"}),"Retry failed at n+1"]}),S.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted-foreground cursor-pointer",children:[S.jsx("input",{type:"checkbox",checked:g,onChange:Ce=>x(Ce.target.checked),className:"rounded"}),"Decrypt historical packets if key found"]}),g&&S.jsx("span",{className:"text-xs text-muted-foreground",children:K!==null&&K>0?`(${K.toLocaleString()} packets; messages will stream in as decrypted)`:"(messages will stream in as decrypted)"}),S.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted-foreground cursor-pointer",children:[S.jsx("input",{type:"checkbox",checked:A,onChange:Ce=>_(Ce.target.checked),className:"rounded"}),"Turbo mode (experimental)"]})]}),S.jsx("button",{onClick:s?nt:Ke,disabled:!N||z===!1,className:vt("w-48 px-4 py-1.5 rounded text-sm font-medium",s?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 disabled:cursor-not-allowed"),children:s?"Stop Search":z===!1?"GPU Not Available":N?"Find Rooms":"Loading dictionary..."}),S.jsxs("div",{className:"flex gap-4 text-sm",children:[S.jsxs("span",{className:"text-muted-foreground",children:["Pending: ",S.jsx("span",{className:"text-foreground font-medium",children:ve})]}),S.jsxs("span",{className:"text-muted-foreground",children:["Cracked: ",S.jsx("span",{className:"text-green-500 font-medium",children:xe})]}),S.jsxs("span",{className:"text-muted-foreground",children:["Failed: ",S.jsx("span",{className:"text-destructive font-medium",children:ye})]}),U>0&&S.jsxs("span",{className:"text-muted-foreground",children:["Skipped (dup):"," ",S.jsx("span",{className:"text-muted-foreground font-medium",children:U})]})]}),b&&S.jsxs("div",{className:"space-y-1",children:[S.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[S.jsxs("span",{children:[b.phase==="wordlist"?"Dictionary":b.phase==="bruteforce"?"Bruteforce":"Public Key",b.phase==="bruteforce"&&` - Length ${b.currentLength}`,":"," ",b.currentPosition]}),S.jsxs("span",{children:[b.rateKeysPerSec>=1e9?`${(b.rateKeysPerSec/1e9).toFixed(2)} Gkeys/s`:`${(b.rateKeysPerSec/1e6).toFixed(1)} Mkeys/s`," "," ETA:"," ",b.etaSeconds<60?`${Math.round(b.etaSeconds)}s`:`${Math.round(b.etaSeconds/60)}m`]})]}),S.jsx("div",{className:"h-2 bg-muted rounded overflow-hidden",children:S.jsx("div",{className:"h-full bg-primary transition-all duration-200",style:{width:`${b.percent}%`}})})]}),z===!1&&S.jsx("div",{className:"text-sm text-destructive",children:"WebGPU not available. Cracking requires Chrome 113+ or Edge 113+."}),!N&&z!==!1&&S.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading wordlist..."}),E.length>0&&S.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[S.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Cracked Rooms:"}),S.jsx("div",{className:"space-y-1",children:E.map((Ce,Ge)=>S.jsxs("div",{className:"text-sm bg-green-950/30 border border-green-900/50 rounded px-2 py-1",children:[S.jsxs("span",{className:"text-green-400 font-medium",children:["#",Ce.roomName]}),S.jsxs("span",{className:"text-muted-foreground ml-2 text-xs",children:['"',Ce.message.slice(0,50),Ce.message.length>50?"...":"",'"']})]},Ge))})]}),S.jsx("hr",{className:"border-border"}),S.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:["For unknown-keyed GroupText packets, this will attempt to dictionary attack, then brute force payloads as they arrive, testing room names up to the specified length to discover active rooms on the local mesh (GroupText packets may not be hashtag messages; we have no way of knowing but try as if they are).",S.jsx("strong",{children:" Retry failed at n+1"})," will let the cracker return to the failed queue and pick up messages it couldn't crack, attempting them at one longer length.",S.jsx("strong",{children:" Decrypt historical"})," will run an async job on any room name it finds to see if any historically captured packets will decrypt with that key.",S.jsx("strong",{children:" Turbo mode"})," will push your GPU to the max (target dispatch time of 10s) and may allow accelerated cracking and/or system instability."]})]})}const eH=NS,tH=LS,cP=R.forwardRef(({className:n,...e},t)=>S.jsx(jp,{className:vt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e,ref:t}));cP.displayName=jp.displayName;const nH=xv("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),uP=R.forwardRef(({side:n="right",className:e,children:t,hideCloseButton:r=!1,...i},s)=>S.jsxs(tH,{children:[S.jsx(cP,{}),S.jsxs(Qp,{ref:s,className:vt(nH({side:n}),e),...i,children:[!r&&S.jsxs(FS,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[S.jsx(Hk,{className:"h-4 w-4"}),S.jsx("span",{className:"sr-only",children:"Close"})]}),t]})]}));uP.displayName=Qp.displayName;const hP=({className:n,...e})=>S.jsx("div",{className:vt("flex flex-col space-y-2 text-center sm:text-left",n),...e});hP.displayName="SheetHeader";const fP=R.forwardRef(({className:n,...e},t)=>S.jsx(Hp,{ref:t,className:vt("text-lg font-semibold text-foreground",n),...e}));fP.displayName=Hp.displayName;const rH=R.forwardRef(({className:n,...e},t)=>S.jsx(Wp,{ref:t,className:vt("text-sm text-muted-foreground",n),...e}));rH.displayName=Wp.displayName;const Nk=500;function iH(){const n=R.useRef(null),e=R.useRef(null),t=R.useRef(new Set),[r,i]=R.useState(null),[s,o]=R.useState(null),[a,u]=R.useState(null),[f,p]=R.useState([]),[g,x]=R.useState([]),[A,_]=R.useState([]),[b,w]=R.useState(null),[C,T]=R.useState(!1),[E,D]=R.useState(!1),[N,F]=R.useState(!1),[z,I]=R.useState(0),[K,W]=R.useState(!1),[U,X]=R.useState(!1),$=(a==null?void 0:a.favorites)??[],ee=R.useRef(null),le=R.useRef(null);R.useEffect(()=>{le.current=(s==null?void 0:s.name)??null},[s==null?void 0:s.name]);const Z=R.useCallback(se=>{const be=le.current;if(!be)return!1;const Oe=be.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(`@\\[${Oe}\\]`,"i").test(se)},[]),{messages:ie,messagesLoading:V,loadingOlder:ne,hasOlderMessages:q,setMessages:B,fetchMessages:Q,fetchOlderMessages:G,addMessageIfNew:Y,updateMessageAck:ue}=UB(b),{unreadCounts:pe,mentions:ve,lastMessageTimes:xe,incrementUnread:ye,markAllRead:Pe,trackNewMessage:Ke}=yB(g,f,b,s==null?void 0:s.name),{repeaterLoggedIn:nt,activeContactIsRepeater:Ce,handleTelemetryRequest:Ge,handleRepeaterCommand:pt}=mB(b,f,B),bt=R.useMemo(()=>({onHealth:se=>{const be=ee.current;ee.current=se,i(se),be!==null&&be.radio_connected!==se.radio_connected&&(se.radio_connected?(kt.success("Radio connected",{description:se.serial_port?`Connected to ${se.serial_port}`:void 0}),dt.getRadioConfig().then(o).catch(console.error)):kt.error("Radio disconnected",{description:"Check radio connection and power"}))},onError:se=>{kt.error(se.message,{description:se.details})},onSuccess:se=>{kt.success(se.message,{description:se.details})},onContacts:se=>p(se),onChannels:se=>x(se),onMessage:se=>{const be=e.current,Oe=be&&(se.type==="CHAN"&&be.type==="channel"||se.type==="PRIV"&&be.type==="contact")?se.conversation_key===be.id:!1;if(Oe&&Y(se),Ke(se),!se.outgoing&&!Oe){const Le=Kd(se);if(t.current.has(Le))return;if(t.current.add(Le),t.current.size>1e3){const ae=Array.from(t.current);t.current=new Set(ae.slice(-500))}let lt=null;if(se.type==="CHAN"&&se.conversation_key?lt=Ii("channel",se.conversation_key):se.type==="PRIV"&&se.conversation_key&&(lt=Ii("contact",se.conversation_key)),lt){const ae=Z(se.text);ye(lt,ae)}}},onContact:se=>{p(be=>{const Oe=be.findIndex(Le=>Le.public_key===se.public_key);if(Oe>=0){const Le=[...be],lt=be[Oe];return Le[Oe]={...lt,...se,name:se.name??lt.name,last_path:se.last_path??lt.last_path,lat:se.lat??lt.lat,lon:se.lon??lt.lon},Le}return[...be,se]})},onRawPacket:se=>{_(be=>{if(be.some(Le=>Le.id===se.id))return be;const Oe=[...be,se];return Oe.length>Nk?Oe.slice(-Nk):Oe})},onMessageAcked:(se,be,Oe)=>{ue(se,be,Oe)}}),[Y,Ke,ye,ue,Z]);aB(bt);const ot=R.useCallback(async()=>{try{const se=await dt.getRadioConfig();o(se)}catch(se){console.error("Failed to fetch config:",se)}},[]),mt=R.useCallback(async()=>{try{const se=await dt.getSettings();u(se),Ab(se.last_message_times??{})}catch(se){console.error("Failed to fetch app settings:",se)}},[]),et=R.useCallback(async()=>{try{const se=await dt.getUndecryptedPacketCount();I(se.count)}catch(se){console.error("Failed to fetch undecrypted count:",se)}},[]);R.useEffect(()=>{ot(),mt(),et()},[ot,mt,et]);const tt=R.useRef(!1);R.useEffect(()=>{if(!a||tt.current)return;if(a.preferences_migrated){Cb(),wb(),tt.current=!0;return}const se=d4(),be=xB(),Oe=gB();if(!(se.length>0||be!=="recent"||Object.keys(Oe).length>0)){tt.current=!0;return}tt.current=!0,(async()=>{try{const ae=await dt.migratePreferences({favorites:se,sort_order:be,last_message_times:Oe});ae.migrated&&kt.success("Preferences migrated",{description:`Migrated ${se.length} favorites to server`}),u(ae.settings),Ab(ae.settings.last_message_times??{}),Cb(),wb()}catch(ae){console.error("Failed to migrate preferences:",ae)}})()},[a]);const at=R.useCallback(()=>{const se=r5();if(!se)return null;if(se.type==="raw")return{type:"raw",id:"raw",name:"Raw Packet Feed"};if(se.type==="map")return{type:"map",id:"map",name:"Node Map",mapFocusKey:se.mapFocusKey};if(se.type==="visualizer")return{type:"visualizer",id:"visualizer",name:"Mesh Visualizer"};if(se.type==="channel"){const be=g.find(Oe=>Oe.name===se.name||Oe.name===`#${se.name}`);if(be)return{type:"channel",id:be.key,name:be.name}}if(se.type==="contact"){const be=f.find(Oe=>ro(Oe.name,Oe.public_key)===se.name);if(be)return{type:"contact",id:be.public_key,name:ro(be.name,be.public_key)}}return null},[g,f]),qe=R.useRef(!1);R.useEffect(()=>{if(qe.current||b||g.length===0&&f.length===0)return;const se=at();if(se){w(se),qe.current=!0;return}const be=g.find(Oe=>Oe.name==="Public");be&&(w({type:"channel",id:be.key,name:be.name}),qe.current=!0)},[g,f,b,at]),R.useEffect(()=>{e.current=b,b&&s5(b)},[b]);const Dt=R.useCallback(async se=>{b&&(b.type==="channel"?await dt.sendChannelMessage(b.id,se):await dt.sendDirectMessage(b.id,se),await Q())},[b,Q]),Jt=R.useCallback(async se=>{await dt.updateRadioConfig(se),await ot()},[ot]),dr=R.useCallback(async se=>{await dt.updateSettings(se),await mt()},[mt]),en=R.useCallback(async se=>{await dt.setPrivateKey(se),await ot()},[ot]),vn=R.useCallback(async()=>{await dt.rebootRadio(),i(be=>be&&{...be,radio_connected:!1}),(async()=>{for(let be=0;be<30;be++){await new Promise(Oe=>setTimeout(Oe,1e3));try{const Oe=await dt.getHealth();if(i(Oe),Oe.radio_connected){ot();return}}catch{}}})()},[ot]),En=R.useCallback(async()=>{try{await dt.sendAdvertisement(!0),kt.success("Advertisement sent")}catch(se){console.error("Failed to send advertisement:",se),kt.error("Failed to send advertisement",{description:se instanceof Error?se.message:"Check radio connection"})}},[]),Zn=R.useCallback(se=>{var be;(be=n.current)==null||be.appendText(`@[${se}] `)},[]),rn=R.useCallback(se=>{w(se),F(!1)},[]),Qt=R.useCallback(async(se,be)=>{const Le=Ga($,se,be)?$.filter(lt=>!(lt.type===se&&lt.id===be)):[...$,{type:se,id:be}];u(lt=>lt&&{...lt,favorites:Le});try{const lt=await dt.toggleFavorite(se,be);u(lt)}catch(lt){console.error("Failed to toggle favorite:",lt),u(ae=>ae&&{...ae,favorites:$}),kt.error("Failed to update favorite")}},[$]),sn=R.useCallback(async se=>{if(confirm("Delete this channel? Message history will be preserved."))try{await dt.deleteChannel(se),x(be=>be.filter(Oe=>Oe.key!==se)),w(null),kt.success("Channel deleted")}catch(be){console.error("Failed to delete channel:",be),kt.error("Failed to delete channel",{description:be instanceof Error?be.message:void 0})}},[]),pr=R.useCallback(async se=>{if(confirm("Delete this contact? Message history will be preserved."))try{await dt.deleteContact(se),p(be=>be.filter(Oe=>Oe.public_key!==se)),w(null),kt.success("Contact deleted")}catch(be){console.error("Failed to delete contact:",be),kt.error("Failed to delete contact",{description:be instanceof Error?be.message:void 0})}},[]),zn=R.useCallback(async(se,be,Oe)=>{const Le=await dt.createContact(be,se||void 0,Oe),lt=await dt.getContacts();p(lt),w({type:"contact",id:Le.public_key,name:ro(Le.name,Le.public_key)})},[]),Ae=R.useCallback(async(se,be,Oe)=>{const Le=await dt.createChannel(se,be),lt=await dt.getChannels();x(lt),w({type:"channel",id:Le.key,name:se}),Oe&&(await dt.decryptHistoricalPackets({key_type:"channel",channel_key:Le.key}),et())},[et]),Te=R.useCallback(async(se,be)=>{const Oe=se.startsWith("#")?se:`#${se}`,Le=await dt.createChannel(Oe),lt=await dt.getChannels();x(lt),w({type:"channel",id:Le.key,name:Oe}),be&&(await dt.decryptHistoricalPackets({key_type:"channel",channel_name:Oe}),et())},[et]),Ie=R.useCallback(async se=>{const be=(a==null?void 0:a.sidebar_sort_order)??"recent";u(Oe=>Oe&&{...Oe,sidebar_sort_order:se});try{const Oe=await dt.updateSettings({sidebar_sort_order:se});u(Oe)}catch(Oe){console.error("Failed to update sort order:",Oe),u(Le=>Le&&{...Le,sidebar_sort_order:be}),kt.error("Failed to save sort preference")}},[a==null?void 0:a.sidebar_sort_order]),xt=S.jsx(hR,{contacts:f,channels:g,activeConversation:b,onSelectConversation:rn,onNewMessage:()=>{T(!0),F(!1)},lastMessageTimes:xe,unreadCounts:pe,mentions:ve,showCracker:K,crackerRunning:U,onToggleCracker:()=>W(se=>!se),onMarkAllRead:Pe,favorites:$,sortOrder:(a==null?void 0:a.sidebar_sort_order)??"recent",onSortOrderChange:Ie});return S.jsxs("div",{className:"flex flex-col h-dvh",children:[S.jsx(i4,{health:r,config:s,onSettingsClick:()=>D(!0),onMenuClick:()=>F(!0)}),S.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[S.jsx("div",{className:"hidden md:block",children:xt}),S.jsx(eH,{open:N,onOpenChange:F,children:S.jsxs(uP,{side:"left",className:"w-[280px] p-0 flex flex-col",hideCloseButton:!0,children:[S.jsx(hP,{className:"sr-only",children:S.jsx(fP,{children:"Navigation"})}),S.jsx("div",{className:"flex-1 overflow-hidden",children:xt})]})}),S.jsx("div",{className:"flex-1 flex flex-col bg-background min-w-0",children:b?b.type==="map"?S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"flex justify-between items-center px-4 py-3 border-b border-border font-medium text-lg",children:"Node Map"}),S.jsx("div",{className:"flex-1 overflow-hidden",children:S.jsx(SQ,{contacts:f,focusedKey:b.mapFocusKey})})]}):b.type==="visualizer"?S.jsx(T7,{packets:A,contacts:f,config:s,onClearPackets:()=>_([])}):b.type==="raw"?S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"flex justify-between items-center px-4 py-3 border-b border-border font-medium text-lg",children:"Raw Packet Feed"}),S.jsx("div",{className:"flex-1 overflow-hidden",children:S.jsx(nv,{packets:A})})]}):S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-border font-medium text-lg gap-2",children:[S.jsxs("span",{className:"flex flex-wrap items-baseline gap-x-2 min-w-0 flex-1",children:[S.jsxs("span",{className:"flex-shrink-0",children:[b.type==="channel"&&!b.name.startsWith("#")&&b.name!=="Public"?"#":"",b.name]}),S.jsx("span",{className:"font-normal text-sm text-muted-foreground font-mono truncate cursor-pointer hover:text-primary",onClick:se=>{se.stopPropagation(),navigator.clipboard.writeText(b.id),kt.success(b.type==="channel"?"Room key copied!":"Contact key copied!")},title:"Click to copy",children:b.type==="channel"?b.id.toLowerCase():b.id}),b.type==="contact"&&(()=>{const se=f.find(Oe=>Oe.public_key===b.id);if(!se)return null;const be=[];if(se.last_seen&&be.push(`Last heard: ${Ac(se.last_seen)}`),se.last_path_len===-1?be.push("flood"):se.last_path_len===0?be.push("direct"):se.last_path_len>0&&be.push(`${se.last_path_len} hop${se.last_path_len>1?"s":""}`),jt(se.lat,se.lon)){const Oe=s&&jt(s.lat,s.lon)?Hi(s.lat,s.lon,se.lat,se.lon):null;be.push(S.jsxs("span",{children:[S.jsxs("span",{className:"font-mono cursor-pointer hover:text-primary hover:underline",onClick:Le=>{Le.stopPropagation();const lt=window.location.origin+window.location.pathname+zS(se.public_key);window.open(lt,"_blank")},title:"View on map",children:[se.lat.toFixed(3),", ",se.lon.toFixed(3)]}),Oe!==null&&` (${tl(Oe)})`]},"coords"))}return be.length>0?S.jsxs("span",{className:"font-normal text-sm text-muted-foreground flex-shrink-0",children:["(",be.map((Oe,Le)=>S.jsxs("span",{children:[Le>0&&", ",Oe]},Le)),")"]}):null})()]}),S.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(b.type==="channel"||b.type==="contact")&&S.jsx("button",{className:"p-1.5 rounded hover:bg-accent text-xl leading-none",onClick:()=>Qt(b.type,b.id),title:Ga($,b.type,b.id)?"Remove from favorites":"Add to favorites",children:Ga($,b.type,b.id)?S.jsx("span",{className:"text-yellow-500",children:""}):S.jsx("span",{className:"text-muted-foreground",children:""})}),!(b.type==="channel"&&b.name==="Public")&&S.jsx("button",{className:"p-1.5 rounded hover:bg-destructive/20 text-destructive text-xl leading-none",onClick:()=>{b.type==="channel"?sn(b.id):pr(b.id)},title:"Delete",children:""})]})]}),S.jsx(h5,{messages:ie,contacts:f,loading:V,loadingOlder:ne,hasOlderMessages:q,onSenderClick:b.type==="channel"?Zn:void 0,onLoadOlder:G,radioName:s==null?void 0:s.name,config:s}),S.jsx(g5,{ref:n,onSend:Ce?nt?pt:Ge:Dt,disabled:!(r!=null&&r.radio_connected),isRepeaterMode:Ce&&!nt,conversationType:b.type,senderName:s==null?void 0:s.name,placeholder:r!=null&&r.radio_connected?Ce?nt?"Send CLI command (requires admin login)...":`Enter password for ${b.name} (or . for none)...`:`Message ${b.name}...`:"Radio not connected"})]}):S.jsx("div",{className:"flex-1 flex items-center justify-center text-muted-foreground",children:"Select a conversation or start a new one"})})]}),S.jsx("div",{className:vt("border-t border-border bg-background transition-all duration-200 overflow-hidden",K?"h-[275px]":"h-0"),children:S.jsx(J7,{packets:A,channels:g,visible:K,onChannelCreate:async(se,be)=>{const Oe=await dt.createChannel(se,be),Le=await dt.getChannels();x(Le),await dt.decryptHistoricalPackets({key_type:"channel",channel_key:Oe.key}),et()},onRunningChange:X})}),S.jsx(G5,{open:C,contacts:f,undecryptedCount:z,onClose:()=>T(!1),onSelectConversation:se=>{w(se),T(!1)},onCreateContact:zn,onCreateChannel:Ae,onCreateHashtagChannel:Te}),S.jsx(c9,{open:E,config:s,health:r,appSettings:a,onClose:()=>D(!1),onSave:Jt,onSaveAppSettings:dr,onSetPrivateKey:en,onReboot:vn,onAdvertise:En,onHealthRefresh:async()=>{const se=await dt.getHealth();i(se)},onRefreshAppSettings:mt}),S.jsx($B,{position:"top-right"})]})}iB.createRoot(document.getElementById("root")).render(S.jsx(R.StrictMode,{children:S.jsx(iH,{})}));
//# sourceMappingURL=index-DEJuRmNA.js.map
